System.register("chunks:///_virtual/ActGetPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./Panel.ts","./Utils.ts","./AudioManager.ts","./EventManager.ts","./MaskView.ts","./PoolManager.ts","./ActivityMgr.ts"],(function(t){var e,n,i,r,o,a,s,c,l,u,p,f,h,g,d,m,v,y,x,b,w,k,C,A,M,P,B,F,_,I;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){s=t.cclegacy,c=t.sp,l=t.Sprite,u=t.Node,p=t._decorator,f=t.UIOpacity,h=t.UITransform,g=t.gfx,d=t.director,m=t.Color,v=t.resources,y=t.SpriteFrame,x=t.isValid,b=t.tween,w=t.v3},function(t){k=t.EventType},function(t){C=t.default},function(t){A=t.Utils},function(t){M=t.AudioManager},function(t){P=t.default},function(t){B=t.MaskView},function(t){F=t.default,_=t.PoolName},function(t){I=t.ActivityMgr}],execute:function(){var T,z,E,G,S,L,O,U,D;s._RF.push({},"91a7dMAdZRHCIIz3NwZ1+2z","ActGetPanel",void 0);var R=p,H=R.ccclass,N=R.property;t("default",(T=H("panel/ActGetPanel"),z=N(c.Skeleton),E=N(l),G=N(u),T((O=e((L=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"sp",O,r(e)),i(e,"imgBg",U,r(e)),i(e,"list",D,r(e)),e.callback=void 0,e}n(e,t);var s=e.prototype;return s.onLoad=function(){for(var t=0;t<50;t++)for(var e=0;e<50;e++){var n=F.get(_.colorBlock);n.addComponent(f),this.list.addChild(n);var i=13*e-318.5,r=318.5-13*t;n.setPosition(i,r,0)}},s.getPixels=function(t,e){var n,i=t.getComponent(h).width,r=t.getComponent(h).height,o=t.spriteFrame.getGFXTexture();if(!o)return null;var a=[],s=[],c=new g.BufferTextureCopy;c.texOffset.x=(null==e?void 0:e.x)||0,c.texOffset.y=(null==e?void 0:e.y)||0,c.texExtent.width=i,c.texExtent.height=r,s.push(c);var l=new Uint8Array(i*r*4);return a.push(l),null==(n=d.root)||n.device.copyTextureToBuffers(o,a,s),l},s.init=function(){var t=o(a().mark((function t(e,n){var i,r,o,s,c,u,p,g,d,b=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.sp.setCompleteListener((function(){b.sp.setCompleteListener(null),b.sp.setAnimation(0,"3_loop",!0)})),this.sp.setAnimation(0,"3_enter",!1),this.callback=e,i=!1,v.load("activity/big/act_"+I.I.ACT_ID+"/spriteFrame",y,(function(t,e){if(t)return console.error("[ActGetPanel] Failed to load activity big image:",t),void v.load("activity/big/act_4/spriteFrame",y,(function(t,e){!t&&e&&x(b.node)&&(b.imgBg.spriteFrame=e),i=!0}));x(b.node)&&(b.imgBg.spriteFrame=e),i=!0})),t.next=7,A.until((function(){return i}));case 7:r=this.getPixels(this.imgBg),o=this.imgBg,s=0;case 10:if(!(s<2500)){t.next=24;break}if(c=o.getComponent(h).width,u=o.getComponent(h).height,p=s%50,g=Math.floor(s/50),!(p<0||p>=c||g<0||g>=u)){t.next=17;break}return t.abrupt("return",null);case 17:d=4*(g*c+p)*13,this.list.children[s].getComponent(l).color=new m(r[d],r[d+1],r[d+2],r[d+3]),this.list.children[s].active=!0,this.list.children[s].getComponent(f).opacity=255;case 21:s++,t.next=10;break;case 24:this.animShow();case 25:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),s.animShow=function(){var t=o(a().mark((function t(){var e,n,i,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:B.show(),e=0;case 2:if(!(e<50)){t.next=10;break}for(n=0;n<50;n++)i=50*e+n,r=this.list.children[i],b(r.getComponent(f)).to(.2,{opacity:0}).start(),b(r).to(.2,{scale:w(5,5,5)}).start();return M.I.playEffect("pot1"),t.next=7,A.wait(50);case 7:e++,t.next=2;break;case 10:return t.next=12,A.wait(100);case 12:B.hide();case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.onClose=function(){this.callback&&this.callback(),P.I.emit(k.GO_HOME),this.close()},e}(C)).prototype,"sp",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(L.prototype,"imgBg",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=e(L.prototype,"list",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=L))||S));s._RF.pop()}}}));

System.register("chunks:///_virtual/ActivityFailPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./Panel.ts","./Utils.ts","./BoardDataMgr.ts","./AudioManager.ts","./EventManager.ts","./SdkTools.ts","./TDataMgr.ts","./I18nImageText.ts"],(function(e){var t,n,i,r,a,o,l,s,u,c,p,f,d,h,y,v,m,g,b,C,w,_,k;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){l=e.cclegacy,s=e.sp,u=e.Node,c=e._decorator,p=e.tween,f=e.UIOpacity,d=e.Color},function(e){h=e.EventType,y=e.TabType},function(e){v=e.default},function(e){m=e.Utils},function(e){g=e.BoardDataMgr},function(e){b=e.AudioManager},function(e){C=e.default},function(e){w=e.SdkTools},function(e){_=e.TDataMgr},function(e){k=e.I18nImageText}],execute:function(){var N,T,I,x,A,R,z,M,P,D,E,L,F;l._RF.push({},"43399FcbN5KZ77VQY6cAEmQ","ActivityFailPanel",void 0);var S=c,B=S.ccclass,H=S.property;e("default",(N=B("panel/ActivityFailPanel"),T=H(s.Skeleton),I=H(u),x=H(u),A=H(u),R=H(u),N((P=t((M=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"sp",P,r(t)),i(t,"hardNode",D,r(t)),i(t,"animNode",E,r(t)),i(t,"btnReplay",L,r(t)),i(t,"btnReplayHard",F,r(t)),t.isClick=!1,t}n(t,e);var l=t.prototype;return l.onLoad=function(){},l.init=function(){var e=a(o().mark((function e(){var t,n,i,r,a=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new d(50,100,50,255),n=[{nodeName:"word_6",i18nKey:"panel.replay",outlineColor:t,outlineWidth:4,fontSize:60},{nodeName:"word_8",i18nKey:"panel.replay",outlineColor:t,outlineWidth:4,fontSize:60}],k.replaceImageTexts(this.node,n),k.listenLanguageChange(this.node,n,this),this.isClick=!0,b.I.playEffect("defeat"),i=!1,r=!!g.I.levelCfg.is_hardlevel,this.animNode.getComponent(f).opacity=0,this.hardNode.active=!1,this.btnReplay.active=!r,this.btnReplayHard.active=r,this.sp.setCompleteListener((function(){a.sp.setCompleteListener(null),a.sp.setAnimation(0,"2_loop",!0),i=!0})),this.sp.setAnimation(0,"2_enter",!1),e.next=16,m.until((function(){return i}));case 16:return i=!1,p(this.animNode.getComponent(f)).to(.2,{opacity:255}).call((function(){i=!0})).start(),this.hardNode.active=!!g.I.levelCfg.is_hardlevel,e.next=21,m.until((function(){return i}));case 21:this.isClick=!1,_.ins.dot("video_exposure",{view_reason:"level_replay2"});case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onReplay=function(){var e=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isClick){e.next=2;break}return e.abrupt("return");case 2:return this.isClick=!0,e.next=5,w.share("level_replay2");case 5:t=e.sent,this.isClick=!1,0==t.code&&(this.close(),C.I.emit(h.REPLAY,!0));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onClose=function(){this.close(),C.I.emit(h.OPEN_TAB,y.activity,!1)},t}(v)).prototype,"sp",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(M.prototype,"hardNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(M.prototype,"animNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(M.prototype,"btnReplay",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(M.prototype,"btnReplayHard",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=M))||z));l._RF.pop()}}}));

System.register("chunks:///_virtual/ActivityMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./GameData.ts","./ObjectInstance.ts","./EventManager.ts"],(function(t){var e,n,i,a,r,s,c,o;return{setters:[function(t){e=t.createClass,n=t.asyncToGenerator,i=t.regeneratorRuntime},function(t){a=t.cclegacy},function(t){r=t.EventType},function(t){s=t.GameData},function(t){c=t.default},function(t){o=t.default}],execute:function(){a._RF.push({},"2bcf0MyRbVIYY8IBHP6n/Ey","ActivityMgr",void 0);t("ActivityMgr",function(){function t(){this.TOTAL_ACTIVITIES=22,this.DAYS_PER_ACTIVITY=14,this.BASE_DATE=new Date("2025-12-28T00:00:00Z").getTime(),this.MAX=25}var a=t.prototype;return a.init=function(){var t=n(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.ACT_ID!=s.data.activityId&&s.data.resetAct(this.ACT_ID),o.I.emit(r.ACT_CHANGE);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),a.addProgess=function(t){return-1==s.data.activityList.indexOf(t)&&s.data.activityList.push(t),!!this.isMAX&&(-1==s.data.collectionIds.indexOf(this.ACT_ID)&&(s.data.collectionIds.unshift(this.ACT_ID),s.save(!0)),!0)},e(t,[{key:"ACT_ID",get:function(){var t=Date.now(),e=Math.floor((t-this.BASE_DATE)/864e5);return e<0?1:Math.floor(e/this.DAYS_PER_ACTIVITY)%this.TOTAL_ACTIVITIES+1}},{key:"leftTime",get:function(){var t=Date.now(),e=(t-this.BASE_DATE)/864e5;if(e<0)return Math.floor((this.BASE_DATE-t)/1e3);var n=e%this.DAYS_PER_ACTIVITY,i=this.DAYS_PER_ACTIVITY-n;return Math.floor(24*i*60*60)}},{key:"isMAX",get:function(){return s.data.activityList.length>=this.MAX}},{key:"round_level",get:function(){return s.data.activityLevel+25*(this.ACT_ID-1)}}],[{key:"I",get:function(){return c.getInstance(t)}}]),t}());a._RF.pop()}}}));

System.register("chunks:///_virtual/ActivityPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./GameData.ts","./Panel.ts","./Utils.ts","./ActivityMgr.ts","./BoardDataMgr.ts","./AudioManager.ts","./EventManager.ts","./MaskView.ts","./PoolManager.ts","./UIManager.ts","./Tips.ts","./SdkTools.ts","./TDataMgr.ts","./I18nManager.ts","./I18nImageText.ts"],(function(t){var e,i,n,a,r,o,s,l,c,u,d,f,h,p,g,m,b,v,y,x,T,w,k,I,B,M,_,A,P,C,S,F,D,L,z,E,N,U,G,O,K,R;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized,r=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){s=t.cclegacy,l=t.Sprite,c=t.Node,u=t.Label,d=t.Prefab,f=t._decorator,h=t.UITransform,p=t.gfx,g=t.director,m=t.find,b=t.view,v=t.Color,y=t.UIOpacity,x=t.resources,T=t.SpriteFrame,w=t.v3,k=t.tween},function(t){I=t.EventType,B=t.GameType},function(t){M=t.GameData},function(t){_=t.default},function(t){A=t.Utils},function(t){P=t.ActivityMgr},function(t){C=t.BoardDataMgr},function(t){S=t.AudioManager},function(t){F=t.default},function(t){D=t.MaskView},function(t){L=t.default,z=t.PoolName},function(t){E=t.default,N=t.PanelType},function(t){U=t.default},function(t){G=t.SdkTools},function(t){O=t.TDataMgr},function(t){K=t.I18n},function(t){R=t.I18nImageText}],execute:function(){var H,V,X,j,W,q,J,Q,Y,Z,$,tt,et;s._RF.push({},"2ffc9SMFnlMTamKFp7s0ICA","ActivityPanel",void 0);var it=f,nt=it.ccclass,at=it.property;t("default",(H=nt("home/ActivityPanel"),V=at(l),X=at(l),j=at(c),W=at(u),q=at(d),H((Y=e((Q=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,n(e,"title",Y,a(e)),n(e,"imgBg",Z,a(e)),n(e,"list",$,a(e)),n(e,"labTime",tt,a(e)),n(e,"colorBlock",et,a(e)),e.isHome=!1,e.isLast=!1,e}i(e,t);var s=e.prototype;return s.onLoad=function(){var t=r(o().mark((function t(){var e,i,n,a,r,s,c,u,d,f,p,g,m,b,w,k,I=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return L.initPool(z.colorBlock,this.colorBlock),t.next=3,P.I.init();case 3:return this.labTime&&this.labTime.node&&this.labTime.node.parent&&this.labTime.node.parent.parent&&(e=this.labTime.node.parent,i=this.labTime.node.parent.parent,e.setSiblingIndex(i.children.length-1),console.log("[ActivityPanel] Moved labTime parent to top for visibility")),n="activity/big/act_"+P.I.ACT_ID+"/spriteFrame",x.load(n,T,(function(t,e){!t&&e?I.imgBg.spriteFrame=e:(console.warn("[ActivityPanel] Failed to load "+n+", trying fallback act_4"),x.load("activity/big/act_4/spriteFrame",T,(function(t,e){!t&&e?I.imgBg.spriteFrame=e:console.error("[ActivityPanel] Failed to load fallback activity bg act_4",t)})))})),this.title&&(this.title.spriteFrame=null,R.addOrUpdateLabel(this.title.node,{nodeName:"title",i18nKey:"home.activity",outlineColor:new v(160,60,0,255),fontSize:50,keepOriginalImage:!1}),K.on((function(){R.addOrUpdateLabel(I.title.node,{nodeName:"title",i18nKey:"home.activity",outlineColor:new v(160,60,0,255),fontSize:50})}),this)),this.updateButtonText(),K.on((function(){I.updateButtonText()}),this),t.next=11,A.until((function(){return!!I.imgBg.spriteFrame}));case 11:for(a=0;a<50;a++)for(r=0;r<50;r++)(s=L.get(z.colorBlock)).addComponent(y),this.list.addChild(s),c=13*r-318.5,u=318.5-13*a,s.setPosition(c,u,0);d=this.getPixels(this.imgBg),f=this.imgBg,p=0;case 15:if(!(p<2500)){t.next=28;break}if(g=f.getComponent(h).width,m=f.getComponent(h).height,b=p%50,w=Math.floor(p/50),!(b<0||b>=g||w<0||w>=m)){t.next=22;break}return t.abrupt("return",null);case 22:k=4*(w*g+b)*13,this.list.children[p].getComponent(l).color=new v(d[k],d[k+1],d[k+2],d[k+3]),this.list.children[p].active=!0;case 25:p++,t.next=15;break;case 28:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.update=function(t){this.labTime&&this.labTime.node&&(this.labTime.node.active=!0,this.labTime.node.parent&&(this.labTime.node.parent.active=!0),P.I.leftTime>0?this.labTime.string=K.t("panel.activity_remain",A.getDate(P.I.leftTime)):this.labTime.string=K.t("panel.activity_coming"))},s.getPixels=function(t,e){var i,n=t.getComponent(h).width,a=t.getComponent(h).height,r=t.spriteFrame.getGFXTexture();if(!r)return null;var o=[],s=[],l=new p.BufferTextureCopy;l.texOffset.x=(null==e?void 0:e.x)||0,l.texOffset.y=(null==e?void 0:e.y)||0,l.texExtent.width=n,l.texExtent.height=a,s.push(l);var c=new Uint8Array(n*a*4);return o.push(c),null==(i=g.root)||i.device.copyTextureToBuffers(r,o,s),c},s.onEnable=function(){this.adaptBgNode("bg2"),this.adaptBgNode("content/top-001/title_bg")},s.adaptBgNode=function(t){var e=this.node.getChildByName(t);if(e||(e=m(t,this.node)),e||"titlebg"===t&&(e=m("content/top-001/title_bg",this.node)),e){var i=e.getComponent(h);if(i){var n=b.getVisibleSize(),a=i.width,r=i.height;n.width,n.width;if(t.includes("title_bg"))i.setContentSize(n.width,r),console.log("[ActivityPanel] "+t+" width adapted: "+a+" -> "+n.width);else{var o=n.width/a,s=n.height/r,l=Math.max(o,s),c=a*l,u=r*l;i.setContentSize(c,u),console.log("[ActivityPanel] "+t+" adapted: "+a+"x"+r+" -> "+c.toFixed(0)+"x"+u.toFixed(0))}}}},s.init=function(){var t=r(o().mark((function t(e){var i,n,a,r,s,l,c,u,d,f,h,p,g,m,b,v,y,x=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e=!1),t.next=3,A.until((function(){return!!x.imgBg.spriteFrame}));case 3:for(i=0;i<M.data.activityList.length;i++)for(n=M.data.activityList[i],a=n%5,r=Math.floor(n/5),s=10*a+10*r*50,l=0;l<10;l++)for(c=0;c<10;c++)u=s+50*l+c,this.list.children[u].active=!1;if(D.show(),d=!0,f=0,this.isLast=!1,!e){t.next=29;break}h=[],p=0;case 11:if(!(p<P.I.MAX)){t.next=18;break}if(!(M.data.activityList.indexOf(p)>-1)){t.next=14;break}return t.abrupt("continue",15);case 14:h.push(p);case 15:p++,t.next=11;break;case 18:if(0!=h.length){t.next=20;break}return t.abrupt("return");case 20:g=h[Math.floor(Math.random()*h.length)],this.isLast=P.I.addProgess(g),m=g%5,b=Math.floor(g/5),f=10*m+10*b*50,v=130*m-325+65,y=130*b-325+65,this.imgBg.node.setPosition(w(5*-v,5*y,0)),this.imgBg.node.scale=w(5,5,5);case 29:return t.next=31,A.until((function(){return d}));case 31:D.hide(),e&&this.animShow(f),M.data.actLevelDie&&O.ins.dot("video_exposure",{view_reason:"act_level_start"}),M.data.goActivityTime=PUCHI_SDK.Time.currentTime;case 35:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),s.animShow=function(){var t=r(o().mark((function t(e){var i,n,a,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:D.show(),i=0;case 2:if(!(i<10)){t.next=18;break}n=0;case 4:if(!(n<10)){t.next=15;break}return a=e+50*i+n,n%3==0&&S.I.playEffect("pot1"),r=this.list.children[a],k(r.getComponent(y)).to(.5,{opacity:0}).start(),k(r).to(.5,{scale:w(5,5,5)}).start(),t.next=12,A.wait(20);case 12:n++,t.next=4;break;case 15:i++,t.next=2;break;case 18:return t.next=20,A.wait(500);case 20:return k(this.imgBg.node).to(.5,{position:w(0,0,0),scale:w(1,1,1)}).start(),t.next=23,A.wait(500);case 23:if(D.hide(),!this.isLast){t.next=28;break}return t.next=27,E.waitAddPanel(N.ActGetPanel,P.I.ACT_ID);case 27:t.sent;case 28:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),s.onStart=function(){var t=r(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!P.I.isMAX){t.next=3;break}return U.show(K.t("tips.activity_complete")),t.abrupt("return");case 3:if(!(P.I.leftTime<0)){t.next=6;break}return U.show(K.t("tips.activity_ended")),t.abrupt("return");case 6:if(!M.data.actLevelDie){t.next=13;break}return 0!==M.data.activityData.map.length&&C.I.resetActLevelData(),t.next=10,G.share("act_level_start");case 10:return 0==t.sent.code&&F.I.emit(I.START_GAME,B.activity,!0),t.abrupt("return");case 13:F.I.emit(I.START_GAME,B.activity);case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),s.updateButtonText=function(){R.replaceImageTexts(this.node,[{nodeName:"huodong__word",i18nKey:"home.play",outlineColor:new v(164,84,0,255),fontSize:55,outlineWidth:6}])},e}(_)).prototype,"title",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=e(Q.prototype,"imgBg",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=e(Q.prototype,"list",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tt=e(Q.prototype,"labTime",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et=e(Q.prototype,"colorBlock",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=Q))||J));s._RF.pop()}}}));

System.register("chunks:///_virtual/AssetMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BundleMgr.ts","./Const.ts"],(function(n){var e,t,r,o,a,c,s,i,u,l,f,d,p,h;return{setters:[function(n){e=n.asyncToGenerator,t=n.regeneratorRuntime,r=n.createClass},function(n){o=n.cclegacy,a=n._decorator,c=n.SpriteFrame,s=n.SpriteAtlas,i=n.Material,u=n.Prefab,l=n.assetManager,f=n.Texture2D,d=n.JsonAsset},function(n){p=n.BundleMgr},function(n){h=n.BUNDLES}],execute:function(){var g,k;o._RF.push({},"8b795pjLCBDboUHVpOu1Ez/","AssetMgr",void 0);var v=a,b=v.ccclass;v.property,n("AssetMgr",b("AssetMgr")(((k=function(){function n(){this.blockIcon={},this.loadingIcon={},this.currentSkin=1,this.t=0,this.sf={}}var o=n.prototype;return o.get=function(n,e,t){var r=p.I.getBundle(n);return r?r.get(e,t):new Error(n+" 未加载,请先加载")},o.load=function(n,e,t,r){var o=p.I.getBundle(n);if(o){var a=o.get(e,t);a?r(null,a):o.load(e,t,(function(n,e){r(n,e)}))}else{var c=new Error(n+" 未加载,请先加载");r(c,null)}},o.loadAsync=function(n,r,o){return new Promise(e(t().mark((function e(a,c){var s,i,u;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=p.I.getBundle(n)){e.next=5;break}return i=new Error(n+" 未加载,请先加载"),c(i),e.abrupt("return");case 5:(u=s.get(r,o))?a(u):s.load(r,o,(function(n,e){n?c(n):a(e)}));case 7:case"end":return e.stop()}}),e)}))))},o.releaseBundleRes=function(n,e){p.I.getBundle(n).release(e)},o.loadDir=function(n,e,t){var r=p.I.getBundle(n);if(r)r.loadDir(e,(function(n,e){t(n,n?null:e)}));else{var o=new Error("loadDir "+n+" 未加载,请先加载");t(o,null)}},o.loadDirAsync=function(){var n=e(t().mark((function n(e,r){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,t){p.I.getBundle(e).loadDir(r,(function(e,r){e?t(e):n(r)}))})));case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),o.loadSpriteFrameAsync=function(n,e){var t=this;return new Promise((function(r,o){t.load(n,e,c,(function(n,e){n?o(n):r(e)}))}))},o.loadAtlas=function(n,e){var t=this;return new Promise((function(r,o){t.load(n,e,s,(function(n,e){n?o(n):r(e)}))}))},o.loadMaterial=function(n,e){var t=this;return new Promise((function(r,o){t.load(n,e,i,(function(n,e){n?o(n):r(e)}))}))},o.loadPrefabAsync=function(n,e){var t=this;return new Promise((function(r,o){t.load(n,e,u,(function(n,e){n?o(n):r(e)}))}))},o.initBlockIcon=function(){var n=e(t().mark((function n(e){var r,o,a,c=this;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:void 0===e&&(e=1),this.currentSkin=e,r=[],o=t().mark((function n(e){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.push(c.loadIcon(h.Game,"images/jewel1_"+(e+1)).then((function(n){c.blockIcon["jewel1_"+(e+1)]=n})).catch((function(n){return console.error("[AssetMgr] Failed to load jewel icon: jewel1_"+(e+1),n)}))),r.push(c.loadIcon(h.Game,"images/jewel1_"+(e+1)+"_bg").then((function(n){c.blockIcon["jewel1_"+(e+1)+"_bg"]=n})).catch((function(n){return console.error("[AssetMgr] Failed to load jewel bg: jewel1_"+(e+1)+"_bg",n)})));case 2:case"end":return n.stop()}}),n)})),a=0;case 5:if(!(a<7)){n.next=10;break}return n.delegateYield(o(a),"t0",7);case 7:a++,n.next=5;break;case 10:return this.preloadSkinInBackground(e),n.next=13,Promise.all(r);case 13:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),o.preloadSkinInBackground=function(){var n=e(t().mark((function n(e){var r;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log("[AssetMgr] Preloading skin "+e+" in background...");try{for(r=0;r<7;r++)this.loadIconLazy("block_"+e+"_"+(r+1),"images/skins/block_"+e+"_"+(r+1));this.loadIconLazy("block_"+e+"_8","images/skins/block_"+e+"_8"),this.loadIconLazy("block_"+e+"_8_2","images/skins/block_"+e+"_8_2"),console.log("[AssetMgr] Skin "+e+" preload started")}catch(n){console.warn("[AssetMgr] Background skin preload warning:",n)}case 2:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),o.loadIconLazy=function(n,e){var t=this;this.blockIcon[n]||this.loadingIcon[n]||(this.loadingIcon[n]=this.loadIcon(h.Game,e).then((function(e){return t.blockIcon[n]=e,delete t.loadingIcon[n],e})).catch((function(e){throw delete t.loadingIcon[n],e})))},o.getBlockIcon=function(n){if(this.blockIcon[n])return this.blockIcon[n];if(this.loadingIcon[n])return null;var e=n.match(/block_(\d+)_(\d+)/);if(e){var t=parseInt(e[1]),r=parseInt(e[2]),o=n.endsWith("_2")?"images/skins/block_"+t+"_"+r+"_2":"images/skins/block_"+t+"_"+r;console.log("[AssetMgr] Lazy loading icon: "+n),this.loadIconLazy(n,o)}return Date.now()-this.t>6e4&&(this.t=Date.now(),console.log("[AssetMgr] Icon not ready: "+n)),null},o.getBlockIconAsync=function(){var n=e(t().mark((function n(e){var r,o,a,c,s,i;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.blockIcon[e]){n.next=2;break}return n.abrupt("return",this.blockIcon[e]);case 2:if(!this.loadingIcon[e]){n.next=6;break}return n.next=5,this.loadingIcon[e];case 5:return n.abrupt("return",n.sent);case 6:if(!(r=e.match(/block_(\d+)_(\d+)/))){n.next=24;break}return o=parseInt(r[1]),a=parseInt(r[2]),c=e.endsWith("_2"),s=c?"images/skins/block_"+o+"_"+a+"_2":"images/skins/block_"+o+"_"+a,n.prev=12,n.next=15,this.loadIcon(h.Game,s);case 15:return i=n.sent,this.blockIcon[e]=i,n.abrupt("return",i);case 20:return n.prev=20,n.t0=n.catch(12),console.error("[AssetMgr] Failed to load icon: "+e,n.t0),n.abrupt("return",null);case 24:return n.abrupt("return",null);case 25:case"end":return n.stop()}}),n,this,[[12,20]])})));return function(e){return n.apply(this,arguments)}}(),o.switchSkin=function(){var n=e(t().mark((function n(e){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==this.currentSkin){n.next=2;break}return n.abrupt("return");case 2:return console.log("[AssetMgr] Switching skin: "+this.currentSkin+" -> "+e),this.currentSkin=e,n.next=6,this.preloadSkinInBackground(e);case 6:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),o.loadIcon=function(){var n=e(t().mark((function n(e,r){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.loadSpriteFrameAsync(e,r+"/spriteFrame");case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})));return function(e,t){return n.apply(this,arguments)}}(),o.loadPuzzleImg=function(){var n=e(t().mark((function n(e,r){var o,a;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===r&&(r=!1),o="puzzle/Puzzle_"+e+(r?"_2":""),a=e<=8?"Game":e<=50?"Puzzle":"Puzzle2",p.I.getBundle(a)){n.next=7;break}return n.next=7,p.I.loadBundleAsync(a);case 7:return n.next=9,this.loadIcon(a,o);case 9:return n.abrupt("return",n.sent);case 10:case"end":return n.stop()}}),n,this)})));return function(e,t){return n.apply(this,arguments)}}(),o.loadActImg=function(){var n=e(t().mark((function n(e){var r,o;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r="activity/act_"+e,o="Panel",p.I.getBundle(o)){n.next=6;break}return n.next=6,p.I.loadBundleAsync(o);case 6:return n.next=8,this.loadIcon(o,r);case 8:return n.abrupt("return",n.sent);case 9:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),o.loadTextuer2D=function(){var n=e(t().mark((function n(e,r){var o=this;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,t){o.load(e,r,f,(function(e,r){e?t(e):n(r)}))})));case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),o.loadJson=function(){var n=e(t().mark((function n(e,r){var o=this;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,t){o.load(e,r,d,(function(e,r){e?t(e):n(r)}))})));case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),o.loadRemote=function(n,e){var t=this;if(this.sf[n])return e(this.sf[n]);l.loadRemote(n,{ext:".png"},(function(r,o){if(o){var a=new f;a.image=o;var s=new c;s.texture=a,t.sf[n]=s,e(s)}}))},r(n,null,[{key:"I",get:function(){return n._instance||(n._instance=new n)}}]),n}())._instance=null,g=k))||g);o._RF.pop()}}}));

System.register("chunks:///_virtual/AssetPool.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts"],(function(e){var t,r,o,n,s,a,i,c,u,l,f,p;return{setters:[function(e){t=e.createClass,r=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){n=e.cclegacy,s=e._decorator,a=e.Vec3,i=e.instantiate,c=e.NodePool,u=e.warn,l=e.Component,f=e.error},function(e){p=e.AssetMgr}],execute:function(){var h,b;n._RF.push({},"f43f0pG7fBLjY1Qnbgb/dpt","AssetPool",void 0);var P=s,g=P.ccclass;P.property,e("AssetPool",g("AssetPool")(((b=function(){function e(){this.pools=new Map,this.prefabs=new Map,this._v3Pool=[]}var n=e.prototype;return n.getV3=function(){return this._v3Pool.length>0?this._v3Pool.pop():new a},n.putV3=function(e){this._v3Pool.push(e)},n.addPrefab=function(e,t,r){e.addRef(),this.pools.has(t)||this.createPool(t,r),this.getPool(t).put(i(e)),this.prefabs.set(t,e)},n.getPrefab=function(e){return this.prefabs.get(e)},n.removePrefab=function(e){var t=this.prefabs.get(e);t&&t.decRef(!0),this.prefabs.delete(e);var r=this.pools.get(e);r&&r.clear(),this.pools.delete(e)},n.clearPrefabs=function(){var e=this;this.prefabs.forEach((function(t,r){t.decRef(!0);var o=e.pools.get(r);o&&o.clear(),e.pools.delete(r)})),this.prefabs.clear()},n.createPool=function(e,t){var r=new c(t);return this.pools.set(e,r),r},n.removePool=function(e){this.pools.has(e)&&this.pools.delete(e)},n.clear=function(e){e?this.getPool(e).clear():this.pools.forEach((function(e,t){e.clear()}))},n.getPool=function(e,t){var r=this.pools.get(e);return r||(r=this.createPool(e,t)),r},n.createObjWithPrefab=function(e,t){var r=i(e);return r.__pool__=t,r},n.createObject=function(e){var t=this.get(e);if(t)return t;var r=this.getPrefab(e);return r?this.createObjWithPrefab(r,e):(u("Can't createObject prefab is null",e),null)},n.createObjAsync=function(){var e=r(o().mark((function e(t,r,n){var s,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s=this.get(r))){e.next=3;break}return e.abrupt("return",s);case 3:if(a=this.getPrefab(r)){e.next=9;break}return e.next=7,p.I.loadPrefabAsync(t,r);case 7:a=e.sent,this.addPrefab(a,r,n);case 9:return e.abrupt("return",this.createObjWithPrefab(a,r));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,o){return e.apply(this,arguments)}}(),n.get=function(e,t,r){var o=this.getPool(e,r),n=null;return o.size()>0&&((n=o.get(t)).__pool__=e),n},n.put=function(e){e instanceof l&&(e=e.node);var t=e.__pool__;t?this.getPool(t).put(e):f("[AssetPool.put] node"+e+", key is nil!")},t(e,null,[{key:"I",get:function(){return e._instance||(e._instance=new e)}}]),e}())._instance=null,h=b))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Const.ts","./AssetMgr.ts","./GameData.ts"],(function(t){var e,i,n,s,o,u,a,r,c,d,h,l,_,f,p;return{setters:[function(t){e=t.inheritsLoose,i=t.createClass,n=t.asyncToGenerator,s=t.regeneratorRuntime},function(t){o=t.cclegacy,u=t.Button,a=t.Component,r=t._decorator,c=t.Node,d=t.director,h=t.AudioSource,l=t.AudioClip},function(t){_=t.BUNDLES},function(t){f=t.AssetMgr},function(t){p=t.GameData}],execute:function(){var m,v;o._RF.push({},"d8494HQqt9PlI287wobjoZr","AudioManager",void 0);var S=r,g=S.ccclass,y=(S.property,10),A=t("AudioManager",g("AudioManager")(((v=function(t){function o(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this)._musicSource=null,e._soundSource=null,e._audios=new Map,e._musicVolume=1,e._effectVolume=1,e.head_=0,e.tail_=0,e.soundPending_=new Array(y),e}e(o,t);var u=o.prototype;return u.load=function(){this.setVolume(1),this.setMusic(p.data.music),this.setEffect(p.data.sound)},u.warmup=function(){var t=n(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("[AudioManager] Warming up audio engine..."),t.prev=1,t.next=4,f.I.loadAsync(_.Audio,"Eliminate",l);case 4:(e=t.sent)&&(this._soundSource.playOneShot(e,0),console.log("[AudioManager] Audio engine warmed up successfully")),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.warn("[AudioManager] Warmup failed:",t.t0);case 11:case"end":return t.stop()}}),t,this,[[1,8]])})));return function(){return t.apply(this,arguments)}}(),u.setVolume=function(t){t<0?t=0:t>1&&(t=1),this._musicSource.volume=t,this._soundSource.volume=t},u.setMusic=function(t){this._musicVolume=t?1:0,this._musicSource.volume=this._musicVolume},u.setEffect=function(t){this._effectVolume=t?1:0,this._soundSource.volume=this._effectVolume},u.playMusic=function(){var t=n(s().mark((function t(e,i){var n,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i=_.Audio),"string"!=typeof(n=e)){t.next=7;break}return t.next=5,f.I.loadAsync(i,""+n,l);case 5:o=t.sent,n=o;case 7:this._musicSource.stop(),this._musicSource.clip=n,this._musicSource.loop=!0,this._musicSource.play();case 11:case"end":return t.stop()}}),t,this)})));return function(e,i){return t.apply(this,arguments)}}(),u.stopMusic=function(){this._musicSource.stop()},u.pauseMusic=function(){this._musicSource.pause()},u.resumeMusic=function(){this._musicSource.play()},u.playEffect=function(){var t=n(s().mark((function t(e,i,n){var o,u;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i=!1),void 0===n&&(n=_.Audio),p.data.sound){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,f.I.loadAsync(n,""+e,l);case 6:o=t.sent,(u=o)&&(this._audios[e]=u,this._addSoundToPending(u,i));case 9:case"end":return t.stop()}}),t,this)})));return function(e,i,n){return t.apply(this,arguments)}}(),u.stopEffect=function(t){"string"==typeof t&&(t=this._audios[t]),this._stopSound(t)},u._addSoundToPending=function(t,e){if((this.tail_+1)%y!=this.head_){for(var i=this.head_;i!=this.tail_;i=(i+1)%y)if(this.soundPending_[i].audioClip==t)return;this.soundPending_[this.tail_]={audioClip:t,loop:e},this.tail_=(this.tail_+1)%y}},u._startSound=function(t,e){var i=this._effectVolume;p.data.sound||(i=0),this._soundSource.volume=i,this._soundSource.playOneShot(t)},u._stopSound=function(t){this._soundSource.stop();for(var e=this.head_;e!=this.tail_;e=(e+1)%y)if(this.soundPending_[e].audioClip==t){this.soundPending_[e]=this.soundPending_[this.tail_],this.tail_=(this.tail_+y-1)%y;break}},u.lateUpdate=function(t){if(this.head_!=this.tail_)for(;this.head_!=this.tail_;){var e=this.soundPending_[this.head_],i=e.audioClip,n=e.loop;this._startSound(i,n),this.head_=(this.head_+1)%y}},i(o,null,[{key:"I",get:function(){if(null==this._instance){var t=new c("AudioManager");d.addPersistRootNode(t),this._instance=t.addComponent(o),this._instance._musicSource=t.addComponent(h),this._instance._soundSource=t.addComponent(h),this._instance.load()}return o._instance}}]),o}(a))._instance=null,m=v))||m);u.prototype._onTouchEnded=function(t){if(this.interactable&&this.enabledInHierarchy){var e;if(A.I.playEffect("click"),p.data.vibrate)"undefined"!=typeof PUCHI_SDK&&null!=(e=PUCHI_SDK.Platform)&&e.vibrateShort&&PUCHI_SDK.Platform.vibrateShort("light");this._pressed&&(a.EventHandler.emitEvents(this.clickEvents,t),this.node.emit("click",this)),this._pressed=!1,this._updateState()}},o._RF.pop()}}}));

System.register("chunks:///_virtual/BackgroundAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,a,h;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t.UITransform,o=t.screen,r=t.view,a=t._decorator,h=t.Component}],execute:function(){var s;n._RF.push({},"bdda74lvVBESZAVo0hjs3LK","BackgroundAdapter",void 0);var d=a,c=d.ccclass;d.property,t("BackgroundAdapter",c("BackgroundAdapter")(s=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).nodeWidth=null,e.nodeHeight=null,e}e(n,t);var a=n.prototype;return a.onLoad=function(){var t=this.node.getComponent(i);this.nodeHeight=t.height,this.nodeWidth=t.width},a.onEnable=function(){this.adapter(),o.on("window-resize",this.adapter,this),o.on("orientation-change",this.adapter,this)},a.onDisable=function(){o.off("window-resize",this.adapter,this),o.off("orientation-change",this.adapter,this)},a.adapter=function(){var t=this.node.getComponent(i),e=r.getVisibleSize(),n=this.nodeWidth/t.height;n=n<e.width/e.height?e.width/this.nodeHeight:e.height/t.height,this.node.setScale(n,n,n)},n}(h))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/Block.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./GameData.ts","./GameConst.ts"],(function(e){var t,o,i,l,r,c,s,n,a,h,p,g,u,f,B,v,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,i=e.initializerDefineProperty,l=e.assertThisInitialized,r=e.createClass},function(e){c=e.cclegacy,s=e.Sprite,n=e.Material,a=e.Node,h=e._decorator,p=e.UIOpacity,g=e.Tween,u=e.Color,f=e.Component},function(e){B=e.AssetMgr},function(e){v=e.GameData},function(e){w=e.default}],execute:function(){var y,b,_,j,I,m,k,C,d,F,O,A,L;c._RF.push({},"fbe16cvMDlHjav0JeSWFGFk","Block",void 0),console.log("[Load] Loading Block.ts");var M=h,T=M.ccclass,K=M.property;e("Block",(y=T("game/Block"),b=K(s),_=K(s),j=K(s),I=K(n),m=K(a),y((d=t((C=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r))||this,i(t,"icon",d,l(t)),i(t,"jewelBg",F,l(t)),i(t,"jewelIcon",O,l(t)),i(t,"materials",A,l(t)),i(t,"obstacles",L,l(t)),t._color=void 0,t._iconOpacity=null,t}o(t,e);var c=t.prototype;return c.getIconOpacity=function(){return!this._iconOpacity&&this.icon&&(this._iconOpacity=this.icon.getComponent(p)),this._iconOpacity},c.forceResetOpacity=function(){g.stopAllByTarget(this.node),this.icon&&(g.stopAllByTarget(this.icon),g.stopAllByTarget(this.icon.node));var e=this.getIconOpacity();e&&(g.stopAllByTarget(e),e.opacity=255);var t=this.node.getComponent(p);if(t&&(g.stopAllByTarget(t),t.opacity=255),this.icon&&this.icon.color){var o=this.icon.color;255!==o.a&&(this.icon.color=new u(o.r,o.g,o.b,255))}if(this.jewelBg){g.stopAllByTarget(this.jewelBg),g.stopAllByTarget(this.jewelBg.node);var i=this.jewelBg.getComponent(p);if(i&&(g.stopAllByTarget(i),i.opacity=255),this.jewelBg.color&&255!==this.jewelBg.color.a){var l=this.jewelBg.color;this.jewelBg.color=new u(l.r,l.g,l.b,255)}}if(this.jewelIcon){g.stopAllByTarget(this.jewelIcon),g.stopAllByTarget(this.jewelIcon.node);var r=this.jewelIcon.getComponent(p);if(r&&(g.stopAllByTarget(r),r.opacity=255),this.jewelIcon.color&&255!==this.jewelIcon.color.a){var c=this.jewelIcon.color;this.jewelIcon.color=new u(c.r,c.g,c.b,255)}}this.icon&&this.icon.node&&(this.icon.node.active&&(this.icon.node.active=!1,this.icon.node.active=!0))},c.initPos=function(e,t,o,i){var l=w.BLOCK_W/2-(w.BLOCK_W+w.BLOCK_SPACE)*o/2+(w.BLOCK_W+w.BLOCK_SPACE)*t,r=-w.BLOCK_H/2+(w.BLOCK_H+w.BLOCK_SPACE)*i/2-(w.BLOCK_H+w.BLOCK_SPACE)*e;this.node.setPosition(l,r)},c.changeColor=function(e){if(this._color=e,e){var t=v.data.skin,o=Math.floor(e/100);if(0==o)for(var i=0;i<this.obstacles.length;i++)this.obstacles[i].active=!1;else if(o<4){for(var l=0;l<3;l++)this.obstacles[l].active=l<o;this.obstacles[3].active=!1}else if(4==o){for(var r=0;r<3;r++)this.obstacles[r].active=!1;this.obstacles[3].active=!0}var c=Math.floor(e%100/10),s=e%10;c>0?(this.icon.spriteFrame=B.I.getBlockIcon("block_"+t+"_8"),this.jewelBg.spriteFrame=B.I.getBlockIcon("jewel1_"+c+"_bg"),this.jewelIcon.spriteFrame=B.I.getBlockIcon("jewel1_"+c)):(this.icon.spriteFrame=B.I.getBlockIcon("block_"+t+"_"+s),this.jewelBg.spriteFrame=null,this.jewelIcon.spriteFrame=null)}else{for(var n=0;n<this.obstacles.length;n++)this.obstacles[n].active=!1;this.icon.spriteFrame=null,this.jewelBg.spriteFrame=null,this.jewelIcon.spriteFrame=null}},c.tipsColor=function(e){var t=Math.floor(this._color/100),o=Math.floor(this._color%100/10);if((t>0||o>0)&&(e=100*t+10*o+e),this._color=e,e){var i=v.data.skin,l=Math.floor(e/100);if(0==l)for(var r=0;r<this.obstacles.length;r++)this.obstacles[r].active=!1;else if(l<4)for(var c=0;c<3;c++)this.obstacles[c].active=c<l;else if(4==l){for(var s=0;s<3;s++)this.obstacles[s].active=!1;this.obstacles[3].active=!0}var n=Math.floor(e%100/10),a=e%10;n>0?(this.icon.spriteFrame=B.I.getBlockIcon("block_"+i+"_8_2"),this.jewelBg.spriteFrame=B.I.getBlockIcon("jewel1_"+n+"_bg"),this.jewelIcon.spriteFrame=B.I.getBlockIcon("jewel1_"+n)):(this.icon.spriteFrame=B.I.getBlockIcon("block_"+i+"_"+a),this.jewelBg.spriteFrame=null,this.jewelIcon.spriteFrame=null)}else{for(var h=0;h<this.obstacles.length;h++)this.obstacles[h].active=!1;this.icon.spriteFrame=null,this.jewelBg.spriteFrame=null,this.jewelIcon.spriteFrame=null}},c.handelObstacle=function(){var e=this.obstacle;4!=e&&this.changeColor(100*(e-1)+this._color%100)},r(t,[{key:"color",get:function(){return this._color}},{key:"jewelId",get:function(){return Math.floor(this._color%100/10)%10}},{key:"obstacle",get:function(){return Math.floor(this._color/100)}},{key:"opacity",set:function(e){var t=this.getIconOpacity();t&&(t.opacity=e)}},{key:"isOpacity",get:function(){var e=this.getIconOpacity();return!!e&&150==e.opacity}}]),t}(f)).prototype,"icon",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(C.prototype,"jewelBg",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(C.prototype,"jewelIcon",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(C.prototype,"materials",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=t(C.prototype,"obstacles",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=C))||k));c._RF.pop()}}}));

System.register("chunks:///_virtual/BoardDataMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./Enum.ts","./GameData.ts","./ObjectInstance.ts","./SdkTools.ts","./Utils.ts","./PlatformManager.ts","./ActivityMgr.ts","./DailyMgr.ts"],(function(e){var t,a,l,i,s,r,n,o,d,c,v,h,u,f,g;return{setters:[function(e){t=e.createClass},function(e){a=e.cclegacy,l=e.sys},function(e){i=e.ConfigManager},function(e){s=e.GameType,r=e.CollectType,n=e.GameState},function(e){o=e.GameData,d=e.BoardData},function(e){c=e.default},function(e){v=e.SdkTools},function(e){h=e.Utils},function(e){u=e.PlatformManager},function(e){f=e.ActivityMgr},function(e){g=e.DailyMgr}],execute:function(){a._RF.push({},"886a0hHGstD7JpxKwvP4Po3","BoardDataMgr",void 0),console.log("[Load] Loading BoardDataMgr.ts");e("BoardDataMgr",function(){function e(){this.state=0,this.type=void 0,this.data=void 0,this.levelCfg=void 0,this.collectType=void 0,this.winStreak=void 0,this.lastIsHard=!1}var a=e.prototype;return a.init=function(e,t,a){var l,d;switch(void 0===a&&(a=!1),this.type=e,this.data=t,this.type){case s.default:this.collectType=r.score;break;case s.level:this.levelCfg=i.getLevelTable(o.data.level),this.collectType=this.levelCfg.score>0?r.score:r.jewel,this.winStreak=o.data.winStreak,console.log("[BoardDataMgr] Level Init DEBUG:",{level:o.data.level,levelCfgScore:null==(l=this.levelCfg)?void 0:l.score,levelCfgCollect:null==(d=this.levelCfg)?void 0:d.collect,collectType:this.collectType,collectTypeName:this.collectType==r.score?"SCORE":"JEWEL",hasLevelCfg:!!this.levelCfg}),o.data.levelDie=!1,o.data.level==o.data.lastlevel?0==this.data.groupData.length&&o.data.levelTimes++:(o.data.lastlevel=o.data.level,o.data.levelTimes=1);break;case s.activity:this.levelCfg=i.getActLevelTable(f.I.round_level),this.collectType=this.levelCfg.score>0?r.score:r.jewel,o.data.actLevelDie=!1,o.data.activityLevel==o.data.actLastlevel?0==this.data.groupData.length&&o.data.actLevelTimes++:(o.data.actLastlevel=o.data.activityLevel,o.data.actLevelTimes=1);break;case s.daily:0==this.data.groupData.length&&o.data.dailyLevelTimes++,o.data.dailyLevelDie=!1,this.levelCfg=i.getDailyLevelTable(g.I.level),this.collectType=this.levelCfg.score>0?r.score:r.jewel}this.data.isVideo=a,this.state=n.Play,console.log("用户分层：",o.data.layer)},a.resetData=function(){switch(this.state=n.End,this.type){case s.default:o.data.today_restart++,o.data.endlessData&&(o.data.endlessData.map=[],o.data.endlessData.groupData=[],o.data.endlessData.score=0),o.data.endlessData=new d,o.data.endlessData.comboColor=h.randFromList([1,2,3],1)[0],o.save();break;case s.level:this.resetLevelData();break;case s.activity:this.resetActLevelData();break;case s.daily:this.resetDailyLevelData()}},a.resetLevelData=function(){o.data.levelData=new d,o.data.levelData.comboColor=h.randFromList([1,2,3],1)[0],o.save()},a.resetActLevelData=function(){o.data.activityData=new d,o.data.activityData.comboColor=h.randFromList([1,2,3],1)[0],o.save()},a.resetDailyLevelData=function(){o.data.dailyData=new d,o.save()},a.addLevel=function(){var e=l.isNative;switch(this.type){case s.default:break;case s.level:o.data.level++,o.data.winStreak++,0==o.data.level_ad_count?o.data.level_no_ad_count++:o.data.level_no_ad_count=0,o.data.level_ad_count=0,o.data.maxWinStreak<o.data.winStreak&&(o.data.maxWinStreak=o.data.winStreak),o.data.levelDie=!1,this.resetData(),e||!o.data.authorize||v.isWhite||PUCHI_SDK.GameService.rankAddV2({key:"rank_level",fraction:o.data.level,extend:{badge:o.data.daily_badge_count+""}}),u.getInstance().current.uploadRankData("rank_level",o.data.level,{badge:o.data.daily_badge_count+""}),o.save(!0);break;case s.activity:o.data.activityLevel++,o.data.actLevelDie=!1,this.resetData(),o.save(!0);break;case s.daily:o.data.daily_is_complete=!0,-1==o.data.dailyCompleteDays.indexOf(g.I.day)&&(o.data.dailyCompleteDays.push(g.I.day),o.data.daily_badge_count++,e||!o.data.authorize||v.isWhite||(PUCHI_SDK.GameService.rankAddV2({key:"rank_level",fraction:o.data.level,extend:{badge:o.data.daily_badge_count+""}}),PUCHI_SDK.GameService.rankAddV2({key:"rank_score",fraction:o.data.maxScore,extend:{badge:o.data.daily_badge_count+""}}))),this.resetData(),o.save(!0)}},a.getCollectById=function(e){var t=this.levelCfg.getCollect().find((function(t){return t.id==e}));if(!t)return 0;var a=t.num,l=this.data.collectJewel[e]||0;return Math.max(0,a-l)},a.getCount=function(e){for(var t=0,a=0;a<e.length;a++)for(var l=0;l<e[a].length;l++)0!=e[a][l]&&t++;return t},a.addCollectJewel=function(e){this.data.collectJewel.hasOwnProperty(e)||(this.data.collectJewel[e]=0),this.data.collectJewel[e]++},a.checkCollectEnd=function(){if(this.collectType!=r.jewel)return!1;for(var e=!0,t=this.levelCfg.getCollect(),a=0;a<t.length;a++){if((this.data.collectJewel[t[a].id]||0)<t[a].num){e=!1;break}}return e},a.addJewelToList=function(e){for(var t={},a=[],l=0,i=this.levelCfg.getCollect(),s=0;s<i.length;s++){var r=i[s];l+=r.num,(t[r.id]||0)<this.getCollectById(r.id)&&a.push(r.id)}if(0==a.length)return e;for(var n=this.getCount(e),o=this.getGemNum(l,Math.random()),d=[],c=0;c<n;c++)d.push(c+1);for(var v=h.randFromList(d,o),u=0,f=10*a[h.random(0,a.length-1)]+1,g=0;g<e.length;g++)for(var y=0;y<e[g].length;y++)0!=e[g][y]&&(u++,-1!=v.indexOf(u)&&(e[g][y]=f))},a.getGemNum=function(e,t){var a=0;return e>200?t>.95?a=20:t>.85?a=3:t>.7?a=2:t>.1&&(a=1):e>150?t>.97?a=20:t>.9?a=3:t>.7?a=2:t>.1&&(a=1):e>100?t>.98?a=20:t>.95?a=3:t>.75?a=2:t>.1&&(a=1):e>50?t>.99?a=20:t>.75?a=2:t>.1&&(a=1):t>.8?a=2:t>.1&&(a=1),a},a.getHardRatio=function(){var e=0;if(this.collectType!=r.jewel)return this.levelCfg.score<500?.5:this.levelCfg.score<1e3?.55:this.levelCfg.score<1500?.6:this.levelCfg.score<2e3?.65:.7;for(var t=this.levelCfg.getCollect(),a=0;a<t.length;a++){e+=t[a].num}return e>200?.85:e>150?.75:e>100?.7:e>50?.6:.5},t(e,[{key:"level",get:function(){switch(this.type){case s.level:return o.data.level;case s.activity:return o.data.activityLevel;case s.daily:default:return 0}}},{key:"collectRatio",get:function(){var e=0,t=0;if(this.collectType==r.score)return this.data.score/this.levelCfg.score;for(var a=this.levelCfg.getCollect(),l=0;l<a.length;l++){var i=a[l].num;e+=i,t+=Math.min(i,this.data.collectJewel[a[l].id]||0)}return t/e}},{key:"isHardLevel",get:function(){return!!this.levelCfg.is_hardlevel}},{key:"isHard",get:function(){if(this.type==s.level&&!this.lastIsHard&&o.data.level>h.getOnlineParamInt("dynamic_difficulty_level",10)){if(this.data.reviveCount>0&&1==h.getOnlineParamInt("revive_skip_hard",1)){var e=.2*this.data.reviveCount;if(e=Math.min(.4,e),Math.random()<e)return console.log("触发复活降低难度",e),!1}if(o.data.level_no_ad_count>0&&1==h.getOnlineParamInt("noad_add_hard",1)){var t=.1*o.data.level_no_ad_count;if(t=Math.min(.3,t),Math.random()<t)return console.log("触发多局未看视频增加难度",t),this.lastIsHard=!0,!0}}else this.lastIsHard=!1;var a=!1;if(this.type==s.level&&"19,22,25".split(",").indexOf(o.data.level+"")>-1&&(a=!0),this.isHardLevel||a){switch(this.type){case s.level:if(o.data.level<20&&Math.random()<h.getOnlineParamInt("lv1_50_ratio",.3))return console.log("触发困难关卡降低难度前20关"),!1;if(o.data.levelTimes>2){var l=.12-o.data.level/1e3;l<.05&&(l=.05);var i=(o.data.levelTimes-2)*l;if(i=Math.min(.5,i),Math.random()<i)return console.log("触发困难关卡重复玩降低难度",i),!1}if(7==o.data.level&&this.data.reviveCount>0&&1==h.getOnlineParamInt("lv_7_revive",1)){var n=.5*this.data.reviveCount;if(Math.random()<n)return console.log("触发第7关复活降低难度",n),!1}break;case s.activity:if(o.data.actLevelTimes>2){var d=.12-o.data.actLastlevel/1e3;d<.05&&(d=.05);var c=(o.data.actLevelTimes-2)*d;if(c=Math.min(.5,c),Math.random()<c)return console.log("触发活动困难关卡重复玩降低难度",c),!1}break;case s.daily:}var v=.1;return this.type===s.level&&"19,22,25".split(",").indexOf(o.data.level+"")>-1&&(v=h.getOnlineParamInt("hard_ratio",.3)),console.log("困难",v,this.collectRatio<=v),this.collectRatio<=v||this.collectRatio>this.getHardRatio()}if(this.levelCfg.hardNum>0){if(this.collectType==r.jewel){var u=0;for(var f in this.data.collectJewel)u+=this.data.collectJewel[f];return u>this.levelCfg.hardNum}return this.data.score>this.levelCfg.hardNum}return!1}},{key:"levelTimes",get:function(){return this.type==s.level?o.data.levelTimes:this.type==s.activity?o.data.actLevelTimes:this.type==s.daily?o.data.dailyLevelTimes:0}}],[{key:"I",get:function(){return c.getInstance(e)}}]),e}());a._RF.pop()}}}));

System.register("chunks:///_virtual/BtnActivity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./Enum.ts","./ActivityMgr.ts","./Utils.ts","./I18nManager.ts"],(function(t){var e,i,n,r,a,c,o,s,l,u,f,p,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,c=t.Label,o=t._decorator,s=t.Component},function(t){l=t.default},function(t){u=t.EventType},function(t){f=t.ActivityMgr},function(t){p=t.Utils},function(t){h=t.I18n}],execute:function(){var v,y,g,m,A;a._RF.push({},"f62535cZ5FA9q0HDABESsuT","BtnActivity",void 0);var T=o,b=T.ccclass,d=T.property;t("BtnActivity",(v=b("game/BtnActivity"),y=d(c),v((A=e((m=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return e=t.call.apply(t,[this].concat(a))||this,n(e,"labTime",A,r(e)),e}i(e,t);var a=e.prototype;return a.onLoad=function(){l.I.on(u.ACT_CHANGE,this.refresh,this),this.refresh()},a.update=function(t){f.I.leftTime>0?this.labTime.string=h.t("panel.activity_remain",p.getDate(f.I.leftTime)):(this.labTime.string="",this.refresh())},a.refresh=function(){this.node.active=f.I.leftTime>0},e}(s)).prototype,"labTime",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=m))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/BtnActLv.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./ActivityMgr.ts"],(function(t){var e,r,n,i,a,c,o,l,u,s,p,f,v,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,i=t.assertThisInitialized,a=t.asyncToGenerator,c=t.regeneratorRuntime},function(t){o=t.cclegacy,l=t.Sprite,u=t.SpriteFrame,s=t.Label,p=t._decorator,f=t.Component},function(t){v=t.GameData},function(t){h=t.ActivityMgr}],execute:function(){var y,b,g,m,L,d,A,w,B;o._RF.push({},"0c769cTlapIlaWOB1i6Xv6k","BtnActLv",void 0);var D=p,S=D.ccclass,z=D.property;t("BtnActLv",(y=S("game/BtnActLv"),b=z(l),g=z(u),m=z(s),y((A=e((d=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return e=t.call.apply(t,[this].concat(a))||this,n(e,"icon",A,i(e)),n(e,"iconSf",w,i(e)),n(e,"labLv",B,i(e)),e}r(e,t);var o=e.prototype;return o.onEnable=function(){var t=a(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.refresh(v.data.activityLevel);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.refresh=function(t){this.labLv.string=t+"/"+h.I.MAX,this.icon.spriteFrame=this.iconSf[v.data.actLevelDie?1:0]},e}(f)).prototype,"icon",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(d.prototype,"iconSf",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=e(d.prototype,"labLv",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=d))||L));o._RF.pop()}}}));

System.register("chunks:///_virtual/BtnEndLess.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts"],(function(e){var t,n,r,i,a,o,s,c,l,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,o=e.Sprite,s=e.SpriteFrame,c=e._decorator,l=e.Component},function(e){u=e.GameData}],execute:function(){var p,f,d,m,y,h,g;a._RF.push({},"6f77cXZZTpMqLe/I8SGKuen","BtnEndLess",void 0);var S=c,v=S.ccclass,_=S.property;e("BtnEndLess",(p=v("game/BtnEndLess"),f=_(o),d=_(s),p((h=t((y=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,r(t,"icon",h,i(t)),r(t,"iconSf",g,i(t)),t}return n(t,e),t.prototype.refresh=function(){var e=u.data.today_restart>=PUCHI_SDK.OnlineService.getParamsInt("today_restart_limit",3)&&0==u.data.endlessData.map.length;this.icon.spriteFrame=this.iconSf[e?1:0]},t}(l)).prototype,"icon",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=t(y.prototype,"iconSf",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),m=y))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/BtnHomeLv.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./GameData.ts","./TDataMgr.ts"],(function(e){var t,i,n,r,o,a,l,c,u,b,s,p,f,h,v,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e.Sprite,l=e.SpriteFrame,c=e.Color,u=e.Label,b=e._decorator,s=e.LabelOutline,p=e.LabelShadow,f=e.Component},function(e){h=e.ConfigManager},function(e){v=e.GameData},function(e){g=e.TDataMgr}],execute:function(){var m,L,d,y,w,C,S,z,D,F,M,_,H,B,I,T,A,P,R;o._RF.push({},"d95659F3FRCLbNcHSYAbHCY","BtnHomeLv",void 0);var x=b,G=x.ccclass,Y=x.property;e("BtnHomeLv",(m=G("game/BtnHomeLv"),L=Y(a),d=Y(l),y=Y(a),w=Y(a),C=Y(a),S=Y(l),z=Y(c),D=Y(u),m((_=t((M=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"bg",_,r(t)),n(t,"bgSf",H,r(t)),n(t,"icon",B,r(t)),n(t,"labIcon",I,r(t)),n(t,"labIcon2",T,r(t)),n(t,"iconSf",A,r(t)),n(t,"colors",P,r(t)),n(t,"labLv",R,r(t)),t}return i(t,e),t.prototype.refresh=function(e){var t,i=!(null==(t=h.getLevelTable(e))||!t.is_hardlevel),n=new c(0,0,0,255),r=this.labLv.getComponent(s);r||(r=this.labLv.addComponent(s)),r.enabled=!0,this.labLv.outlineColor=n,this.labLv.outlineWidth=5,this.labLv.color=new c(255,255,255,255),this.labLv.cacheMode=u.CacheMode.BITMAP;var o=this.labLv.getComponent(p);o||(o=this.labLv.addComponent(p)),this.labLv.shadowColor=this.colors[i?2:0]||new c(0,0,0,100),this.bg.spriteFrame=this.bgSf[i?1:0],this.icon.spriteFrame=this.iconSf[i?1:0],v.data.isLevelDie&&(g.ins.dot("video_exposure",{view_reason:"level_start"}),this.icon.spriteFrame=this.iconSf[i?3:2])},t}(f)).prototype,"bg",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(M.prototype,"bgSf",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=t(M.prototype,"icon",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(M.prototype,"labIcon",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(M.prototype,"labIcon2",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(M.prototype,"iconSf",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=t(M.prototype,"colors",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=t(M.prototype,"labLv",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=M))||F));o._RF.pop()}}}));

System.register("chunks:///_virtual/BundleMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t,u,r,l,i;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy,u=n._decorator,r=n.AssetManager,l=n.assetManager,i=n.error}],execute:function(){var o,a;t._RF.push({},"810aeRrAcdNc5kyQjT7jbnm","BundleMgr",void 0);var c=u,d=c.ccclass;c.property,n("BundleMgr",d("BundleMgr")(((a=function(){function n(){}var t=n.prototype;return t.isEngineBundle=function(n){return n==r.BuiltinBundleName.INTERNAL||n==r.BuiltinBundleName.MAIN||n==r.BuiltinBundleName.RESOURCES||n==r.BuiltinBundleName.START_SCENE},t.removeLoadedBundle=function(n){var e=this;void 0===n&&(n=[]);var t=[];l.bundles.forEach((function(n,u){e.isEngineBundle(u)||t.push(u)}));for(var u=t.length;u--;){var r=t[u];if(-1==n.indexOf(r)){var i=this.getBundle(r);i&&(this.removeBundle(i),l.removeBundle(i))}}},t.removeBundle=function(n){var e=this.getBundle(n);e&&e.releaseAll()},t.loadBundle=function(n,e){var t=this.getBundle(n);t?e&&e(t):l.loadBundle(n,{onFileProgress:function(){}},(function(n,t){e&&e(t)}))},t.loadBundleAsync=function(n){var e=this;return new Promise((function(t,u){var r=e.getBundle(n);r?t(r):l.loadBundle(n,(function(n,e){t(e)}))}))},t.getBundle=function(n){return n?"string"==typeof n?l.getBundle(n):n:null},t.getBundleName=function(n){return n?"string"==typeof n?n:n.name:(i("参数错误:"+n),"")},e(n,null,[{key:"I",get:function(){return n._instance||(n._instance=new n)}}]),n}())._instance=null,o=a))||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/CanvasAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,a,s,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t.screen,o=t.view,a=t.ResolutionPolicy,s=t._decorator,r=t.Component}],execute:function(){var c;n._RF.push({},"dce84LYBnxON5vwWl5KLKjD","CanvasAdapter",void 0);var u=s,h=u.ccclass;u.property,t("CanvasAdapter",h("CanvasAdapter")(c=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var s=n.prototype;return s.onLoad=function(){this.adapter()},s.onEnable=function(){i.on("window-resize",this.adapter,this),i.on("orientation-change",this.adapter,this)},s.onDisable=function(){i.off("window-resize",this.adapter,this),i.off("orientation-change",this.adapter,this)},s.adapter=function(){var t=i.windowSize,e=o.getDesignResolutionSize();t.width/t.height>e.width/e.height?o.setResolutionPolicy(a.FIXED_HEIGHT):o.setResolutionPolicy(a.FIXED_WIDTH)},n}(r))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/ChannelMgr.ts",["cc"],(function(n){var e,t,r;return{setters:[function(n){e=n.cclegacy,t=n.sys,r=n.native}],execute:function(){e._RF.push({},"732d6bg1QpDDbiayOz4SpTb","ChannelMgr",void 0),n("ChannelMgr",function(){function n(){}return n.getChannelId=function(){if(t.isNative&&t.os===t.OS.ANDROID)try{var n=r.reflection.callStaticMethod(this.CLASS_NAME,"getChannelId","()Ljava/lang/String;");return console.log("[ChannelMgr] Current Channel: "+n),n||"google"}catch(n){return console.error("[ChannelMgr] Failed to get channel ID",n),"google"}return"google"},n}()).CLASS_NAME="com/cocos/game/ChannelBridge",e._RF.pop()}}}));

System.register("chunks:///_virtual/CollectGamePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./GameData.ts","./Tips.ts","./I18nManager.ts"],(function(t){var e,n,i,a,r,o,c,s,l,u,f,p,h,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,a=t.assertThisInitialized,r=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){c=t.cclegacy,s=t.Node,l=t._decorator,u=t.Button},function(t){f=t.default},function(t){p=t.GameData},function(t){h=t.default},function(t){b=t.I18n}],execute:function(){var d,G,m,v,y,g,C;c._RF.push({},"4c64d9HfNdBmIVG6qHM69R+","CollectGamePanel",void 0);var P=l,k=P.ccclass,w=P.property;t("default",(d=k("panel/CollectGamePanel"),G=w(s),m=w(s),d((g=e((y=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,i(e,"btnGet",g,a(e)),i(e,"btnGet2",C,a(e)),e.t=0,e}n(e,t);var c=e.prototype;return c.update=function(t){p.data.isCollect||(this.t+=t,this.t>5&&(this.t=0,this.init()))},c.init=function(){var t=r(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p.data.isCollect){t.next=7;break}return t.next=3,PUCHI_SDK.Platform.checkIsAddedToMyMiniProgram();case 3:t.sent.code?this.btnGet.active=!1:this.btnGet.active=!0,t.next=9;break;case 7:this.btnGet.active=!1,this.btnGet2.active=!0;case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),c.onGet=function(){p.data.isCollect=!0,p.data.blockNum+=20,this.btnGet.getComponent(u).interactable=!1,h.show(b.t("tips.collect_success")),this.btnGet.active=!1,this.init()},c.onClose=function(){this.close()},e}(f)).prototype,"btnGet",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(y.prototype,"btnGet2",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=y))||v));c._RF.pop()}}}));

System.register("chunks:///_virtual/ComBlocks.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./Block.ts"],(function(t){var i,o,e,s,n,r,a,l,h,c,u,d,f,p,v,b,k,y;return{setters:[function(t){i=t.applyDecoratedDescriptor,o=t.inheritsLoose,e=t.initializerDefineProperty,s=t.assertThisInitialized,n=t.createForOfIteratorHelperLoose,r=t.createClass},function(t){a=t.cclegacy,l=t.Node,h=t.ParticleSystem2D,c=t.sp,u=t._decorator,d=t.v3,f=t.isValid,p=t.tween,v=t.Component},function(t){b=t.default,k=t.PoolName},function(t){y=t.Block}],execute:function(){var g,m,w,x,C,D,A,P,B,T,G;a._RF.push({},"e8050sTudNNVbnUeqRD/yqx","ComBlocks",void 0);var S=u,_=S.ccclass,z=S.property;t("ComBlocks",(g=_("game/ComBlocks"),m=z(l),w=z(l),x=z(h),C=z(c.Skeleton),g((P=i((A=function(t){function i(){for(var i,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return i=t.call.apply(t,[this].concat(n))||this,e(i,"box",P,s(i)),e(i,"shadow",B,s(i)),e(i,"par",T,s(i)),e(i,"ske",G,s(i)),i.blocks=[],i.shadows=[],i.onTouchGroup=void 0,i.index=void 0,i.isDisadble=!1,i.isPut=!1,i._list=void 0,i.color=void 0,i.oldColor=void 0,i.isGray=!1,i}o(i,t);var a=i.prototype;return a.init=function(t,i){this.index=t,this.isGray=!1,this.node.setPosition(220*t-220,0),this.onTouchGroup=i,this.node.on(l.EventType.TOUCH_START,this.touchStart,this)},a.getIndex=function(){return this.index},a.touchStart=function(t){if(!(this.isDisadble||this.isPut||this.isGray)){this.isDisadble=!0;var i=t.touch.getUILocation();this.onTouchGroup&&this.onTouchGroup(this.index,d(i.x,i.y,0))}},a.setDisable=function(t){this.isDisadble=t},a.createBlocks=function(t,i,o){if(void 0===o&&(o=!0),this._list=t,this.color=i,this.blocks.length>0){for(var e,s=n(this.blocks);!(e=s()).done;){var r=e.value;r.opacity=255,b.put(k.block,r.node)}this.blocks=[]}for(var a,l=n(this.shadows);!(a=l()).done;){var h=a.value;b.put(k.shadow,h)}this.shadows=[],o?(this.node.setScale(0,0),this.showAnim()):this.node.setScale(.5,.5);for(var c=0;c<t.length;c++)for(var u=0;u<t[c].length;u++)if(0!=t[c][u]){var f=b.get(k.block);this.box.addChild(f);var p=f.getComponent(y);p.initPos(c,u,t[0].length,t.length),p.changeColor(t[c][u]>0?10*Math.floor(t[c][u]/10)+i:0),this.blocks.push(p);var v=b.get(k.shadow);this.shadow.addChild(v);var g=d(p.node.position.x+12,p.node.position.y-16,0);v.setPosition(g),this.shadows.push(v)}this.visible=!0,this.isDisadble=!1,this.isPut=!1},a.showAnim=function(){if(f(this.node)&&(p(this.node).to(.1,{scale:d(.5,.5,1)}).start(),this.ske&&this.ske.skeletonData))try{this.ske.setAnimation(0,"enter",!1)}catch(t){console.warn("[ComBlocks] showAnim setAnimation error:",t)}},a.showAnim2=function(){if(p(this.node).to(.1,{scale:d(.4,.4,1)}).start(),this.ske&&this.ske.skeletonData)try{this.ske.setAnimation(0,"enter",!1)}catch(t){console.warn("[ComBlocks] showAnim2 setAnimation error:",t)}},a.shadowAnim=function(t){for(var i,o=n(this.shadows);!(i=o()).done;){var e=i.value;p(e).to(.1,{scale:d(t?.9:1,t?.9:1,1)}).start()}},r(i,[{key:"visible",get:function(){return this.box.active},set:function(t){this.box.active=t,this.shadow.active=t}},{key:"list",get:function(){return this._list}},{key:"count",get:function(){for(var t=0,i=0;i<this.list.length;i++)for(var o=0;o<this.list[i].length;o++)0!=this.list[i][o]&&t++;return t}},{key:"gray",set:function(t){this.isGray=t;for(var i,o=n(this.blocks);!(i=o()).done;){i.value.opacity=t?100:255}}}]),i}(v)).prototype,"box",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(A.prototype,"shadow",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=i(A.prototype,"par",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=i(A.prototype,"ske",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=A))||D));a._RF.pop()}}}));

System.register("chunks:///_virtual/ComBox.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./Enum.ts","./GameData.ts","./Utils.ts","./AudioManager.ts","./EventManager.ts","./PoolManager.ts","./UIManager.ts","./BoardDataMgr.ts","./GameMgr.ts","./Block.ts","./ComBlocks.ts","./ComCombo.ts","./ComDuoxiao.ts","./ComLight.ts","./GameConst.ts","./ModelView.ts","./TDataMgr.ts","./Tips.ts","./MaskView.ts","./NoSpace.ts","./SdkTools.ts","./PlatformManager.ts","./AssetMgr.ts","./DailyMgr.ts","./I18nManager.ts","./TopOnMgr.ts"],(function(e){var t,o,i,a,n,s,r,l,c,d,u,h,p,m,f,g,b,v,C,x,k,y,I,B,w,S,D,P,_,G,T,A,O,L,E,M,R,N,W,H,U,V,z,K,F,X,j,Y,J,q,Z,Q,$,ee,te,oe,ie,ae;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,n=e.createClass,s=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e.Node,d=e.sp,u=e._decorator,h=e.UIOpacity,p=e.find,m=e.UITransform,f=e.view,g=e.Label,b=e.Color,v=e.sys,C=e.isValid,x=e.Tween,k=e.Sprite,y=e.tween,I=e.v3,B=e.Component,w=e.Widget},function(e){S=e.ConfigManager},function(e){D=e.GameState,P=e.GameType,_=e.CollectType,G=e.EventType,T=e.TabType},function(e){A=e.GameData},function(e){O=e.Utils},function(e){L=e.AudioManager},function(e){E=e.default},function(e){M=e.default,R=e.PoolName},function(e){N=e.default,W=e.PanelType},function(e){H=e.BoardDataMgr},function(e){U=e.GameMgr},function(e){V=e.Block},function(e){z=e.ComBlocks},function(e){K=e.ComCombo},function(e){F=e.ComDuoxiao},function(e){X=e.ComLight},function(e){j=e.default},function(e){Y=e.ModelView},function(e){J=e.TDataMgr},function(e){q=e.default},function(e){Z=e.MaskView},function(e){Q=e.default},function(e){$=e.SdkTools},function(e){ee=e.PlatformManager},function(e){te=e.AssetMgr},function(e){oe=e.DailyMgr},function(e){ie=e.I18n},function(e){ae=e.TopOnMgr}],execute:function(){var ne,se,re,le,ce,de,ue,he,pe,me,fe,ge,be,ve,Ce,xe,ke,ye,Ie,Be,we,Se;function De(e,t){if(console.log("[safeSkin-ComBox] Called with skinName='"+t+"'"),!e)return console.warn("[safeSkin-ComBox] Skeleton is null"),!1;if(!e.skeletonData)return console.warn("[safeSkin-ComBox] skeletonData is null"),!1;try{var o=e.skeletonData.getRuntimeData();if(console.log("[safeSkin-ComBox] getRuntimeData returned:",o?"valid":"null"),!o||!o.findSkin)return console.warn("[safeSkin-ComBox] Cannot check skin existence"),!1;var i=o.findSkin(t);return console.log("[safeSkin-ComBox] findSkin('"+t+"') returned:",i?"found":"NOT FOUND"),i?(console.log("[safeSkin-ComBox] Calling setSkin('"+t+"')..."),e.setSkin(t),console.log("[safeSkin-ComBox] setSkin completed successfully"),!0):(console.warn("[safeSkin-ComBox] Skin '"+t+"' not found, skipping setSkin"),!1)}catch(e){return console.warn("[safeSkin-ComBox] Error setting skin '"+t+"':",e),!1}}l._RF.push({},"81188BrymJF86ldRiGGgO9U","ComBox",void 0),console.log("[Load] Loading ComBox.ts");var Pe=u,_e=Pe.ccclass,Ge=Pe.property;function Te(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];var a=v.isNative,n=A.data.level>=10,s=function(){N.openPanel.apply(N,[e].concat(o))};if(n&&a){console.log("[ComBox] openPanelWithAd: Native - showing ad FIRST before "+e);var r=ee.getInstance().current;r.showInterstitialWithCallback?r.showInterstitialWithCallback(s):s()}else s()}e("ComBox",(ne=_e("game/ComBox"),se=Ge(Y),re=Ge(c),le=Ge(c),ce=Ge(c),de=Ge(c),ue=Ge(d.Skeleton),he=Ge(d.Skeleton),pe=Ge(c),me=Ge(c),ne(((Se=function(e){function t(){for(var t,o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return t=e.call.apply(e,[this].concat(n))||this,i(t,"modelView",be,a(t)),i(t,"btm",ve,a(t)),i(t,"list",Ce,a(t)),i(t,"effect",xe,a(t)),i(t,"effect2",ke,a(t)),i(t,"comboSp",ye,a(t)),i(t,"duoxiaoSp",Ie,a(t)),i(t,"duoxiaoBG",Be,a(t)),i(t,"guideHand",we,a(t)),t.game=void 0,t.blocks=[],t.groups=[],t.selComBlock=void 0,t.moveComBlock=void 0,t.guideComBlock=void 0,t.isMove=void 0,t.isTouchEnd=void 0,t.score=0,t.hard_time=0,t.is_hard=!1,t.comboCount=0,t.comboLeft=0,t.isWin=!1,t.guideTipsTime=void 0,t.isGuide=!1,t.guideStep=0,t._screenAdapted=!1,t._t=0,t._playId=0,t.isTouchAnim=!1,t.oldPuts=[],t.oldLights=[],t.changeColorIds=[],t.idsStr="",t.isAnimMap=!1,t.t2=0,t.testNode=null,t}o(t,e);var l=t.prototype;return l.init=function(e){this.game=e,this.adaptScreen(),this.createBlocks(),this.createGroups();var t=M.get(R.comBlocks);this.moveComBlock=t.getComponent(z),this.moveComBlock.node.parent=this.effect2,this.moveComBlock.node.active=!1;var o=M.get(R.comBlocks);o.getComponent(h).opacity=150,this.guideComBlock=o.getComponent(z),this.guideComBlock.node.parent=this.effect2,this.guideComBlock.node.active=!1,U.I?U.I.init(this):console.error("[ComBox] GameMgr.I is null during init"),this.testAddSp()},l.showDebugInfo=function(e){t.DEBUG_SCREEN_ADAPT?(console.log(e),t._debugLines.push(e),t._debugLines.length>20&&t._debugLines.shift(),this.updateDebugLabel()):console.log("[ScreenAdapt] "+e)},l.updateDebugLabel=function(){if(t.DEBUG_SCREEN_ADAPT)try{if(!t._debugLabel){var e=p("Canvas");if(!e)return;var o=new c("DebugInfo");o.parent=e,o.layer=e.layer;var i=o.addComponent(m);i.setContentSize(700,500),i.setAnchorPoint(.5,1);var a=f.getVisibleSize();o.setPosition(0,a.height/2-20,0);var n=new c("DebugLabel");n.parent=o,n.layer=o.layer;var s=n.addComponent(m);s.setContentSize(700,500),s.setAnchorPoint(.5,1),t._debugLabel=n.addComponent(g),t._debugLabel.fontSize=20,t._debugLabel.lineHeight=24,t._debugLabel.color=new b(255,255,0,255),t._debugLabel.overflow=g.Overflow.CLAMP,t._debugLabel.horizontalAlign=g.HorizontalAlign.LEFT,t._debugLabel.verticalAlign=g.VerticalAlign.TOP;try{t._debugLabel.outlineColor=new b(0,0,0,255),t._debugLabel.outlineWidth=2}catch(e){}}t._debugLabel&&(t._debugLabel.string=t._debugLines.join("\n"))}catch(e){console.error("[ComBox] updateDebugLabel error:",e)}},l.adaptScreen=function(){var e,o=this,i=f.getVisibleSize(),a=1334/750,n=i.height/i.width,s=this.node.parent,r=this.modelView?this.modelView.node:null;!r&&s&&((r=s.getChildByName("top")||s.getChildByName("Top"))||s.children.forEach((function(e){"top"===e.name.toLowerCase()&&(r=e)})));var l=null==(e=this.game)?void 0:e.groups;this.showDebugInfo("=== 屏幕适配 ==="),this.showDebugInfo("可见: "+i.width.toFixed(0)+"x"+i.height.toFixed(0)),this.showDebugInfo("比例: "+n.toFixed(2)+" (设计: "+a.toFixed(2)+")");var c=function(e,t){if(e){var i=e.getComponent(w);if(i&&i.enabled){if(o.showDebugInfo("Widget detected on "+e.name),i.isAlignTop)i.top-=t,o.showDebugInfo("Widget "+e.name+": top -= "+t+" -> "+i.top);else if(i.isAlignBottom)i.bottom+=t,o.showDebugInfo("Widget "+e.name+": bottom += "+t+" -> "+i.bottom);else if(i.isAlignVerticalCenter)i.verticalCenter+=t,o.showDebugInfo("Widget "+e.name+": vCenter += "+t+" -> "+i.verticalCenter);else{var a=e.position;e.setPosition(a.x,a.y+t,a.z),o.showDebugInfo("Node(W-NoV) "+e.name+": y += "+t)}i.updateAlignment()}else{var n=e.position;e.setPosition(n.x,n.y+t,n.z),o.showDebugInfo("Node "+e.name+": y += "+t)}}};if(s){var d=s.children.map((function(e){return e.name})).join(",");console.log("[ComBox] Game Children: "+d)}if(this._screenAdapted)this.showDebugInfo("已适配过");else{if(n>a+.05){var u=750*n-1334;t._adaptOffset=u/2,this.showDebugInfo("长屏适配: 额外高度="+u.toFixed(0)+", 偏移="+t._adaptOffset.toFixed(0)),v.isNative?(c(r,t._adaptOffset+10),this.showDebugInfo("Native 长屏: Top Up "+(t._adaptOffset+10).toFixed(0)+"px")):this.showDebugInfo("Web 长屏: Top 不移动"),c(l,-85);c(this.node,-50);var h=-50;this.btm&&this.btm.parent===this.node&&(h=0,this.showDebugInfo("Btm is child of ComBox, no extra shift needed.")),c(this.btm,h),this.showDebugInfo("长屏适配完成")}else if(n<1.5){this.showDebugInfo("宽屏模式 (比例="+n.toFixed(2)+")");c(this.node,-80),this.showDebugInfo("宽屏: Board down -80"),l&&(c(l,-100),this.showDebugInfo("宽屏: Groups down -100 to avoid board overlap"))}else{this.showDebugInfo("Normal Ratio ("+n.toFixed(2)+")");var p=navigator.userAgent||"",m=v.isNative&&(p.includes("Silk")||p.includes("KFTT")||p.includes("KFOT")||p.includes("KFSOWI")||p.includes("Kindle")||p.includes("Amazon")),g=n>=1.55&&n<=1.7,b="amazon"===new URLSearchParams(window.location.search).get("simulate");if(b&&this.showDebugInfo("[Simulate] Amazon mode forced via URL param"),m||b||v.isNative&&g)this.showDebugInfo("Amazon/Tablet detected: ratio="+n.toFixed(2)),l&&(c(l,-50),this.showDebugInfo("Amazon: Groups down -50")),r&&(c(r,-20),this.showDebugInfo("Amazon: Top down -50")),c(this.node,-20),this.showDebugInfo("Amazon: Board down -20"),this.btm&&(c(this.btm,100),this.showDebugInfo("Amazon: Btm up +100 (banner space)"));else!v.isNative&&(window.ysdk||window.YaGames)&&l&&(c(l,-40),this.showDebugInfo("Yandex Normal: Groups down -40 to avoid board overlap"))}if(v.isNative&&(v.os===v.OS.ANDROID||v.os===v.OS.IOS)){var C=v.os===v.OS.IOS,x=C&&n<1.5,k=x?0:C?20:45;c(this.btm,150),this.showDebugInfo("Native Banner: Btm moved UP by 150");var y=0;n>a+.05&&(y=(t._adaptOffset||0)+10),C&&!x?(c(r,-y-k),this.showDebugInfo("iOS Notch: Reset "+y.toFixed(1)+"px & Down "+k+"px")):x?(c(r,80),this.showDebugInfo("iPad: Top moved UP 80px (no notch)")):(c(r,-k),this.showDebugInfo("Android Notch: Top moved DOWN by "+k+" (Relative)")),n>=1.5?(l&&c(l,100),c(this.node,70),this.showDebugInfo("Native Adjust: Groups/Board moved UP to avoid Btm overlap")):(l&&c(l,100),c(this.node,80),this.showDebugInfo("Native iPad: Shifted UP to avoid btn overlap"))}this._screenAdapted=!0}},l.createBlocks=function(){this.blocks=[];for(var e=0;e<j.ROW;e++)for(var t=0;t<j.COL;t++){var o=M.get(R.block);this.list.addChild(o);var i=o.getComponent(V);i.initPos(e,t,j.COL,j.ROW),this.blocks.push(i)}},l.createGroups=function(){for(var e=0;e<3;e++){var t=M.get(R.comBlocks);t.getComponent(z).init(e,this.doTouchGroup.bind(this)),this.game.groups.addChild(t),this.groups.push(t.getComponent(z))}},l.update=function(e){this.game.home.parent.active||this.isWin||H.I.state!=D.Play||H.I.data&&(this._t+=e,this._t>1&&(this._t--,!this.isMove&&Date.now()-this.guideTipsTime>(this.isGuide?2e3:1e4)&&(this.guideTipsTime=Date.now(),this.guideTips()),H.I.data.time++,A.data.onlineTime++))},l.play=function(){var e=s(r().mark((function e(t,o){var i,a,n,s=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===o&&(o=!1),this._playId++,this.logComBoxParentOpacity(),this.forceResetAllBlocksOpacity("play_start"),this.resetData(),!v.isNative||v.os!==v.OS.ANDROID&&v.os!==v.OS.IOS||(t===P.default||t===P.level?(console.log("[ComBox] Showing Banner for mode:",t),ae.I.showBanner()):(console.log("[ComBox] Hiding Banner for mode:",t),ae.I.hideBanner())),e.t0=t,e.next=e.t0===P.default?9:e.t0===P.level?13:e.t0===P.activity?19:e.t0===P.daily?22:25;break;case 9:return this.isGuide=!1,H.I.init(t,A.data.endlessData,o),J.ins.dot("endless_start",{startType:H.I.data.map.length>0?"继续游戏":"开始游戏",maxScore:A.data.maxScore,start_way:o?"广告开局":"免费开始"}),e.abrupt("break",27);case 13:return H.I.init(t,A.data.levelData,o),J.ins.levelStart(A.data.level,A.data.levelTimes,H.I.collectType,o,H.I.data.groupData.length>0?"继续游戏":"开始游戏"),this.isGuide=1==A.data.level&&!A.data.guide,this.guideStep=0,console.log("[ComBox] play: level =",A.data.level,"guide completed =",A.data.guide,"isGuide =",this.isGuide),e.abrupt("break",27);case 19:return H.I.init(t,A.data.activityData,o),J.ins.actLevelStart(A.data.activityLevel,A.data.actLevelTimes,H.I.collectType,o,H.I.data.groupData.length>0?"继续游戏":"开始游戏"),e.abrupt("break",27);case 22:return H.I.init(t,A.data.dailyData,o),J.ins.dailyLevelStart(oe.I.level,A.data.dailyLevelTimes,H.I.collectType,o,H.I.data.groupData.length>0?"继续游戏":"开始游戏"),e.abrupt("break",27);case 25:return console.error("不支持的类型"),e.abrupt("break",27);case 27:return this.modelView.refresh(),e.next=30,O.until((function(){return 3==s.groups.length}));case 30:if(!this.isGuide){e.next=38;break}return this.initGuide(),U.I.updateScore(8500),this.modelView.updateScore(0),1!=A.data.special_user&&2!=A.data.special_user||"undefined"==typeof PUCHI_SDK||!PUCHI_SDK.IsWx?this.btm.active=!0:(this.btm.active=!1,i=f.getVisibleSize().height/f.getVisibleSize().width>1.8,"undefined"!=typeof wx&&wx.getSystemInfoSync&&(a=wx.getSystemInfoSync(),PUCHI_SDK.Banner.create("adunit-ee1abbf657ba87df",!0,{bannerWidth:i?a.screenWidth:300,offsetY:0,adIntervals:120}))),e.abrupt("return");case 38:this.btm.active=!0;case 39:this.initBlock(),console.log("[ComBox] play: groupData.length =",H.I.data.groupData.length),H.I.data.groupData.length>0?(console.log("[ComBox] play: Has saved groupData, calling initGroupData"),this.initGroupData()):(console.log("[ComBox] play: No saved groupData, calling updateGroups"),this.updateGroups()),t==P.level||t==P.activity||t==P.daily?(N.openPanel(W.TargetPanel),t==P.daily&&0==A.data.daily_badge_count&&O.wait(1e3).then((function(){N.openPanel(W.HelpPanel,3)}))):this.animMapClear(),(n=ee.getInstance().current).gameplayStart&&n.gameplayStart();case 45:case"end":return e.stop()}}),e,this)})));return function(t,o){return e.apply(this,arguments)}}(),l.initGuide=function(){var e=s(r().mark((function e(){var t,o,i,a,n,s,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[ComBox] initGuide: guideStep =",this.guideStep),3!=this.guideStep){e.next=28;break}if(console.log("[ComBox] initGuide: Guide completed! Setting isGuide = false"),this.isGuide=!1,this.guideStep=0,A.data.guide=!0,"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Analytics)try{PUCHI_SDK.Analytics.behaviors()}catch(e){console.warn("[ComBox] PUCHI_SDK.Analytics.behaviors error:",e)}return console.log("[ComBox] initGuide: Waiting 800ms..."),e.next=10,O.wait(800);case 10:for(console.log("[ComBox] initGuide: Showing tips"),q.show("tips.guide_complete"),console.log("[ComBox] initGuide: Setting map colors"),t=H.I.levelCfg.map,o=0;o<this.blocks.length;o++)this.blocks[o].changeColor(t[o]),this.blocks[o].opacity=255;return console.log("[ComBox] initGuide: Calling updateGroups(true)..."),e.prev=16,e.next=19,this.updateGroups(!0);case 19:console.log("[ComBox] initGuide: updateGroups completed successfully"),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(16),console.error("[ComBox] initGuide: updateGroups threw error:",e.t0);case 25:return 1!=A.data.special_user&&2!=A.data.special_user||"undefined"==typeof PUCHI_SDK||!PUCHI_SDK.IsWx||(PUCHI_SDK.Banner.hide(),this.btm.active=!0),console.log("[ComBox] initGuide: Guide completion finished"),e.abrupt("return");case 28:for(i=j.GUIDE_MAP[this.guideStep],a=0;a<this.blocks.length;a++)this.blocks[a].changeColor(i[a]),this.blocks[a].opacity=255;for(n=j.GUIDE_BLOCKS[this.guideStep],s=0;s<3;s++)l=S.getBlocks(n[s]),this.groups[s].createBlocks(O.clone(l),3,1==s),this.groups[s].visible=1==s,this.groups[s].isPut=1!=s;this.checkGG(),this.guideTipsTime=Date.now(),this.guideTips();case 35:case"end":return e.stop()}}),e,this,[[16,22]])})));return function(){return e.apply(this,arguments)}}(),l.resetData=function(){this.score=0,this.is_hard=!1,this.hard_time=Date.now(),this.guideTipsTime=Date.now(),this.comboCount=0,this.comboLeft=0,this.comboSp.node.active=!1,this.isWin=!1,this.forceResetAllBlocksOpacity("resetData")},l.forceResetAllBlocksOpacity=function(e){if(this.blocks&&0!==this.blocks.length){for(var t=0;t<this.blocks.length;t++){var o=this.blocks[t];if(o&&o.icon){var i=o.icon.getComponent(h);i&&i.opacity}}for(var a=0;a<this.blocks.length;a++){var n=this.blocks[a];n&&n.forceResetOpacity()}for(var s=0;s<this.blocks.length;s++){var r=this.blocks[s];if(r&&r.icon){var l=r.icon.getComponent(h);l&&l.opacity}}}},l.initBlock=function(){var e=this;if(U.I.resetData(),this.duoxiaoBG&&C(this.duoxiaoBG)){this.duoxiaoBG.active=!1;var t=this.duoxiaoBG.getComponent(h);t&&(x.stopAllByTarget(t),t.opacity=0)}if(this.forceResetAllBlocksOpacity("initBlock_start"),H.I.data.map.length>0){for(var o=0;o<this.blocks.length;o++)this.blocks[o].changeColor(H.I.data.map[o]),this.blocks[o].opacity=255;this.score=H.I.data.score,U.I.updateScore(this.score),this.modelView.updateScore(H.I.data.score)}else if(H.I.type==P.level||H.I.type==P.activity||H.I.type==P.daily){for(var i=H.I.levelCfg.map,a=0;a<this.blocks.length;a++)this.blocks[a].changeColor(i[a]),this.blocks[a].opacity=255;U.I.updateScore(8500),this.modelView.updateScore(0)}else{for(var n=0;n<this.blocks.length;n++)this.blocks[n].changeColor(0),this.blocks[n].opacity=255;this.modelView.updateScore(0)}this.forceResetAllBlocksOpacity("initBlock_end"),this.scheduleOnce((function(){e.forceResetAllBlocksOpacity("initBlock_scheduleOnce_0.1s"),e.logBlocksOpacity("after_0.1s")}),.1),this.scheduleOnce((function(){e.logBlocksOpacity("after_0.5s"),e.forceResetAllBlocksOpacity("initBlock_scheduleOnce_0.5s")}),.5),this.scheduleOnce((function(){e.logBlocksOpacity("final_1s")}),1)},l.logBlocksOpacity=function(e){for(var t=[],o=0;o<this.blocks.length;o++){var i=this.blocks[o];if(i&&i.icon){var a=i.icon.getComponent(h),n=i.node.getComponent(h),s=i.icon.color,r=i.icon.node,l=[];if(a&&255!==a.opacity&&l.push("icon.UIOpacity="+a.opacity),n&&255!==n.opacity&&l.push("node.UIOpacity="+n.opacity),s&&255!==s.a&&l.push("icon.color.a="+s.a),r){var c=r.getComponent(h);c&&c!==a&&255!==c.opacity&&l.push("iconNode.UIOpacity="+c.opacity)}l.length>0&&t.push({index:o,issues:l.join(", "),color:i.color})}}if(t.length>0);else{for(var d=null,u=-1,p=0;p<this.blocks.length;p++)if(this.blocks[p]&&this.blocks[p].color>0){d=this.blocks[p],u=p;break}if(d&&d.icon){var m=d.icon.getComponent(h),f=d.node.getComponent(h),g=d.icon.color,b=d.icon,v=b?"spriteFrame="+(b.spriteFrame?"loaded":"null")+", color=("+g.r+","+g.g+","+g.b+","+g.a+")":"no sprite";d.color,m&&m.opacity,f&&f.opacity;this.logParentOpacity(d.node)}}},l.logParentOpacity=function(e){for(var t=e.parent,o=0,i=[];t&&o<10;){var a=t.getComponent(h);a&&255!==a.opacity&&i.push(t.name+"(depth="+o+"): opacity="+a.opacity),t=t.parent,o++}},l.logComBoxParentOpacity=function(){for(var e=this.node,t=0,o=[];e&&t<15;){var i=e.getComponent(h),a=i?i.opacity:"N/A";o.push(e.name+": "+a),i&&255!==i.opacity&&(x.stopAllByTarget(i),i.opacity=255),e=e.parent,t++}if(this.blocks&&this.blocks.length>0){var n=this.blocks[0].node.parent;if(n){var s=n.getComponent(h);s&&255!==s.opacity&&(x.stopAllByTarget(s),s.opacity=255)}}for(var r=0;r<this.node.children.length;r++){var l=this.node.children[r];l.getComponent(h),l.getComponent(k);l.active}},l.initGroupData=function(){var e=H.I.data.groupData;console.log("[ComBox] initGroupData: Restoring from save, groupData length =",e.length);for(var t=0;t<3;t++)console.log("[ComBox] initGroupData: Group "+t+" - isPut from save:",e[t].isPut,"visible will be:",!e[t].isPut),this.groups[t].createBlocks(O.clone(e[t].list),e[t].color),this.groups[t].visible=!e[t].isPut,this.groups[t].isPut=e[t].isPut;this.checkGG()},l.updateGroups=function(){var e=s(r().mark((function e(t){var o,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),console.log("[ComBox] updateGroups CALLED, fillblank =",t),e.prev=2,console.log("[ComBox] updateGroups start - inside try block"),o=[],console.log("[ComBox] updateGroups: BoardDataMgr.I.type =",H.I.type),H.I.type==P.level||H.I.type==P.activity||H.I.type==P.daily?(console.log("[ComBox] updateGroups: Level/Activity/Daily mode"),H.I.type==P.level&&A.data.level<=5&&!t&&(t=Math.random()<O.getOnlineParamInt("lv5_fillblank",.3))&&console.log("触发前5关填空"),i=H.I.isHard,console.log("[ComBox] updateGroups: isHard =",i),"困难"!=U.I.modeType&&"死亡"!=U.I.modeType||1!=O.getOnlineParamInt("hard_mode_open",1)||(i=!1,console.log("上一次是困难/死亡出题，跳过困难出题")),console.log("[ComBox] updateGroups: calling levelModelGetGroups..."),o=U.I.levelModelGetGroups(H.I.collectRatio,i,t,H.I.levelTimes),console.log("[ComBox] updateGroups: levelModelGetGroups returned, list =",o)):o=U.I.getGroups(t),e.next=9,this.updateGroupsByIds(o);case 9:console.log("[ComBox] updateGroups finished"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.error("[ComBox] updateGroups error:",e.t0);case 15:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t){return e.apply(this,arguments)}}(),l.updateGroupsByIds=function(){var e=s(r().mark((function e(t,o){var i,a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,console.log("[ComBox] updateGroupsByIds start"),i=0;i<3;i++)(a=S.getBlockTable(t[i]))?(n=O.clone(a.getBlocks()),H.I.collectType==_.jewel&&H.I.addJewelToList(n),this.groups[i].createBlocks(n,o?o[i]:this.getColor()),this.groups[i].showAnim()):console.error("配置不存在ID:",t[i]);return console.log("[ComBox] updateGroupsByIds: invoking checkGG"),e.next=6,this.checkGG();case 6:console.log("[ComBox] updateGroupsByIds: checkGG finished"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("[ComBox] updateGroupsByIds error:",e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,o){return e.apply(this,arguments)}}(),l.doTouchGroup=function(e,t){var o=this;this.guideTipsTime=Date.now(),this.isWin||this.isMove||this.isTouchEnd?this.groups[e].setDisable(!1):(this.selComBlock=this.groups[e],this.moveComBlock.createBlocks(O.clone(this.selComBlock.list),this.selComBlock.color,!1),this.moveComBlock.node.active=!0,this.moveComBlock.node.setWorldPosition(t),this.selComBlock.visible=!1,x.stopAllByTarget(this.moveComBlock.node),this.isMove=!0,this.isTouchAnim=!0,this.moveComBlock.shadowAnim(!0),y(this.moveComBlock.node).to(.001,{worldPosition:I(t.x,t.y+this.getBlcoksH(),0),scale:I(1,1,1)}).call((function(){o.isTouchAnim=!1})).start(),L.I.playEffect("block_pick"),this.game.node.on(c.EventType.TOUCH_MOVE,this.touchMove,this),this.game.node.on(c.EventType.TOUCH_END,this.touchEnd,this),this.game.node.on(c.EventType.TOUCH_CANCEL,this.touchEnd,this))},l.getBlcoksH=function(){return 220+20*this.moveComBlock.list.length},l.touchStart=function(e){},l.touchMove=function(e){if(this.isMove&&!this.isAnimMap){var t=e.touch.getUILocation();this.moveComBlock.node.setWorldPosition(t.x,t.y+this.getBlcoksH(),0),this.isTouchAnim||this.checkPosIsPut()}},l.touchEnd=function(){var e=s(r().mark((function e(t){var o,i,a,n,l,d,u,h,p,m,f,g,b,v,k,B,w,S,D,P,T,N,W,V,z,F,X,j,Y,J,q=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isMove){e.next=105;break}if(this.isTouchEnd=!0,this.isMove=!1,this.oldLights){for(o=0;o<this.oldLights.length;o++)M.put(R.light,this.oldLights[o]);this.oldLights=[]}if(this.changeColorIds.length>0){for(i=0;i<this.changeColorIds.length;i++)a=this.changeColorIds[i],this.blocks[a[0]].changeColor(a[1]);this.changeColorIds=[]}if(n=!1,!(this.oldPuts.length>0)){e.next=91;break}return H.I.data.putCount++,l=this.moveComBlock.blocks[0].node.worldPosition,d=this.blocks[this.oldPuts[0]].node.worldPosition,u=d.x-l.x,h=d.y-l.y,p=this.moveComBlock.node.worldPosition,m=!1,y(this.moveComBlock.node).to(.1,{worldPosition:I(p.x+u,p.y+h,0)}).call((function(){var e;A.data.vibrate&&("undefined"!=typeof PUCHI_SDK&&null!=(e=PUCHI_SDK.Platform)&&e.vibrateShort&&PUCHI_SDK.Platform.vibrateShort());for(var t=0;t<q.oldPuts.length;t++)q.blocks[q.oldPuts[t]].opacity=255;if(1==O.getOnlineParamInt("best_pos_anim",1)){var o=U.I.checkBestPut(q.selComBlock.getIndex());if(o>0&&(1==o||2==o)){var i=O.clone(q.oldPuts);q.playBsetAnim(i,o)}}L.I.playEffect("block_drop"),q.oldPuts=[],q.selComBlock.isPut=!0,m=!0})).start(),e.next=18,O.until((function(){return m}));case 18:if(!((f=this.checkEliminate()).delX.length>0||f.delY.length>0)){e.next=59;break}for(g=f.delX.length+f.delY.length>=3||this.comboCount>3,this.addCombo(),(b=f.delX.length+f.delY.length)>1&&this.animDuoxiao(b),this.checkAddScore(b),v=f.delX.concat(f.delY),k=[],B=0;B<v.length;B++)for(w=v[B],S=0;S<w.length;S++)this.blocks[w[S]].obstacle>0&&this.blocks[w[S]].obstacle<4&&k.push(w[S]);k.length>0&&this.animObstacle(k),this.animXiaochu(f.delX,!0,g?8:this.selComBlock.color,this.selComBlock.color),this.animXiaochu(f.delY,!1,g?8:this.selComBlock.color,this.selComBlock.color),D={},P=0;case 33:if(!(P<v.length)){e.next=49;break}T=v[P],N=0;case 36:if(!(N<T.length)){e.next=46;break}if(!((W=this.blocks[T[N]]).obstacle>0)){e.next=41;break}return W.handelObstacle(),e.abrupt("continue",43);case 41:W.jewelId>0&&(D.hasOwnProperty(T[N])||(D[T[N]]=W.jewelId)),W.changeColor(0);case 43:N++,e.next=36;break;case 46:P++,e.next=33;break;case 49:for(z in console.log("宝石数据",D),console.log("[ComBox] touchEnd: Processing jewels and emitting TARGET_ANIM"),V=0,D)F=this.blocks[z].node.worldPosition,H.I.addCollectJewel(D[z]),E.I.emit(G.TARGET_ANIM,F,D[z],!0,V),V++;console.log("[ComBox] touchEnd: Checking clear"),X=!0,this.blocks.forEach((function(e){0!=e.color&&(X=!1)})),X&&!this.isGuide&&H.I.collectType!=_.jewel&&(this.isAnimMap=!0,O.wait(800).then(s(r().mark((function e(){var t,o,i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,q.animMapClear(),e.next=4,O.wait(500);case 4:return q.animMapClear(),e.next=7,O.wait(500);case 7:(t=M.get(R.combo))&&((o=t.getComponent(K))&&o.showPerfect?(t.setParent(q.effect),i=I(0,q.node.position.y,0),t.setPosition(i),o.showPerfect(),O.wait(2e3).then((function(){C(t)&&M.put(R.combo,t)}))):M.put(R.combo,t)),H.I.collectType!=_.jewel&&(q.addScore(100),a=I(q.node.worldPosition.x,q.node.worldPosition.y+100,0),q.animScore(100,a)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("clear anim error",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))))),e.next=63;break;case 59:this.comboLeft--,this.comboLeft<=0&&(this.comboCount=0),this.comboSp.node.active&&(this.comboSp.setCompleteListener(null),console.log(3-this.comboLeft),this.comboSp.setAnimation(0,"exit_"+(3-this.comboLeft),!1),this.comboSp.setCompleteListener((function(){q.comboSp.setCompleteListener(null),q.comboSp.setAnimation(0,"idle_"+(4-q.comboLeft),!0),q.comboLeft<=0&&(q.comboSp.node.active=!1)}))),this.addScore(this.moveComBlock.count);case 63:if(console.log("[ComBox] touchEnd: Checking groups"),j=0,this.groups.forEach((function(e){e.isPut&&j++})),console.log("[ComBox] touchEnd: Groups count = "+j),console.log("[ComBox] touchEnd: isGuide = "+this.isGuide),!this.isGuide){e.next=73;break}console.log("[ComBox] touchEnd: In guide mode, skipping updateGroups"),O.wait(800).then((function(){q.guideStep++,q.initGuide()})),e.next=89;break;case 73:if(3!=j){e.next=86;break}return console.log("[ComBox] touchEnd: count == 3, calling updateGroups NOW"),e.prev=75,e.next=78,this.updateGroups();case 78:console.log("[ComBox] touchEnd: updateGroups completed"),e.next=84;break;case 81:e.prev=81,e.t0=e.catch(75),console.error("[ComBox] touchEnd: updateGroups threw error:",e.t0);case 84:e.next=89;break;case 86:return console.log("[ComBox] touchEnd: Calling checkGG"),e.next=89,this.checkGG();case 89:e.next=101;break;case 91:return Y=!1,this.selComBlock.node.active=!1,this.selComBlock.visible=!0,J=this.selComBlock.node.worldPosition,x.stopAllByTarget(this.moveComBlock.node),this.moveComBlock.shadowAnim(!1),y(this.moveComBlock.node).to(.001,{worldPosition:J,scale:I(.5,.5,1)}).call((function(){q.selComBlock.node.active=!0,Y=!0})).start(),e.next=100,O.until((function(){return Y}));case 100:n=!0;case 101:this.moveComBlock.node.active=!1,this.isMove=!1,this.isTouchEnd=!1,n&&this.selComBlock.setDisable(!1);case 105:this.isGuide||(this.guideTipsTime=Date.now()),this.game.node.off(c.EventType.TOUCH_MOVE,this.touchMove,this),this.game.node.off(c.EventType.TOUCH_END,this.touchEnd,this),this.game.node.off(c.EventType.TOUCH_CANCEL,this.touchEnd,this),console.log("[ComBox] touchEnd finished successfully"),e.next=115;break;case 112:e.prev=112,e.t1=e.catch(0),console.error("[ComBox] touchEnd fatal error:",e.t1);case 115:case"end":return e.stop()}}),e,this,[[0,112],[75,81]])})));return function(t){return e.apply(this,arguments)}}(),l.checkPosIsPut=function(){for(var e=this,t=this.moveComBlock.blocks,o=0,i=0,a={},n=[],s=0;s<t.length;s++)if(0!=t[s].color){var r=t[s].color;o++;for(var l=t[s].node.worldPosition,c=0;c<this.blocks.length;c++)if(0==this.blocks[c].color||this.blocks[c].isOpacity){var u=this.blocks[c].node.worldPosition;if(Math.abs(l.x-u.x)+.5<=(j.BLOCK_W+2)/2&&Math.abs(l.y-u.y)+.5<=(j.BLOCK_H+2)/2){i++,a[c]=r,n.push(c);break}}}var h=function(){if(e.oldPuts.length>0){for(var t=0;t<e.oldPuts.length;t++)e.blocks[e.oldPuts[t]].changeColor(0),e.blocks[e.oldPuts[t]].opacity=255;e.oldPuts=[]}if(e.oldLights){for(var o=0;o<e.oldLights.length;o++)M.put(R.light,e.oldLights[o]);e.oldLights=[]}if(e.changeColorIds.length>0){for(var i=0;i<e.changeColorIds.length;i++){var a=e.changeColorIds[i];e.blocks[a[0]].changeColor(a[1])}e.changeColorIds=[]}e.idsStr=""};if(this.isGuide&&i==o){for(var p=j.GUIDE_ANSWER[this.guideStep],m=!0,f=0;f<n.length;f++)if(!(p.indexOf(n[f])>-1)){m=!1;break}if(!m)return void h()}if(i==o){for(var g="",b=0;b<n.length;b++)g+=n[b]+",";if(this.idsStr==g)return;for(var v in h(),a)this.oldPuts.push(+v),this.blocks[+v].changeColor(a[v]),this.blocks[+v].opacity=150;this.idsStr=g;var C=this.checkEliminate(),x=[];if(C.delX.length>0||C.delY.length>0){for(var k=C.delX.length+C.delY.length>=3||this.comboCount>3,y=0;y<C.delX.length;y++){var B=M.get(R.light);if(B){var w=this.blocks[C.delX[y][3]];x=x.concat(C.delX[y]);var S=w.node.position,D=I(S.x+(j.BLOCK_W+2)/2,S.y,S.z),P=B.getComponent(X),_=B.getComponentInChildren(d.Skeleton);_&&(_.enabled=!1),B.setParent(this.effect),B.setPosition(D),P.initColor(k?8:this.selComBlock.color,!0,!0),this.oldLights.push(B)}}for(var G=0;G<C.delY.length;G++){x=x.concat(C.delY[G]);var T=M.get(R.light);if(T){var A=this.blocks[C.delY[G][4]].node.position,L=I(A.x,A.y+(j.BLOCK_H+1)/2,A.z),E=T.getComponent(X),N=T.getComponentInChildren(d.Skeleton);N&&(N.enabled=!1),T.setParent(this.effect),T.setPosition(L),E.initColor(k?8:this.selComBlock.color,!1,!0),this.oldLights.push(T)}}(x=O.unique(x)).forEach((function(t){e.blocks[t].isOpacity||(e.changeColorIds.push([t,e.blocks[t].color]),e.blocks[t].tipsColor(e.selComBlock.color))}))}}else h()},l.checkEliminate=function(){for(var e=this.blocks,t=j.COL,o=j.ROW,i=[],a=[],n=0;n<t;n++){for(var s=[],r=[],l=0;l<o;l++){var c=n*o+l;(e[c].color>0||e[c].isOpacity)&&s.push(c);var d=n+l*o;(e[d].color>0||e[d].isOpacity)&&r.push(d)}s.length===o&&i.push(s),r.length===t&&a.push(r)}return{delX:i,delY:a}},l.addCombo=function(){var e,t=this;(this.comboCount++,L.I.playEffect("comb"+Math.min(8,this.comboCount)),A.data.vibrate)&&("undefined"!=typeof PUCHI_SDK&&null!=(e=PUCHI_SDK.Platform)&&e.vibrateShort&&PUCHI_SDK.Platform.vibrateShort("heavy"));if(this.comboCount>1){var o,i=M.get(R.combo);if(i){var a=i.getComponentInChildren(d.Skeleton);a&&(a.enabled=!1),i.setParent(this.effect2);var n=this.node.position,s=I(0,n.y+60,0);i.setPosition(s),i.getComponent(K).init(this.comboCount-1),a&&(a.enabled=!0),O.wait(2e3).then((function(){C(i)&&M.put(R.combo,i)}))}this.comboSp.node.active=!0;var r=(null==(o=H.I.data)?void 0:o.comboColor)||1,l=["huang","lan","qing"][r-1]||"huang";console.log("[ComBox] animCombo: comboColor="+r+", skin="+l),De(this.comboSp,l)&&(this.comboSp.setAnimation(0,3==this.comboLeft?"enter":"enter_"+(4-this.comboLeft),!1),this.comboSp.setCompleteListener((function(){t.comboSp.setCompleteListener(null),t.comboSp.setAnimation(0,"idle_1",!0)})))}this.comboLeft=3},l.animDuoxiao=function(){var e=s(r().mark((function e(t){var o,i,a,n,s=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("[ComBox] animDuoxiao start: len="+t),t>=3&&(v.isNative&&this.duoxiaoSp&&C(this.duoxiaoSp.node)&&(this.duoxiaoSp.node.active=!0,this.duoxiaoSp.enableBatch=!1,this.duoxiaoSp.setAnimationCacheMode&&this.duoxiaoSp.setAnimationCacheMode(0),this.duoxiaoSp.setAnimation(0,"enter",!1),this.duoxiaoSp.setCompleteListener((function(){s.comboSp&&C(s.comboSp.node)&&s.comboSp.setCompleteListener(null),C(s.duoxiaoSp.node)&&(s.duoxiaoSp.node.active=!1)}))),this.duoxiaoBG&&C(this.duoxiaoBG)&&(this.duoxiaoBG.active=!0,(o=this.duoxiaoBG.getComponent(h))&&(o.opacity=0,y(o).to(.1,{opacity:255}).delay(1).to(.3,{opacity:0}).call((function(){C(s.duoxiaoBG)&&(s.duoxiaoBG.active=!1)})).start()))),console.log("[ComBox] animDuoxiao waiting 500ms"),e.next=6,O.wait(500);case 6:if(C(this.node)){e.next=9;break}return console.warn("[ComBox] animDuoxiao: Node destroyed after wait"),e.abrupt("return");case 9:if(console.log("[ComBox] animDuoxiao getting duoxiao from pool"),i=M.get(R.duoxiao)){e.next=14;break}return console.warn("[ComBox] animDuoxiao: PoolManager returned null duoxiao"),e.abrupt("return");case 14:if(C(i)){e.next=17;break}return console.warn("[ComBox] animDuoxiao: Got invalid node from pool"),e.abrupt("return");case 17:if(!(a=i.getComponent(F))){e.next=30;break}return console.log("[ComBox] animDuoxiao disabling spine"),a.disableSpine(),console.log("[ComBox] animDuoxiao setting parent"),i.setParent(this.effect),console.log("[ComBox] animDuoxiao initializing comp"),e.next=26,a.init(t,this.selComBlock.color);case 26:console.log("[ComBox] animDuoxiao comp initialized"),a.enableSpine(),e.next=32;break;case 30:console.warn("[ComBox] animDuoxiao: Missing ComDuoxiao component"),i.setParent(this.effect);case 32:if(C(this.node)){e.next=36;break}return console.warn("[ComBox] animDuoxiao: Node destroyed after init await"),C(i)&&M.put(R.duoxiao,i),e.abrupt("return");case 36:if(C(i)){e.next=39;break}return console.warn("[ComBox] animDuoxiao: Duoxiao node destroyed after init await"),e.abrupt("return");case 39:console.log("[ComBox] animDuoxiao setting position"),n=I(0,this.node.position.y+160,0),i.setPosition(n),console.log("[ComBox] animDuoxiao scheduling cleanup"),O.wait(2e3).then((function(){try{C(i)&&M.put(R.duoxiao,i)}catch(e){console.error("animDuoxiao cleanup error",e)}})),console.log("[ComBox] animDuoxiao finished"),e.next=50;break;case 47:e.prev=47,e.t0=e.catch(0),console.error("[ComBox] animDuoxiao error:",e.t0);case 50:case"end":return e.stop()}}),e,this,[[0,47]])})));return function(t){return e.apply(this,arguments)}}(),l.playBsetAnim=function(e,t){var o=this;try{for(var i=["an","liang"][t-1],a=function(){var t=M.get(R.bestPos);if(!t)return 1;var a=o.blocks[e[n]].node.position,s=t.getComponent(d.Skeleton);if(s&&(s.enabled=!1),t.setParent(o.effect2),t.setPosition(a),i&&De(s,i))try{s.setAnimation(0,"enter",!1),s.enabled=!0}catch(e){console.warn("[ComBox] playBsetAnim setAnimation error:",e),s&&(s.enabled=!0)}else s&&(s.enabled=!0);O.wait(2e3).then((function(){C(t)&&M.put(R.bestPos,t)}))},n=0;n<e.length;n++)a()}catch(e){console.error("[ComBox] playBsetAnim error:",e)}},l.animObstacle=function(e){for(var t=this,o=function(){try{var o=M.get(R.obstacles);if(!o)return 1;var a=t.blocks[e[i]],n=a.node.position,s=o.getComponent(d.Skeleton);if(s&&s.skeletonData){s.enabled=!1,o.setParent(t.effect2),o.setPosition(n),s.clearAnimations(),s.setCompleteListener((function(){s.setCompleteListener(null),C(o)&&M.put(R.obstacles,o)})),1==a.obstacle?L.I.playEffect("obstacle2"):L.I.playEffect("obstacle1");try{s.setAnimation(0,"enter"+(4-a.obstacle),!1),s.enabled=!0}catch(e){console.warn("[ComBox] animObstacle setAnimation error:",e),s.enabled=!0}}else C(o)&&M.put(R.obstacles,o)}catch(e){console.error("[ComBox] animObstacle error:",e)}},i=0;i<e.length;i++)o()},l.animXiaochu=function(){var e=s(r().mark((function e(t,o,i,a){var n,s,l,c,u,h,p,m;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,console.log("[ComBox] animXiaochu start"),n=[],s=!1,1!=A.data.skin&&(s=!0),l=0;case 6:if(!(l<t.length)){e.next=30;break}if(e.prev=7,c=M.get(s?R.xiaochu2:R.xiaochu)){e.next=12;break}return console.warn("[ComBox] animXiaochu: PoolManager returned null item"),e.abrupt("continue",27);case 12:if(u=this.blocks[t[l][o?3:4]],h=u.node.position,p=I(),p=o?I(h.x+(j.BLOCK_W+2)/2,h.y,h.z):I(h.x,h.y+(j.BLOCK_H+1)/2,h.z),(m=c.getComponent(d.Skeleton))&&(m.enabled=!1),c.setParent(this.effect),c.setPosition(p),m&&m.skeletonData){m.clearAnimations();try{s?(c.angle=o?90:0,m.setAnimation(0,"xiaochu_"+a,!1)):m.setAnimation(0,"xiaochu_"+i+(o?"_2":""),!1),m.enabled=!0}catch(e){console.warn("[ComBox] animXiaochu setAnimation error:",e),m.enabled=!0}}else console.warn("[ComBox] animXiaochu: Missing Skeleton component or skeletonData"),m&&(m.enabled=!0);n.push(c),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(7),console.error("[ComBox] animXiaochu error:",e.t0);case 27:l++,e.next=6;break;case 30:n.length>0&&O.wait(2e3).then((function(){try{n.forEach((function(e){C(e)&&M.put(s?R.xiaochu2:R.xiaochu,e)}))}catch(e){console.error("animXiaochu cleanup error",e)}})),console.log("[ComBox] animXiaochu finished"),e.next=37;break;case 34:e.prev=34,e.t1=e.catch(0),console.error("[ComBox] animXiaochu fatal error:",e.t1);case 37:case"end":return e.stop()}}),e,this,[[0,34],[7,24]])})));return function(t,o,i,a){return e.apply(this,arguments)}}(),l.checkAddScore=function(e){var t=this.moveComBlock.count,o=this.comboCount||1,i=0;t+=i=1==e?10:10*o*e*(e-1),H.I.type==P.default&&this.animScore(i),this.addScore(t,!0)},l.animScore=function(){var e=s(r().mark((function e(t,o){var i,a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=o||this.moveComBlock.node.worldPosition,e.next=4,O.wait(300);case 4:if(C(this.node)){e.next=6;break}return e.abrupt("return");case 6:if(i=M.get(R.score)){e.next=9;break}return e.abrupt("return");case 9:(a=i.getComponent(g))&&(a.string=""+t),this.effect.addChild(i),i.setWorldPosition(o.x,o.y+100,o.z),n=this.modelView.labScore.node.worldPosition,y(i).to(.1,{scale:I(1.2,1.2,1.2)}).to(.1,{scale:I(1,1,1)}).to(.2,{worldPosition:n},{easing:"sineInOut"}).call((function(){try{C(i)&&M.put(R.score,i)}catch(e){console.error("animScore cleanup error",e)}})).start(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.error("[ComBox] animScore error:",e.t0);case 20:case"end":return e.stop()}}),e,this,[[0,17]])})));return function(t,o){return e.apply(this,arguments)}}(),l.addScore=function(){var e=s(r().mark((function e(t,o){var i,a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===o&&(o=!1),e.prev=1,console.log("[ComBox] addScore start:",t),this.score+=t,U.I.updateScore(this.score),a=!1,H.I.type==P.default&&this.score>A.data.maxScore&&(H.I.data.maxAnim||(H.I.data.maxAnim=!0,A.data.maxScore>0&&(a=!0)),A.data.maxScore=this.score,A.save()),H.I.data.score=this.score,this.modelView.updateScore(this.score,!0,o),a&&this.playMaxAnim(),console.log("[ComBox] addScore DEBUG:",{gameType:H.I.type,collectType:H.I.collectType,currentScore:H.I.data.score,targetScore:null==(i=H.I.levelCfg)?void 0:i.score,isWin:this.isWin,level:A.data.level,isScoreMode:H.I.collectType==_.score,scoreReached:H.I.levelCfg?H.I.data.score>=H.I.levelCfg.score:"no levelCfg"}),e.t0=H.I.type,e.next=e.t0===P.level?14:e.t0===P.activity?30:e.t0===P.daily?42:55;break;case 14:if(this.isWin||H.I.collectType!=_.score){e.next=29;break}if(!(H.I.data.score>=H.I.levelCfg.score)){e.next=29;break}return console.log("[ComBox] addScore: Level Win (Score Mode) - Opening RetPanel soon..."),this.isWin=!0,n=A.data.level_ad_count,console.log("[ComBox] addScore: Calling BoardDataMgr.addLevel()"),H.I.addLevel(),console.log("[ComBox] addScore: Waiting 800ms..."),e.next=24,O.wait(800);case 24:return console.log("[ComBox] addScore: Calling animMapClear..."),e.next=27,this.animMapClear(!1);case 27:console.log("[ComBox] addScore: animMapClear finished, checking node validity..."),C(this.node)?(console.log("[ComBox] addScore: Opening RetPanel NOW, ad_count =",n),Te(W.RetPanel,!0,n),console.log("[ComBox] addScore: UIManager.openPanel called")):console.warn("[ComBox] addScore: Node invalid before RetPanel");case 29:return e.abrupt("break",55);case 30:if(this.isWin||H.I.collectType!=_.score){e.next=41;break}if(!(H.I.data.score>=H.I.levelCfg.score)){e.next=41;break}return console.log("[ComBox] addScore: Activity Win (Score Mode)"),this.isWin=!0,J.ins.actLevelEnd(A.data.activityLevel,"关卡胜利",H.I.data.time,A.data.actLevelTimes,H.I.data.reviveCount,H.I.collectRatio,"分数模式",H.I.data.putCount,H.I.data.isVideo),H.I.addLevel(),e.next=38,O.wait(800);case 38:return e.next=40,this.animMapClear(!1);case 40:E.I.emit(G.OPEN_TAB,T.activity,!0);case 41:return e.abrupt("break",55);case 42:if(this.isWin||H.I.collectType!=_.score){e.next=54;break}if(!(H.I.data.score>=H.I.levelCfg.score)){e.next=54;break}return console.log("[ComBox] addScore: Daily Win (Score Mode)"),this.isWin=!0,J.ins.dailyLevelEnd(oe.I.level,"关卡胜利",H.I.data.time,A.data.dailyLevelTimes,H.I.data.reviveCount,H.I.collectRatio,"分数模式",H.I.data.putCount,H.I.data.isVideo),s=-1==A.data.dailyCompleteDays.indexOf(oe.I.day),H.I.addLevel(),e.next=51,O.wait(800);case 51:return e.next=53,this.animMapClear(!1);case 53:E.I.emit(G.OPEN_TAB,T.daily,s);case 54:return e.abrupt("break",55);case 55:console.log("[ComBox] addScore finished"),e.next=61;break;case 58:e.prev=58,e.t1=e.catch(1),console.error("[ComBox] addScore error:",e.t1);case 61:case"end":return e.stop()}}),e,this,[[1,58]])})));return function(t,o){return e.apply(this,arguments)}}(),l.animMapClear=function(){var e=s(r().mark((function e(t){var o,i,a,n,s=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===t&&(t=!0),this.isAnimMap=!0,L.I.playEffect("map_clear"),o={},Z.show(),i=7;case 6:if(!(i>=0)){e.next=13;break}return this.animRow(i,!1,t,o),e.next=10,O.wait(50);case 10:i--,e.next=6;break;case 13:a=0;case 14:if(!(a<8)){e.next=21;break}return this.animRow(a,!0,t,o),e.next=18,O.wait(50);case 18:a++,e.next=14;break;case 21:return O.wait(150).then((function(){s.isAnimMap=!1})),e.next=24,O.wait(100);case 24:for(this.forceResetAllBlocksOpacity("animMapClear_end"),this.logBlocksOpacity("animMapClear_end_check"),n=0;n<this.blocks.length;n++)this.blocks[n].changeColor(0);Z.hide();case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.animRow=function(e,t,o,i){for(var a=this,n=function(){var n=a.blocks[8*e+s];o&&!t&&n.color&&(console.log("[ComBox] animRow SAVE map: idx="+e+" j="+s+" color="+n.color),i[8*e+s]=n.color);var r=n.color||(e+1>7?7:e+1);if(t||n.changeColor(r),n.forceResetOpacity(),n.opacity=t?255:0,t&&i[8*e+s])return console.log("[ComBox] animRow idx="+e+" j="+s+" RESTORE color="+i[8*e+s]),n.changeColor(i[8*e+s]),n.opacity=255,1;var l=n.icon.getComponent(h);l||console.warn("[ComBox] animRow Missing UIOpacity: idx="+e+" j="+s),t&&console.log("[ComBox] animRow HIDE tween start: idx="+e+" j="+s),y(l).to(.05,{opacity:t?0:255}).call((function(){t&&(n.changeColor(0),n.opacity=255)})).start()},s=0;s<8;s++)n()},l.animMapFail=function(){var e=s(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z.show(),L.I.playEffect("gameover"),Q.show(),e.next=5,O.wait(800);case 5:return e.next=7,O.wait(50);case 7:Z.hide();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l.getColor=function(){0==H.I.data.boardColor.length&&(H.I.data.boardColor=O.randFromList([1,2,3,4,5,6,7],O.random(4,7)));var e=H.I.data.boardColor;return e[O.random(0,e.length-1)]},l.checkGG=function(){var e=s(r().mark((function e(){var t,o,i,a,n,l,c,d,u,h,p,m,f,g,b,x,k,y,I,B,w,S,D,M,R,V,z,K,F,X,Y,q,Q,te,ie,ae,ne=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._playId,e.prev=1,!this.isWin){e.next=5;break}return console.log("[ComBox] checkGG: Already Win, returning"),e.abrupt("return");case 5:o=0,i=[],a=0;case 9:if(!(a<3)){e.next=19;break}if(i.push({color:this.groups[a].color,isPut:this.groups[a].isPut,list:this.groups[a].list}),!this.groups[a].isPut){e.next=13;break}return e.abrupt("continue",16);case 13:n=O.clone(this.groups[a].list),U.I.canPut(this.map,n)?(o++,this.groups[a].gray=!1):this.groups[a].gray=!0;case 16:a++,e.next=9;break;case 19:return console.log("[ComBox] checkGG: count =",o),e.next=22,O.until((function(){return!ne.isAnimMap}));case 22:if(t==this._playId){e.next=25;break}return console.warn("[ComBox] checkGG: Session mismatch (Captured: "+t+", Current: "+this._playId+"). Aborting save."),e.abrupt("return");case 25:if(H.I.data.map=this.map2,H.I.data.groupData=i,A.save(),!H.I.checkCollectEnd()){e.next=40;break}return console.log("[ComBox] checkGG: Collect End"),this.isWin=!0,l=A.data.level_ad_count,H.I.type==P.activity?J.ins.actLevelEnd(A.data.activityLevel,"关卡胜利",H.I.data.time,A.data.actLevelTimes,H.I.data.reviveCount,H.I.collectRatio,"宝石模式",H.I.data.putCount,H.I.data.isVideo):H.I.type==P.daily&&J.ins.dailyLevelEnd(oe.I.level,"关卡胜利",H.I.data.time,A.data.dailyLevelTimes,H.I.data.reviveCount,H.I.collectRatio,"宝石模式",H.I.data.putCount,H.I.data.isVideo),H.I.addLevel(),e.next=36,O.wait(1e3);case 36:return e.next=38,this.animMapClear(!1);case 38:return H.I.type==P.level?C(this.node)?(console.log("[ComBox] checkGG: Opening RetPanel"),Te(W.RetPanel,!0,l)):console.warn("[ComBox] checkGG: Node invalid before RetPanel"):H.I.type==P.activity?E.I.emit(G.OPEN_TAB,T.activity,!0):H.I.type==P.daily&&(c=-1==A.data.dailyCompleteDays.indexOf(oe.I.day),E.I.emit(G.OPEN_TAB,T.daily,c)),e.abrupt("return");case 40:if(0!=o){e.next=129;break}console.log("[ComBox] checkGG: GG Triggered"),d=function(){var e=s(r().mark((function e(){var t,o,i,a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[ComBox] checkGG: fun() called (End Game Logic)"),H.I.type!=P.level||1!=O.getOnlineParamInt("replace_show2",1)){e.next=24;break}if(!(H.I.data.reviveCount>=j.HARD_REVIVE_COUNT)||H.I.data.replaceVideo){e.next=19;break}for(H.I.data.replaceVideo=!0,t=U.I.levelModelGetGroups(H.I.collectRatio,!1,!0,H.I.levelTimes),o=[],i=0;i<3;i++)o.push(ne.getColor());return console.log("ids:",t,"colors:",o),a=A.data.winStreak,A.data.levelDie=!0,A.data.winStreak=0,e.next=13,N.waitOpenPanel(W.ReplacePanel,t,o,!1);case 13:if(!e.sent){e.next=19;break}return A.data.levelDie=!1,A.data.winStreak=a,ne.updateGroupsByIds(t,o),e.abrupt("return");case 19:return C(ne.node)&&(console.log("[ComBox] checkGG: Opening RetPanel (Fail)"),Te(W.RetPanel,!1)),A.data.levelDie=!0,A.data.winStreak=0,H.I.resetData(),e.abrupt("return");case 24:if(H.I.type!=P.activity){e.next=32;break}return J.ins.actLevelEnd(A.data.activityLevel,"关卡失败",H.I.data.time,A.data.actLevelTimes,H.I.data.reviveCount,H.I.collectRatio,H.I.collectType==_.jewel?"宝石模式":"分数模式",H.I.data.putCount,H.I.data.isVideo),A.data.actLevelDie=!0,H.I.resetData(),e.next=30,ne.animMapFail();case 30:return C(ne.node)&&N.openPanel(W.ActivityFailPanel),e.abrupt("return");case 32:if(H.I.type!=P.daily){e.next=40;break}return J.ins.dailyLevelEnd(oe.I.level,"关卡胜利",H.I.data.time,A.data.dailyLevelTimes,H.I.data.reviveCount,H.I.collectRatio,H.I.collectType==_.jewel?"宝石模式":"分数模式",H.I.data.putCount,H.I.data.isVideo),A.data.dailyLevelDie=!0,H.I.resetData(),e.next=38,ne.animMapFail();case 38:return C(ne.node)&&N.openPanel(W.DailyFailPanel),e.abrupt("return");case 40:return e.next=42,ne.animMapFail();case 42:H.I.resetData(),C(ne.node)&&Te(W.EndPanel,ne.score),n=H.I.data.score==A.data.maxScore,s=A.data.dieCount,A.data.dieCount++,H.I.data.score==A.data.maxScore&&(A.data.dieCount=0,A.data.authorize&&!$.isWhite&&(!v.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.GameService&&PUCHI_SDK.GameService.rankAddV2({key:"rank_score",fraction:A.data.maxScore,extend:{badge:A.data.daily_badge_count+""}}),ee.getInstance().current.uploadRankData("rank_score",A.data.maxScore,{badge:A.data.daily_badge_count+""}))),J.ins.dot("endless_end",{score:ne.score,dieCount:s,recordBreaking:n,maxScore:A.data.maxScore}),H.I.resetData(),ne.resetData();case 51:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=j.REVIVE_COUNT,e.t0=H.I.type,e.next=e.t0===P.level?47:e.t0===P.activity?49:e.t0===P.daily?51:e.t0===P.default?52:54;break;case 47:case 49:return H.I.isHardLevel&&(u=j.HARD_REVIVE_COUNT),e.abrupt("break",54);case 51:return e.abrupt("break",54);case 52:return u=j.HARD_REVIVE_COUNT,e.abrupt("break",54);case 54:if(!(H.I.data.reviveCount>=u)){e.next=58;break}return console.log("[ComBox] checkGG: Revive count reached, ending game"),d(),e.abrupt("return");case 58:return Z.show(),e.next=61,O.wait(500);case 61:if(Z.hide(),h=A.data.winStreak,H.I.type==P.level&&(A.data.levelDie=!0,A.data.winStreak=0),H.I.type==P.activity&&(A.data.actLevelDie=!0),H.I.type==P.daily&&(A.data.dailyLevelDie=!0),J.ins.dot("gg_form",{model_type:U.I.modeType,type:H.I.type,level:H.I.level}),!(H.I.type==P.level&&A.data.replaceCount<O.getOnlineParamInt("replace_show_count",3)&&A.data.level>10&&1==O.getOnlineParamInt("replace_show",1))){e.next=82;break}if(H.I.data.replace||!(H.I.data.putCount<6||A.data.onlineTime<O.getOnlineParamInt("replace_time",180))){e.next=82;break}for(H.I.data.replace=!0,A.data.replaceCount++,p=U.I.levelModelGetGroups(H.I.collectRatio,!1,!0,H.I.levelTimes),m=[],f=0;f<3;f++)m.push(this.getColor());return e.next=76,N.waitOpenPanel(W.ReplacePanel,p,m,!0);case 76:if(!e.sent){e.next=82;break}return A.data.levelDie=!1,A.data.winStreak=h,this.updateGroupsByIds(p,m),e.abrupt("return");case 82:return console.log("[ComBox] checkGG: Opening RevivePanel"),e.next=85,N.waitOpenPanel(W.RevivePanel);case 85:if(g=e.sent,H.I.type==P.level&&(A.data.levelDie=!1,A.data.winStreak=h,A.data.level_ad_count++),H.I.type==P.activity&&(A.data.actLevelDie=!1),H.I.type==P.daily&&(A.data.dailyLevelDie=!1),!g){e.next=127;break}for(H.I.data.reviveCount++,b=O.random(0,6),x=[b,b+1],k=[],y=[],I=0;I<x.length;I++){for(B=[],w=[],S=0;S<8;S++)B.push(8*x[I]+S),w.push(8*S+x[I]);k.push(B),y.push(w)}for(D=O.randFromList(H.I.data.boardColor,1),L.I.playEffect("comb1"),M=k.concat(y),R=[],V=0;V<M.length;V++)for(z=M[V],K=0;K<z.length;K++)this.blocks[z[K]].obstacle>0&&this.blocks[z[K]].obstacle<4&&R.push(z[K]);R.length>0&&this.animObstacle(R),this.animXiaochu(k,!0,D[0],D[0]),this.animXiaochu(y,!1,D[0],D[0]),F={},X=0;case 106:if(!(X<M.length)){e.next=122;break}Y=M[X],q=0;case 109:if(!(q<Y.length)){e.next=119;break}if(!((Q=this.blocks[Y[q]]).obstacle>0)){e.next=114;break}return Q.handelObstacle(),e.abrupt("continue",116);case 114:Q.jewelId>0&&(F.hasOwnProperty(Y[q])||(F[Y[q]]=Q.jewelId)),Q.changeColor(0);case 116:q++,e.next=109;break;case 119:X++,e.next=106;break;case 122:for(ie in te=0,F)ae=this.blocks[ie].node.worldPosition,H.I.addCollectJewel(F[ie]),E.I.emit(G.TARGET_ANIM,ae,F[ie],!0,te),te++;this.updateGroups(!0),e.next=129;break;case 127:console.log("[ComBox] checkGG: Revive declined, ending game"),d();case 129:e.next=134;break;case 131:e.prev=131,e.t1=e.catch(1),console.error("[ComBox] checkGG error:",e.t1);case 134:case"end":return e.stop()}}),e,this,[[1,131]])})));return function(){return e.apply(this,arguments)}}(),l.guideTips=function(){var e=s(r().mark((function e(){var t,o,i,a,n,s,l,c,d,u,h,p,m,f=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null,o=-1,i=0;case 3:if(!(i<3)){e.next=19;break}if(!(a=this.groups[i]).isPut){e.next=7;break}return e.abrupt("continue",16);case 7:if(a.visible||Date.now()-this.t2<3e4&&J.ins.dot("tips_item_visible",{from:i}),n=O.clone(a.list),!U.I.canPut(this.map,n)){e.next=16;break}if(!(s=U.I.findBestWay(n,this.map))){e.next=16;break}return o=i,t=s,e.abrupt("break",19);case 16:i++,e.next=3;break;case 19:if(!t){e.next=36;break}return this.guideHand.active=!0,l=O.clone(this.groups[o].list),c=l.length*(j.BLOCK_W+j.BLOCK_SPACE)/2-j.BLOCK_W/2,d=l[0].length*(j.BLOCK_H+j.BLOCK_SPACE)/2-j.BLOCK_H/2,this.guideComBlock.createBlocks(l,this.groups[o].color,!1),u=this.blocks[8*t[0]+t[1]].node.worldPosition,h=I(u.x+d,u.y-c,0),p=!1,x.stopAllByTarget(this.guideHand),this.guideHand.setWorldPosition(this.groups[o].node.worldPosition),this.guideHand.setScale(I(1.2,1.2,1.2)),y(this.guideHand).to(.3,{scale:I(1,1,1)}).call((function(){p=!0})).start(),m=this.guideTipsTime,e.next=35,O.until((function(){return p}));case 35:this.guideHand.active&&m==this.guideTipsTime&&(this.guideComBlock.node.active=!0,y(this.guideHand).to(.3,{worldPosition:h,scale:I(1,1,1)}).delay(.6).call((function(){f.guideHand.active=!1})).start(),x.stopAllByTarget(this.guideComBlock.node),this.guideComBlock.node.setWorldPosition(this.groups[o].node.worldPosition),y(this.guideComBlock.node).to(.3,{worldPosition:h,scale:I(1,1,1)}).delay(.6).call((function(){f.guideComBlock.node.active=!1,f.guideTipsTime=Date.now()-8e3})).start());case 36:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.stopTips=function(){var e;null!=(e=this.guideHand)&&e.active&&(this.guideHand.active=!1,this.guideComBlock.node.active=!1,this.guideTipsTime=Date.now())},l.test=function(){this.guideTips()},l.testWin=function(){var e=s(r().mark((function e(){var t,o,i,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H.I.type!=P.default){e.next=14;break}return this.isWin=!0,e.next=4,this.animMapFail();case 4:C(this.node)&&Te(W.EndPanel,this.score),t=H.I.data.score==A.data.maxScore,o=A.data.dieCount,A.data.dieCount++,H.I.data.score==A.data.maxScore&&(A.data.dieCount=0,A.data.authorize&&!$.isWhite&&!v.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.GameService&&PUCHI_SDK.GameService.rankAddV2({key:"rank_score",fraction:A.data.maxScore,extend:{badge:A.data.daily_badge_count+""}}),ee.getInstance().current.uploadRankData("rank_score",A.data.maxScore,{badge:A.data.daily_badge_count+""})),J.ins.dot("endless_end",{score:this.score,dieCount:o,recordBreaking:t,maxScore:A.data.maxScore}),H.I.resetData(),this.resetData(),e.next=38;break;case 14:if(H.I.type!=P.level){e.next=23;break}return this.isWin=!0,i=A.data.level_ad_count,H.I.addLevel(),e.next=20,this.animMapClear(!1);case 20:C(this.node)&&Te(W.RetPanel,!0,i),e.next=38;break;case 23:if(H.I.type!=P.activity){e.next=31;break}return this.isWin=!0,H.I.addLevel(),e.next=28,this.animMapClear(!1);case 28:E.I.emit(G.OPEN_TAB,T.activity,!0),e.next=38;break;case 31:if(H.I.type!=P.daily){e.next=38;break}return this.isWin=!0,a=-1==A.data.dailyCompleteDays.indexOf(oe.I.day),H.I.addLevel(),e.next=37,this.animMapClear(!1);case 37:E.I.emit(G.OPEN_TAB,T.daily,a);case 38:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.testLose=function(){var e=s(r().mark((function e(){var t,o,i,a,n,s,l,c,d,u,h,p,m,f,g,b,v,x,k,y,I,B;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H.I.type===P.level){e.next=42;break}return e.next=3,N.waitOpenPanel(W.RevivePanel);case 3:if(!e.sent){e.next=40;break}for(H.I.data.reviveCount++,t=O.random(0,6),o=[t,t+1],i=[],a=[],n=0;n<o.length;n++){for(s=[],l=[],c=0;c<8;c++)s.push(8*o[n]+c),l.push(8*c+o[n]);i.push(s),a.push(l)}for(d=O.randFromList(H.I.data.boardColor,1),L.I.playEffect("comb1"),u=i.concat(a),h=[],p=0;p<u.length;p++)for(m=u[p],f=0;f<m.length;f++)this.blocks[m[f]].obstacle>0&&this.blocks[m[f]].obstacle<4&&h.push(m[f]);h.length>0&&this.animObstacle(h),this.animXiaochu(i,!0,d[0],d[0]),this.animXiaochu(a,!1,d[0],d[0]),g={},b=0;case 21:if(!(b<u.length)){e.next=37;break}v=u[b],x=0;case 24:if(!(x<v.length)){e.next=34;break}if(!((k=this.blocks[v[x]]).obstacle>0)){e.next=29;break}return k.handelObstacle(),e.abrupt("continue",31);case 29:k.jewelId>0&&(g.hasOwnProperty(v[x])||(g[v[x]]=k.jewelId)),k.changeColor(0);case 31:x++,e.next=24;break;case 34:b++,e.next=21;break;case 37:for(I in y=0,g)B=this.blocks[I].node.worldPosition,H.I.addCollectJewel(g[I]),E.I.emit(G.TARGET_ANIM,B,g[I],!0,y),y++;this.updateGroups(!0);case 40:e.next=68;break;case 42:if(H.I.type!=P.level){e.next=52;break}return this.isWin=!0,e.next=46,this.animMapFail();case 46:A.data.levelDie=!0,A.data.winStreak=0,H.I.resetData(),C(this.node)&&Te(W.RetPanel,!1),e.next=68;break;case 52:if(H.I.type!=P.activity){e.next=61;break}return this.isWin=!0,e.next=56,this.animMapFail();case 56:A.data.actLevelDie=!0,H.I.resetData(),C(this.node)&&N.openPanel(W.ActivityFailPanel),e.next=68;break;case 61:if(H.I.type!=P.daily){e.next=68;break}return this.isWin=!0,e.next=65,this.animMapFail();case 65:A.data.dailyLevelDie=!0,H.I.resetData(),C(this.node)&&N.openPanel(W.DailyFailPanel);case 68:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.changeSkin=function(){var e=s(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.I.initBlockIcon(A.data.skin);case 2:this.blocks.forEach((function(e){e.changeColor(e.color)})),this.groups.forEach((function(e){e.blocks.forEach((function(e){e.changeColor(e.color)}))})),this.testAddSp();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.testAddSp=function(){this.testNode||(this.testNode=new c("testNode"),this.testNode.active=!1,this.node.addChild(this.testNode)),this.testNode.removeAllChildren();for(var e=[1,2,3,4,5,6,7,11,21,31,41,51,61,71,101,201,301,401],t=0;t<e.length;t++){var o=M.get(R.block);o.getComponent(V).changeColor(e[t]),o.active=!1,this.testNode.addChild(o)}},l.playMaxAnim=function(){try{var e=M.get(R.maxAnim);if(!e)return;var t=e.getComponent(d.Skeleton);if(ie.isZh())if(t&&t.skeletonData){t.enabled=!1,e.setParent(this.effect2),e.setPosition(0,250,0);var o=e.getChildByName("_i18n_record_label");o&&(o.active=!1),t.setCompleteListener((function(){C(e)&&M.put(R.maxAnim,e)}));try{t.setAnimation(0,"enter",!1),t.enabled=!0}catch(e){console.warn("[ComBox] playMaxAnim setAnimation error:",e),t.enabled=!0}}else C(e)&&M.put(R.maxAnim,e);else{t&&(t.enabled=!1),e.setParent(this.effect2),e.setPosition(0,250,0);var i=e.getChildByName("_i18n_record_label");if(!i){(i=new c("_i18n_record_label")).layer=e.layer,e.addChild(i);var a=i.addComponent(g);a.fontSize=70,a.lineHeight=80,a.isBold=!0,a.overflow=g.Overflow.NONE,a.outlineWidth=5}i.active=!0;var n=i.getComponent(g);n.string=ie.t("tips.new_record"),n.color=new b(255,255,255),n.outlineColor=new b(255,140,0,255),i.scale=I(0,0,1),y(i).to(.2,{scale:I(1.4,1.4,1.4)},{easing:"backOut"}).to(.1,{scale:I(1,1,1)}).delay(1.5).call((function(){C(e)&&M.put(R.maxAnim,e)})).start()}}catch(e){console.error("[ComBox] playMaxAnim error:",e)}},n(t,[{key:"map",get:function(){for(var e=[],t=0;t<8;t++){for(var o=[],i=0;i<8;i++){var a=this.blocks[8*t+i];a.color>0?o.push(a.obstacle+1):o.push(0)}e.push(o)}return e}},{key:"map2",get:function(){for(var e=[],t=0;t<this.blocks.length;t++)e.push(this.blocks[t].color);return e}}]),t}(B))._adaptOffset=0,Se.DEBUG_SCREEN_ADAPT=!1,Se._debugLabel=null,Se._debugLines=[],be=t((ge=Se).prototype,"modelView",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=t(ge.prototype,"btm",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=t(ge.prototype,"list",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=t(ge.prototype,"effect",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=t(ge.prototype,"effect2",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=t(ge.prototype,"comboSp",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=t(ge.prototype,"duoxiaoSp",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=t(ge.prototype,"duoxiaoBG",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=t(ge.prototype,"guideHand",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=ge))||fe));l._RF.pop()}}}));

System.register("chunks:///_virtual/ComCombo.ts",["./rollupPluginModLoBabelHelpers.js","cc","./I18nManager.ts"],(function(t){var e,o,n,a,i,l,r,s,c,b,u,d,m,p,h,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){i=t.cclegacy,l=t.Node,r=t.Label,s=t.sp,c=t._decorator,b=t.v3,u=t.UIOpacity,d=t.Color,m=t.Sprite,p=t.tween,h=t.Component},function(t){f=t.I18n}],execute:function(){var N,C,y,g,v,w,S,k,z;i._RF.push({},"c81b9vqelVIhJd3xZ7J2QNV","ComCombo",void 0);var L=c,A=L.ccclass,P=L.property;function B(t,e,o,n){if(!t||!t.skeletonData)return console.warn("[safeSetAnimation] Skeleton or skeletonData is null"),!1;try{return t.setAnimation(e,o,n),!0}catch(t){return console.warn("[safeSetAnimation] Error setting animation '"+o+"':",t),!1}}t("ComCombo",(N=A("game/ComCombo"),C=P(l),y=P(r),g=P(s.Skeleton),N((S=e((w=function(t){function e(){for(var e,o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i))||this,n(e,"labNode",S,a(e)),n(e,"labNum",k,a(e)),n(e,"ske",z,a(e)),e}o(e,t);var i=e.prototype;return i.init=function(t){var e=this;if(this.labNum.string=""+t,this.labNum.node.parent.setPosition(b(t>9?80:70,4,1)),this.labNode.active=!0,this.labNum.node.active=!0,this.labNode.setScale(b(0,0,0)),this.labNode.getComponent(u).opacity=255,this.labNode){var o=this.labNode.getChildByName("ComboLabel");if(o)o.getComponent(r).string=f.t("home.combo");else{var n=(o=new l("ComboLabel")).addComponent(r);n.string=f.t("home.combo"),n.fontSize=40,n.fontFamily="Arial",n.isBold=!0,n.outlineColor=new d(0,0,0,255),n.outlineWidth=3,o.parent=this.labNode,o.setPosition(0,0,0);var a=this.labNode.getComponent(m);a&&(a.enabled=!1)}}B(this.ske,0,"enter",!1),p(this.labNode).to(.1,{scale:b(1.3,1.3,1.3)}).to(.06,{scale:b(1,1,1)}).delay(.24).call((function(){p(e.labNode.getComponent(u)).to(.1,{opacity:0}).start()})).to(.1,{scale:b(1.3,1.3,1.3)}).call((function(){e.labNode.active=!1})).start(),this.labNum.node.parent.setScale(b(0,0,0)),this.labNum.node.parent.getComponent(u).opacity=255,p(this.labNum.node.parent).delay(.02).to(.1,{scale:b(1.3,1.3,1.3)}).to(.1,{scale:b(1,1,1)}).delay(.24).call((function(){p(e.labNum.node.parent.getComponent(u)).to(.1,{opacity:0}).start()})).to(.1,{scale:b(1.3,1.3,1.3)}).call((function(){e.labNum.node.active=!1})).start()},i.showPerfect=function(){var t=this;if(this.labNode){this.labNode.active=!0,this.labNode.setScale(b(0,0,0)),this.labNode.getComponent(u).opacity=255;var e=this.labNode.getChildByName("ComboLabel");if(!e){var o=(e=new l("ComboLabel")).addComponent(r);o.fontSize=50,o.fontFamily="Arial",o.isBold=!0,o.outlineColor=new d(200,50,50,255),o.outlineWidth=4,e.parent=this.labNode,e.setPosition(0,0,0)}e.getComponent(r).string=f.t("tips.perfect");var n=this.labNode.getComponent(m);n&&(n.enabled=!1),B(this.ske,0,"enter",!1),p(this.labNode).to(.1,{scale:b(1.5,1.5,1.5)}).to(.06,{scale:b(1,1,1)}).delay(.5).call((function(){p(t.labNode.getComponent(u)).to(.1,{opacity:0}).start()})).to(.1,{scale:b(1.5,1.5,1.5)}).call((function(){t.labNode.active=!1})).start()}},e}(h)).prototype,"labNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(w.prototype,"labNum",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(w.prototype,"ske",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=w))||v));i._RF.pop()}}}));

System.register("chunks:///_virtual/ComDuoxiao.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./Const.ts","./I18nManager.ts"],(function(e){var o,n,t,i,a,s,r,l,c,u,p,d,f,k,g,h,m,x,D,C,w;return{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){r=e.cclegacy,l=e.Sprite,c=e.sp,u=e._decorator,p=e.Component,d=e.Node,f=e.Label,k=e.Color,g=e.UIOpacity,h=e.v3,m=e.tween,x=e.isValid},function(e){D=e.AssetMgr},function(e){C=e.BUNDLES},function(e){w=e.I18n}],execute:function(){var S,b,y,v,_,N,F;r._RF.push({},"5bfa7EdpylCtqMxxA/mFIQq","ComDuoxiao",void 0);var I=u,z=I.ccclass,A=I.property;function B(e,o){if(console.log("[safeSkin-Duoxiao] Called with skinName='"+o+"'"),!e)return console.warn("[safeSkin-Duoxiao] Skeleton is null"),!1;if(!e.skeletonData)return console.warn("[safeSkin-Duoxiao] skeletonData is null"),!1;try{var n=e.skeletonData.getRuntimeData();if(console.log("[safeSkin-Duoxiao] getRuntimeData returned:",n?"valid":"null"),!n||!n.findSkin)return console.warn("[safeSkin-Duoxiao] Cannot check skin existence"),!1;var t=n.findSkin(o);return console.log("[safeSkin-Duoxiao] findSkin('"+o+"') returned:",t?"found":"NOT FOUND"),t?(console.log("[safeSkin-Duoxiao] Calling setSkin('"+o+"')..."),e.setSkin(o),console.log("[safeSkin-Duoxiao] setSkin completed successfully"),!0):(console.warn("[safeSkin-Duoxiao] Skin '"+o+"' not found, skipping setSkin"),!1)}catch(e){return console.warn("[safeSkin-Duoxiao] Error setting skin '"+o+"':",e),!1}}e("ComDuoxiao",(S=z("game/ComDuoxiao"),b=A(l),y=A(c.Skeleton),S((N=o((_=function(e){function o(){for(var o,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return o=e.call.apply(e,[this].concat(a))||this,t(o,"sp",N,i(o)),t(o,"ske",F,i(o)),o}n(o,e);var r=o.prototype;return r.disableSpine=function(){this.ske&&(this.ske.enabled=!1)},r.enableSpine=function(){this.ske&&(this.ske.enabled=!0)},r.init=function(){var e=a(s().mark((function e(o,n){var t,i,a,r,l,c,u,p,S,b=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[ComDuoxiao] init start: len="+o+", color="+n),o>6&&(o=6),t=["hong","cheng","huang","lv","qing","lan","zi"][n-1]||"huang",console.log("[ComDuoxiao] setting skin: "+t),B(this.ske,t))try{this.ske.color=new k(255,255,255,255),this.ske.setAnimation(0,"enter",!1),this.ske.setCompleteListener((function(){b.ske.clearTracks(),b.ske.color=new k(255,255,255,0)}))}catch(e){console.warn("[ComDuoxiao] setAnimation error:",e)}else console.log("[ComDuoxiao] Skeleton or skin not available");if(i=null,!(a=w.isZh())){e.next=21;break}return e.prev=9,console.log("[ComDuoxiao] loading icon: images/dx_"+(o-1)+"_"+n),e.next=13,D.I.loadIcon(C.Game,"images/dx_"+(o-1)+"_"+n);case 13:i=e.sent,console.log("[ComDuoxiao] icon loaded: "+(i?"success":"failed")),e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(9),console.warn("[ComDuoxiao] Failed to load icon: images/dx_"+(o-1)+"_"+n,e.t0),e.abrupt("return");case 21:if(x(this.node)&&x(this.sp)){e.next=24;break}return console.warn("[ComDuoxiao] Node or Sprite invalid after load"),e.abrupt("return");case 24:a?(this.sp.spriteFrame=i,(r=this.sp.node.getChildByName("_i18n_combo_label"))&&(r.active=!1)):(this.sp.spriteFrame=null,(l=this.sp.node.getChildByName("_i18n_combo_label"))||((l=new d("_i18n_combo_label")).layer=this.sp.node.layer,this.sp.node.addChild(l),(c=l.addComponent(f)).fontSize=60,c.lineHeight=70,c.isBold=!0,c.outlineWidth=4),l.active=!0,(u=l.getComponent(f)).string=w.t("combo_words."+o),p=[new k(255,69,58),new k(255,159,10),new k(255,214,10),new k(50,215,75),new k(100,210,255),new k(10,132,255),new k(191,90,242)],S=p[(n-1)%p.length]||p[0],u.color=new k(255,255,255),u.outlineColor=S),this.sp.node.getComponent(g).opacity=255,this.sp.node.scale=h(0,0,1),console.log("[ComDuoxiao] starting tween"),m(this.sp.node).to(.1,{scale:h(1.3,1.3,1.3)}).to(.06,{scale:h(1,1,1)}).call((function(){x(b.sp.node)&&m(b.sp.node.getComponent(g)).delay(.3).to(.2,{opacity:0}).start()})).start(),console.log("[ComDuoxiao] init finished");case 30:case"end":return e.stop()}}),e,this,[[9,17]])})));return function(o,n){return e.apply(this,arguments)}}(),o}(p)).prototype,"sp",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=o(_.prototype,"ske",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=_))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/ComFail.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./Utils.ts","./I18nManager.ts"],(function(e){var t,n,i,r,o,a,l,s,c,u,p,g,f,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.createClass},function(e){a=e.cclegacy,l=e.Sprite,s=e.Label,c=e._decorator,u=e.isValid,p=e.Component},function(e){g=e.AssetMgr},function(e){f=e.Utils},function(e){m=e.I18n}],execute:function(){var h,b,y,d,F,C,D;a._RF.push({},"85a19JPPxJOIpH49h6pyzu8","ComFail",void 0);var I=c,_=I.ccclass,v=I.property;e("ComFail",(h=_("comp/ComFail"),b=v(l),y=v(s),h((C=t((F=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"img",C,r(t)),i(t,"labDesc",D,r(t)),t}n(t,e);var a=t.prototype;return a.onLoad=function(){},a.onEnable=function(){var e=this,t=this.FAIL_DESC,n=t.length>0?t.length-1:8,i=f.random(0,n);g.I.loadIcon("Panel","images_compress/failImg/shibai_img_"+(i+1)).then((function(t){u(e.node)&&(e.img.spriteFrame=t)})),t.length>0&&t[i]?this.labDesc.string=t[i]:(console.warn("[ComFail] No encouragement text found for index:",i,"total:",t.length),this.labDesc.string="")},o(t,[{key:"FAIL_DESC",get:function(){return m.tArray("fail.encouragements")}}]),t}(p)).prototype,"img",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(F.prototype,"labDesc",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=F))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/ComLight.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,i,t,o,r,s,a,l,c,f;return{setters:[function(n){e=n.applyDecoratedDescriptor,i=n.inheritsLoose,t=n.initializerDefineProperty,o=n.assertThisInitialized},function(n){r=n.cclegacy,s=n.ParticleSystem2D,a=n.sp,l=n._decorator,c=n.Color,f=n.Component}],execute:function(){var u,p,k,h,g,d,S;r._RF.push({},"52d94cwDzBJqK0QXanYi7kH","ComLight",void 0);var m=l,C=m.ccclass,v=m.property;n("ComLight",(u=C("game/ComLight"),p=v(s),k=v(a.Skeleton),u((d=e((g=function(n){function e(){for(var e,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e=n.call.apply(n,[this].concat(r))||this,t(e,"pars",d,o(e)),t(e,"sp",S,o(e)),e}return i(e,n),e.prototype.initColor=function(n,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var t=c.BLACK.fromHEX(["#E68B8A","#FDC698","#F1DF7F","#87D37C","#86D5F0","#7EADF0","#C39BE2","#ffffff"][n-1]||"#ffffff");this.node.angle=e?0:-90,this.pars[0].node.active=!1,this.pars[1].node.active=!1;var o=["hong","cheng","huang","lv","qing","lan","zi","caise"][n-1]||"huang";if(console.log("[ComLight] initColor: color="+n+", skin="+o),i&&this.sp&&(this.sp.enabled=!1),function(n,e){if(console.log("[safeSkin] Called with skinName='"+e+"'"),!n)return console.warn("[safeSkin] Skeleton is null"),!1;if(!n.skeletonData)return console.warn("[safeSkin] skeletonData is null"),!1;try{var i=n.skeletonData.getRuntimeData();if(console.log("[safeSkin] getRuntimeData returned:",i?"valid":"null"),!i||!i.findSkin)return console.warn("[safeSkin] Cannot check skin existence, skData or findSkin not available"),!1;var t=i.findSkin(e);return console.log("[safeSkin] findSkin('"+e+"') returned:",t?"found":"NOT FOUND"),t?(console.log("[safeSkin] Calling setSkin('"+e+"')..."),n.setSkin(e),console.log("[safeSkin] setSkin completed successfully"),!0):(console.warn("[safeSkin] Skin '"+e+"' not found in skeleton, skipping setSkin"),!1)}catch(n){return console.warn("[safeSkin] Error setting skin '"+e+"':",n),!1}}(this.sp,o)){try{this.sp.setAnimation(0,"xuanzhong_1",!0)}catch(n){console.warn("[ComLight] setAnimation error:",n)}i&&this.sp&&(this.sp.enabled=!0)}this.pars.forEach((function(n){var e=n.startColor!=t;n.startColor=t,n.endColor=t,e&&n.active&&n.resetSystem()}))},e}(f)).prototype,"pars",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=e(g.prototype,"sp",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=g))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/CompCollectJewelItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./Const.ts"],(function(e){var t,n,i,r,o,l,c,a,u,s,p,m,f,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){c=e.cclegacy,a=e.Label,u=e.Sprite,s=e.Node,p=e._decorator,m=e.Component},function(e){f=e.AssetMgr},function(e){h=e.BUNDLES}],execute:function(){var g,b,y,d,v,w,C,N,z;c._RF.push({},"26650JNy2JFzbkd1SCig9jt","CompCollectJewelItem",void 0);var J=p,S=J.ccclass,F=J.property;e("CompCollectJewelitem",(g=S("game/CompCollectJewelitem"),b=F(a),y=F(u),d=F(s),g((C=t((w=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return t=e.call.apply(e,[this].concat(o))||this,i(t,"labNum",C,r(t)),i(t,"icon",N,r(t)),i(t,"complete",z,r(t)),t}n(t,e);var c=t.prototype;return c.refresh=function(){var e=o(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.I.loadIcon(h.Game,"images/jewel1_"+t.id);case 2:this.icon.spriteFrame=e.sent,this.labNum.string=n?0==t.num?"":t.num.toString():"",this.complete&&(this.complete.active=!!n&&0==t.num);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),c.updateNum=function(e){this.labNum.string=0==e?"":e.toString(),this.complete&&(this.complete.active=0==e)},c.hide=function(){this.icon.spriteFrame=null,this.labNum.string="",this.complete&&(this.complete.active=!1)},t}(m)).prototype,"labNum",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(w.prototype,"icon",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(w.prototype,"complete",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=w))||v));c._RF.pop()}}}));

System.register("chunks:///_virtual/CompCollectJewels.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CompCollectJewelItem.ts"],(function(e){var t,o,r,i,n,l,c,s,a;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,l=e.Node,c=e._decorator,s=e.Component},function(e){a=e.CompCollectJewelitem}],execute:function(){var p,u,f,h,m;n._RF.push({},"10dc08dgBVMc7hlIM4AGQHs","CompCollectJewels",void 0);var C=c,d=C.ccclass,v=C.property;e("CompCollectJewels",(p=d("game/CompCollectJewels"),u=v(l),p((m=t((h=function(e){function t(){for(var t,o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];return t=e.call.apply(e,[this].concat(n))||this,r(t,"list",m,i(t)),t.obj={},t}o(t,e);var n=t.prototype;return n.refresh=function(e,t){void 0===t&&(t=!1),this.obj={};for(var o=0;o<6;o++){var r=this.list.children[o].getComponent(a);o<e.length?(r.node.active=!0,this.obj[e[o].id]=r,r.refresh(e[o],t)):r.node.active=!1}},n.getItem=function(e){return this.obj[e]},t}(s)).prototype,"list",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=h))||f));n._RF.pop()}}}));

System.register("chunks:///_virtual/ComTab.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./Enum.ts","./TabItem.ts"],(function(e){var t,n,i,o,r,a,s,c,u,l,f,m,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e.Node,s=e._decorator,c=e.tween,u=e.v3,l=e.Component},function(e){f=e.default},function(e){m=e.EventType},function(e){p=e.TabItem}],execute:function(){var h,d,b,v,y,T,g;r._RF.push({},"47677Llr4FJfquO9VTSfRsM","ComTab",void 0);var C=s,I=C.ccclass,L=C.property;e("ComTab",(h=I("game/ComTab"),d=L(a),b=L(a),h((T=t((y=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,i(t,"items",T,o(t)),i(t,"animNode",g,o(t)),t}n(t,e);var r=t.prototype;return r.onLoad=function(){this.animNode.setPosition(0,-200,0),c(this.animNode).to(.3,{position:u(0,0,0)}).start()},r.onItem=function(e,t){f.I.emit(m.TOGGLE_TAB,+t)},r.refresh=function(e,t){for(var n=0;n<this.items.children.length;n++)this.items.children[n].getComponent(p).refresh(e==n,t)},t}(l)).prototype,"items",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=t(y.prototype,"animNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=y))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/ConfigExtension.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"e0959jz2nVH5poise209BMU","ConfigExtension",void 0);t("test",(function(){this.id=void 0})),t("CollectData",(function(){this.id=void 0,this.num=void 0}));i._RF.pop()}}}));

System.register("chunks:///_virtual/ConfigManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./DataModel.ts","./DataAccess.ts","./Const.ts","./ConfigExtension.ts","./GameConst.ts"],(function(e){var t,n,l,i,r,a,o,s,u,c,f,g,v;return{setters:[function(e){t=e.createClass},function(e){n=e.cclegacy,l=e._decorator,i=e.sys,r=e.BufferAsset},function(e){a=e.AssetMgr},function(e){o=e.GameConfig,s=e.DataConverter},function(e){u=e.DataTable,c=e.DataAccess},function(e){f=e.BUNDLES},function(e){g=e.CollectData},function(e){v=e.default}],execute:function(){var C,b;n._RF.push({},"6eb21/yLnZDh5Zrzhm8ulnv","ConfigManager",void 0),console.log("[Load] Loading ConfigManager.ts");var h=l,m=h.ccclass;h.property,e("ConfigManager",m("ConfigManager")(((b=function(){function e(){}return e.loadConfig=function(){s.convertHandler=this.modelConvert.bind(this);c.initial("data/",(function(e){var t=a.I.get(f.Config,""+e,r);return new Uint8Array(t.buffer())})),this._modelConverter["CollectData[]"]=this.parseCollectData.bind(this),this._modelConverter["number[][]"]=this.parseNumberArrs.bind(this)},e.parseNumberArrs=function(e,t,n){if(!n)return null;var l=[];if(""==n)return[];for(var i=n.split("|"),r=0;r<i.length;r++){var a=i[r].split(",").map(Number);l.push(a)}return l},e.parseCollectData=function(e,t,n){if(!n)return null;var l=[];if(""==n)return[];for(var i=n.split("|"),r=0;r<i.length;r++){var a=new g,o=i[r].split(",");a.id=Number(o[0]),a.num=Number(o[1]),l.push(a)}return l},e.getBlockTable=function(e){return this.BlockTable.getItem(e)},e.getBlocks=function(e){return(!e||e.length>0)&&console.log(e),this.getBlockTable(e).getBlocks()},e.getLevelTable=function(e){if(this.testCfg)return this.testCfg;if(e>v.MAX_LV){e-=v.MAX_LV;var t=Math.floor(e/(v.MAX_LV-50))+1,n=50+e%(v.MAX_LV-50),l=JSON.parse(JSON.stringify(this.LevelTable.getItem(n)));return l.score>0&&(l.score=l.score+100*t),l.getCollect=function(){var e=[];if(""==l.collect)return[];for(var n=l.collect.split("|"),i=0;i<n.length;i++){var r=new g,a=n[i].split(",");r.id=Number(a[0]),r.num=Number(a[1])+Math.floor(20*t/n.length),e.push(r)}return e},l}return e<=100&&(!i.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService&&PUCHI_SDK.OnlineService.getParamsInt("special_user_3",1),!i.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService&&PUCHI_SDK.OnlineService.getParamsInt("plan_level",80)),this.LevelTable.getItem(e)},e.getActLevelTable=function(e){return e>202?(e-=202,e%=202,this.ActivityLevelTable.getItem(e)):this.ActivityLevelTable.getItem(e)},e.getDailyLevelTable=function(e){return e>294?(e-=294,e%=294,this.DailyLevelTable.getItem(e)):this.DailyLevelTable.getItem(e)},e.setTestCfg=function(e){this.testCfg=e},e.getSkinsTable=function(e){return this.SkinsTable.getItem(e)},e.getFallDownTable=function(e){return this.FallDownTable.getItem(e)},e.modelConvert=function(e,t,n,l){var i=this._modelConverter[l];if(i)return i(e,t,n);console.error("can not find alias named "+l+" in field="+t)},t(e,null,[{key:"settings",get:function(){return this.SettingTable.getItem(1)}},{key:"skinsTable",get:function(){return this.SkinsTable.items}},{key:"fallDownTable",get:function(){return this.FallDownTable.items}}]),e}()).SettingTable=new u(o.SettingsCfg),b.BlockTable=new u(o.BlockCfg),b.LevelTable=new u(o.LevelCfg),b.LevelBTable=new u(o.LevelBCfg),b.LevelCTable=new u(o.LevelCCfg),b.ActivityLevelTable=new u(o.ActivityLevelCfg),b.DailyLevelTable=new u(o.DailyLevelCfg),b.SkinsTable=new u(o.SkinsCfg),b.FallDownTable=new u(o.FallDownCfg),b._modelConverter={},b.testCfg=void 0,C=b))||C);n._RF.pop()}}}));

System.register("chunks:///_virtual/Const.ts",["cc"],(function(o){var n;return{setters:[function(o){n=o.cclegacy}],execute:function(){n._RF.push({},"3cd5f3AQsFF4ZPK3/Et9f9M","Const",void 0);o("BUNDLES",{Panel:"Panel",CommonAsset:"CommonAsset",Asset:"Asset",Common:"Common",Game:"Game",Audio:"Audio",Config:"Config",FallDown:"FallDown"});n._RF.pop()}}}));

System.register("chunks:///_virtual/CrazyGamesPlatform.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var a,r,n;return{setters:[function(e){a=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"f15cc9a18tBVIwpLzr5RI/Q","CrazyGamesPlatform",void 0);e("CrazyGamesPlatform",function(){function e(){this.name="CrazyGames",this._sdk=null,console.log("CrazyGamesPlatform constructor")}var n=e.prototype;return n.init=function(){console.log("CrazyGamesPlatform init (sync wrapper)")},n.initAsync=function(){var e=a(r().mark((function e(){var a,n,o,t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("CrazyGamesPlatform initAsync"),window.CrazyGames&&window.CrazyGames.SDK){e.next=4;break}return console.error("CrazyGames SDK not found in window"),e.abrupt("return");case 4:if(a=window.CrazyGames.SDK,console.log("CrazyGames SDK found (Pre-init). Keys:",Object.keys(a)),e.prev=6,"function"!=typeof a.init){e.next=14;break}return console.log("Calling CrazyGames.SDK.init()..."),e.next=11,a.init();case 11:n=e.sent,console.log("CrazyGames.SDK.init() completed"),n&&(console.log("CrazyGames.SDK.init() returned a new object. Using it."),a=n);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),console.warn("CrazyGames.SDK.init() failed or warnings:",e.t0);case 19:this._sdk=a;try{o=Object.keys(this._sdk),console.log("CrazyGames Final Cached SDK Keys:",o),this._sdk.data?console.log("CrazyGames Data Module VERIFIED on cached instance."):(console.error("CrazyGames Data Module MISSING on cached instance. Available:",o),(t=window.CrazyGames.SDK)!==this._sdk&&console.warn("Global Window SDK is different from cached one. Keys:",Object.keys(t)))}catch(e){}console.log("CrazyGames SDK initialized");case 22:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(){return e.apply(this,arguments)}}(),n.getSDK=function(){var e;return this._sdk?this._sdk:null!=(e=window.CrazyGames)&&e.SDK?window.CrazyGames.SDK:null},n.login=function(){var e=this;return new Promise((function(a){var r=e.getSDK();if(!r||!r.user)return console.warn("CrazyGames SDK or User module missing"),void a({code:0,userInfo:{userId:"guest_"+Math.floor(1e5*Math.random()),nickName:"Guest",avatarUrl:""}});r.user.getUser().then((function(e){e?(console.log("CrazyGames User:",e),a({code:0,userInfo:{userId:e.id||"guest",nickName:e.username||"Guest",avatarUrl:e.profilePictureUrl||""}})):(console.log("CrazyGames User: Guest"),a({code:0,userInfo:{userId:"guest_"+Math.floor(1e5*Math.random()),nickName:"Guest",avatarUrl:""}}))})).catch((function(e){console.warn("CrazyGames getUser failed",e),a({code:0,userInfo:{userId:"guest_"+Math.floor(1e5*Math.random()),nickName:"Guest",avatarUrl:""}})}))}))},n.getUserInfo=function(){return Promise.resolve({})},n.vibrateShort=function(e){navigator.vibrate&&navigator.vibrate(15)},n.vibrateLong=function(){navigator.vibrate&&navigator.vibrate(200)},n.showBanner=function(){console.log("CrazyGames showBanner (Not implemented)")},n.hideBanner=function(){console.log("CrazyGames hideBanner (Not implemented)")},n.showInterstitial=function(){var e=this.getSDK();e&&e.ad&&(console.log("CrazyGames requesting midgame ad"),e.game&&e.game.gameplayStop(),e.ad.requestAd("midgame",{adStarted:function(){console.log("Ad started")},adFinished:function(){console.log("Ad finished"),e.game&&e.game.gameplayStart()},adError:function(a){console.warn("Ad error",a),e.game&&e.game.gameplayStart()}}))},n.showRewardVideo=function(e){var a=this;return new Promise((function(e){console.warn("[CrazyGames TEST] showRewardVideo called from Game Logic");var r=a.getSDK();if(!r||!r.ad)return console.warn("[CrazyGames TEST] SDK or Ad module missing",r),void e({code:1,msg:"SDK/Ad module not ready"});console.warn("[CrazyGames TEST] Requesting rewarded ad now..."),r.game&&(console.warn("[CrazyGames TEST] Stopping Gameplay..."),r.game.gameplayStop());var n=!1;r.ad.requestAd("rewarded",{adStarted:function(){console.warn("[CrazyGames TEST] Rewarded Ad started callback"),n=!0},adFinished:function(){console.warn("[CrazyGames TEST] Rewarded Ad finished callback"),r.game&&r.game.gameplayStart(),n?(console.warn("[CrazyGames TEST] resolving Success"),e({code:0,msg:"Success"})):(console.warn("[CrazyGames TEST] finished but never started. Resolving Success for QA."),e({code:0,msg:"Success"}))},adError:function(a){console.warn("[CrazyGames TEST] Rewarded Ad error callback",a),r.game&&r.game.gameplayStart(),e({code:1,msg:"Error"})}})}))},n.uploadRankData=function(e,a,r){},n.postMessage=function(e,a){},n.trackEvent=function(e,a){console.log("[CrazyGames] Track "+e+" ",a)},n.getSafeAreaTop=function(){return 0},n.getVersion=function(){return"1.0.0"},n.saveData=function(e,a){var r=this;return new Promise((function(n,o){var t=r.getSDK();if(!t||!t.data)return console.warn("[CrazyGames] Data module missing during save. Cached SDK Keys:",t?Object.keys(t):"null"),void n();try{t.data.setItem(e,a),console.log("[CrazyGames] Saved "+e+" "),n()}catch(e){console.error("[CrazyGames] Save error",e),n()}}))},n.loadData=function(e){var a=this;return new Promise((function(r,n){var o=a.getSDK();if(!o||!o.data)return console.warn("[CrazyGames] Data module missing during load."),void r(null);try{var t=o.data.getItem(e);console.log("[CrazyGames] Loaded "+e+" "),r(t)}catch(e){console.error("[CrazyGames] Load error",e),r(null)}}))},n.gameReady=function(){},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/DailyFailPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./Panel.ts","./Utils.ts","./AudioManager.ts","./EventManager.ts","./SdkTools.ts","./TDataMgr.ts"],(function(e){var t,n,i,r,a,o,s,l,u,c,p,f,d,h,y,m,v,b,g,k;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e.sp,u=e.Node,c=e._decorator,p=e.tween,f=e.UIOpacity},function(e){d=e.EventType,h=e.TabType},function(e){y=e.default},function(e){m=e.Utils},function(e){v=e.AudioManager},function(e){b=e.default},function(e){g=e.SdkTools},function(e){k=e.TDataMgr}],execute:function(){var w,C,_,T,x,N,A,D,P,R,L;s._RF.push({},"5e459Iuqc9Aprk6dxKr4Lue","DailyFailPanel",void 0);var z=c,E=z.ccclass,I=z.property;e("default",(w=E("panel/DailyFailPanel"),C=I(l.Skeleton),_=I(u),T=I(u),x=I(u),w((D=t((A=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"sp",D,r(t)),i(t,"hardNode",P,r(t)),i(t,"animNode",R,r(t)),i(t,"btnReplay",L,r(t)),t.isClick=!1,t}n(t,e);var s=t.prototype;return s.onLoad=function(){},s.init=function(){var e=a(o().mark((function e(){var t,n=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isClick=!0,v.I.playEffect("defeat"),t=!1,this.animNode.getComponent(f).opacity=0,this.hardNode.active=!1,this.btnReplay.active=!0,this.sp.setCompleteListener((function(){n.sp.setCompleteListener(null),n.sp.setAnimation(0,"2_loop",!0),t=!0})),this.sp.setAnimation(0,"2_enter",!1),e.next=10,m.until((function(){return t}));case 10:return t=!1,p(this.animNode.getComponent(f)).to(.2,{opacity:255}).call((function(){t=!0})).start(),e.next=14,m.until((function(){return t}));case 14:this.isClick=!1,k.ins.dot("video_exposure",{view_reason:"level_replay3"});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.onReplay=function(){var e=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isClick){e.next=2;break}return e.abrupt("return");case 2:return this.isClick=!0,e.next=5,g.share("level_replay3");case 5:t=e.sent,this.isClick=!1,0==t.code&&(this.close(),b.I.emit(d.REPLAY,!0));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.onClose=function(){this.close(),b.I.emit(d.OPEN_TAB,h.daily,!1)},t}(y)).prototype,"sp",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(A.prototype,"hardNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(A.prototype,"animNode",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(A.prototype,"btnReplay",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=A))||N));s._RF.pop()}}}));

System.register("chunks:///_virtual/DailyItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./DailyMgr.ts"],(function(t){var i,e,a,r,n,o,l,c,s,u,y,p;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,a=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){n=t.cclegacy,o=t.Node,l=t.Label,c=t._decorator,s=t.Color,u=t.Component},function(t){y=t.GameData},function(t){p=t.DailyMgr}],execute:function(){var f,b,D,h,g,v,m,d,I;n._RF.push({},"7c77a+gRoZLt7a4DoEWqZm6","DailyItem",void 0);var w=c,z=w.ccclass,L=w.property;t("DailyItem",(f=z("DailyItem"),b=L(o),D=L(l),h=L(o),f((m=i((v=function(t){function i(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return i=t.call.apply(t,[this].concat(n))||this,a(i,"bg",m,r(i)),a(i,"labDay",d,r(i)),a(i,"icon",I,r(i)),i}e(i,t);var n=i.prototype;return n.refresh=function(t,i,e,a){if(i<e)return this.bg.active=!1,this.labDay.string="",void(this.icon.active=!1);var r=i-e+1;this.labDay.string=""+r,a&&r==p.I.day?this.icon.active=!1:this.icon.active=y.data.dailyCompleteDays.includes(r);var n=+p.I.today.split("/")[2]==r;this.bg.active=n,this.labDay.color=s.BLACK.fromHEX(n?"#DFE2F0":"#335386")},n.showStar=function(){this.icon.active=!0},i}(u)).prototype,"bg",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(v.prototype,"labDay",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=i(v.prototype,"icon",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=v))||g));n._RF.pop()}}}));

System.register("chunks:///_virtual/DailyMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./GameData.ts","./ObjectInstance.ts","./EventManager.ts","./Utils.ts"],(function(t){var e,a,n,r,i,s,o,u,c;return{setters:[function(t){e=t.createClass,a=t.asyncToGenerator,n=t.regeneratorRuntime},function(t){r=t.cclegacy},function(t){i=t.EventType},function(t){s=t.GameData},function(t){o=t.default},function(t){u=t.default},function(t){c=t.Utils}],execute:function(){r._RF.push({},"aeccfJkoC9MFIXnduBbi6ro","DailyMgr",void 0);t("DailyMgr",function(){function t(){this.testLv=0}var r=t.prototype;return r.init=function(){var t=a(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u.I.on(i.RESET_DAY,this.resetDay,this),this.resetDay();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.resetDay=function(){var t=this.today.split("/"),e=+t[0],a=+t[1];s.data.dailyLastYm!=e+"/"+a&&(s.data.dailyLastYm=e+"/"+a,s.data.dailyCompleteDays=[],s.save())},r.add=function(t){return t<10?"0"+t:""+t},r.getDays=function(t,e){return e=parseInt(e,10),isNaN(e)||isNaN(t)?(console.warn("[DailyMgr] getDays invalid input: "+t+", "+e),30):new Date(t,e,0).getDate()},r.getWeeks=function(t){var e=t.split("/"),a=new Date(+e[0],+e[1]-1,+e[2]).getDay();return isNaN(a)&&(console.error("[DailyMgr] Invalid date:",t),a=1),0==a&&(a=7),a-1},e(t,[{key:"level",get:function(){if(this.testLv)return this.testLv;var t=(+new Date(this.today)-+new Date("2025/08/07"))/864e5+1;return t=Math.abs(t),this.testLv=t||1,this.testLv}},{key:"today",get:function(){var t=c.getServerTime();t&&!isNaN(t)||(t=Math.floor(Date.now()/1e3));var e=new Date(1e3*t);isNaN(e.getTime())&&(e=new Date);var a=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return a+"/"+this.add(n)+"/"+this.add(r)}},{key:"day",get:function(){var t=c.getServerTime();return t&&!isNaN(t)||(t=Math.floor(Date.now()/1e3)),new Date(1e3*t).getDate()}}],[{key:"I",get:function(){return o.getInstance(t)}}]),t}());r._RF.pop()}}}));

System.register("chunks:///_virtual/DailyPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./EventManager.ts","./ListView.ts","./ListViewAdapter.ts","./DailyItem.ts","./DailyMgr.ts","./GameData.ts","./BoardDataMgr.ts","./Utils.ts","./MaskView.ts","./Tips.ts","./SdkTools.ts","./TDataMgr.ts","./I18nManager.ts","./I18nImageText.ts"],(function(t){var e,i,n,a,r,o,l,s,u,c,d,p,f,h,g,y,m,v,b,w,I,x,_,S,D,T,M,L,N,k,B,z,C,P,A;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose,o=t.asyncToGenerator,l=t.regeneratorRuntime},function(t){s=t.cclegacy,u=t.Label,c=t.Node,d=t.sp,p=t._decorator,f=t.view,h=t.UITransform,g=t.Color,y=t.v3,m=t.Sprite,v=t.Vec3,b=t.tween},function(t){w=t.EventType,I=t.GameType},function(t){x=t.default},function(t){_=t.default},function(t){S=t.default},function(t){D=t.DailyItem},function(t){T=t.DailyMgr},function(t){M=t.GameData},function(t){L=t.BoardDataMgr},function(t){N=t.Utils},function(t){k=t.MaskView},function(t){B=t.default},function(t){z=t.SdkTools},function(t){C=t.TDataMgr},function(t){P=t.I18n},function(t){A=t.I18nImageText}],execute:function(){var W,V,H,R,E,G,U,F,K,Y,O,j,J,Q,Z,q,X,$,tt,et,it;s._RF.push({},"0fd545CAl5JWaZnrHaf56DQ","DailyPanel",void 0);var nt=p,at=nt.ccclass,rt=nt.property;t("default",(W=at("home/DailyPanel"),V=rt(_),H=rt(u),R=rt(u),E=rt(c),G=rt(d.Skeleton),U=rt(c),F=rt(c),K=rt(c),Y=rt(c),W((J=e((j=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,n(e,"list",J,a(e)),n(e,"txtYM",Q,a(e)),n(e,"txtBadge",Z,a(e)),n(e,"spBg",q,a(e)),n(e,"sp",X,a(e)),n(e,"videoIcon",$,a(e)),n(e,"animStarNode",tt,a(e)),n(e,"btnStart",et,a(e)),n(e,"rlNode",it,a(e)),e.isHome=!1,e.isWin=!1,e.dataSet=[],e.week=void 0,e.i18nLabelMap=new Map,e}i(e,t);var s=e.prototype;return s.onLoad=function(){var t=this,e=f.getVisibleSize().height/f.getVisibleSize().width>1.833,i=e?1:.9;this.rlNode.setScale(i,i,i),this.rlNode.setPosition(0,e?0:50,0),this.btnStart.setPosition(0,e?-558:-430,0),P.on((function(){t.initI18nLabels(),t.initI18nImageTexts(),t.refreshDynamicTexts()}),this)},s.onEnable=function(){this.initI18nLabels(),this.initI18nImageTexts(),this.adaptBg2()},s.adaptBg2=function(){var t=this.node.getChildByName("bg2");if(t){var e=t.getComponent(h);if(e){var i=f.getVisibleSize(),n=e.width,a=e.height,r=i.width/n,o=i.height/a,l=Math.max(r,o),s=n*l,u=a*l;e.setContentSize(s,u),console.log("[DailyPanel] bg2 adapted: "+n+"x"+a+" -> "+s.toFixed(0)+"x"+u.toFixed(0))}}},s.initI18nLabels=function(){for(var t,e={"日":"daily.sun","一":"daily.mon","二":"daily.tue","三":"daily.wed","四":"daily.thu","五":"daily.fri","六":"daily.sat"},i=this.node.getComponentsInChildren(u),n=r(i);!(t=n()).done;){var a=t.value;if(this.i18nLabelMap.has(a)){var o=this.i18nLabelMap.get(a);a.string=P.t(o),o.startsWith("daily.")&&"daily.year_month"!==o&&"daily.total_earned"!==o&&"daily.start_challenge"!==o&&(a.overflow=u.Overflow.SHRINK,a.enableWrapText=!1)}else{var l=e[a.string];l&&(this.i18nLabelMap.set(a,l),a.string=P.t(l),a.overflow=u.Overflow.SHRINK,a.enableWrapText=!1)}}},s.initI18nImageTexts=function(){var t=[{nodeName:"word_6",i18nKey:"daily.start_challenge",outlineColor:new g(50,100,50,255),outlineWidth:3},{nodeName:"mryg_title_bg",i18nKey:"daily.title",outlineColor:new g(50,80,120,255),fontSize:40,offset:y(0,5,0)}];A.replaceImageTexts(this.node,t)},s.refreshDynamicTexts=function(){if(this.txtYM&&this.txtBadge){var t=T.I.today.split("/"),e=+t[0],i=+t[1];this.txtYM.string=P.t("daily.year_month",e,i),this.txtBadge.string=P.t("daily.total_earned",M.data.daily_badge_count)}},s.init=function(){var t=o(l().mark((function t(e){var i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:void 0===e&&(e=!1),i=T.I.today,this.isWin=e,this.updateUI(i),this.videoIcon.active=M.data.dailyLevelDie,this.animStarNode.active=!1,this.btnStart.getComponent(m).grayscale=this.btnStart.children[0].children[1].getComponent(m).grayscale=M.data.daily_is_complete,e&&this.animStar(),M.data.dailyLevelDie&&C.ins.dot("video_exposure",{view_reason:"daily_level_start"}),M.data.goDailyTime=PUCHI_SDK.Time.currentTime;case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),s.animStar=function(){var t=o(l().mark((function t(){var e,i,n,a,r,o,s,u=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return k.show(),t.next=3,N.wait(100);case 3:e=T.I.today.split("/"),i=+e[0],n=+e[1],a=+e[2],r=T.I.getWeeks(i+"/"+n+"/01"),o=this.list.getItems()[r-1+a],s=o.worldPosition,this.animStarNode.setPosition(new v(0,300,0)),this.animStarNode.active=!0,this.animStarNode.setScale(1,1,1),b(this.animStarNode).to(.2,{scale:y(3,3,3)}).to(.1,{angle:-10}).to(.2,{angle:20}).to(.1,{angle:0}).to(.3,{scale:y(1,1,1),worldPosition:new v(s.x,s.y,0)}).call((function(){u.animStarNode.active=!1,o.getComponent(D).showStar();var t=u.spBg.active;u.spBg.active=!1,u.sp.node.active=!0,u.sp.setCompleteListener((function(){u.sp.setCompleteListener(null),u.sp.setAnimation(0,"idle3",!0),u.txtBadge.string=P.t("daily.total_earned",M.data.daily_badge_count),k.hide()})),u.sp.setAnimation(0,t?"enter":"idle2",!1)})).start();case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.updateUI=function(){var t=o(l().mark((function t(e){var i,n,a,r,o,s,u;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.split("/"),n=+i[0],a=+i[1],r=T.I.getDays(n,a),o=T.I.getWeeks(n+"/"+a+"/01"),this.week=o,this.txtYM.string=P.t("daily.year_month",n,a),s=this.isWin?M.data.daily_badge_count-1:M.data.daily_badge_count,this.txtBadge.string=P.t("daily.total_earned",s),this.spBg.active=s<=0,this.sp.node.active=s>0,s>0&&this.sp.setAnimation(0,"idle3",!0),u=r+o,(isNaN(u)||u<0)&&(console.error("[DailyPanel] Invalid array length: len="+r+", week="+o+", fixing to defualt."),u=35),this.dataSet=new Array(u).fill(0),this.list.setAdapter(this);case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),s.updateView=function(t,e,i){t.getComponent(D).refresh(i,e,this.week,this.isWin)},s.onStart=function(){var t=o(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!M.data.daily_is_complete){t.next=3;break}return B.show(P.t("tips.daily_complete")),t.abrupt("return");case 3:if(!M.data.dailyLevelDie){t.next=10;break}return 0!==M.data.dailyData.map.length&&L.I.resetDailyLevelData(),t.next=7,z.share("daily_level_start");case 7:return 0==t.sent.code&&x.I.emit(w.START_GAME,I.daily,!0),t.abrupt("return");case 10:x.I.emit(w.START_GAME,I.daily);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e}(S)).prototype,"list",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(j.prototype,"txtYM",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(j.prototype,"txtBadge",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(j.prototype,"spBg",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(j.prototype,"sp",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=e(j.prototype,"videoIcon",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=e(j.prototype,"animStarNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=e(j.prototype,"btnStart",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=e(j.prototype,"rlNode",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=j))||O));s._RF.pop()}}}));

System.register("chunks:///_virtual/DataAccess.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,a,n,r;return{setters:[function(t){e=t.createClass,i=t.inheritsLoose},function(t){a=t.cclegacy,n=t.resources,r=t.BufferAsset}],execute:function(){a._RF.push({},"921e5SvsgJOhYLwG1f6TjXG","DataAccess",void 0);var s=t("DataAccess",function(){function t(){}return t.initial=function(t,e,i){this.dataDir=t,this.generator=i,this.loader=e},t.getDataItem=function(t){var e=t.__type_name__;return this._items[e]?this._items[e]:this._items[e]=new o(t)},t.getDataTable=function(t,e){void 0===e&&(e="ID");var i=t.__type_name__;return this._tables[i]?this._tables[i]:this._tables[i]=new u(t,e)},t}());s.useProtoMemberTagAsHashtableKey=!1,s.cacheHashValue=!0,s.dataExt=".bin",s.dataDir=void 0,s.generator=void 0,s.loader=void 0,s._items={},s._tables={};var o=t("DataItem",function(){function t(t){this.localGenerator=void 0,this.localLoader=void 0,this.dataType=void 0,this.source=void 0,this._item=void 0,this.dataType=t}var i=t.prototype;return i.onGenerateFilename=function(t){return null!=this.localGenerator?this.localGenerator(t):null!=s.generator?s.generator(t):(t=t.replace("_ARRAY",""),s.dataDir+t.toLocaleLowerCase())},i.onLoadData=function(t){if(null!=this.source)return new Uint8Array(this.source.buffer());var e=this.onGenerateFilename(t);return null!=this.localLoader?this.localLoader(e):null!=s.loader?s.loader(e):(this.source=n.get(e,r),this.source?new Uint8Array(this.source.buffer()):null)},i.setSource=function(t){this.source=t},i.initial=function(t,e,i){this.dataType=t,this.localLoader=e,this.localGenerator=i},t.create=function(e,i){var a=new t(e);return a.setSource(i),a},i.clear=function(){null!=this.source&&(this.source.destroy(),this.source=null)},i.load=function(){var t=this.onLoadData(this.dataType.__array_type_name__);return this.dataType.__array_type__.decode(t)},e(t,[{key:"data",get:function(){return null==this._item&&(this._item=this.load()),this._item}}]),t}()),u=t("DataTable",function(t){function a(e,i){var a;return void 0===i&&(i="ID"),(a=t.call(this,e)||this)._keyName="ID",a._itemMap=void 0,a._items=void 0,a._ids=void 0,a._keyName=i,a}i(a,t);var n=a.prototype;return n.load=function(){var t=this.dataType.__array_type_name__,e=this.onLoadData(t);return this.dataType.getArrayType().decode(e).Items},a.create=function(t,e,i){void 0===i&&(i="ID");var n=new a(t,i);return n.setSource(e),n},n.getItem=function(t){return this.itemMap[t]},n.initDataAsDict=function(){var t=this,e={};try{return this.items.forEach((function(i){e[i[t.keyName]]=i})),e}catch(t){return console.error("can not get data map by key "+this.keyName),e}},n.initDataAsList=function(){return this.load()},n.contains=function(t){return null!=this.itemMap[t]},n.clear=function(){t.prototype.clear.call(this),this._itemMap=null,this._items=null},e(a,[{key:"keyName",get:function(){return this._keyName}},{key:"itemMap",get:function(){return null==this._itemMap&&(this._itemMap=this.initDataAsDict()),this._itemMap}},{key:"items",get:function(){try{null==this._items&&(this._items=this.initDataAsList())}catch(t){console.log("config data load error: "+t)}return this._items}},{key:"IDs",get:function(){var t=this;return null==this._ids&&(this._ids=this.items.map((function(e,i,a){a.push(e[t.keyName])}),[])),this._ids}}]),a}(o));a._RF.pop()}}}));

System.register("chunks:///_virtual/DataModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.mjs_cjs=&original=.js","./index.js"],(function(e){var t,r,n;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy},null,function(e){n=e.default}],execute:function(){e("GameConfig",void 0),r._RF.push({},"f4584Ai+MlOVZSmzSCRLcmk","DataModel",void 0);var l=n.Reader,a=n.Writer,i=n.util,o=(n.roots.default||(n.roots.default={}),e("DataConverter",function(){function e(){}return e.getConvertData=function(t,r,n,l,a){if(t._converted=t._converted||{},t._converted[r])return t._converted[r];if(null==e.convertHandler)throw"convert field "+r+" value need a convetor";var i=e.convertHandler(t,r,n,l);return a&&(t._converted[r]=i),i},e}()));o.convertHandler=void 0;var u,s=e("DataModel",function(){function e(){this._converted={}}return e.prototype.getConvertData=function(e,t,r,n){if(this._converted[e])return this._converted[e];if(null==o.convertHandler)throw"convert field "+e+" value need a convetor";var l=o.convertHandler(this,e,t,r);return n&&(this._converted[e]=l),l},e}());!function(e){var r={},o=function(e){function o(t){var r;if((r=e.call(this)||this).ID=0,r.USER_DEFAULT_GOLD=0,r.USER_DEFAULT_ENERGY=0,r.ENERGY_MAX=0,r.ENERGY_RECOVER_CD=0,r.AD_ENERGY_RECOVER=0,r.USER_DEFAULT_PROP_MERGE=0,r.USER_DEFAULT_PROP_BACK=0,r.USER_DEFAULT_PROP_SHUFFLE=0,r.USER_DEFAULT_PROP_FORWARD=0,r.MIX_DIMENSION=0,r.DIFF_LEVEL_REMAIN=i.emptyArray,r.GUIDE_DECK_LIST=i.emptyArray,r.AD_REVIVE_ADD_TIME=0,r.LEVEL_SUCCESS_MULTIPE=0,r.ORIGIN_SKIN_ID=0,r.ORIGIN_CUBE_ID=0,r.TIME_PROP_ADD=0,r.DICE_AD_LEVEL=0,r.COLLECT_LEVEL=0,r.COLLECTION_ITEM_CHANCE=0,r.COLLECTION_ITEM_NUM=i.emptyArray,r.DIFF_LEVEL_REMAIN=[],r.GUIDE_DECK_LIST=[],r.COLLECTION_ITEM_NUM=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(o,e),o.getArrayType=function(){return r[o.__array_type_name__]},o.create=function(e){return new o(e)},o.encode=function(e,t){if(t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.USER_DEFAULT_GOLD&&Object.hasOwnProperty.call(e,"USER_DEFAULT_GOLD")&&t.uint32(16).uint32(e.USER_DEFAULT_GOLD),null!=e.USER_DEFAULT_ENERGY&&Object.hasOwnProperty.call(e,"USER_DEFAULT_ENERGY")&&t.uint32(24).uint32(e.USER_DEFAULT_ENERGY),null!=e.ENERGY_MAX&&Object.hasOwnProperty.call(e,"ENERGY_MAX")&&t.uint32(32).uint32(e.ENERGY_MAX),null!=e.ENERGY_RECOVER_CD&&Object.hasOwnProperty.call(e,"ENERGY_RECOVER_CD")&&t.uint32(40).uint32(e.ENERGY_RECOVER_CD),null!=e.AD_ENERGY_RECOVER&&Object.hasOwnProperty.call(e,"AD_ENERGY_RECOVER")&&t.uint32(48).uint32(e.AD_ENERGY_RECOVER),null!=e.USER_DEFAULT_PROP_MERGE&&Object.hasOwnProperty.call(e,"USER_DEFAULT_PROP_MERGE")&&t.uint32(56).uint32(e.USER_DEFAULT_PROP_MERGE),null!=e.USER_DEFAULT_PROP_BACK&&Object.hasOwnProperty.call(e,"USER_DEFAULT_PROP_BACK")&&t.uint32(64).uint32(e.USER_DEFAULT_PROP_BACK),null!=e.USER_DEFAULT_PROP_SHUFFLE&&Object.hasOwnProperty.call(e,"USER_DEFAULT_PROP_SHUFFLE")&&t.uint32(72).uint32(e.USER_DEFAULT_PROP_SHUFFLE),null!=e.USER_DEFAULT_PROP_FORWARD&&Object.hasOwnProperty.call(e,"USER_DEFAULT_PROP_FORWARD")&&t.uint32(80).uint32(e.USER_DEFAULT_PROP_FORWARD),null!=e.MIX_DIMENSION&&Object.hasOwnProperty.call(e,"MIX_DIMENSION")&&t.uint32(88).uint32(e.MIX_DIMENSION),null!=e.DIFF_LEVEL_REMAIN&&e.DIFF_LEVEL_REMAIN.length){t.uint32(98).fork();for(var r=0;r<e.DIFF_LEVEL_REMAIN.length;++r)t.uint32(e.DIFF_LEVEL_REMAIN[r]);t.ldelim()}if(null!=e.GUIDE_DECK_LIST&&e.GUIDE_DECK_LIST.length)for(r=0;r<e.GUIDE_DECK_LIST.length;++r)t.uint32(106).string(e.GUIDE_DECK_LIST[r]);if(null!=e.AD_REVIVE_ADD_TIME&&Object.hasOwnProperty.call(e,"AD_REVIVE_ADD_TIME")&&t.uint32(112).uint32(e.AD_REVIVE_ADD_TIME),null!=e.LEVEL_SUCCESS_MULTIPE&&Object.hasOwnProperty.call(e,"LEVEL_SUCCESS_MULTIPE")&&t.uint32(120).uint32(e.LEVEL_SUCCESS_MULTIPE),null!=e.ORIGIN_SKIN_ID&&Object.hasOwnProperty.call(e,"ORIGIN_SKIN_ID")&&t.uint32(128).uint32(e.ORIGIN_SKIN_ID),null!=e.ORIGIN_CUBE_ID&&Object.hasOwnProperty.call(e,"ORIGIN_CUBE_ID")&&t.uint32(136).uint32(e.ORIGIN_CUBE_ID),null!=e.TIME_PROP_ADD&&Object.hasOwnProperty.call(e,"TIME_PROP_ADD")&&t.uint32(144).uint32(e.TIME_PROP_ADD),null!=e.DICE_AD_LEVEL&&Object.hasOwnProperty.call(e,"DICE_AD_LEVEL")&&t.uint32(152).uint32(e.DICE_AD_LEVEL),null!=e.COLLECT_LEVEL&&Object.hasOwnProperty.call(e,"COLLECT_LEVEL")&&t.uint32(160).uint32(e.COLLECT_LEVEL),null!=e.COLLECTION_ITEM_CHANCE&&Object.hasOwnProperty.call(e,"COLLECTION_ITEM_CHANCE")&&t.uint32(168).uint32(e.COLLECTION_ITEM_CHANCE),null!=e.COLLECTION_ITEM_NUM&&e.COLLECTION_ITEM_NUM.length){t.uint32(178).fork();for(r=0;r<e.COLLECTION_ITEM_NUM.length;++r)t.uint32(e.COLLECTION_ITEM_NUM[r]);t.ldelim()}return t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new o;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:n.USER_DEFAULT_GOLD=e.uint32();break;case 3:n.USER_DEFAULT_ENERGY=e.uint32();break;case 4:n.ENERGY_MAX=e.uint32();break;case 5:n.ENERGY_RECOVER_CD=e.uint32();break;case 6:n.AD_ENERGY_RECOVER=e.uint32();break;case 7:n.USER_DEFAULT_PROP_MERGE=e.uint32();break;case 8:n.USER_DEFAULT_PROP_BACK=e.uint32();break;case 9:n.USER_DEFAULT_PROP_SHUFFLE=e.uint32();break;case 10:n.USER_DEFAULT_PROP_FORWARD=e.uint32();break;case 11:n.MIX_DIMENSION=e.uint32();break;case 12:if(n.DIFF_LEVEL_REMAIN&&n.DIFF_LEVEL_REMAIN.length||(n.DIFF_LEVEL_REMAIN=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.DIFF_LEVEL_REMAIN.push(e.uint32());else n.DIFF_LEVEL_REMAIN.push(e.uint32());break;case 13:n.GUIDE_DECK_LIST&&n.GUIDE_DECK_LIST.length||(n.GUIDE_DECK_LIST=[]),n.GUIDE_DECK_LIST.push(e.string());break;case 14:n.AD_REVIVE_ADD_TIME=e.uint32();break;case 15:n.LEVEL_SUCCESS_MULTIPE=e.uint32();break;case 16:n.ORIGIN_SKIN_ID=e.uint32();break;case 17:n.ORIGIN_CUBE_ID=e.uint32();break;case 18:n.TIME_PROP_ADD=e.uint32();break;case 19:n.DICE_AD_LEVEL=e.uint32();break;case 20:n.COLLECT_LEVEL=e.uint32();break;case 21:n.COLLECTION_ITEM_CHANCE=e.uint32();break;case 22:if(n.COLLECTION_ITEM_NUM&&n.COLLECTION_ITEM_NUM.length||(n.COLLECTION_ITEM_NUM=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.COLLECTION_ITEM_NUM.push(e.uint32());else n.COLLECTION_ITEM_NUM.push(e.uint32());break;default:e.skipType(7&a)}}return n},o.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},o.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID))return"ID: integer expected";if(null!=e.USER_DEFAULT_GOLD&&e.hasOwnProperty("USER_DEFAULT_GOLD")&&!i.isInteger(e.USER_DEFAULT_GOLD))return"USER_DEFAULT_GOLD: integer expected";if(null!=e.USER_DEFAULT_ENERGY&&e.hasOwnProperty("USER_DEFAULT_ENERGY")&&!i.isInteger(e.USER_DEFAULT_ENERGY))return"USER_DEFAULT_ENERGY: integer expected";if(null!=e.ENERGY_MAX&&e.hasOwnProperty("ENERGY_MAX")&&!i.isInteger(e.ENERGY_MAX))return"ENERGY_MAX: integer expected";if(null!=e.ENERGY_RECOVER_CD&&e.hasOwnProperty("ENERGY_RECOVER_CD")&&!i.isInteger(e.ENERGY_RECOVER_CD))return"ENERGY_RECOVER_CD: integer expected";if(null!=e.AD_ENERGY_RECOVER&&e.hasOwnProperty("AD_ENERGY_RECOVER")&&!i.isInteger(e.AD_ENERGY_RECOVER))return"AD_ENERGY_RECOVER: integer expected";if(null!=e.USER_DEFAULT_PROP_MERGE&&e.hasOwnProperty("USER_DEFAULT_PROP_MERGE")&&!i.isInteger(e.USER_DEFAULT_PROP_MERGE))return"USER_DEFAULT_PROP_MERGE: integer expected";if(null!=e.USER_DEFAULT_PROP_BACK&&e.hasOwnProperty("USER_DEFAULT_PROP_BACK")&&!i.isInteger(e.USER_DEFAULT_PROP_BACK))return"USER_DEFAULT_PROP_BACK: integer expected";if(null!=e.USER_DEFAULT_PROP_SHUFFLE&&e.hasOwnProperty("USER_DEFAULT_PROP_SHUFFLE")&&!i.isInteger(e.USER_DEFAULT_PROP_SHUFFLE))return"USER_DEFAULT_PROP_SHUFFLE: integer expected";if(null!=e.USER_DEFAULT_PROP_FORWARD&&e.hasOwnProperty("USER_DEFAULT_PROP_FORWARD")&&!i.isInteger(e.USER_DEFAULT_PROP_FORWARD))return"USER_DEFAULT_PROP_FORWARD: integer expected";if(null!=e.MIX_DIMENSION&&e.hasOwnProperty("MIX_DIMENSION")&&!i.isInteger(e.MIX_DIMENSION))return"MIX_DIMENSION: integer expected";if(null!=e.DIFF_LEVEL_REMAIN&&e.hasOwnProperty("DIFF_LEVEL_REMAIN")){if(!Array.isArray(e.DIFF_LEVEL_REMAIN))return"DIFF_LEVEL_REMAIN: array expected";for(var t=0;t<e.DIFF_LEVEL_REMAIN.length;++t)if(!i.isInteger(e.DIFF_LEVEL_REMAIN[t]))return"DIFF_LEVEL_REMAIN: integer[] expected"}if(null!=e.GUIDE_DECK_LIST&&e.hasOwnProperty("GUIDE_DECK_LIST")){if(!Array.isArray(e.GUIDE_DECK_LIST))return"GUIDE_DECK_LIST: array expected";for(t=0;t<e.GUIDE_DECK_LIST.length;++t)if(!i.isString(e.GUIDE_DECK_LIST[t]))return"GUIDE_DECK_LIST: string[] expected"}if(null!=e.AD_REVIVE_ADD_TIME&&e.hasOwnProperty("AD_REVIVE_ADD_TIME")&&!i.isInteger(e.AD_REVIVE_ADD_TIME))return"AD_REVIVE_ADD_TIME: integer expected";if(null!=e.LEVEL_SUCCESS_MULTIPE&&e.hasOwnProperty("LEVEL_SUCCESS_MULTIPE")&&!i.isInteger(e.LEVEL_SUCCESS_MULTIPE))return"LEVEL_SUCCESS_MULTIPE: integer expected";if(null!=e.ORIGIN_SKIN_ID&&e.hasOwnProperty("ORIGIN_SKIN_ID")&&!i.isInteger(e.ORIGIN_SKIN_ID))return"ORIGIN_SKIN_ID: integer expected";if(null!=e.ORIGIN_CUBE_ID&&e.hasOwnProperty("ORIGIN_CUBE_ID")&&!i.isInteger(e.ORIGIN_CUBE_ID))return"ORIGIN_CUBE_ID: integer expected";if(null!=e.TIME_PROP_ADD&&e.hasOwnProperty("TIME_PROP_ADD")&&!i.isInteger(e.TIME_PROP_ADD))return"TIME_PROP_ADD: integer expected";if(null!=e.DICE_AD_LEVEL&&e.hasOwnProperty("DICE_AD_LEVEL")&&!i.isInteger(e.DICE_AD_LEVEL))return"DICE_AD_LEVEL: integer expected";if(null!=e.COLLECT_LEVEL&&e.hasOwnProperty("COLLECT_LEVEL")&&!i.isInteger(e.COLLECT_LEVEL))return"COLLECT_LEVEL: integer expected";if(null!=e.COLLECTION_ITEM_CHANCE&&e.hasOwnProperty("COLLECTION_ITEM_CHANCE")&&!i.isInteger(e.COLLECTION_ITEM_CHANCE))return"COLLECTION_ITEM_CHANCE: integer expected";if(null!=e.COLLECTION_ITEM_NUM&&e.hasOwnProperty("COLLECTION_ITEM_NUM")){if(!Array.isArray(e.COLLECTION_ITEM_NUM))return"COLLECTION_ITEM_NUM: array expected";for(t=0;t<e.COLLECTION_ITEM_NUM.length;++t)if(!i.isInteger(e.COLLECTION_ITEM_NUM[t]))return"COLLECTION_ITEM_NUM: integer[] expected"}return null},o.fromObject=function(e){if(e instanceof o)return e;var t=new o;if(null!=e.ID&&(t.ID=e.ID>>>0),null!=e.USER_DEFAULT_GOLD&&(t.USER_DEFAULT_GOLD=e.USER_DEFAULT_GOLD>>>0),null!=e.USER_DEFAULT_ENERGY&&(t.USER_DEFAULT_ENERGY=e.USER_DEFAULT_ENERGY>>>0),null!=e.ENERGY_MAX&&(t.ENERGY_MAX=e.ENERGY_MAX>>>0),null!=e.ENERGY_RECOVER_CD&&(t.ENERGY_RECOVER_CD=e.ENERGY_RECOVER_CD>>>0),null!=e.AD_ENERGY_RECOVER&&(t.AD_ENERGY_RECOVER=e.AD_ENERGY_RECOVER>>>0),null!=e.USER_DEFAULT_PROP_MERGE&&(t.USER_DEFAULT_PROP_MERGE=e.USER_DEFAULT_PROP_MERGE>>>0),null!=e.USER_DEFAULT_PROP_BACK&&(t.USER_DEFAULT_PROP_BACK=e.USER_DEFAULT_PROP_BACK>>>0),null!=e.USER_DEFAULT_PROP_SHUFFLE&&(t.USER_DEFAULT_PROP_SHUFFLE=e.USER_DEFAULT_PROP_SHUFFLE>>>0),null!=e.USER_DEFAULT_PROP_FORWARD&&(t.USER_DEFAULT_PROP_FORWARD=e.USER_DEFAULT_PROP_FORWARD>>>0),null!=e.MIX_DIMENSION&&(t.MIX_DIMENSION=e.MIX_DIMENSION>>>0),e.DIFF_LEVEL_REMAIN){if(!Array.isArray(e.DIFF_LEVEL_REMAIN))throw TypeError("SettingsCfg.DIFF_LEVEL_REMAIN: array expected");t.DIFF_LEVEL_REMAIN=[];for(var r=0;r<e.DIFF_LEVEL_REMAIN.length;++r)t.DIFF_LEVEL_REMAIN[r]=e.DIFF_LEVEL_REMAIN[r]>>>0}if(e.GUIDE_DECK_LIST){if(!Array.isArray(e.GUIDE_DECK_LIST))throw TypeError("SettingsCfg.GUIDE_DECK_LIST: array expected");t.GUIDE_DECK_LIST=[];for(r=0;r<e.GUIDE_DECK_LIST.length;++r)t.GUIDE_DECK_LIST[r]=String(e.GUIDE_DECK_LIST[r])}if(null!=e.AD_REVIVE_ADD_TIME&&(t.AD_REVIVE_ADD_TIME=e.AD_REVIVE_ADD_TIME>>>0),null!=e.LEVEL_SUCCESS_MULTIPE&&(t.LEVEL_SUCCESS_MULTIPE=e.LEVEL_SUCCESS_MULTIPE>>>0),null!=e.ORIGIN_SKIN_ID&&(t.ORIGIN_SKIN_ID=e.ORIGIN_SKIN_ID>>>0),null!=e.ORIGIN_CUBE_ID&&(t.ORIGIN_CUBE_ID=e.ORIGIN_CUBE_ID>>>0),null!=e.TIME_PROP_ADD&&(t.TIME_PROP_ADD=e.TIME_PROP_ADD>>>0),null!=e.DICE_AD_LEVEL&&(t.DICE_AD_LEVEL=e.DICE_AD_LEVEL>>>0),null!=e.COLLECT_LEVEL&&(t.COLLECT_LEVEL=e.COLLECT_LEVEL>>>0),null!=e.COLLECTION_ITEM_CHANCE&&(t.COLLECTION_ITEM_CHANCE=e.COLLECTION_ITEM_CHANCE>>>0),e.COLLECTION_ITEM_NUM){if(!Array.isArray(e.COLLECTION_ITEM_NUM))throw TypeError("SettingsCfg.COLLECTION_ITEM_NUM: array expected");t.COLLECTION_ITEM_NUM=[];for(r=0;r<e.COLLECTION_ITEM_NUM.length;++r)t.COLLECTION_ITEM_NUM[r]=e.COLLECTION_ITEM_NUM[r]>>>0}return t},o.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.DIFF_LEVEL_REMAIN=[],r.GUIDE_DECK_LIST=[],r.COLLECTION_ITEM_NUM=[]),t.defaults&&(r.ID=0,r.USER_DEFAULT_GOLD=0,r.USER_DEFAULT_ENERGY=0,r.ENERGY_MAX=0,r.ENERGY_RECOVER_CD=0,r.AD_ENERGY_RECOVER=0,r.USER_DEFAULT_PROP_MERGE=0,r.USER_DEFAULT_PROP_BACK=0,r.USER_DEFAULT_PROP_SHUFFLE=0,r.USER_DEFAULT_PROP_FORWARD=0,r.MIX_DIMENSION=0,r.DIFF_LEVEL_REMAIN=null,r.GUIDE_DECK_LIST=null,r.AD_REVIVE_ADD_TIME=0,r.LEVEL_SUCCESS_MULTIPE=0,r.ORIGIN_SKIN_ID=0,r.ORIGIN_CUBE_ID=0,r.TIME_PROP_ADD=0,r.DICE_AD_LEVEL=0,r.COLLECT_LEVEL=0,r.COLLECTION_ITEM_CHANCE=0,r.COLLECTION_ITEM_NUM=null),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),null!=e.USER_DEFAULT_GOLD&&e.hasOwnProperty("USER_DEFAULT_GOLD")&&(r.USER_DEFAULT_GOLD=e.USER_DEFAULT_GOLD),null!=e.USER_DEFAULT_ENERGY&&e.hasOwnProperty("USER_DEFAULT_ENERGY")&&(r.USER_DEFAULT_ENERGY=e.USER_DEFAULT_ENERGY),null!=e.ENERGY_MAX&&e.hasOwnProperty("ENERGY_MAX")&&(r.ENERGY_MAX=e.ENERGY_MAX),null!=e.ENERGY_RECOVER_CD&&e.hasOwnProperty("ENERGY_RECOVER_CD")&&(r.ENERGY_RECOVER_CD=e.ENERGY_RECOVER_CD),null!=e.AD_ENERGY_RECOVER&&e.hasOwnProperty("AD_ENERGY_RECOVER")&&(r.AD_ENERGY_RECOVER=e.AD_ENERGY_RECOVER),null!=e.USER_DEFAULT_PROP_MERGE&&e.hasOwnProperty("USER_DEFAULT_PROP_MERGE")&&(r.USER_DEFAULT_PROP_MERGE=e.USER_DEFAULT_PROP_MERGE),null!=e.USER_DEFAULT_PROP_BACK&&e.hasOwnProperty("USER_DEFAULT_PROP_BACK")&&(r.USER_DEFAULT_PROP_BACK=e.USER_DEFAULT_PROP_BACK),null!=e.USER_DEFAULT_PROP_SHUFFLE&&e.hasOwnProperty("USER_DEFAULT_PROP_SHUFFLE")&&(r.USER_DEFAULT_PROP_SHUFFLE=e.USER_DEFAULT_PROP_SHUFFLE),null!=e.USER_DEFAULT_PROP_FORWARD&&e.hasOwnProperty("USER_DEFAULT_PROP_FORWARD")&&(r.USER_DEFAULT_PROP_FORWARD=e.USER_DEFAULT_PROP_FORWARD),null!=e.MIX_DIMENSION&&e.hasOwnProperty("MIX_DIMENSION")&&(r.MIX_DIMENSION=e.MIX_DIMENSION),e.DIFF_LEVEL_REMAIN&&e.DIFF_LEVEL_REMAIN.length){r.DIFF_LEVEL_REMAIN=[];for(var n=0;n<e.DIFF_LEVEL_REMAIN.length;++n)r.DIFF_LEVEL_REMAIN[n]=e.DIFF_LEVEL_REMAIN[n]}if(e.GUIDE_DECK_LIST&&e.GUIDE_DECK_LIST.length){r.GUIDE_DECK_LIST=[];for(n=0;n<e.GUIDE_DECK_LIST.length;++n)r.GUIDE_DECK_LIST[n]=e.GUIDE_DECK_LIST[n]}if(null!=e.AD_REVIVE_ADD_TIME&&e.hasOwnProperty("AD_REVIVE_ADD_TIME")&&(r.AD_REVIVE_ADD_TIME=e.AD_REVIVE_ADD_TIME),null!=e.LEVEL_SUCCESS_MULTIPE&&e.hasOwnProperty("LEVEL_SUCCESS_MULTIPE")&&(r.LEVEL_SUCCESS_MULTIPE=e.LEVEL_SUCCESS_MULTIPE),null!=e.ORIGIN_SKIN_ID&&e.hasOwnProperty("ORIGIN_SKIN_ID")&&(r.ORIGIN_SKIN_ID=e.ORIGIN_SKIN_ID),null!=e.ORIGIN_CUBE_ID&&e.hasOwnProperty("ORIGIN_CUBE_ID")&&(r.ORIGIN_CUBE_ID=e.ORIGIN_CUBE_ID),null!=e.TIME_PROP_ADD&&e.hasOwnProperty("TIME_PROP_ADD")&&(r.TIME_PROP_ADD=e.TIME_PROP_ADD),null!=e.DICE_AD_LEVEL&&e.hasOwnProperty("DICE_AD_LEVEL")&&(r.DICE_AD_LEVEL=e.DICE_AD_LEVEL),null!=e.COLLECT_LEVEL&&e.hasOwnProperty("COLLECT_LEVEL")&&(r.COLLECT_LEVEL=e.COLLECT_LEVEL),null!=e.COLLECTION_ITEM_CHANCE&&e.hasOwnProperty("COLLECTION_ITEM_CHANCE")&&(r.COLLECTION_ITEM_CHANCE=e.COLLECTION_ITEM_CHANCE),e.COLLECTION_ITEM_NUM&&e.COLLECTION_ITEM_NUM.length){r.COLLECTION_ITEM_NUM=[];for(n=0;n<e.COLLECTION_ITEM_NUM.length;++n)r.COLLECTION_ITEM_NUM[n]=e.COLLECTION_ITEM_NUM[n]}return r},o.prototype.toJSON=function(){return o.toObject(this,n.util.toJSONOptions)},o}(s);o.__type_name__="SettingsCfg",o.__array_type_name__="SettingsCfg_ARRAY",e.SettingsCfg=o,r.SettingsCfg=o;var u=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)o.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(o.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=o.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("SettingsCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("SettingsCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=o.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);u.__type_name__="SettingsCfg_ARRAY",e.SettingsCfg_ARRAY=u,r.SettingsCfg_ARRAY=u;var c=function(e){t(u,e),u.getArrayType=function(){return r[u.__array_type_name__]};var o=u.prototype;function u(t){var r;if((r=e.call(this)||this).ID=0,r.blocks="",r.weight=i.emptyArray,r.weight=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return o.getBlocks=function(){return this.getConvertData("blocks",this.blocks,"number[][]",!0)},u.create=function(e){return new u(e)},u.encode=function(e,t){if(t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.blocks&&Object.hasOwnProperty.call(e,"blocks")&&t.uint32(18).string(e.blocks),null!=e.weight&&e.weight.length){t.uint32(26).fork();for(var r=0;r<e.weight.length;++r)t.uint32(e.weight[r]);t.ldelim()}return t},u.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},u.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new u;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:n.blocks=e.string();break;case 3:if(n.weight&&n.weight.length||(n.weight=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.weight.push(e.uint32());else n.weight.push(e.uint32());break;default:e.skipType(7&a)}}return n},u.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},u.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID))return"ID: integer expected";if(null!=e.blocks&&e.hasOwnProperty("blocks")&&!i.isString(e.blocks))return"blocks: string expected";if(null!=e.weight&&e.hasOwnProperty("weight")){if(!Array.isArray(e.weight))return"weight: array expected";for(var t=0;t<e.weight.length;++t)if(!i.isInteger(e.weight[t]))return"weight: integer[] expected"}return null},u.fromObject=function(e){if(e instanceof u)return e;var t=new u;if(null!=e.ID&&(t.ID=e.ID>>>0),null!=e.blocks&&(t.blocks=String(e.blocks)),e.weight){if(!Array.isArray(e.weight))throw TypeError("BlockCfg.weight: array expected");t.weight=[];for(var r=0;r<e.weight.length;++r)t.weight[r]=e.weight[r]>>>0}return t},u.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.weight=[]),t.defaults&&(r.ID=0,r.blocks="",r.weight=null),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),null!=e.blocks&&e.hasOwnProperty("blocks")&&(r.blocks=e.blocks),e.weight&&e.weight.length){r.weight=[];for(var n=0;n<e.weight.length;++n)r.weight[n]=e.weight[n]}return r},o.toJSON=function(){return u.toObject(this,n.util.toJSONOptions)},u}(s);c.__type_name__="BlockCfg",c.__array_type_name__="BlockCfg_ARRAY",e.BlockCfg=c,r.BlockCfg=c;var _=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)c.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(c.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=c.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("BlockCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("BlockCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=c.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);_.__type_name__="BlockCfg_ARRAY",e.BlockCfg_ARRAY=_,r.BlockCfg_ARRAY=_;var E=function(e){t(u,e),u.getArrayType=function(){return r[u.__array_type_name__]};var o=u.prototype;function u(t){var r;if((r=e.call(this)||this).ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=i.emptyArray,r.collect="",r.is_hardlevel=0,r.map=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return o.getCollect=function(){return this.getConvertData("collect",this.collect,"CollectData[]",!0)},u.create=function(e){return new u(e)},u.encode=function(e,t){if(t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.score&&Object.hasOwnProperty.call(e,"score")&&t.uint32(16).uint32(e.score),null!=e.hardType&&Object.hasOwnProperty.call(e,"hardType")&&t.uint32(24).uint32(e.hardType),null!=e.hardNum&&Object.hasOwnProperty.call(e,"hardNum")&&t.uint32(32).uint32(e.hardNum),null!=e.map&&e.map.length){t.uint32(42).fork();for(var r=0;r<e.map.length;++r)t.uint32(e.map[r]);t.ldelim()}return null!=e.collect&&Object.hasOwnProperty.call(e,"collect")&&t.uint32(50).string(e.collect),null!=e.is_hardlevel&&Object.hasOwnProperty.call(e,"is_hardlevel")&&t.uint32(56).uint32(e.is_hardlevel),t},u.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},u.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new u;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:n.score=e.uint32();break;case 3:n.hardType=e.uint32();break;case 4:n.hardNum=e.uint32();break;case 5:if(n.map&&n.map.length||(n.map=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.map.push(e.uint32());else n.map.push(e.uint32());break;case 6:n.collect=e.string();break;case 7:n.is_hardlevel=e.uint32();break;default:e.skipType(7&a)}}return n},u.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},u.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID))return"ID: integer expected";if(null!=e.score&&e.hasOwnProperty("score")&&!i.isInteger(e.score))return"score: integer expected";if(null!=e.hardType&&e.hasOwnProperty("hardType")&&!i.isInteger(e.hardType))return"hardType: integer expected";if(null!=e.hardNum&&e.hasOwnProperty("hardNum")&&!i.isInteger(e.hardNum))return"hardNum: integer expected";if(null!=e.map&&e.hasOwnProperty("map")){if(!Array.isArray(e.map))return"map: array expected";for(var t=0;t<e.map.length;++t)if(!i.isInteger(e.map[t]))return"map: integer[] expected"}return null!=e.collect&&e.hasOwnProperty("collect")&&!i.isString(e.collect)?"collect: string expected":null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&!i.isInteger(e.is_hardlevel)?"is_hardlevel: integer expected":null},u.fromObject=function(e){if(e instanceof u)return e;var t=new u;if(null!=e.ID&&(t.ID=e.ID>>>0),null!=e.score&&(t.score=e.score>>>0),null!=e.hardType&&(t.hardType=e.hardType>>>0),null!=e.hardNum&&(t.hardNum=e.hardNum>>>0),e.map){if(!Array.isArray(e.map))throw TypeError("LevelCfg.map: array expected");t.map=[];for(var r=0;r<e.map.length;++r)t.map[r]=e.map[r]>>>0}return null!=e.collect&&(t.collect=String(e.collect)),null!=e.is_hardlevel&&(t.is_hardlevel=e.is_hardlevel>>>0),t},u.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.map=[]),t.defaults&&(r.ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=null,r.collect="",r.is_hardlevel=0),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),null!=e.score&&e.hasOwnProperty("score")&&(r.score=e.score),null!=e.hardType&&e.hasOwnProperty("hardType")&&(r.hardType=e.hardType),null!=e.hardNum&&e.hasOwnProperty("hardNum")&&(r.hardNum=e.hardNum),e.map&&e.map.length){r.map=[];for(var n=0;n<e.map.length;++n)r.map[n]=e.map[n]}return null!=e.collect&&e.hasOwnProperty("collect")&&(r.collect=e.collect),null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&(r.is_hardlevel=e.is_hardlevel),r},o.toJSON=function(){return u.toObject(this,n.util.toJSONOptions)},u}(s);E.__type_name__="LevelCfg",E.__array_type_name__="LevelCfg_ARRAY",e.LevelCfg=E,r.LevelCfg=E;var I=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)E.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(E.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=E.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("LevelCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("LevelCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=E.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);I.__type_name__="LevelCfg_ARRAY",e.LevelCfg_ARRAY=I,r.LevelCfg_ARRAY=I;var p=function(e){t(u,e),u.getArrayType=function(){return r[u.__array_type_name__]};var o=u.prototype;function u(t){var r;if((r=e.call(this)||this).ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=i.emptyArray,r.collect="",r.is_hardlevel=0,r.map=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return o.getCollect=function(){return this.getConvertData("collect",this.collect,"CollectData[]",!0)},u.create=function(e){return new u(e)},u.encode=function(e,t){if(t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.score&&Object.hasOwnProperty.call(e,"score")&&t.uint32(16).uint32(e.score),null!=e.hardType&&Object.hasOwnProperty.call(e,"hardType")&&t.uint32(24).uint32(e.hardType),null!=e.hardNum&&Object.hasOwnProperty.call(e,"hardNum")&&t.uint32(32).uint32(e.hardNum),null!=e.map&&e.map.length){t.uint32(42).fork();for(var r=0;r<e.map.length;++r)t.uint32(e.map[r]);t.ldelim()}return null!=e.collect&&Object.hasOwnProperty.call(e,"collect")&&t.uint32(50).string(e.collect),null!=e.is_hardlevel&&Object.hasOwnProperty.call(e,"is_hardlevel")&&t.uint32(56).uint32(e.is_hardlevel),t},u.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},u.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new u;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:n.score=e.uint32();break;case 3:n.hardType=e.uint32();break;case 4:n.hardNum=e.uint32();break;case 5:if(n.map&&n.map.length||(n.map=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.map.push(e.uint32());else n.map.push(e.uint32());break;case 6:n.collect=e.string();break;case 7:n.is_hardlevel=e.uint32();break;default:e.skipType(7&a)}}return n},u.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},u.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID))return"ID: integer expected";if(null!=e.score&&e.hasOwnProperty("score")&&!i.isInteger(e.score))return"score: integer expected";if(null!=e.hardType&&e.hasOwnProperty("hardType")&&!i.isInteger(e.hardType))return"hardType: integer expected";if(null!=e.hardNum&&e.hasOwnProperty("hardNum")&&!i.isInteger(e.hardNum))return"hardNum: integer expected";if(null!=e.map&&e.hasOwnProperty("map")){if(!Array.isArray(e.map))return"map: array expected";for(var t=0;t<e.map.length;++t)if(!i.isInteger(e.map[t]))return"map: integer[] expected"}return null!=e.collect&&e.hasOwnProperty("collect")&&!i.isString(e.collect)?"collect: string expected":null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&!i.isInteger(e.is_hardlevel)?"is_hardlevel: integer expected":null},u.fromObject=function(e){if(e instanceof u)return e;var t=new u;if(null!=e.ID&&(t.ID=e.ID>>>0),null!=e.score&&(t.score=e.score>>>0),null!=e.hardType&&(t.hardType=e.hardType>>>0),null!=e.hardNum&&(t.hardNum=e.hardNum>>>0),e.map){if(!Array.isArray(e.map))throw TypeError("ActivityLevelCfg.map: array expected");t.map=[];for(var r=0;r<e.map.length;++r)t.map[r]=e.map[r]>>>0}return null!=e.collect&&(t.collect=String(e.collect)),null!=e.is_hardlevel&&(t.is_hardlevel=e.is_hardlevel>>>0),t},u.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.map=[]),t.defaults&&(r.ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=null,r.collect="",r.is_hardlevel=0),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),null!=e.score&&e.hasOwnProperty("score")&&(r.score=e.score),null!=e.hardType&&e.hasOwnProperty("hardType")&&(r.hardType=e.hardType),null!=e.hardNum&&e.hasOwnProperty("hardNum")&&(r.hardNum=e.hardNum),e.map&&e.map.length){r.map=[];for(var n=0;n<e.map.length;++n)r.map[n]=e.map[n]}return null!=e.collect&&e.hasOwnProperty("collect")&&(r.collect=e.collect),null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&(r.is_hardlevel=e.is_hardlevel),r},o.toJSON=function(){return u.toObject(this,n.util.toJSONOptions)},u}(s);p.__type_name__="ActivityLevelCfg",p.__array_type_name__="ActivityLevelCfg_ARRAY",e.ActivityLevelCfg=p,r.ActivityLevelCfg=p;var f=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)p.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(p.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=p.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("ActivityLevelCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("ActivityLevelCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=p.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);f.__type_name__="ActivityLevelCfg_ARRAY",e.ActivityLevelCfg_ARRAY=f,r.ActivityLevelCfg_ARRAY=f;var h=function(e){function o(t){var r;if((r=e.call(this)||this).ID=0,r.name="",r.type=0,r.target=0,t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(o,e),o.getArrayType=function(){return r[o.__array_type_name__]},o.create=function(e){return new o(e)},o.encode=function(e,t){return t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(24).uint32(e.type),null!=e.target&&Object.hasOwnProperty.call(e,"target")&&t.uint32(32).uint32(e.target),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new o;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:n.name=e.string();break;case 3:n.type=e.uint32();break;case 4:n.target=e.uint32();break;default:e.skipType(7&a)}}return n},o.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},o.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID)?"ID: integer expected":null!=e.name&&e.hasOwnProperty("name")&&!i.isString(e.name)?"name: string expected":null!=e.type&&e.hasOwnProperty("type")&&!i.isInteger(e.type)?"type: integer expected":null!=e.target&&e.hasOwnProperty("target")&&!i.isInteger(e.target)?"target: integer expected":null},o.fromObject=function(e){if(e instanceof o)return e;var t=new o;return null!=e.ID&&(t.ID=e.ID>>>0),null!=e.name&&(t.name=String(e.name)),null!=e.type&&(t.type=e.type>>>0),null!=e.target&&(t.target=e.target>>>0),t},o.toObject=function(e,t){t||(t={});var r={};return t.arrays||t.defaults,t.defaults&&(r.ID=0,r.name="",r.type=0,r.target=0),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(r.type=e.type),null!=e.target&&e.hasOwnProperty("target")&&(r.target=e.target),r},o.prototype.toJSON=function(){return o.toObject(this,n.util.toJSONOptions)},o}(s);h.__type_name__="SkinsCfg",h.__array_type_name__="SkinsCfg_ARRAY",e.SkinsCfg=h,r.SkinsCfg=h;var d=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)h.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(h.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=h.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("SkinsCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("SkinsCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=h.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);d.__type_name__="SkinsCfg_ARRAY",e.SkinsCfg_ARRAY=d,r.SkinsCfg_ARRAY=d;var m=function(e){t(u,e),u.getArrayType=function(){return r[u.__array_type_name__]};var o=u.prototype;function u(t){var r;if((r=e.call(this)||this).ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=i.emptyArray,r.collect="",r.is_hardlevel=0,r.map=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return o.getCollect=function(){return this.getConvertData("collect",this.collect,"CollectData[]",!0)},u.create=function(e){return new u(e)},u.encode=function(e,t){if(t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.score&&Object.hasOwnProperty.call(e,"score")&&t.uint32(16).uint32(e.score),null!=e.hardType&&Object.hasOwnProperty.call(e,"hardType")&&t.uint32(24).uint32(e.hardType),null!=e.hardNum&&Object.hasOwnProperty.call(e,"hardNum")&&t.uint32(32).uint32(e.hardNum),null!=e.map&&e.map.length){t.uint32(42).fork();for(var r=0;r<e.map.length;++r)t.uint32(e.map[r]);t.ldelim()}return null!=e.collect&&Object.hasOwnProperty.call(e,"collect")&&t.uint32(50).string(e.collect),null!=e.is_hardlevel&&Object.hasOwnProperty.call(e,"is_hardlevel")&&t.uint32(56).uint32(e.is_hardlevel),t},u.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},u.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new u;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:n.score=e.uint32();break;case 3:n.hardType=e.uint32();break;case 4:n.hardNum=e.uint32();break;case 5:if(n.map&&n.map.length||(n.map=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.map.push(e.uint32());else n.map.push(e.uint32());break;case 6:n.collect=e.string();break;case 7:n.is_hardlevel=e.uint32();break;default:e.skipType(7&a)}}return n},u.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},u.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID))return"ID: integer expected";if(null!=e.score&&e.hasOwnProperty("score")&&!i.isInteger(e.score))return"score: integer expected";if(null!=e.hardType&&e.hasOwnProperty("hardType")&&!i.isInteger(e.hardType))return"hardType: integer expected";if(null!=e.hardNum&&e.hasOwnProperty("hardNum")&&!i.isInteger(e.hardNum))return"hardNum: integer expected";if(null!=e.map&&e.hasOwnProperty("map")){if(!Array.isArray(e.map))return"map: array expected";for(var t=0;t<e.map.length;++t)if(!i.isInteger(e.map[t]))return"map: integer[] expected"}return null!=e.collect&&e.hasOwnProperty("collect")&&!i.isString(e.collect)?"collect: string expected":null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&!i.isInteger(e.is_hardlevel)?"is_hardlevel: integer expected":null},u.fromObject=function(e){if(e instanceof u)return e;var t=new u;if(null!=e.ID&&(t.ID=e.ID>>>0),null!=e.score&&(t.score=e.score>>>0),null!=e.hardType&&(t.hardType=e.hardType>>>0),null!=e.hardNum&&(t.hardNum=e.hardNum>>>0),e.map){if(!Array.isArray(e.map))throw TypeError("DailyLevelCfg.map: array expected");t.map=[];for(var r=0;r<e.map.length;++r)t.map[r]=e.map[r]>>>0}return null!=e.collect&&(t.collect=String(e.collect)),null!=e.is_hardlevel&&(t.is_hardlevel=e.is_hardlevel>>>0),t},u.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.map=[]),t.defaults&&(r.ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=null,r.collect="",r.is_hardlevel=0),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),null!=e.score&&e.hasOwnProperty("score")&&(r.score=e.score),null!=e.hardType&&e.hasOwnProperty("hardType")&&(r.hardType=e.hardType),null!=e.hardNum&&e.hasOwnProperty("hardNum")&&(r.hardNum=e.hardNum),e.map&&e.map.length){r.map=[];for(var n=0;n<e.map.length;++n)r.map[n]=e.map[n]}return null!=e.collect&&e.hasOwnProperty("collect")&&(r.collect=e.collect),null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&(r.is_hardlevel=e.is_hardlevel),r},o.toJSON=function(){return u.toObject(this,n.util.toJSONOptions)},u}(s);m.__type_name__="DailyLevelCfg",m.__array_type_name__="DailyLevelCfg_ARRAY",e.DailyLevelCfg=m,r.DailyLevelCfg=m;var O=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)m.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(m.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=m.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("DailyLevelCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("DailyLevelCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=m.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);O.__type_name__="DailyLevelCfg_ARRAY",e.DailyLevelCfg_ARRAY=O,r.DailyLevelCfg_ARRAY=O;var y=function(e){function o(t){var r;if((r=e.call(this)||this).ID=0,r.eList=i.emptyArray,r.rCnt=i.emptyArray,r.rep=0,r.nId=0,r.eList=[],r.rCnt=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(o,e),o.getArrayType=function(){return r[o.__array_type_name__]},o.create=function(e){return new o(e)},o.encode=function(e,t){if(t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.eList&&e.eList.length){t.uint32(18).fork();for(var r=0;r<e.eList.length;++r)t.uint32(e.eList[r]);t.ldelim()}if(null!=e.rCnt&&e.rCnt.length){t.uint32(26).fork();for(r=0;r<e.rCnt.length;++r)t.uint32(e.rCnt[r]);t.ldelim()}return null!=e.rep&&Object.hasOwnProperty.call(e,"rep")&&t.uint32(32).uint32(e.rep),null!=e.nId&&Object.hasOwnProperty.call(e,"nId")&&t.uint32(40).uint32(e.nId),t},o.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},o.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new o;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:if(n.eList&&n.eList.length||(n.eList=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.eList.push(e.uint32());else n.eList.push(e.uint32());break;case 3:if(n.rCnt&&n.rCnt.length||(n.rCnt=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.rCnt.push(e.uint32());else n.rCnt.push(e.uint32());break;case 4:n.rep=e.uint32();break;case 5:n.nId=e.uint32();break;default:e.skipType(7&a)}}return n},o.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},o.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID))return"ID: integer expected";if(null!=e.eList&&e.hasOwnProperty("eList")){if(!Array.isArray(e.eList))return"eList: array expected";for(var t=0;t<e.eList.length;++t)if(!i.isInteger(e.eList[t]))return"eList: integer[] expected"}if(null!=e.rCnt&&e.hasOwnProperty("rCnt")){if(!Array.isArray(e.rCnt))return"rCnt: array expected";for(t=0;t<e.rCnt.length;++t)if(!i.isInteger(e.rCnt[t]))return"rCnt: integer[] expected"}return null!=e.rep&&e.hasOwnProperty("rep")&&!i.isInteger(e.rep)?"rep: integer expected":null!=e.nId&&e.hasOwnProperty("nId")&&!i.isInteger(e.nId)?"nId: integer expected":null},o.fromObject=function(e){if(e instanceof o)return e;var t=new o;if(null!=e.ID&&(t.ID=e.ID>>>0),e.eList){if(!Array.isArray(e.eList))throw TypeError("FallDownCfg.eList: array expected");t.eList=[];for(var r=0;r<e.eList.length;++r)t.eList[r]=e.eList[r]>>>0}if(e.rCnt){if(!Array.isArray(e.rCnt))throw TypeError("FallDownCfg.rCnt: array expected");t.rCnt=[];for(r=0;r<e.rCnt.length;++r)t.rCnt[r]=e.rCnt[r]>>>0}return null!=e.rep&&(t.rep=e.rep>>>0),null!=e.nId&&(t.nId=e.nId>>>0),t},o.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.eList=[],r.rCnt=[]),t.defaults&&(r.ID=0,r.eList=null,r.rCnt=null,r.rep=0,r.nId=0),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),e.eList&&e.eList.length){r.eList=[];for(var n=0;n<e.eList.length;++n)r.eList[n]=e.eList[n]}if(e.rCnt&&e.rCnt.length){r.rCnt=[];for(n=0;n<e.rCnt.length;++n)r.rCnt[n]=e.rCnt[n]}return null!=e.rep&&e.hasOwnProperty("rep")&&(r.rep=e.rep),null!=e.nId&&e.hasOwnProperty("nId")&&(r.nId=e.nId),r},o.prototype.toJSON=function(){return o.toObject(this,n.util.toJSONOptions)},o}(s);y.__type_name__="FallDownCfg",y.__array_type_name__="FallDownCfg_ARRAY",e.FallDownCfg=y,r.FallDownCfg=y;var D=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)y.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(y.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=y.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("FallDownCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("FallDownCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=y.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);D.__type_name__="FallDownCfg_ARRAY",e.FallDownCfg_ARRAY=D,r.FallDownCfg_ARRAY=D;var L=function(e){t(u,e),u.getArrayType=function(){return r[u.__array_type_name__]};var o=u.prototype;function u(t){var r;if((r=e.call(this)||this).ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=i.emptyArray,r.collect="",r.is_hardlevel=0,r.map=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return o.getCollect=function(){return this.getConvertData("collect",this.collect,"CollectData[]",!0)},u.create=function(e){return new u(e)},u.encode=function(e,t){if(t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.score&&Object.hasOwnProperty.call(e,"score")&&t.uint32(16).uint32(e.score),null!=e.hardType&&Object.hasOwnProperty.call(e,"hardType")&&t.uint32(24).uint32(e.hardType),null!=e.hardNum&&Object.hasOwnProperty.call(e,"hardNum")&&t.uint32(32).uint32(e.hardNum),null!=e.map&&e.map.length){t.uint32(42).fork();for(var r=0;r<e.map.length;++r)t.uint32(e.map[r]);t.ldelim()}return null!=e.collect&&Object.hasOwnProperty.call(e,"collect")&&t.uint32(50).string(e.collect),null!=e.is_hardlevel&&Object.hasOwnProperty.call(e,"is_hardlevel")&&t.uint32(56).uint32(e.is_hardlevel),t},u.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},u.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new u;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:n.score=e.uint32();break;case 3:n.hardType=e.uint32();break;case 4:n.hardNum=e.uint32();break;case 5:if(n.map&&n.map.length||(n.map=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.map.push(e.uint32());else n.map.push(e.uint32());break;case 6:n.collect=e.string();break;case 7:n.is_hardlevel=e.uint32();break;default:e.skipType(7&a)}}return n},u.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},u.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID))return"ID: integer expected";if(null!=e.score&&e.hasOwnProperty("score")&&!i.isInteger(e.score))return"score: integer expected";if(null!=e.hardType&&e.hasOwnProperty("hardType")&&!i.isInteger(e.hardType))return"hardType: integer expected";if(null!=e.hardNum&&e.hasOwnProperty("hardNum")&&!i.isInteger(e.hardNum))return"hardNum: integer expected";if(null!=e.map&&e.hasOwnProperty("map")){if(!Array.isArray(e.map))return"map: array expected";for(var t=0;t<e.map.length;++t)if(!i.isInteger(e.map[t]))return"map: integer[] expected"}return null!=e.collect&&e.hasOwnProperty("collect")&&!i.isString(e.collect)?"collect: string expected":null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&!i.isInteger(e.is_hardlevel)?"is_hardlevel: integer expected":null},u.fromObject=function(e){if(e instanceof u)return e;var t=new u;if(null!=e.ID&&(t.ID=e.ID>>>0),null!=e.score&&(t.score=e.score>>>0),null!=e.hardType&&(t.hardType=e.hardType>>>0),null!=e.hardNum&&(t.hardNum=e.hardNum>>>0),e.map){if(!Array.isArray(e.map))throw TypeError("LevelBCfg.map: array expected");t.map=[];for(var r=0;r<e.map.length;++r)t.map[r]=e.map[r]>>>0}return null!=e.collect&&(t.collect=String(e.collect)),null!=e.is_hardlevel&&(t.is_hardlevel=e.is_hardlevel>>>0),t},u.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.map=[]),t.defaults&&(r.ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=null,r.collect="",r.is_hardlevel=0),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),null!=e.score&&e.hasOwnProperty("score")&&(r.score=e.score),null!=e.hardType&&e.hasOwnProperty("hardType")&&(r.hardType=e.hardType),null!=e.hardNum&&e.hasOwnProperty("hardNum")&&(r.hardNum=e.hardNum),e.map&&e.map.length){r.map=[];for(var n=0;n<e.map.length;++n)r.map[n]=e.map[n]}return null!=e.collect&&e.hasOwnProperty("collect")&&(r.collect=e.collect),null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&(r.is_hardlevel=e.is_hardlevel),r},o.toJSON=function(){return u.toObject(this,n.util.toJSONOptions)},u}(s);L.__type_name__="LevelBCfg",L.__array_type_name__="LevelBCfg_ARRAY",e.LevelBCfg=L,r.LevelBCfg=L;var R=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)L.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(L.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=L.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("LevelBCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("LevelBCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=L.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);R.__type_name__="LevelBCfg_ARRAY",e.LevelBCfg_ARRAY=R,r.LevelBCfg_ARRAY=R;var A=function(e){t(u,e),u.getArrayType=function(){return r[u.__array_type_name__]};var o=u.prototype;function u(t){var r;if((r=e.call(this)||this).ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=i.emptyArray,r.collect="",r.is_hardlevel=0,r.map=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return o.getCollect=function(){return this.getConvertData("collect",this.collect,"CollectData[]",!0)},u.create=function(e){return new u(e)},u.encode=function(e,t){if(t||(t=a.create()),null!=e.ID&&Object.hasOwnProperty.call(e,"ID")&&t.uint32(8).uint32(e.ID),null!=e.score&&Object.hasOwnProperty.call(e,"score")&&t.uint32(16).uint32(e.score),null!=e.hardType&&Object.hasOwnProperty.call(e,"hardType")&&t.uint32(24).uint32(e.hardType),null!=e.hardNum&&Object.hasOwnProperty.call(e,"hardNum")&&t.uint32(32).uint32(e.hardNum),null!=e.map&&e.map.length){t.uint32(42).fork();for(var r=0;r<e.map.length;++r)t.uint32(e.map[r]);t.ldelim()}return null!=e.collect&&Object.hasOwnProperty.call(e,"collect")&&t.uint32(50).string(e.collect),null!=e.is_hardlevel&&Object.hasOwnProperty.call(e,"is_hardlevel")&&t.uint32(56).uint32(e.is_hardlevel),t},u.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},u.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new u;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ID=e.uint32();break;case 2:n.score=e.uint32();break;case 3:n.hardType=e.uint32();break;case 4:n.hardNum=e.uint32();break;case 5:if(n.map&&n.map.length||(n.map=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.map.push(e.uint32());else n.map.push(e.uint32());break;case 6:n.collect=e.string();break;case 7:n.is_hardlevel=e.uint32();break;default:e.skipType(7&a)}}return n},u.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},u.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ID&&e.hasOwnProperty("ID")&&!i.isInteger(e.ID))return"ID: integer expected";if(null!=e.score&&e.hasOwnProperty("score")&&!i.isInteger(e.score))return"score: integer expected";if(null!=e.hardType&&e.hasOwnProperty("hardType")&&!i.isInteger(e.hardType))return"hardType: integer expected";if(null!=e.hardNum&&e.hasOwnProperty("hardNum")&&!i.isInteger(e.hardNum))return"hardNum: integer expected";if(null!=e.map&&e.hasOwnProperty("map")){if(!Array.isArray(e.map))return"map: array expected";for(var t=0;t<e.map.length;++t)if(!i.isInteger(e.map[t]))return"map: integer[] expected"}return null!=e.collect&&e.hasOwnProperty("collect")&&!i.isString(e.collect)?"collect: string expected":null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&!i.isInteger(e.is_hardlevel)?"is_hardlevel: integer expected":null},u.fromObject=function(e){if(e instanceof u)return e;var t=new u;if(null!=e.ID&&(t.ID=e.ID>>>0),null!=e.score&&(t.score=e.score>>>0),null!=e.hardType&&(t.hardType=e.hardType>>>0),null!=e.hardNum&&(t.hardNum=e.hardNum>>>0),e.map){if(!Array.isArray(e.map))throw TypeError("LevelCCfg.map: array expected");t.map=[];for(var r=0;r<e.map.length;++r)t.map[r]=e.map[r]>>>0}return null!=e.collect&&(t.collect=String(e.collect)),null!=e.is_hardlevel&&(t.is_hardlevel=e.is_hardlevel>>>0),t},u.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.map=[]),t.defaults&&(r.ID=0,r.score=0,r.hardType=0,r.hardNum=0,r.map=null,r.collect="",r.is_hardlevel=0),null!=e.ID&&e.hasOwnProperty("ID")&&(r.ID=e.ID),null!=e.score&&e.hasOwnProperty("score")&&(r.score=e.score),null!=e.hardType&&e.hasOwnProperty("hardType")&&(r.hardType=e.hardType),null!=e.hardNum&&e.hasOwnProperty("hardNum")&&(r.hardNum=e.hardNum),e.map&&e.map.length){r.map=[];for(var n=0;n<e.map.length;++n)r.map[n]=e.map[n]}return null!=e.collect&&e.hasOwnProperty("collect")&&(r.collect=e.collect),null!=e.is_hardlevel&&e.hasOwnProperty("is_hardlevel")&&(r.is_hardlevel=e.is_hardlevel),r},o.toJSON=function(){return u.toObject(this,n.util.toJSONOptions)},u}(s);A.__type_name__="LevelCCfg",A.__array_type_name__="LevelCCfg_ARRAY",e.LevelCCfg=A,r.LevelCCfg=A;var g=function(e){function r(t){var r;if((r=e.call(this)||this).Items=i.emptyArray,r.Items=[],t)for(var n=Object.keys(t),l=0;l<n.length;++l)null!=t[n[l]]&&(r[n[l]]=t[n[l]]);return r}return t(r,e),r.create=function(e){return new r(e)},r.encode=function(e,t){if(t||(t=a.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)A.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},r.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},r.decode=function(e,t){e instanceof l||(e=l.create(e));for(var n=void 0===t?e.len:e.pos+t,a=new r;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:a.Items&&a.Items.length||(a.Items=[]),a.Items.push(A.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return a},r.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},r.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.Items&&e.hasOwnProperty("Items")){if(!Array.isArray(e.Items))return"Items: array expected";for(var t=0;t<e.Items.length;++t){var r=A.verify(e.Items[t]);if(r)return"Items."+r}}return null},r.fromObject=function(e){if(e instanceof r)return e;var t=new r;if(e.Items){if(!Array.isArray(e.Items))throw TypeError("LevelCCfg_ARRAY.Items: array expected");t.Items=[];for(var n=0;n<e.Items.length;++n)if("object"!=typeof e.Items[n])throw TypeError("LevelCCfg_ARRAY.Items: object expected");t.Items[n]=r.fromObject(e.Items[n])}return t},r.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Items=[]),t.defaults&&(r.Items=null),e.Items&&e.Items.length){r.Items=[];for(var n=0;n<e.Items.length;++n)r.Items[n]=A.toObject(e.Items[n],t)}return r},r.prototype.toJSON=function(){return r.toObject(this,n.util.toJSONOptions)},r}(s);g.__type_name__="LevelCCfg_ARRAY",e.LevelCCfg_ARRAY=g,r.LevelCCfg_ARRAY=g}(u||(u=e("GameConfig",{}))),r._RF.pop()}}}));

System.register("chunks:///_virtual/DingyuePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./GameData.ts","./Tips.ts","./UIManager.ts","./EventManager.ts","./Enum.ts","./TDataMgr.ts","./I18nManager.ts"],(function(e){var n,t,a,i,r,o,s,u,c,l,d,f,p,g,y,_,b,h,I,S;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){u=e.cclegacy,c=e.Node,l=e._decorator,d=e.Label},function(e){f=e.default},function(e){p=e.GameData},function(e){g=e.default},function(e){y=e.default,_=e.PanelType},function(e){b=e.default},function(e){h=e.EventType},function(e){I=e.TDataMgr},function(e){S=e.I18n}],execute:function(){var m,v,E,P,D;u._RF.push({},"676caW9yhZPKpeYp8W2ejOL","DingyuePanel",void 0);var G=l,T=G.ccclass,w=G.property;e("default",(m=T("panel/DingyuePanel"),v=w(c),m((D=n((P=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n=e.call.apply(e,[this].concat(r))||this,a(n,"btnGet",D,i(n)),n}t(n,e);var u=n.prototype;return u.onEnable=function(){this.initI18nLabels()},u.initI18nLabels=function(){for(var e,n={"订阅可获得皮肤奖励":"panel.subscribe_reward"},t=this.node.getComponentsInChildren(d),a=r(t);!(e=a()).done;){var i=e.value,o=n[i.string];o&&(i.string=S.t(o))}},u.init=function(){var e=o(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I.ins.dot("panel_dingyue",{from:"show"});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u.onDingyue=function(){var e=this;PUCHI_SDK.IsWx?(console.log("dingyue"),wx.requestSubscribeSystemMessage({msgTypeList:["SYS_MSG_TYPE_WHATS_NEW"],success:function(n){"accept"===n.SYS_MSG_TYPE_WHATS_NEW?(p.data.dingyue=!0,p.data.addSkin(4),b.I.emit(h.REFRESH_DINGYUE),b.I.emit(h.CHANGE_SKIN),e.btnGet.active=!1,I.ins.dot("panel_dingyue",{from:"get"}),e.onClose(),y.addPanel(_.RewardPanel,{type:2,id:4})):g.show(S.t("tips.subscribe_failed"))},fail:function(e){g.show(S.t("tips.subscribe_failed"))}})):(p.data.dingyue=!0,p.data.addSkin(4),b.I.emit(h.CHANGE_SKIN),b.I.emit(h.REFRESH_DINGYUE),e.btnGet.active=!1,I.ins.dot("panel_dingyue",{from:"get"}),e.onClose(),y.addPanel(_.RewardPanel,{type:2,id:4}))},u.onClose=function(){this.close()},n}(f)).prototype,"btnGet",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=P))||E));u._RF.pop()}}}));

System.register("chunks:///_virtual/EctypeMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./Enum.ts","./ObjectInstance.ts","./Utils.ts","./GameConst.ts"],(function(t){var i,n,e,s,o,r,a;return{setters:[function(t){i=t.createClass},function(t){n=t.cclegacy},function(t){e=t.ConfigManager},function(t){s=t.GameStatus},function(t){o=t.default},function(t){r=t.Utils},function(t){a=t.default}],execute:function(){n._RF.push({},"e744aFxowhIw5zoar1+8V49","EctypeMgr",void 0);t("EctypeMgr",function(){function t(){this._gameStatus=s.None,this._boxColLen=30,this._bWid=0,this._lastProInfo=null,this._score=0,this._nextLock=!0,this._failCnt=0,this.prop_change_cnt=0,this.prop_eliminate_cnt=0,this.duration=0,this.reviveCnt=0,this.gmRowAdd=0,this._originList=[],this._emptyMap=new Map,this._endPMap=new Map,this._colMap=new Map,this._repeatList=[],this._rowIds=[],this._waitingRow=[],this._lastColList=[],this._blockData=[]}var n=t.prototype;return n.addScore=function(t){this._score+=t},n.addReviveCnt=function(t){this._failCnt+=t},n.init=function(){this.getOriginCfgList(),this.getRepeatCfgList(),this.freshProInfo()},n.freshProInfo=function(){var t=this._originList[this._originList.length-1].eList;this._lastProInfo={id:0,lastIds:t,nextId:11,isRow:!1,rowBack:!1,rowId:-1,isRowF:!1}},n.getOriginCfgList=function(){if(0!==this._originList.length)return this._originList;for(var t=0;t<e.fallDownTable.length;t++){var i=e.fallDownTable[t];if(0===i.rep)for(var n=r.random(i.rCnt[0],i.rCnt[1]),s=0;s<n;s++)this._originList.push(i)}return this._originList},n.getRepeatCfgList=function(){var t=this;if(0!==this._repeatList.length)return this._repeatList;for(var i=function(){var i=e.fallDownTable[n];if(1===i.rep){if(t._repeatList.push(i),i.eList.forEach((function(n){var e=t._emptyMap.get(n)||[];e.push(i.ID),t._emptyMap.set(n,e)})),1===i.eList.length){var s=i.eList[0],o=t._colMap.get(s)||[];o.push(i.ID),t._colMap.set(s,o)}if(t.isRowIds(i.eList)&&t._rowIds.push(i.ID),i.eList.length>=2){var r=i.eList[0],a=i.eList[i.eList.length-1],h=t._endPMap.get(r)||[];h.push(i.ID),t._endPMap.set(r,h);var l=t._endPMap.get(a)||[];l.push(i.ID),t._endPMap.set(a,l)}}},n=0;n<e.fallDownTable.length;n++)i();return this._repeatList},n.getNextRow=function(){return this._waitingRow.length<=0&&this.getNextCfg(),this._waitingRow.shift()},n.getNextCfg=function(){var t=this._lastProInfo.nextId,i=e.getFallDownTable(t),n=i.eList,s=this.isRowIds(n),o=s?t===n[0]?n[0]:n[n.length-1]:-1,a=this.getNextCfgId(n,s?this._rowIds.concat(this._lastProInfo.id):[this._lastProInfo.id]);s&&(a=t===n[0]?r.randOneList(this._colMap.get(n[n.length-1])):r.randOneList(this._colMap.get(n[0])));var h=s?1:r.random(i.rCnt[0],i.rCnt[1]);i.nId>0&&(a=i.nId),this._lastProInfo={id:i.ID,lastIds:n,nextId:a,isRow:s,rowBack:s,rowId:s?o:-1,isRowF:s&&t===n[0]},h>=3&&(this._lastColList=this._colMap.get(n[0]));for(var l=0;l<h;l++)this._waitingRow.push(i.eList);return this._lastProInfo},n.getNextCfgId=function(t,i){var n=this,e=r.randOneList(t),s=this._emptyMap.get(e);s&&s.length>0||(console.warn("find empty map error",e),s=Array.from(this._emptyMap.values()).flat());var o=(s=s.filter((function(t){return!n._lastColList.includes(t)}))).filter((function(t){return!i.includes(t)}));return r.randOneList(o.length>0?o:s)},n.isRowIds=function(t){if(t.length>=4){var i=t[0],n=t[t.length-1];if(i+t.length-1===n)return!0}return!1},n.getBlockData=function(){(!this._blockData||this._blockData.length<=0)&&(this._blockData=[a.FALL_BLOCK[0],a.FALL_BLOCK[1]]);var t=this._blockData.shift();return this._blockData.push(r.randOneList(a.FALL_BLOCK)),t},n.getFirstBlockData=function(){return this._blockData[0]},n.getColList=function(t,i){var n=[];return t.map((function(t){n.push(t[i])})),n},n.clearData=function(){this.gmRowAdd=0,this._score=0,this._failCnt=0,this.prop_change_cnt=0,this.prop_eliminate_cnt=0,this.duration=0,this.reviveCnt=0,this._nextLock=!0,this._blockData=null,this.freshProInfo()},i(t,[{key:"gameStatus",get:function(){return this._gameStatus},set:function(t){this._gameStatus!==t&&(this._gameStatus=t)}},{key:"boxRowLen",get:function(){return 20}},{key:"boxColLen",get:function(){return this._boxColLen},set:function(t){this._boxColLen=t}},{key:"bWid",get:function(){return this._bWid},set:function(t){this._bWid=t}},{key:"score",get:function(){return this._score}},{key:"nextLock",get:function(){return this._nextLock},set:function(t){this._nextLock=t}},{key:"failCnt",get:function(){return this._failCnt}}],[{key:"I",get:function(){return o.getInstance(t)}}]),t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/EndPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./GameData.ts","./Panel.ts","./Utils.ts","./EventManager.ts","./MaskView.ts","./SdkTools.ts","./TDataMgr.ts","./I18nManager.ts","./I18nImageText.ts","./PlatformManager.ts"],(function(e){var t,n,i,a,o,r,s,c,l,u,h,p,d,f,m,g,I,_,S,w,y,v,b,x,P,C,T;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose,r=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){c=e.cclegacy,l=e.Label,u=e.Node,h=e._decorator,p=e.Color,d=e.tween,f=e.UIOpacity,m=e.Tween,g=e.v3},function(e){I=e.EventType},function(e){_=e.GameData},function(e){S=e.default},function(e){w=e.Utils},function(e){y=e.default},function(e){v=e.MaskView},function(e){b=e.SdkTools},function(e){x=e.TDataMgr},function(e){P=e.I18n},function(e){C=e.I18nImageText},function(e){T=e.PlatformManager}],execute:function(){var E,H,D,M,U,R,K,O,A,k,L;c._RF.push({},"5c305bVElxM0LlS5rJj2SgK","EndPanel",void 0);var z=h,V=z.ccclass,Y=z.property;e("default",(E=V("panel/EndPanel"),H=Y(l),D=Y(l),M=Y(u),U=Y(u),E((O=t((K=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,i(t,"labScore",O,a(t)),i(t,"labMax",A,a(t)),i(t,"newRecord",k,a(t)),i(t,"iconVideo",L,a(t)),t.isTouch=!1,t.isAnim=!1,t.t=0,t}n(t,e);var c=t.prototype;return c.onLoad=function(){this.bg.on(u.EventType.TOUCH_START,this.touchStart,this),this.bg.on(u.EventType.TOUCH_END,this.touchEnd,this),this.bg.on(u.EventType.TOUCH_CANCEL,this.touchEnd,this)},c.onEnable=function(){this.initI18nLabels(),this.initI18nImageTexts()},c.initI18nLabels=function(){for(var e,t={"本局得分":"panel.this_score","你打败了":"panel.beat_players","的玩家！":"panel.of_players","分享好友":"panel.share_friend","分享一下":"panel.share_it","新用户额外":"panel.new_user_extra"},n=this.node.getComponentsInChildren(l),i=o(n);!(e=i()).done;){var a=e.value,r=t[a.string];r&&(a.string=P.t(r))}},c.initI18nImageTexts=function(){new p(100,50,50,255);var e=[{nodeName:"shibai_wujin_word",i18nKey:"end_panel.victory",outlineColor:new p(200,100,50,255),outlineWidth:3},{nodeName:"zhuye_word_6",i18nKey:"end_panel.restart",outlineColor:new p(50,100,50,255),outlineWidth:2,fontSize:45},{nodeName:"word_1",i18nKey:"end_panel.home",outlineColor:new p(50,80,150,255),outlineWidth:2,fontSize:45}];C.replaceImageTexts(this.node,e)},c.update=function(e){this.isTouch&&!this.isAnim&&Date.now()-this.t>1e3&&(this.isAnim=!0,this.animHide())},c.touchStart=function(){this.isTouch=!0,this.t=Date.now()},c.touchEnd=function(){this.isTouch=!1,this.isAnim&&(this.isAnim=!1,this.animShow())},c.animHide=function(){d(this.content.getComponent(f)).to(.1,{opacity:0}).start(),d(this.bg.getComponent(f)).to(.1,{opacity:50}).start()},c.animShow=function(){m.stopAllByTarget(this.content),m.stopAllByTarget(this.bg),d(this.content.getComponent(f)).to(.1,{opacity:255}).start(),d(this.bg.getComponent(f)).to(.1,{opacity:180}).start()},c.init=function(){var e=r(s().mark((function e(t){var n,i,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.labScore.string="",v.show(),this.iconVideo.active=_.data.today_restart>=PUCHI_SDK.OnlineService.getParamsInt("today_restart_limit",3),this.labMax.string=P.t("game.best_score",_.data.maxScore),this.newRecord.active=!1,n=Math.min(13,t),i=Math.floor(t/n),a=[0],o=0;o<n;o++)a.push(i*(o+1));return a.push(t),e.next=12,w.wait(300);case 12:this.animScore(a,t),v.hide(),this.iconVideo.active&&x.ins.dot("video_exposure",{view_reason:"game_replay"}),1==_.data.special_user&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.IsWx&&1==PUCHI_SDK.OnlineService.getParamsInt("special_user_in",1)&&T.getInstance().current.showInterstitial(),"Yandex"!==T.getInstance().current.name&&this.scheduleOnce((function(){T.getInstance().current.showInterstitial()}),1);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),c.animScore=function(){var e=r(s().mark((function e(t,n){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.shift(),this.labScore.string=i+"",!t.length){e.next=8;break}return e.next=5,w.wait(80-2*(13-t.length));case 5:this.animScore(t,n),e.next=9;break;case 8:n==_.data.maxScore&&(this.newRecord.active=!0,this.newRecord.setScale(3,3,3),d(this.newRecord).to(.3,{scale:g(1,1,1)}).start());case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),c.onHome=function(){this.close(),y.I.emit(I.GO_HOME);var e="Yandex"===T.getInstance().current.name,t=500;e?t=100:"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService&&(t=PUCHI_SDK.OnlineService.getParamsInt("interstitial_score",500)),console.log("[EndPanel] onHome - maxScore: "+_.data.maxScore+", limit: "+t+", isYandex: "+e),_.data.maxScore>=t&&(console.log("[EndPanel] Calling showInterstitial from onHome"),T.getInstance().current.showInterstitial())},c.onRepaly=function(){var e=r(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.iconVideo.active){e.next=6;break}return e.next=3,b.share("game_replay");case 3:return 0==e.sent.code&&(this.close(),y.I.emit(I.REPLAY,!0)),e.abrupt("return");case 6:this.close(),y.I.emit(I.REPLAY),t="Yandex"===T.getInstance().current.name,n=500,t?n=100:"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService&&(n=PUCHI_SDK.OnlineService.getParamsInt("interstitial_score",500)),console.log("[EndPanel] onReplay - maxScore: "+_.data.maxScore+", limit: "+n+", isYandex: "+t),_.data.maxScore>=n&&(console.log("[EndPanel] Calling showInterstitial from onReplay"),T.getInstance().current.showInterstitial());case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.onShare=function(){this.onHome()},t}(S)).prototype,"labScore",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(K.prototype,"labMax",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(K.prototype,"newRecord",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(K.prototype,"iconVideo",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=K))||R));c._RF.pop()}}}));

System.register("chunks:///_virtual/Enum.ts",["cc"],(function(e){var E;return{setters:[function(e){E=e.cclegacy}],execute:function(){E._RF.push({},"f8096OnX91OwIiCKVh0CKem","Enum",void 0);e("GameType",function(e){return e[e.default=1]="default",e[e.level=2]="level",e[e.activity=3]="activity",e[e.daily=4]="daily",e}({})),e("CollectType",function(e){return e[e.jewel=1]="jewel",e[e.score=2]="score",e}({})),e("GameState",function(e){return e[e.None=0]="None",e[e.Play=1]="Play",e[e.Stop=2]="Stop",e[e.End=3]="End",e}({})),e("EventType",function(e){return e.RESET_DAY="RESET_DAY",e.GO_HOME="goHome",e.REPLAY="replay",e.TARGET_ANIM="TARGET_ANIM",e.SHOW_GM="showGm",e.ACT_CHANGE="ACT_CHANGE",e.SHOW_YXQ="show_yxq",e.REFRESH_DINGYUE="refresh_dingyue",e.CHANGE_SKIN="CHANGE_SKIN",e.NO_SKIN_ERROR="NO_SKIN_ERROR",e.TOGGLE_TAB="TOGGLE_TAB",e.OPEN_TAB="OPEN_TAB",e.START_GAME="START_GAME",e.LANGUAGE_CHANGED="LANGUAGE_CHANGED",e.OPEN_OTHER_GAME="OPEN_OTHER_GAME",e.CHECK_OPEN_GO="CHECK_OPEN_GO",e.DATA_SYNCED="DATA_SYNCED",e}({})),e("TabType",function(e){return e[e.handBook=0]="handBook",e[e.daily=1]="daily",e[e.home=2]="home",e[e.activity=3]="activity",e[e.moregame=4]="moregame",e}({})),e("GameStatus",function(e){return e[e.None=0]="None",e[e.Game=1]="Game",e[e.Fail=2]="Fail",e[e.Success=3]="Success",e[e.Pause=4]="Pause",e}({}));E._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,l;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,n=e.createClass},function(e){r=e.cclegacy,l=e._decorator}],execute:function(){var i,a;r._RF.push({},"af9f2yUtXtO8Zbd6io+j2M9","EventManager",void 0);var s=l.ccclass,o=(e("default",s(((a=function(){function e(){this._listener=new Map}var r=e.prototype;return r.emit=function(e,t,n,r,l,i,a){var s=this._listener.get(e);if("replay"===e&&console.log("[EventManager] emit replay: listeners count = "+((null==s?void 0:s.length)||0)),s&&s.length)for(var o=s.length-1;o>=0;--o)"replay"===e&&console.log("[EventManager] Calling replay listener "+o),s[o].func.call(s[o].caller,t,n,r,l,i,a)},r.on=function(e,n,r){var l=this._listener.get(e);l||(l=[]);for(var i,a=t(l);!(i=a()).done;){var s=i.value;if(s.func==n&&s.caller==r)return}var c=new o;c.func=n,c.caller=r,l.push(c),this._listener.set(e,l),"replay"===e&&console.log("[EventManager] Registered replay listener, total: "+l.length)},r.off=function(e,t,n){var r=this._listener.get(e);if(r&&r.length){for(var l=r.length-1;l>=0;--l)if(r[l].func==t&&r[l].caller==n){r.splice(l,1);break}this._listener.set(e,r)}},n(e,null,[{key:"I",get:function(){return this._inst||(this._inst=new e),this._inst}}]),e}())._inst=void 0,i=a))||i),function(){this.func=void 0,this.caller=void 0});r._RF.pop()}}}));

System.register("chunks:///_virtual/FacebookPlatform.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,o;return{setters:[function(e){n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"39d8552UaVG5anZtVHwwDzB","FacebookPlatform",void 0);e("FacebookPlatform",function(){function e(){this.name="Facebook",this._initialized=!1,this._rewardedVideo=null,this._interstitialAd=null,this.BANNER_PLACEMENT_ID="YOUR_BANNER_PLACEMENT_ID",this.INTERSTITIAL_PLACEMENT_ID="YOUR_INTERSTITIAL_PLACEMENT_ID",this.REWARDED_VIDEO_PLACEMENT_ID="YOUR_REWARDED_VIDEO_PLACEMENT_ID",console.log("FacebookPlatform constructor")}var o=e.prototype;return o.init=function(){console.log("FacebookPlatform init (sync wrapper)")},o.initAsync=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("FacebookPlatform initAsync"),"undefined"!=typeof FBInstant){e.next=4;break}return console.error("[Facebook] FBInstant SDK not found!"),e.abrupt("return");case 4:return e.prev=4,e.next=7,FBInstant.initializeAsync();case 7:return console.log("[Facebook] SDK initialized"),FBInstant.setLoadingProgress(100),e.next=11,FBInstant.startGameAsync();case 11:console.log("[Facebook] Game started"),this._initialized=!0,this.preloadAds(),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),console.error("[Facebook] Init failed:",e.t0);case 19:case"end":return e.stop()}}),e,this,[[4,16]])})));return function(){return e.apply(this,arguments)}}(),o.preloadAds=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.getRewardedVideoAsync(this.REWARDED_VIDEO_PLACEMENT_ID);case 3:return this._rewardedVideo=e.sent,e.next=6,this._rewardedVideo.loadAsync();case 6:console.log("[Facebook] Rewarded video preloaded"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn("[Facebook] Failed to preload rewarded video:",e.t0);case 12:return e.prev=12,e.next=15,FBInstant.getInterstitialAdAsync(this.INTERSTITIAL_PLACEMENT_ID);case 15:return this._interstitialAd=e.sent,e.next=18,this._interstitialAd.loadAsync();case 18:console.log("[Facebook] Interstitial ad preloaded"),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(12),console.warn("[Facebook] Failed to preload interstitial:",e.t1);case 24:case"end":return e.stop()}}),e,this,[[0,9],[12,21]])})));return function(){return e.apply(this,arguments)}}(),o.login=function(){return new Promise((function(e){if("undefined"!=typeof FBInstant)try{var n=FBInstant.player.getID(),t=FBInstant.player.getName(),o=FBInstant.player.getPhoto();console.log("[Facebook] Player:",n,t),e({code:0,userInfo:{userId:n||"guest",nickName:t||"Player",avatarUrl:o||""}})}catch(n){console.error("[Facebook] Login failed:",n),e({code:1,msg:"Login failed"})}else e({code:1,msg:"SDK not ready"})}))},o.getUserInfo=function(){if("undefined"==typeof FBInstant)return Promise.resolve({});try{return Promise.resolve({userId:FBInstant.player.getID(),nickName:FBInstant.player.getName(),avatarUrl:FBInstant.player.getPhoto()})}catch(e){return Promise.resolve({})}},o.vibrateShort=function(e){"undefined"!=typeof FBInstant&&FBInstant.performHapticFeedbackAsync&&FBInstant.performHapticFeedbackAsync().catch((function(){}))},o.vibrateLong=function(){this.vibrateShort("heavy")},o.showBanner=function(){"undefined"!=typeof FBInstant&&FBInstant.loadBannerAdAsync(this.BANNER_PLACEMENT_ID,"bottom").then((function(){console.log("[Facebook] Banner ad loaded")})).catch((function(e){console.warn("[Facebook] Banner ad failed:",e)}))},o.hideBanner=function(){"undefined"!=typeof FBInstant&&FBInstant.hideBannerAdAsync().then((function(){console.log("[Facebook] Banner ad hidden")})).catch((function(e){console.warn("[Facebook] Hide banner failed:",e)}))},o.showInterstitial=function(){var e=this;this._interstitialAd?this._interstitialAd.showAsync().then((function(){console.log("[Facebook] Interstitial shown"),e.preloadInterstitial()})).catch((function(e){console.warn("[Facebook] Interstitial show failed:",e)})):console.warn("[Facebook] Interstitial not loaded")},o.preloadInterstitial=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.getInterstitialAdAsync(this.INTERSTITIAL_PLACEMENT_ID);case 3:return this._interstitialAd=e.sent,e.next=6,this._interstitialAd.loadAsync();case 6:console.log("[Facebook] Interstitial reloaded"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn("[Facebook] Failed to reload interstitial:",e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),o.showRewardVideo=function(e){var o=this;return new Promise(n(t().mark((function e(n){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o._rewardedVideo){e.next=14;break}return console.warn("[Facebook] Rewarded video not loaded, attempting to load..."),e.prev=2,e.next=5,FBInstant.getRewardedVideoAsync(o.REWARDED_VIDEO_PLACEMENT_ID);case 5:return o._rewardedVideo=e.sent,e.next=8,o._rewardedVideo.loadAsync();case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(2),n({code:1,msg:"Ad not ready"}),e.abrupt("return");case 14:return e.prev=14,e.next=17,o._rewardedVideo.showAsync();case 17:console.log("[Facebook] Rewarded video completed"),o.preloadRewardedVideo(),n({code:0,msg:"Success"}),e.next=26;break;case 22:e.prev=22,e.t1=e.catch(14),console.warn("[Facebook] Rewarded video failed:",e.t1),n({code:1,msg:(null==e.t1?void 0:e.t1.message)||"Failed"});case 26:case"end":return e.stop()}}),e,null,[[2,10],[14,22]])}))))},o.preloadRewardedVideo=function(){var e=n(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,FBInstant.getRewardedVideoAsync(this.REWARDED_VIDEO_PLACEMENT_ID);case 3:return this._rewardedVideo=e.sent,e.next=6,this._rewardedVideo.loadAsync();case 6:console.log("[Facebook] Rewarded video reloaded"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn("[Facebook] Failed to reload rewarded video:",e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),o.uploadRankData=function(e,n,t){"undefined"!=typeof FBInstant&&FBInstant.getLeaderboardAsync(e).then((function(e){return e.setScoreAsync(n)})).then((function(){console.log("[Facebook] Leaderboard "+e+" updated: "+n)})).catch((function(e){console.warn("[Facebook] Leaderboard update failed:",e)}))},o.postMessage=function(e,n){console.log("[Facebook] postMessage (not used): "+e,n)},o.trackEvent=function(e,n){if("undefined"!=typeof FBInstant)try{FBInstant.logEvent(e,(null==n?void 0:n.value)||1,n||{}),console.log("[Facebook] Event logged: "+e)}catch(e){console.warn("[Facebook] Log event failed:",e)}},o.getSafeAreaTop=function(){return 0},o.getVersion=function(){return"undefined"!=typeof FBInstant?FBInstant.getSDKVersion():"1.0.0"},o.saveData=function(e,n){return new Promise((function(t,o){if("undefined"!=typeof FBInstant){var a={};a[e]=n,FBInstant.player.setDataAsync(a).then((function(){return console.log("[Facebook] Data saved: "+e),FBInstant.player.flushDataAsync()})).then((function(){t()})).catch((function(e){console.error("[Facebook] Save data failed:",e),t()}))}else t()}))},o.loadData=function(e){return new Promise((function(n){"undefined"!=typeof FBInstant?FBInstant.player.getDataAsync([e]).then((function(t){var o=t[e];console.log("[Facebook] Data loaded: "+e),n(void 0!==o?String(o):null)})).catch((function(e){console.error("[Facebook] Load data failed:",e),n(null)})):n(null)}))},o.getLanguage=function(){if("undefined"!=typeof FBInstant){var e=FBInstant.getLocale();return e?e.split("_")[0]:"en"}return"en"},o.gameReady=function(){console.log("[Facebook] gameReady (already called in initAsync)")},o.gameplayStart=function(){console.log("[Facebook] Gameplay started")},o.gameplayStop=function(){console.log("[Facebook] Gameplay stopped")},e}());o._RF.pop()}}}));

System.register("chunks:///_virtual/FallBlock.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EctypeMgr.ts","./Utils.ts"],(function(t){var i,n,e,a,r,o,l,c,s,u,p,f,h,y;return{setters:[function(t){i=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){r=t.cclegacy,o=t.Node,l=t.Sprite,c=t.Animation,s=t._decorator,u=t.UITransform,p=t.tween,f=t.Component},function(t){h=t.EctypeMgr},function(t){y=t.Utils}],execute:function(){var g,b,d,v,m,S,k,w,z,B,F,N,P;r._RF.push({},"a1638eqUspO4pYf/JdIP3PB","FallBlock",void 0);var E=s,D=E.ccclass,I=E.property;t("FallBlock",(g=D("Ectype/FallDown/FallBlock"),b=I(o),d=I(o),v=I(l),m=I(o),S=I(c),g((z=i((w=function(t){function i(){for(var i,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return i=t.call.apply(t,[this].concat(r))||this,e(i,"block",z,a(i)),e(i,"shain",B,a(i)),e(i,"graySp",F,a(i)),e(i,"shainNode",N,a(i)),e(i,"anim",P,a(i)),i}n(i,t);var r=i.prototype;return r.setBlock=function(t){this.block.active=t,this.shain.active=!t,this.graySp.node.active=!1,this.shainNode.active=!1},r.initPos=function(t,i,n,e){var a=h.I.bWid;this.node.getComponent(u).setContentSize(a,a);var r=a/2-(a+0)*n/2+(a+0)*i,o=-a/2+(a+0)*e/2-(a+0)*t;this.node.setPosition(r,o)},r.playGrayEffect=function(t){this.graySp.fillRange=0,this.graySp.node.active=!0,p(this.graySp).to(.005,{fillRange:-1}).call((function(){t()})).start()},r.hideGrayEffect=function(){this.graySp.node.active=!1},r.playShainAnim=function(){var t=this;this.shainNode.active=!0,this.anim.play(),y.wait(500).then((function(){t.shainNode.active=!1,t.anim.stop()}))},i}(f)).prototype,"block",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(w.prototype,"shain",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=i(w.prototype,"graySp",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=i(w.prototype,"shainNode",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=i(w.prototype,"anim",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=w))||k));r._RF.pop()}}}));

System.register("chunks:///_virtual/FallBlocks.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./EctypeMgr.ts","./FallBlock.ts"],(function(t){var e,n,o,i,l,r,s,a,c,u,f,h,p,g,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized,l=t.createForOfIteratorHelperLoose,r=t.createClass},function(t){s=t.cclegacy,a=t.UITransform,c=t.Node,u=t._decorator,f=t.Component},function(t){h=t.default,p=t.PoolName},function(t){g=t.EctypeMgr},function(t){d=t.FallBlock}],execute:function(){var k,b,y,v,B,F,m;s._RF.push({},"5ea87FJ7W1HPqgWgDXyZpbt","FallBlocks",void 0);var _=u,x=_.ccclass,E=_.property;t("FallBlocks",(k=x("Ectype/FallDown/FallBlocks"),b=E(a),y=E(c),k((F=e((B=function(t){function e(){for(var e,n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return e=t.call.apply(t,[this].concat(l))||this,o(e,"trans",F,i(e)),o(e,"box",m,i(e)),e.blocks=[],e._list=void 0,e}n(e,t);var s=e.prototype;return s.putBlocks=function(){if(this.blocks.length>0){for(var t,e=l(this.blocks);!(t=e()).done;){var n=t.value;h.put(p.fallBlock,n.node)}this.blocks=[]}},s.clearBlocks=function(){this._list=[],this.putBlocks()},s.playGrayEffect=function(){if(this.blocks.length>0)for(var t,e=l(this.blocks);!(t=e()).done;){t.value.playGrayEffect((function(){}))}},s.hideGrayEffect=function(){if(this.blocks.length>0)for(var t,e=l(this.blocks);!(t=e()).done;){t.value.hideGrayEffect()}},s.createBlocks=function(t){this._list=t,this.putBlocks();for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)if(0!=t[e][n]){var o=h.get(p.fallBlock);this.box.addChild(o);var i=o.getComponent(d);i.setBlock(!0),i.initPos(e,n,t[0].length,t.length),this.blocks.push(i)}this.updateBundingBox()},s.updateBundingBox=function(){var t=Math.max.apply(Math,this.list.map((function(t){return t.length}))),e=this.list.length;this.trans.setContentSize(t*g.I.bWid,e*g.I.bWid)},s.getWidth=function(){return this.trans.width},s.getHeight=function(){return this.trans.height},r(e,[{key:"list",get:function(){return this._list}}]),e}(f)).prototype,"trans",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=e(B.prototype,"box",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=B))||v));s._RF.pop()}}}));

System.register("chunks:///_virtual/FallDownGameView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EctypeMgr.ts","./Enum.ts","./PoolManager.ts","./FallBlocks.ts","./Utils.ts","./FallBlock.ts","./GameConst.ts","./TopUICom.ts","./Tips.ts","./UIManager.ts","./AudioManager.ts","./GameData.ts","./SdkTools.ts","./I18nManager.ts","./PlatformManager.ts"],(function(t){var e,n,i,o,a,s,r,l,c,h,u,f,d,p,g,_,m,b,k,I,v,x,w,B,y,E,P,C,S,D,L,N,T,M,F,W,R,A,O,U,G,H,V,X,z,K;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.createForOfIteratorHelperLoose,s=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){l=t.cclegacy,c=t.Node,h=t.SpriteFrame,u=t._decorator,f=t.easing,d=t.find,p=t.Widget,g=t.UITransform,_=t.view,m=t.Label,b=t.Layout,k=t.Vec3,I=t.sys,v=t.v3,x=t.NodeEventType,w=t.ParticleSystem2D,B=t.UIOpacity,y=t.tween,E=t.lerp,P=t.instantiate,C=t.Component,S=t.v2},function(t){D=t.EctypeMgr},function(t){L=t.GameStatus},function(t){N=t.default,T=t.PoolName},function(t){M=t.FallBlocks},function(t){F=t.Utils},function(t){W=t.FallBlock},function(t){R=t.default},function(t){A=t.TopUICom},function(t){O=t.default},function(t){U=t.default,G=t.PanelType},function(t){H=t.AudioManager},function(t){V=t.GameData},function(t){X=t.SdkTools},function(t){z=t.I18n},function(t){K=t.PlatformManager}],execute:function(){var Y,Z,j,q,J,Q,$,tt,et,nt,it,ot,at,st,rt,lt,ct;l._RF.push({},"c9c15utyFBDR6Ff1vlrn2gX","FallDownGameView",void 0),console.log("[Load] Loading FallDownGameView.ts");var ht=u,ut=ht.ccclass,ft=ht.property,dt=function(t){return t[t.Full=0]="Full",t[t.NoPut=1]="NoPut",t}(dt||{});t("FallDownGameView",(Y=ut("Ectype/FallDown/FallDownGameView"),Z=ft(A),j=ft(c),q=ft(c),J=ft(c),Q=ft(c),$=ft(M),tt=ft(h),Y((it=e((nt=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,i(e,"topUI",it,o(e)),i(e,"chestNode",ot,o(e)),i(e,"bgBox",at,o(e)),i(e,"boxNode",st,o(e)),i(e,"fallDownShain",rt,o(e)),i(e,"fallBlock",lt,o(e)),i(e,"frames",ct,o(e)),e._blocks=[],e._shainBlocks=[],e._startId=0,e._bottomAdd=0,e._moveEasing=f.quadIn,e._boxOriginY=0,e._startPos=null,e._delX=0,e._isRotate=!0,e._touchTime=0,e.SLIDE_THRESHOLD=-50,e.CHECK_TIME=50,e._autoFallTime=0,e._curBlockData=null,e._targetList=[],e._boxOffect=0,e._speed=10,e._spIdx=0,e._spAddMul=1e3,e}n(e,t);var l=e.prototype;return l.onLoad=function(){var t=this;D.I.init(),this.adapterView(),this.initI18nLabels(),z.on((function(){t.initI18nLabels()}),this)},l.start=function(){var t=this;this.scheduleOnce((function(){t.adaptBgNode("bg"),t.adaptBgNode("top/top_bg")}),0)},l.adaptBgNode=function(t){var e=this.node.getChildByName(t);if(e||(e=d(t,this.node)),e||t.includes("top_bg")&&this.topUI&&(e=this.topUI.node.getChildByName("top_bg")),e){var n=e.getComponent(p);n&&(n.enabled=!1);var i=e.getComponent(g);if(i){var o=_.getVisibleSize(),a=i.width,s=i.height;if(t.includes("top_bg"))i.setContentSize(o.width,s),console.log("[FallDownGameView] "+t+" width adapted: "+a+" -> "+o.width);else{var r=o.width/a,l=o.height/s,c=Math.max(r,l),h=a*c,u=s*c;i.setContentSize(h,u),console.log("[FallDownGameView] "+t+" adapted: "+a+"x"+s+" -> "+h.toFixed(0)+"x"+u.toFixed(0))}}}},l.initI18nLabels=function(){for(var t=0,e=[{name:"change_prop_label",key:"falldown.swap",maxWidth:75,offsetX:10},{name:"eliminate_prop_label",key:"falldown.eliminate",maxWidth:75,offsetX:10},{name:"top_score_title",key:"falldown.best_score"},{name:"next_label",key:"falldown.next_block"}];t<e.length;t++){var n=e[t],i=this.findNodeByName(this.node,n.name);if(i){var o=i.getComponent(m);if(o){var a;o.string=z.t(n.key);var s=null==(a=i.parent)?void 0:a.getComponent(b);if(s&&s.type===b.Type.HORIZONTAL)n.offsetX&&s.spacingX<10&&(s.spacingX+=n.offsetX,s.updateLayout());else if(n.offsetX){var r=i.position.clone();r.x+=n.offsetX,i.setPosition(r)}if(n.maxWidth){o.updateRenderData(!0);var l=i.getComponent(g);if(l&&l.width>n.maxWidth){var c=n.maxWidth/l.width;i.scale=new k(c,c,1)}else i.scale=new k(1,1,1)}}}}},l.findNodeByName=function(t,e){for(var n,i=a(t.children);!(n=i()).done;){var o=n.value;if(o.name===e)return o;var s=this.findNodeByName(o,e);if(s)return s}return null},l.adapterView=function(){var t=this.topUI.getComponent(p),e=_.getVisibleSize(),n=0;I.isNative?n=K.getInstance().current.getSafeAreaTop():"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Platform&&(n=PUCHI_SDK.Platform.getSafeAreaTop());var i=this.topUI.node.getComponent(g).height,o=this.chestNode.getComponent(p).bottom,a=this.chestNode.getComponent(g),s=a.width-50;D.I.bWid=s/D.I.boxRowLen;var r=e.height-50-o-(n+i),l=Math.floor(r/D.I.bWid)*D.I.bWid;this.chestNode.setPosition(v(0,-(n+i)/2,0)),a.height=l+50,this.initBgBox(a.width-50,a.height-50),t.top=n+(r-l),t.updateAlignment(),this._boxOriginY=-(a.height-50)/2},l.onEnable=function(){this.chestNode.on(x.TOUCH_START,this._onTouchStart,this),this.chestNode.on(x.TOUCH_MOVE,this._onTouchMove,this),this.chestNode.on(x.TOUCH_END,this._onTouchEnd,this),this.chestNode.on(x.TOUCH_CANCEL,this._onTouchEnd,this)},l.onDisable=function(){this.chestNode.off(x.TOUCH_START,this._onTouchStart,this),this.chestNode.off(x.TOUCH_MOVE,this._onTouchMove,this),this.chestNode.off(x.TOUCH_END,this._onTouchEnd,this),this.chestNode.off(x.TOUCH_CANCEL,this._onTouchEnd,this)},l._onTouchStart=function(t){D.I.gameStatus===L.Game&&(this._delX=0,this._curBlockData?(this._startPos=t.getUILocation(),this._isRotate=!0,this._touchTime=performance.now()):(this._startPos=null,this._isRotate=!1))},l._onTouchMove=function(t){if(D.I.gameStatus===L.Game&&this._startPos&&this._curBlockData){var e=t.getUILocation().y-this._startPos.y,n=performance.now()-this._touchTime;if(e<=this.SLIDE_THRESHOLD&&n<=this.CHECK_TIME)return this._isRotate=!1,this.blockFallDown(),this._startPos=null,void(this._touchTime=performance.now());n>this.CHECK_TIME&&(this._startPos=t.getUILocation(),this._touchTime=performance.now());var i=t.getUIDelta();if(this._delX+=i.x,Math.abs(this._delX)>D.I.bWid){this._isRotate=!1;var o=this._delX<0?-1:1;this._delX+=-1*o*D.I.bWid;var a=this._startId+o;a<0?a=0:a>D.I.boxRowLen-1&&(a=D.I.boxRowLen-1);var s=D.I.getColList(this._blocks,a).map((function(t){return t?1:0})),r=s.indexOf(1),l=-1===r?0:s.length-(r+1);if(D.I.boxColLen-l-this._curBlockData.length-2<0)return;var c=this.fallBlock.node.getPosition().x+o*D.I.bWid,h=this.chestNode.getComponent(g),u=this.fallBlock.getWidth(),f=-(h.width-50)/2+u/2,d=(h.width-50)/2-u/2;return c<f?c=f:c>d&&(c=d),this.fallBlock.node.setPosition(v(c,this.fallBlock.node.getPosition().y,0)),this.fallDownShain.setPosition(v(c,0,0)),this.updateStartId(),this.updateShainBlocks(),this._startPos=t.getUILocation(),void(this._touchTime=performance.now())}}},l._onTouchEnd=function(t){this._startPos=null,this._isRotate&&D.I.gameStatus===L.Game&&(H.I.playEffect("ItemRotate"),this._curBlockData=F.rotate90Clockwise(this._curBlockData),this.updateFallBlock())},l.blockFallDown=function(){var t=s(r().mark((function t(){var e,n,i,o,a,s,l,c,h,u,f,d,p=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._curBlockData,n=this.getMinMixNum(e[0].length,e),i=D.I.boxColLen-(2+e.length)-this._blocks.length+n,this._curBlockData=null,o=this._targetList,s=(a=i<=1?1:i-1)*D.I.bWid,this._targetList=[],l=0,c=[],h=[],u=[],o.forEach((function(t,n){var i=o.length-1-n,r=t[0][1];h.push(r);var f=null;f=r<0?new Array(D.I.boxRowLen).fill(null):p._blocks[r],t.forEach((function(t){var n=t[0];if(1===e[i][n-p._startId]){var o=p.getBlockNode(!0);p.boxNode.addChild(o);var h=p.getPosByIdx(r+p._bottomAdd+l,n);o.setPosition(v(h.x,h.y+s)),c.push(new Promise((function(t){y(o).to(a*R.MOVE_SPEED,{position:v(h.x,h.y)},{easing:p._moveEasing}).call((function(){t(),o.getComponent(W).playShainAnim()})).start()}))),f[n]=o,u[0]=u[0]?Math.max(h.y,u[0]):h.y,u[1]=u[1]?Math.max(h.x,u[1]):h.x,u[2]=u[2]?Math.min(h.y,u[2]):h.y,u[3]=u[3]?Math.min(h.x,u[3]):h.x}})),r<0?(p._blocks.unshift(f),l+=1):p._blocks[r]=f})),this.clearFallBlock(),t.next=16,Promise.all(c);case 16:return H.I.playEffect("BlockFallEnd"),t.next=19,F.wait(100);case 19:return this.updateShainBlocks(),this.playDownEffect(v((u[1]+u[3])/2,(u[0]+u[2])/2)),f=this.getCheckIds(h),t.next=24,this.checkEliminate(f);case 24:if(d=t.sent,this._autoFallTime=0,!(d>-1)){t.next=29;break}return t.next=29,this.autoBlockDown(d);case 29:this.freshFallBlock();case 30:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.playDownEffect=function(t){V.data.vibrate&&(I.isNative?K.getInstance().current.vibrateShort():"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Platform&&PUCHI_SDK.Platform.vibrateShort());var e=N.get(T.itemParticles);e.setPosition(t),this.boxNode.addChild(e);var n=e.getComponentsInChildren(w);n.forEach((function(t){t.resetSystem()}));var i=e.getChildByName("mt"),o=e.getChildByName("mb");i.setPosition(k.ZERO),o.setPosition(k.ZERO);var a=i.getComponent(B),s=o.getComponent(B);y(i).to(.4,{position:v(0,150)},{onUpdate:function(t,e){i.setPosition(v(0,E(0,150,e))),a.opacity=E(255,0,e)}}).start(),y(o).to(.4,{position:v(0,-150)},{onUpdate:function(t,e){o.setPosition(v(0,E(0,-150,e))),s.opacity=E(255,0,e)}}).start(),F.wait(300).then((function(){n.forEach((function(t){t.stopSystem()}))})),F.wait(500).then((function(){N.put(T.itemParticles,e)}))},l.autoBlockDown=function(){var t=s(r().mark((function t(e){var n,i,o,a,s,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this._autoFallTime>=3)){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,F.wait(200);case 4:if(n=e+1,!this._blocks[n]){t.next=21;break}if(i=this._blocks[n],!((o=this.findEmptyList(i)).length>0)){t.next=21;break}return t.next=11,this.autoDownMove(e,o);case 11:if(!((a=t.sent).length>0)){t.next=21;break}return s=this.getCheckIds(a),t.next=16,this.checkEliminate(s);case 16:if(l=t.sent,this._autoFallTime+=1,!(l>-1)){t.next=21;break}return t.next=21,this.autoBlockDown(l);case 21:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),l.findEmptyList=function(t){for(var e=[],n=t.length-1;n>=0;n--)null==t[n]&&e.push(n);return e},l.autoDownMove=function(){var t=s(r().mark((function t(e,n){var i,o,a,s,l,c,h,u,f,d,p,g,_=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=[],o=[],a=0;case 3:if(!(a<n.length)){t.next=22;break}s=n[a],l=D.I.getColList(this._blocks,s),c=l.filter((function(t,n){return n<=e})),h=l.filter((function(t,n){return n>e})),u=h.findIndex((function(t){return null!=t})),f=c.filter((function(t){return null!=t})),-1===u&&(u=h.length),d=c.length+u-1,p=r().mark((function t(){var e,n,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=f.pop())?(o.includes(g)||o.push(g),_._blocks[g][s]=e,n=_.getPosByIdx(g+_._bottomAdd,s),a=Math.abs(n.y-e.getPosition().y)/D.I.bWid,i.push(new Promise((function(t){y(e).to(R.AUTO_MOVE_SPEED*a,{position:n},{easing:_._moveEasing}).call((function(){t()})).start()})))):_._blocks[g][s]=null;case 2:case"end":return t.stop()}}),t)})),g=d;case 14:if(!(g>=0)){t.next=19;break}return t.delegateYield(p(),"t0",16);case 16:g--,t.next=14;break;case 19:a++,t.next=3;break;case 22:return t.next=24,Promise.all(i);case 24:return t.abrupt("return",o);case 25:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),l.getCheckIds=function(t){var e=t.filter((function(t){return t<0}));e.length<=0&&(e=[0]);var n=Math.min.apply(Math,e);return t.filter((function(t){return t>=0})).map((function(t){return t+Math.abs(n)}))},l.checkEliminate=function(){var t=s(r().mark((function t(e){var n,i,o,s,l,c,h,u,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=-1,e=e.sort((function(t,e){return e-t})),i=0,o=0;o<e.length;o++)if(s=e[o],l=this._blocks[s],l.every((function(t){return null!==t}))){for(n=Math.max(n,s),c=a(l);!(h=c()).done;)u=h.value,N.put(T.fallBlock,u);i+=1,this._blocks.splice(s,1),this.playEliminateEffect(v(0,l[0].getPosition().y))}if(!(i>0)){t.next=15;break}return D.I.addScore((i>1?R.ELIMINATE_DOUBLE:R.ELIMINATE_SINGLE)*i),this.topUI.freshScore(),f=e[0],H.I.playEffect("Eliminate"),t.next=11,F.wait(200);case 11:return t.next=13,this.eliminateMove(f-i);case 13:return this.checkNewSpeed(),t.abrupt("return",n-i);case 15:return t.abrupt("return",n);case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),l.playEliminateEffect=function(){var t=s(r().mark((function t(e){var n,i,o=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=r().mark((function t(){var n,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.y+=F.random(-5,5),t.next=3,F.wait(i<3?0:30);case 3:(n=N.get(T.breakParticles)).setPosition(e),o.boxNode.addChild(n),(a=n.getComponent(w)).resetSystem(),a.spriteFrame=o.frames[i],i<=3?(a.gravity=S(0,1500),y(a).to(.3,{gravity:S(0,-3e3)}).start()):a.gravity=S(0,-3e3),F.wait(1e3).then((function(){N.put(T.breakParticles,n)}));case 11:case"end":return t.stop()}}),t)})),i=0;case 2:if(!(i<10)){t.next=7;break}return t.delegateYield(n(),"t0",4);case 4:i++,t.next=2;break;case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l.eliminateMove=function(){var t=s(r().mark((function t(e){var n,i,o,a,s=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],i=e;case 2:if(!(i>=0)){t.next=13;break}o=r().mark((function t(){var e,o,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=s.getPosByIdx(i+s._bottomAdd,a),(o=s._blocks[i][a])&&(l=Math.abs(e.y-o.getPosition().y)/D.I.bWid,n.push(new Promise((function(t){y(o).to(R.AUTO_MOVE_SPEED*l,{position:e},{easing:s._moveEasing}).call((function(){t()})).start()}))));case 3:case"end":return t.stop()}}),t)})),a=0;case 5:if(!(a<D.I.boxRowLen)){t.next=10;break}return t.delegateYield(o(),"t0",7);case 7:a++,t.next=5;break;case 10:i--,t.next=2;break;case 13:return t.next=15,Promise.all(n);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l.clearData=function(){var t=this._blocks.flat();if(t.length>0)for(var e,n=a(t);!(e=n()).done;){var i=e.value;i&&N.put(T.fallBlock,i)}this._blocks=[],this._boxOffect=0,this._bottomAdd=0,this._curBlockData=null,this._spIdx=0,this._speed=R.FALL_SPEED_LIST[0]},l.updateGameBox=function(){D.I.clearData(),this.clearData(),this.topUI.freshComponent(),this.boxNode.setPosition(0,this._boxOriginY);for(var t=D.I.getOriginCfgList(),e=-(D.I.boxRowLen-1)*D.I.bWid/2,n=(t.length-1)*D.I.bWid,i=0;i<t.length;i++){for(var o=t[i],a=new Array(D.I.boxRowLen).fill(null),s=0;s<D.I.boxRowLen;s++)if(!o.eList.includes(s)){var r=this.getBlockNode();a[s]=r,r.setPosition(e+s*D.I.bWid,n-(i+.5)*D.I.bWid),this.boxNode.addChild(r)}this._blocks.push(a)}this.freshFallBlock()},l.getBlockNode=function(t){void 0===t&&(t=!0);var e=N.get(T.fallBlock),n=e.getComponent(g);return e.getComponent(W).setBlock(t),n.setContentSize(D.I.bWid+1,D.I.bWid+1),e},l.addRowBlock=function(){for(var t=-(D.I.boxRowLen-1)*D.I.bWid/2,e=this.getPosByIdx(this._blocks.length+this._bottomAdd,0).y,n=D.I.getNextRow(),i=new Array(D.I.boxRowLen).fill(null),o=0;o<D.I.boxRowLen;o++)if(!n.includes(o)){var a=this.getBlockNode();i[o]=a,a.setPosition(t+o*D.I.bWid,e),this.boxNode.insertChild(a,0)}this._blocks.push(i)},l.getPosByIdx=function(t,e){var n=-(D.I.boxRowLen-1)*D.I.bWid/2,i=(this._blocks.length-1)*D.I.bWid;return v(n+e*D.I.bWid,i-(t+.5)*D.I.bWid)},l.freshFallBlock=function(){this._curBlockData||(this._curBlockData=D.I.getBlockData()),H.I.playEffect("ItemNew"),this.fallBlock.createBlocks(this._curBlockData);var t=this.fallBlock.getHeight(),e=this.fallBlock.getWidth(),n=this.chestNode.getComponent(g),i=(n.height-50)/2-2*D.I.bWid-t/2,o=-(n.width-50)/2+D.I.bWid*D.I.boxRowLen/2+e/2;this.fallBlock.node.setPosition(v(o,i)),this.fallDownShain.setPosition(v(o,0)),this.updateStartId(),this.updateLightInfo(),this.topUI.freshNextBlock(),this.checkFail()},l.updateFallBlock=function(){var t=this.fallBlock.getWidth();this.fallBlock.createBlocks(this._curBlockData);var e=this.fallBlock.getWidth(),n=this.fallBlock.getHeight(),i=this.chestNode.getComponent(g),o=this.fallBlock.node.getPosition().x+(e-t)/2,a=(i.height-50)/2-2*D.I.bWid-n/2,s=-(i.width-50)/2+e/2,r=(i.width-50)/2-e/2;o<s?o=s:o>r&&(o=r),this.fallBlock.node.setPosition(v(o,a)),this.fallDownShain.setPosition(v(o,0)),this.updateStartId(),this.updateLightInfo()},l.clearFallBlock=function(){this.fallBlock.clearBlocks(),this.updateLightInfo()},l.updateLightInfo=function(){var t=this.fallDownShain.getComponent(B);this._curBlockData?(t.opacity=255,this.fallDownShain.getComponent(g).width=this.fallBlock.getWidth(),this.fallDownShain.children.forEach((function(t){var e;null==(e=t.getComponent(p))||e.updateAlignment()})),this.updateShainBlocks()):t.opacity=0},l.updateStartId=function(){var t=this.fallBlock.node.getPosition(),e=this.fallBlock.getWidth(),n=this.chestNode.getComponent(g),i=t.x-e/2- -(n.width-50)/2;this._startId=Math.floor(i/D.I.bWid)},l.updateShainBlocks=function(){var t=this;if(this._shainBlocks.length>0)for(var e,n=a(this._shainBlocks);!(e=n()).done;){var i=e.value;N.put(T.fallBlock,i)}if(this._shainBlocks=[],this._curBlockData){for(var o=this._curBlockData,s=o[0].length,r=this.getMinMixNum(s,o),l=[],c=r-1;c>r-1-o.length;c--){for(var h=[],u=0;u<s;u++)h.push([u+this._startId,c]);l.push(h)}this._targetList=l,l.forEach((function(e,n){var i=l.length-1-n;e.forEach((function(e){var n=e[0],a=e[1];if(1===o[i][n-t._startId]){var s=t.getBlockNode(!1);t.boxNode.addChild(s);var r=t.getPosByIdx(a+t._bottomAdd,n);s.setPosition(r),t._shainBlocks.push(s)}}))}))}},l.getMinMixNum=function(t,e){for(var n=null,i=0;i<t;i++){var o=D.I.getColList(e,i),a=D.I.getColList(this._blocks,this._startId+i).map((function(t){return t?1:0})),s=o.lastIndexOf(1),r=a.indexOf(1),l=-1===s?o.length:o.length-1-s,c=-1===r?a.length:r;n=null===n?l+c:Math.min(n,l+c)}return n},l.checkFail=function(){if(this._blocks.length>=D.I.boxColLen)return this.onGameFail(dt.Full),!0;if(this._curBlockData){var t=this._curBlockData,e=t[0].length,n=this.getMinMixNum(e,t);if(this._curBlockData.length+2-n+this._blocks.length>=D.I.boxColLen)return this.onGameFail(dt.NoPut),!0}return!1},l.onGameFail=function(){var t=s(r().mark((function t(e){var n,i,o=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(D.I.gameStatus!==L.Fail){t.next=2;break}return t.abrupt("return");case 2:return D.I.gameStatus=L.Fail,D.I.addReviveCnt(1),t.next=6,this.playFailEffect();case 6:if(H.I.playEffect("defeat"),n=e===dt.Full?z.t("falldown.fail_full"):z.t("falldown.fail_touch"),!(D.I.failCnt>2)){t.next=11;break}return U.addPanel(G.FallFailPanel,this.updateGameBox.bind(this),n),t.abrupt("return");case 11:i=function(){o.removeTopRowBlocks(),o.fallBlock.hideGrayEffect(),o._blocks.flat().forEach((function(t){t&&t.getComponent(W).hideGrayEffect()}))},U.addPanel(G.FallRevivePanel,i,this.updateGameBox.bind(this),n);case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),l.playFailEffect=function(){var t=s(r().mark((function t(){var e,n,i,o,a=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.fallBlock.playGrayEffect(),e=0;case 2:if(!(e<this._blocks.length)){t.next=16;break}n=[],i=r().mark((function t(){var i,s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(i=a._blocks[e][o])&&(s=i.getComponent(W),n.push(new Promise((function(t){s.playGrayEffect((function(){t()}))}))));case 2:case"end":return t.stop()}}),t)})),o=0;case 6:if(!(o<this._blocks[e].length)){t.next=11;break}return t.delegateYield(i(),"t0",8);case 8:o++,t.next=6;break;case 11:return t.next=13,Promise.all(n);case 13:e++,t.next=2;break;case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.onGamePropChange=function(){var t=s(r().mark((function t(){var e;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._curBlockData&&D.I.gameStatus===L.Game){t.next=3;break}return O.show(z.t("tips.cannot_use_item")),t.abrupt("return");case 3:return D.I.gameStatus=L.Pause,t.next=6,X.share("fall_prop_change");case 6:e=t.sent,D.I.gameStatus=L.Game,0==e.code&&(this._curBlockData=R.CHANGE_BLOCK,this.freshFallBlock(),D.I.prop_change_cnt+=1);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.onGamePropEliminate=function(){var t=s(r().mark((function t(){var e;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._curBlockData&&!(this._blocks.length<=1)&&D.I.gameStatus===L.Game){t.next=3;break}return O.show(z.t("tips.cannot_use_item")),t.abrupt("return");case 3:return D.I.gameStatus=L.Pause,t.next=6,X.share("fall_prop_eliminate");case 6:e=t.sent,D.I.gameStatus=L.Game,0==e.code&&(this.removeTopRowBlocks(),D.I.prop_eliminate_cnt+=1);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.removeTopRowBlocks=function(){var t=R.ELIMINATE_PROP_ROW;this._blocks.length<R.ELIMINATE_PROP_ROW&&(t=this._blocks.length);var e=this._blocks.splice(0,t).flat(),n=[];if(e.length>0)for(var i,o=a(e);!(i=o()).done;){var s=i.value;if(s){var r=Math.floor(s.getPosition().y);n.includes(r)||n.push(r),N.put(T.fallBlock,s)}}for(var l=0;l<n.length;l++)this.playEliminateEffect(v(0,n[l],0));this.updateShainBlocks(),H.I.playEffect("Eliminate")},l.initBgBox=function(t,e){var n=Math.floor(e/D.I.bWid);D.I.boxColLen=n;var i=this.bgBox.getChildByName("bg_item");i.getComponent(g).setContentSize(D.I.bWid,D.I.bWid);for(var o=-t/2+D.I.bWid/2,a=-e/2+D.I.bWid/2,s=0;s<n;s++){for(var r=0;r<D.I.boxRowLen;r++){var l=null;l=0===s&&0===r?i:P(i),this.bgBox.addChild(l),l.setPosition(o,a),o+=D.I.bWid}o=-t/2+D.I.bWid/2,a+=D.I.bWid}},l.checkNewSpeed=function(){var t=D.I.score,e=R.FALL_SCORE_LIST;if(t<e[0])this._spIdx=0;else if(t>=e[e.length-1])this._spIdx=e.length-1;else{for(var n=0,i=0;i<e.length;i++)if(t>=e[i]&&t<e[i+1]){n=i;break}this._spIdx=n>e.length-1?e.length-1:n}},l.lateUpdate=function(t){if(D.I.gameStatus===L.Game){if(D.I.duration+=t,this._blocks.length<=5||D.I.gmRowAdd>0)this._speed<R.FALL_SPEED_MAX&&(this._speed+=t*this._spAddMul);else if(this._blocks.length>=10){var e=R.FALL_SPEED_LIST[this._spIdx];this._speed!==e&&(Math.abs(this._speed-e)<.017*this._spAddMul?this._speed=e:this._speed>R.FALL_SPEED_LIST[this._spIdx]?this._speed-=t*this._spAddMul:this._speed+=t*this._spAddMul)}var n=this.boxNode.getPosition(),i=t*this._speed;if(this.boxNode.setPosition(n.add3f(0,i,0)),this._boxOffect+=i,this._boxOffect>=D.I.bWid){if(this.checkFail())return;D.I.gmRowAdd-=1,this._boxOffect-=D.I.bWid,this.addRowBlock(),this._bottomAdd+=1,this.updateShainBlocks()}}},e}(C)).prototype,"topUI",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ot=e(nt.prototype,"chestNode",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=e(nt.prototype,"bgBox",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),st=e(nt.prototype,"boxNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=e(nt.prototype,"fallDownShain",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt=e(nt.prototype,"fallBlock",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ct=e(nt.prototype,"frames",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),et=nt))||et));l._RF.pop()}}}));

System.register("chunks:///_virtual/FallFailPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./EctypeMgr.ts","./Enum.ts","./EventManager.ts","./GameData.ts","./TDataMgr.ts","./I18nImageText.ts","./I18nManager.ts","./PlatformManager.ts"],(function(e){var t,n,a,l,o,i,r,c,s,u,f,p,h,d,g,I,m,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){o=e.cclegacy,i=e.Label,r=e._decorator,c=e.Color},function(e){s=e.default},function(e){u=e.EctypeMgr},function(e){f=e.GameStatus,p=e.EventType},function(e){h=e.default},function(e){d=e.GameData},function(e){g=e.TDataMgr},function(e){I=e.I18nImageText},function(e){m=e.I18n},function(e){y=e.PlatformManager}],execute:function(){var _,b,w,v,L,S,C;o._RF.push({},"066f9lRwR5LC5n+QfYOHOK3","FallFailPanel",void 0);var M=r,F=M.ccclass,T=M.property;e("default",(_=F("Ectype/FallDown/Panel/FallFailPanel"),b=T(i),w=T(i),_((S=t((L=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o))||this,a(t,"scoreLabel",S,l(t)),a(t,"topScoreLabel",C,l(t)),t._replayCall=null,t}n(t,e);var o=t.prototype;return o.onEnable=function(){this.initI18nLabels()},o.initI18nLabels=function(){var e=this.node.getChildByPath("content/label");if(e){var t=e.getComponent(i);t&&(t.string=m.t("falldown.this_score"))}I.replaceImageTexts(this.node,[{nodeName:"shibai_wujin_word",i18nKey:"falldown.title_over",outlineColor:new c(0,60,160,255),outlineWidth:6,fontSize:70},{nodeName:"word_1",i18nKey:"falldown.btn_home",outlineColor:new c(160,80,10,255),outlineWidth:4,fontSize:50},{nodeName:"zhuye_word_6",i18nKey:"falldown.btn_restart",outlineColor:new c(35,120,30,255),outlineWidth:4,fontSize:50}])},o.init=function(e,t){this._replayCall=e,this.scoreLabel.string=""+u.I.score,this.topScoreLabel.string=m.t("falldown.best_score_full",d.data.fallTopScore),d.data.fallTopScore=Math.max(d.data.fallTopScore,u.I.score),this.reportFail(t)},o.onReplayClick=function(){var e;this.close(),null==(e=this._replayCall)||e.call(this),u.I.gameStatus=f.Game,g.ins.fallLevelStart("失败界面开始"),y.getInstance().current.showInterstitial()},o.onHomeClick=function(){this.close(),u.I.gameStatus=f.None,h.I.emit(p.GO_HOME),y.getInstance().current.showInterstitial()},o.reportFail=function(e){g.ins.fallLevelEnd(Math.floor(u.I.duration),e,d.data.fallTopScore,u.I.score,u.I.nextLock?0:1,u.I.prop_change_cnt,u.I.prop_eliminate_cnt,u.I.reviveCnt)},t}(s)).prototype,"scoreLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(L.prototype,"topScoreLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=L))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/FallHelpPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./EctypeMgr.ts","./Enum.ts","./I18nManager.ts"],(function(t){var n,e,l,o,a,i,r,c;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,l=t.Label,o=t._decorator},function(t){a=t.default},function(t){i=t.EctypeMgr},function(t){r=t.GameStatus},function(t){c=t.I18n}],execute:function(){var s;e._RF.push({},"54677xN4cZOaYuQLDa9RgkW","FallHelpPanel",void 0);var u=o,f=u.ccclass;u.property,t("FallHelpPanel",f("Ectype/FallDown/Panel/FallHelpPanel")(s=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.onEnable=function(){this.initI18nLabels()},o.initI18nLabels=function(){var t=this.node.getChildByPath("content/board/title");if(t){var n=t.getComponent(l);n&&(n.string=c.t("falldown.how_to_play"))}var e=this.node.getChildByPath("content/board/layoutR");if(e)for(var o=e.children,a=["falldown.move_hint","falldown.rotate_hint","falldown.speed_hint"],i=0;i<o.length&&i<a.length;i++){var r=o[i].getComponent(l);r&&(r.string=c.t(a[i]),r.overflow=l.Overflow.SHRINK)}},o.onClose=function(){this.close(),i.I.gameStatus=r.Game},e}(a))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/FallPausePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./GameData.ts","./AudioManager.ts","./EctypeMgr.ts","./Enum.ts","./EventManager.ts","./UIManager.ts","./I18nManager.ts","./I18nImageText.ts"],(function(e){var t,n,i,a,s,o,r,l,u,c,d,f,g,h,v,b,p,I,m,P,N;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,s=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,r=e.Node,l=e.Label,u=e._decorator,c=e.Color},function(e){d=e.default},function(e){f=e.GameData},function(e){g=e.AudioManager},function(e){h=e.EctypeMgr},function(e){v=e.EventType,b=e.GameStatus},function(e){p=e.default},function(e){I=e.default,m=e.PanelType},function(e){P=e.I18n},function(e){N=e.I18nImageText}],execute:function(){var C,D,_,M,y,L,S;o._RF.push({},"c35cdNr61JNvp1nA4xfW5cf","FallPausePanel",void 0);var A=u,H=A.ccclass,E=A.property;e("default",(C=H("Ectype/FallDown/Panel/FallPausePanel"),D=E(r),_=E(l),C((L=t((y=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return t=e.call.apply(e,[this].concat(s))||this,i(t,"closeNodes",L,a(t)),i(t,"labVer",S,a(t)),t.i18nLabelMap=new Map,t}n(t,e);var o=t.prototype;return o.onEnable=function(){this.refreshI18n(),p.I.on(v.LANGUAGE_CHANGED,this.refreshI18n,this)},o.onDisable=function(){p.I.off(v.LANGUAGE_CHANGED,this.refreshI18n,this)},o.refreshI18n=function(){this.initI18nLabels(),this.initI18nImageTexts()},o.initI18nLabels=function(){for(var e,t={"音效":"settings.sound",Sound:"settings.sound","音乐":"settings.music",Music:"settings.music","震动":"settings.vibration",Vibrate:"settings.vibration",Vibration:"settings.vibration","语言":"settings.language",Language:"settings.language","设置":"settings.title",Settings:"settings.title"},n=this.node.getComponentsInChildren(l),i=s(n);!(e=i()).done;){var a=e.value,o=this.i18nLabelMap.get(a);if(!o){var r=a.string.trim();if(t[r])o=t[r];else for(var u in t)if(P.t(t[u])===r){o=t[u];break}o&&this.i18nLabelMap.set(a,o)}o&&(a.string=P.t(o))}var c=this.findLabel("label",0),d=this.findLabel("label",1);c&&!this.i18nLabelMap.has(c)&&(this.i18nLabelMap.set(c,"settings.sound"),c.string=P.t("settings.sound")),d&&!this.i18nLabelMap.has(d)&&(this.i18nLabelMap.set(d,"settings.vibration"),d.string=P.t("settings.vibration"))},o.findLabel=function(e,t){var n=0;return function i(a){for(var o,r=s(a.children);!(o=r()).done;){var u=o.value;if(u.name===e){if(n===t)return u.getComponent(l);n++}var c=i(u);if(c)return c}return null}(this.node)},o.initI18nImageTexts=function(){var e=new c(50,50,100,255),t=[{nodeName:"shezhi_word_1",i18nKey:"settings.title",outlineColor:e,outlineWidth:3},{nodeName:"shezhi_word_5",i18nKey:"settings.home",outlineColor:e,outlineWidth:2},{nodeName:"word_6",i18nKey:"game.continue",outlineColor:e,outlineWidth:2}];N.replaceImageTexts(this.node,t)},o.init=function(){this.closeNodes[0]&&(this.closeNodes[0].active=!f.data.vibrate),this.closeNodes[1]&&(this.closeNodes[1].active=!f.data.sound),this.closeNodes[2]&&(this.closeNodes[2].active=!f.data.music);var e="1.0.0";"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Platform&&PUCHI_SDK.Platform.getVersion?e=PUCHI_SDK.Platform.getVersion():"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.GAMEDATA&&(e=PUCHI_SDK.GAMEDATA.version);var t="0";"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.DataService&&(t=PUCHI_SDK.DataService.uid||"0"),this.labVer.string="v"+e+"_"+t},o.onHomeClick=function(){this.close(),h.I.gameStatus=b.None,p.I.emit(v.GO_HOME)},o.onContinueClick=function(){this.close(),h.I.gameStatus=b.Game},o.onCloseClick=function(){this.close(),h.I.gameStatus=b.Game},o.onVibrate=function(){f.data.vibrate=!f.data.vibrate,this.closeNodes[0]&&(this.closeNodes[0].active=!f.data.vibrate)},o.onSound=function(){f.data.sound=!f.data.sound,g.I.setEffect(f.data.sound),this.closeNodes[1]&&(this.closeNodes[1].active=!f.data.sound)},o.onMusic=function(){f.data.music=!f.data.music,g.I.setMusic(f.data.music),this.closeNodes[2]&&(this.closeNodes[2].active=!f.data.music)},o.onLanguageSwitch=function(){I.addPanel(m.LanguagePanel)},t}(d)).prototype,"closeNodes",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=t(y.prototype,"labVer",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=y))||M));o._RF.pop()}}}));

System.register("chunks:///_virtual/FallRevivePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./EctypeMgr.ts","./Enum.ts","./UIManager.ts","./TDataMgr.ts","./SdkTools.ts","./I18nImageText.ts","./I18nManager.ts"],(function(e){var t,i,n,a,r,l,o,s,u,c,h,f,v,p,m,g,_,d,y,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){o=e.cclegacy,s=e.Label,u=e.Sprite,c=e._decorator,h=e.Color},function(e){f=e.default},function(e){v=e.EctypeMgr},function(e){p=e.GameStatus},function(e){m=e.default,g=e.PanelType},function(e){_=e.TDataMgr},function(e){d=e.SdkTools},function(e){y=e.I18nImageText},function(e){w=e.I18n}],execute:function(){var T,C,b,I,P,z,S,O,R;o._RF.push({},"ca35eicwr1D27s+ZvfzAsp4","FallRevivePanel",void 0);var F=c,L=F.ccclass,M=F.property;e("default",(T=L("Ectype/FallDown/Panel/FallRevivePanel"),C=M(s),b=M(s),I=M(u),T((S=t((z=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,n(t,"score",S,a(t)),n(t,"remainTime",O,a(t)),n(t,"progress",R,a(t)),t._waitTime=5,t._timeOn=!0,t._result="",t._reviveCall=null,t._replayCall=null,t}i(t,e);var o=t.prototype;return o.onEnable=function(){this.initI18nLabels()},o.initI18nLabels=function(){var e=this.node.getChildByPath("content/label");if(e){var t=e.getComponent(s);t&&(t.string=w.t("falldown.this_score"))}var i=this.node.getChildByPath("content/tips");if(i){var n=i.getComponent(s);n&&(n.string=w.t("falldown.revive_desc","12"))}var a=this.node.getChildByPath("content/tips/tips-001");if(a)if("zh-CN"===w.currentLanguage||"zh-TW"===w.currentLanguage){a.active=!0;var r=a.getComponent(s);r&&(r.string=w.t("falldown.rows",12))}else a.active=!1;new h(160,60,0,255);y.replaceImageTexts(this.node,[{nodeName:"title",i18nKey:"falldown.title_revive",outlineColor:new h(160,45,0,255),outlineWidth:6,fontSize:70},{nodeName:"zhuye_word_6",i18nKey:"falldown.btn_revive",outlineColor:new h(13,71,143,255),outlineWidth:4,fontSize:50}])},o.init=function(e,t,i){this._reviveCall=e,this._replayCall=t,this.score.string=""+v.I.score,this._waitTime=5,this._timeOn=!0,this._result=i,_.ins.dot("video_exposure",{view_reason:"fall_revive"})},o.onAdReviveClick=function(){var e=r(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._timeOn=!1,e.next=3,d.share("fall_revive");case 3:0==e.sent.code?(this.close(),null==(t=this._reviveCall)||t.call(this),v.I.gameStatus=p.Game,v.I.reviveCnt+=1):this._timeOn=!0;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.onContinueClick=function(){var e;this.close(),null==(e=this._replayCall)||e.call(this),v.I.gameStatus=p.Game,_.ins.fallLevelStart("复活界面开始")},o.onTimeOut=function(){this._timeOn=!1,this.close(),m.addPanel(g.FallFailPanel,this._replayCall,this._result)},o.lateUpdate=function(e){if(this._timeOn)if(this._waitTime-=e,this._waitTime<=0)this._timeOn=!1,this.onTimeOut(),this.remainTime.string="0",this.progress.fillRange=0;else{var t=Math.ceil(this._waitTime);this.remainTime.string=""+t,this.progress.fillRange=this._waitTime/5}},t}(f)).prototype,"score",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(z.prototype,"remainTime",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(z.prototype,"progress",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=z))||P));o._RF.pop()}}}));

System.register("chunks:///_virtual/FirebaseManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(e,n){var a,r,o,i,t,s;return{setters:[function(e){a=e.createClass},function(e){r=e.cclegacy,o=e._decorator,i=e.native,t=e.sys},function(e){s=e.default}],execute:function(){var S,c;r._RF.push({},"8ca91Pb3NNKQ6/JU7fmGihx","FirebaseManager",void 0);var l=o.ccclass,g=(o.property,e("FIREBASE_EVENTS",{LOGIN_SUCCESS:"FIREBASE_LOGIN_SUCCESS",LOGIN_FAIL:"FIREBASE_LOGIN_FAIL",SAVE_SUCCESS:"FIREBASE_SAVE_SUCCESS",SAVE_FAIL:"FIREBASE_SAVE_FAIL",LOAD_SUCCESS:"FIREBASE_LOAD_SUCCESS",LOAD_FAIL:"FIREBASE_LOAD_FAIL"}));e("FirebaseManager",l("FirebaseManager")(((c=function(){function e(){this.IOS_CLASS_NAME="FirebaseBridge",this.ANDROID_CLASS_NAME="com/cocos/game/FirebaseBridge",this.initNativeListeners()}var r=e.prototype;return r.initNativeListeners=function(){var e=this;i.jsbBridgeWrapper?(i.jsbBridgeWrapper.addNativeEventListener(g.LOGIN_SUCCESS,(function(n){console.log("[FirebaseManager] Login Success: "+n),s.I.emit(g.LOGIN_SUCCESS,n),e.trackSingularLogin(n)})),i.jsbBridgeWrapper.addNativeEventListener(g.LOGIN_FAIL,(function(e){console.error("[FirebaseManager] Login Failed: "+e),s.I.emit(g.LOGIN_FAIL,e)})),i.jsbBridgeWrapper.addNativeEventListener(g.SAVE_SUCCESS,(function(e){console.log("[FirebaseManager] Save Success"),s.I.emit(g.SAVE_SUCCESS)})),i.jsbBridgeWrapper.addNativeEventListener(g.SAVE_FAIL,(function(e){console.error("[FirebaseManager] Save Failed: "+e),s.I.emit(g.SAVE_FAIL,e)})),i.jsbBridgeWrapper.addNativeEventListener(g.LOAD_SUCCESS,(function(e){console.log("[FirebaseManager] Load Success");try{var n=JSON.parse(e);s.I.emit(g.LOAD_SUCCESS,n)}catch(e){console.error("[FirebaseManager] JSON Parse Error",e),s.I.emit(g.LOAD_FAIL,"JSON Parse Error")}})),i.jsbBridgeWrapper.addNativeEventListener(g.LOAD_FAIL,(function(e){console.error("[FirebaseManager] Load Failed: "+e),s.I.emit(g.LOAD_FAIL,e)}))):console.warn("[FirebaseManager] jsbBridgeWrapper not available (not native or old version)")},r.loginAnonymously=function(){var e=this;return new Promise((function(n,a){var r=function a(r){s.I.off(g.LOGIN_SUCCESS,a,e),s.I.off(g.LOGIN_FAIL,o,e),n(r)},o=function n(o){s.I.off(g.LOGIN_SUCCESS,r,e),s.I.off(g.LOGIN_FAIL,n,e),a(o)};s.I.on(g.LOGIN_SUCCESS,r,e),s.I.on(g.LOGIN_FAIL,o,e),console.log("[FirebaseManager] Requesting Anonymous Login..."),i.reflection&&t.os===t.OS.IOS?i.reflection.callStaticMethod(e.IOS_CLASS_NAME,"loginAnonymously"):i.reflection&&t.os===t.OS.ANDROID?i.reflection.callStaticMethod(e.ANDROID_CLASS_NAME,"loginAnonymously","()V"):(console.warn("[FirebaseManager] Not Native environment, skipping login."),s.I.emit(g.LOGIN_SUCCESS,"mock_user_id"))}))},r.loadUserDataAsync=function(){var e=this;return new Promise((function(n,a){var r=function a(r){s.I.off(g.LOAD_SUCCESS,a,e),s.I.off(g.LOAD_FAIL,o,e),n(r)},o=function a(o){s.I.off(g.LOAD_SUCCESS,r,e),s.I.off(g.LOAD_FAIL,a,e),n({})};s.I.on(g.LOAD_SUCCESS,r,e),s.I.on(g.LOAD_FAIL,o,e),e.loadUserData()}))},r.saveUserData=function(e){if(console.log("[FirebaseManager] Saving User Data...",e),!i.reflection||t.os!==t.OS.IOS&&t.os!==t.OS.ANDROID)console.warn("[FirebaseManager] Not iOS/Android Native environment, skipping save."),s.I.emit(g.SAVE_SUCCESS);else try{var n=JSON.stringify(e),a=btoa(unescape(encodeURIComponent(n)));console.log("[FirebaseManager] Saving Base64 data length:",a.length),t.os===t.OS.IOS?i.reflection.callStaticMethod(this.IOS_CLASS_NAME,"saveUserData:",a):t.os===t.OS.ANDROID&&i.reflection.callStaticMethod(this.ANDROID_CLASS_NAME,"saveUserData","(Ljava/lang/String;)V",a)}catch(e){console.error("[FirebaseManager] Base64 encode or Save failed:",e)}},r.loadUserData=function(){console.log("[FirebaseManager] Loading User Data..."),i.reflection&&t.os===t.OS.IOS?i.reflection.callStaticMethod(this.IOS_CLASS_NAME,"loadUserData"):i.reflection&&t.os===t.OS.ANDROID?i.reflection.callStaticMethod(this.ANDROID_CLASS_NAME,"loadUserData","()V"):(console.warn("[FirebaseManager] Not iOS/Android Native environment, skipping load."),s.I.emit(g.LOAD_SUCCESS,{}))},r.logEvent=function(e,a){if(void 0===a&&(a={}),e)if(console.log("[FirebaseManager] logEvent: "+e,a),!i.reflection||t.os!==t.OS.IOS&&t.os!==t.OS.ANDROID)t.isNative||n.import("./FirebaseWebManager.ts").then((function(n){n.FirebaseWebManager.instance.logEvent(e,a)})).catch((function(e){console.warn("[FirebaseManager] FirebaseWebManager import failed:",e)}));else try{var r=JSON.stringify(a);t.os===t.OS.IOS?i.reflection.callStaticMethod(this.IOS_CLASS_NAME,"logEvent:params:",e,r):t.os===t.OS.ANDROID&&i.reflection.callStaticMethod(this.ANDROID_CLASS_NAME,"logEvent","(Ljava/lang/String;Ljava/lang/String;)V",e,r)}catch(e){console.error("[FirebaseManager] logEvent failed:",e)}},r.trackSingularLogin=function(e){n.import("cc").then((function(a){var r=a.sys;r.os!==r.OS.IOS?n.import("./ChannelMgr.ts").then((function(a){var r=a.ChannelMgr.getChannelId();"google"===r?n.import("./SingularMgr.ts").then((function(n){var a=n.SingularMgr;console.log("[FirebaseManager] Tracking Singular sngLogin for Google channel"),a.I.trackLogin(e),a.I.setCustomUserId(e)})).catch((function(e){return console.error("[FirebaseManager] Failed to import SingularMgr:",e)})):console.log("[FirebaseManager] Skip Singular login for channel: "+r)})).catch((function(e){return console.error("[FirebaseManager] Failed to import ChannelMgr:",e)})):n.import("./SingularMgr.ts").then((function(n){var a=n.SingularMgr;console.log("[FirebaseManager] Tracking Singular sngLogin for iOS"),a.I.trackLogin(e),a.I.setCustomUserId(e)})).catch((function(e){return console.error("[FirebaseManager] Failed to import SingularMgr:",e)}))}))},a(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}())._instance=void 0,S=c))||S);r._RF.pop()}}}));

System.register("chunks:///_virtual/FirebaseWebConfig.ts",["cc"],(function(e){var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"07c6a02L9ZJFaXAzDZ1rl0w","FirebaseWebConfig",void 0);e("firebaseWebConfig",{apiKey:"AIzaSyB5dRi4FcLsfI6SgIIUIGXvr08bgTY_sI0",authDomain:"blockblast-af84d.firebaseapp.com",projectId:"blockblast-af84d",storageBucket:"blockblast-af84d.firebasestorage.app",messagingSenderId:"567838482114",appId:"1:567838482114:web:baf84b263a69c14251a55b",measurementId:"G-KKZSHWLBE1"});a._RF.pop()}}}));

System.register("chunks:///_virtual/FirebaseWebManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FirebaseWebConfig.ts"],(function(e){var i,n,a,t,r,s;return{setters:[function(e){i=e.extends,n=e.createClass,a=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){r=e.cclegacy},function(e){s=e.firebaseWebConfig}],execute:function(){function o(){if("undefined"==typeof window)return"unknown";var e=window.location.hostname,i=window.location.search;return window.Telegram&&window.Telegram.WebApp||i.includes("platform=telegram")?"telegram":window.vkBridge||i.includes("vk_app_id")||i.includes("vk_platform")||i.includes("platform=vk")?"vk":window.ysdk||window.YaGames||e.includes("yandex.net")||e.includes("yandex.com")||e.includes("yandex.ru")?"yandex":window.CrazyGames||e.includes("crazygames.com")||e.includes("1001juegos.com")?"crazygames":window.gdsdk||e.includes("gamedistribution.com")?"gamedistribution":window.PokiSDK||e.includes("poki.com")?"poki":"web_direct"}r._RF.push({},"aa7edEWli1HIbWlm6RzMMKp","FirebaseWebManager",void 0),e("FirebaseWebManager",function(){function e(){this._initialized=!1,this._analytics=null,this._channel="unknown"}var r=e.prototype;return r.init=function(){var e=a(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._initialized){e.next=3;break}return console.log("[FirebaseWebManager] Already initialized"),e.abrupt("return",!0);case 3:if("undefined"!=typeof firebase){e.next=6;break}return console.warn("[FirebaseWebManager] Firebase SDK not loaded. Please add Firebase scripts to index.html."),e.abrupt("return",!1);case 6:return e.prev=6,firebase.apps&&0!==firebase.apps.length||(firebase.initializeApp(s),console.log("[FirebaseWebManager] Firebase App initialized")),this._analytics=firebase.analytics(),this._initialized=!0,this._channel=o(),console.log("[FirebaseWebManager] Detected channel: "+this._channel),this.setUserProperty("channel",this._channel),this.setUserProperty("platform_type","web"),console.log("[FirebaseWebManager] Initialization complete"),e.abrupt("return",!0);case 18:return e.prev=18,e.t0=e.catch(6),console.error("[FirebaseWebManager] Initialization failed:",e.t0),e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,this,[[6,18]])})));return function(){return e.apply(this,arguments)}}(),r.logEvent=function(e,n){if(void 0===n&&(n={}),this._initialized&&this._analytics)try{var a=i({},n,{channel:this._channel});this._analytics.logEvent(e,a),console.log("[FirebaseWebManager] Event logged: "+e,a)}catch(e){console.error("[FirebaseWebManager] logEvent failed:",e)}else console.warn("[FirebaseWebManager] Not initialized, skipping event: "+e)},r.setUserProperty=function(e,i){if(this._initialized&&this._analytics)try{var n;this._analytics.setUserProperties(((n={})[e]=i,n)),console.log("[FirebaseWebManager] User property set: "+e+"="+i)}catch(e){console.error("[FirebaseWebManager] setUserProperty failed:",e)}else console.warn("[FirebaseWebManager] Not initialized, skipping setUserProperty: "+e)},r.setUserId=function(e){if(this._initialized&&this._analytics)try{this._analytics.setUserId(e),console.log("[FirebaseWebManager] User ID set: "+e)}catch(e){console.error("[FirebaseWebManager] setUserId failed:",e)}else console.warn("[FirebaseWebManager] Not initialized, skipping setUserId")},r.getChannel=function(){return this._channel},r.isInitialized=function(){return this._initialized},n(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}())._instance=void 0,r._RF.pop()}}}));

System.register("chunks:///_virtual/Game.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigExtension.ts","./ConfigManager.ts","./Enum.ts","./GameData.ts","./TDataMgr.ts","./EctypeMgr.ts","./EventManager.ts","./UIManager.ts","./Tips.ts","./BoardDataMgr.ts","./ComBox.ts","./DailyMgr.ts","./I18nManager.ts"],(function(e,t){var a,n,o,i,r,s,l,c,u,p,d,h,g,b,f,m,y,v,x,k,I,w,S,G,C,T,P,_,D,M,R;return{setters:[function(e){a=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e.Node,u=e.EditBox,p=e._decorator,d=e.UITransform,h=e.view,g=e.Component,b=e.Widget,f=e.sys},function(e){m=e.CollectData},function(e){y=e.ConfigManager},function(e){v=e.GameType,x=e.CollectType,k=e.EventType},function(e){I=e.GameData},function(e){w=e.TDataMgr},function(e){S=e.EctypeMgr},function(e){G=e.default},function(e){C=e.default,T=e.PanelType},function(e){P=e.default},function(e){_=e.BoardDataMgr},function(e){D=e.ComBox},function(e){M=e.DailyMgr},function(e){R=e.I18n}],execute:function(){var z,L,O,B,N,E,H,A,F,U,K;l._RF.push({},"7c9fcCr2x9GGIa8dXzjpypj","Game",void 0),console.log("[Load] Loading Game.ts");var V=p,W=V.ccclass,Y=V.property;e("Game",(z=W("game/Game"),L=Y(c),O=Y(D),B=Y(c),N=Y(u),z((A=a((H=function(e){function a(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return t=e.call.apply(e,[this].concat(n))||this,o(t,"home",A,i(t)),o(t,"box",F,i(t)),o(t,"groups",U,i(t)),o(t,"edit",K,i(t)),t.recommendPageManager=void 0,t}n(a,e);var l=a.prototype;return l.onLoad=function(){var e=r(s().mark((function e(){var a,n,o,i,r,l,u,p,g,m,y,v,x,w;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Game] Registering event listeners (sync)..."),G.I.on(k.REPLAY,this.onReplay,this),G.I.on(k.CHANGE_SKIN,this.onChangeSkin,this),G.I.on(k.NO_SKIN_ERROR,this.handleError,this),this.node.on(c.EventType.TOUCH_START,this.touchStart,this),G.I.on(k.SHOW_GM,this.showGm,this),console.log("[Game] Event listeners registered (sync)"),this.box.init(this),e.next=10,R.init();case 10:if(!f.isNative||f.os!==f.OS.IOS&&f.os!==f.OS.OSX&&f.os!==f.OS.ANDROID){e.next=40;break}return e.next=13,t.import("./FirebaseManager.ts");case 13:if(a=e.sent,a.FirebaseManager.instance.loginAnonymously().then((function(e){console.log("Firebase Logged in as",e),I.syncFromFirebase()})).catch((function(e){console.error("Firebase Login failed",e)})),f.os!==f.OS.ANDROID&&f.os!==f.OS.IOS){e.next=38;break}return e.next=19,t.import("./TopOnMgr.ts");case 19:if(n=e.sent,o=n.TopOnMgr,i="",r="",f.os!==f.OS.ANDROID){e.next=34;break}return e.next=26,t.import("./ChannelMgr.ts");case 26:l=e.sent,u=l.ChannelMgr,p=u.getChannelId(),console.log("[Game] Initializing TopOn for Android channel: "+p),i="h69429810d6690",r="ace93da4a88d60d8781dcb09d83bfdd0a",e.next=35;break;case 34:f.os===f.OS.IOS&&(console.log("[Game] Initializing TopOn for iOS"),i="h694b5e648d8bb",r="ac4627e58dbf3786442af4e99b66cc664");case 35:o.I.initSDK(i,r),console.log("[Game] Initializing TopOn Banner state (Hidden)"),o.I.hideBanner();case 38:e.next=41;break;case 40:!f.isNative&&window.Telegram&&window.Telegram.WebApp&&console.log("[Game] Telegram environment detected (handled in Main.ts)");case 41:g=this.node.getChildByName("top"),console.log("[Game] DEBUG: topNode exists: "+!!g),g&&(m=new URLSearchParams(window.location.search),y="yandex"===m.get("platform")||!!window.ysdk||!!window.YaGames,console.log("[Game] DEBUG: isYandex: "+y),y&&((v=g.getComponent(b))&&(v.isAlignTop=!0,v.top=0,v.isAbsoluteTop=!0,v.updateAlignment(),console.log("[Game] Yandex: Set top node to flush with screen top (top=0)")),x=h.getVisibleSize().height,1334,g.getComponent(d),x<1067.2&&(w=Math.max(.6,x/1334),g.setScale(w,w,1),console.log("[Game] Yandex: Scaling top node to "+w.toFixed(2)+" for short screen ("+x+"px)")))),this.edit.node.parent.active=!1;case 46:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.start=function(){this.adaptZhandouBg(),this.adaptZhandouBg2(),this.initI18nButtons()},l.initI18nButtons=function(){},l.replay=function(e){void 0===e&&(e=!1),this.box.play(_.I.type,e)},l.showGm=function(){this.edit.node.parent.parent.active=!this.edit.node.parent.parent.active},l.onTest=function(){var e=r(s().mark((function e(t,a){var n,o,i,r,l,c,u,p,d,h,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.edit.string,e.t0=+a,e.next=99===e.t0?4:1===e.t0?6:2===e.t0?11:3===e.t0?13:4===e.t0?15:5===e.t0?17:6===e.t0?22:7===e.t0?27:8===e.t0?29:9===e.t0?31:10===e.t0?34:11===e.t0?36:12===e.t0?39:13===e.t0?43:14===e.t0?69:15===e.t0?71:16===e.t0?73:17===e.t0?96:18===e.t0?100:19===e.t0?104:20===e.t0?106:109;break;case 4:return this.edit.node.parent.active=!this.edit.node.parent.active,e.abrupt("break",109);case 6:if(_.I.type==v.activity){if(+n>0&&(I.data.activityLevel=+n,this.onReplay(),24==+n))for(I.data.activityList=[],o=0;o<24;o++)I.data.activityList.push(o)}else _.I.type==v.daily?+n>0&&(M.I.testLv=+n,this.onReplay()):+n>0&&(I.data.level=+n,this.onReplay());return 998==+n&&(I.data.login_days=3,I.save()),997==+n&&(I.data.mapId=7),-99==+n&&(I.data.activityList=[]),e.abrupt("break",109);case 11:return this.onReplay(),e.abrupt("break",109);case 13:return this.box.updateGroups(),e.abrupt("break",109);case 15:return this.box.guideTips(),e.abrupt("break",109);case 17:if(_.I.type!=v.default){e.next=20;break}return P.show("无尽模式不可用"),e.abrupt("return");case 20:return _.I.type==v.level?I.data.level>1&&(I.data.level--,this.onReplay()):_.I.type==v.daily?M.I.testLv>1&&(M.I.testLv--,this.onReplay()):I.data.activityLevel>1&&(I.data.activityLevel--,this.onReplay()),e.abrupt("break",109);case 22:if(_.I.type!=v.default){e.next=25;break}return P.show("无尽模式不可用"),e.abrupt("return");case 25:return _.I.type==v.level?(I.data.level++,this.onReplay()):_.I.type==v.daily?(M.I.testLv++,this.onReplay()):(I.data.activityLevel++,this.onReplay()),e.abrupt("break",109);case 27:return this.box.testWin(),e.abrupt("break",109);case 29:return this.box.testLose(),e.abrupt("break",109);case 31:return+n>0&&(I.data.blockNum=+n),+n<0&&(I.data.mapId=-n),e.abrupt("break",109);case 34:return PUCHI_SDK.ShareVideoService.isDebug=!PUCHI_SDK.ShareVideoService.isDebug,e.abrupt("break",109);case 36:return I.data.clear(),PUCHI_SDK.Platform.restartGame(),e.abrupt("break",109);case 39:return this.box.comboCount=0,this.box.hard_time-=5e6,this.box.updateGroups(),e.abrupt("break",109);case 43:if(this.box.addScore(+n||10),999!=+n){e.next=50;break}if(wx.createPageManager){e.next=47;break}throw"当前基础库版本暂不支持。";case 47:return this.recommendPageManager=wx.createPageManager(),e.next=50,this.recommendPageManager.load({openlink:"TWFRCqV5WeM2AkMXhKwJ03MhfPOieJfAsvXKUbWvQFQtLyyA5etMPabBehga950uzfZcH3Vi3QeEh41xRGEVFw"});case 50:if(998==+n&&this.recommendPageManager.show(),997!=+n){e.next=68;break}i=20;case 53:if(!(i<1680)){e.next=68;break}if(!(r=y.getLevelTable(i+1))||0!=r.score){e.next=65;break}l=r.getCollect(),c=0;case 58:if(!(c<l.length)){e.next=65;break}if(!(l[c].num<10)){e.next=62;break}return console.log(i),e.abrupt("break",65);case 62:c++,e.next=58;break;case 65:i++,e.next=53;break;case 68:return e.abrupt("break",109);case 69:return I.data.userLayer=+n,e.abrupt("break",109);case 71:if(""!=n){for(p in u=JSON.parse(n))I.data[p]=u[p];I.save(),PUCHI_SDK.Platform.restartGame()}else PUCHI_SDK.Time.switchLocalTime(!PUCHI_SDK.Time.isLocalTime);return e.abrupt("break",109);case 73:if(""!=n){e.next=76;break}return y.setTestCfg(null),e.abrupt("return");case 76:if("\t",d=n.split("\t"),console.log(d),7==d.length){e.next=82;break}return P.show("格式不对"),e.abrupt("return");case 82:return _.I.type!=v.level&&this.box.play(v.level),(h={}).ID=_.I.levelCfg.ID,h.score=+d[1],h.hardType=+d[2],h.hardNum=+d[3],h.map=d[4].split(",").map((function(e){return+e})),h.collect=d[5],h.getCollect=function(){var e=[];if(""==d[5])return[];for(var t=d[5].split("|"),a=0;a<t.length;a++){var n=new m,o=t[a].split(",");n.id=Number(o[0]),n.num=Number(o[1]),e.push(n)}return e},h.is_hardlevel=+d[6],y.setTestCfg(h),this.onReplay(),P.show("自动切到关卡模式，输入空再点清空"),e.abrupt("break",109);case 96:return P.show("清除每日完成记录"),I.data.daily_is_complete=!1,C.openPanel(T.ReplacePanel,(function(e){console.log("替换:",e)}),[11,38,28],[1,3,2],!0),e.abrupt("break",109);case 100:return g=""===n?1:+n,S.I.gmRowAdd=g,PUCHI_SDK.GameService.dy2wxReport(),e.abrupt("break",109);case 104:return+n>-1&&(P.show("特殊身份设置为:"+n),I.data.special_user=+n),e.abrupt("break",109);case 106:return+n>-1&&(P.show("设置为:"+n),I.data.plan_id=+n),this.box.animDuoxiao(4),e.abrupt("break",109);case 109:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),l.onSetting=function(){C.openPanel(T.SettingPanel)},l.onReplay=function(e){void 0===e&&(e=!1),console.log("[Game] onReplay received! isVideo="+e),this.box.resetData(),_.I.resetData(),this.replay(e),console.log("[Game] onReplay finished")},l.onHelp=function(){_.I.type===v.level||_.I.type===v.activity||_.I.type===v.daily?C.openPanel(T.HelpPanel,_.I.collectType===x.jewel?2:1):C.openPanel(T.HelpPanel,1)},l.onHandbook=function(){C.openPanel(T.HandbookPanel,!1)},l.onSkin=function(){C.openPanel(T.SkinPanel)},l.onRank=function(){C.openPanel(T.RankPanel)},l.touchStart=function(e){this.box.stopTips()},l.onChangeSkin=function(){this.box.changeSkin()},l.handleError=function(){w.ins.dot("no_skin_error",{from:I.data.skin+""}),this.box.changeSkin()},l.play=function(e,t){void 0===t&&(t=!1),this.box.play(e,t)},l.adaptZhandouBg=function(){var e=this.node.getChildByName("zhandou_bg");if(e){var t=e.getComponent(d);if(t){var a=h.getVisibleSize();if(a.width<=0||a.height<=0)console.warn("[Game] visibleSize invalid: "+a.width+"x"+a.height+", skipping adapt");else{var n=t.width,o=t.height;if(n<=0||o<=0)console.warn("[Game] zhandou_bg original size invalid: "+n+"x"+o);else{var i=a.width/n,r=a.height/o,s=Math.max(i,r);if(s>20||s<=0)console.warn("[Game] scale abnormal: "+s+", skipping");else if(s>20||s<=0)console.warn("[Game] scale abnormal: "+s+", skipping");else{var l=n*s,c=o*s;t.setContentSize(l,c),e.active||(e.active=!0,console.log("[Game] zhandou_bg was inactive, forced active=true")),console.log("[Game] zhandou_bg adapted: "+n+"x"+o+" -> "+l.toFixed(0)+"x"+c.toFixed(0))}}}}else console.warn("[Game] zhandou_bg UITransform not found")}else console.log("[Game] zhandou_bg node not found, skipping background adaptation")},l.adaptZhandouBg2=function(){var e=this.node.getChildByName("zhandou_bg_2");if(e){var t=e.getComponent(d);if(t){var a=h.getVisibleSize(),n=t.width,o=t.height,i=a.width/n,r=a.height/o,s=Math.max(i,r),l=n*s,c=o*s;t.setContentSize(l,c),console.log("[Game] zhandou_bg adapted: "+n+"x"+o+" -> "+l.toFixed(0)+"x"+c.toFixed(0))}else console.warn("[Game] zhandou_bg UITransform not found")}else console.log("[Game] zhandou_bg node not found, skipping background adaptation")},a}(g)).prototype,"home",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=a(H.prototype,"box",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=a(H.prototype,"groups",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=a(H.prototype,"edit",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=H))||E));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameConst.ts",["cc"],(function(E){var _;return{setters:[function(E){_=E.cclegacy}],execute:function(){_._RF.push({},"6acafj1hthOm5q6kdTJDHJX","GameConst",void 0);var L=E("default",(function(){}));L.GAME_VERSION="1.3.6",L.ROW=8,L.COL=8,L.BLOCK_W=84,L.BLOCK_H=84,L.BLOCK_SPACE=2,L.SCORE_STAGE=[300,500,700,1e3,1400,1800,2200,2500,3e3,3800,4500,5200,6e3,6800,7600,8400,Number.MAX_VALUE],L.PUZZLE_REWARD=[2,4,6,8,10],L.MAX_LV=2100,L.GUIDE_MAP=[[0,0,0,1,1,1,0,0,0,0,0,2,2,2,0,0,0,0,0,3,3,3,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,0,0,0,0,0,6,6,6,0,0,0,0,0,7,7,7,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,3,4,5,6,7,1,2,0,3,4,5,6,7,1,2,0,3,4,5,6,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,2,2,0,0,0,1,1,2,0,0,2,1,1,1,1,2,0,0,2,1,1,0,0,0,2,2,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0]],L.GUIDE_BLOCKS=[[5,5,5],[4,4,4],[9,9,9]],L.GUIDE_ANSWER=[[35,36,37],[18,26,34],[27,28,35,36]],L.winTimes=[75,75,100,85,101,85,166,182,160,230],L.winLefts=[14,14,22,16,18,16,32,34,28,44],L.REVIVE_COUNT=3,L.HARD_REVIVE_COUNT=3,L.FALL_BLOCK=[[[1,1],[1,1]],[[1,0],[1,0],[1,1]],[[1,1,0],[0,1,1]],[[0,1],[0,1],[1,1]],[[0,1,0],[1,1,1]],[[1,1,1,1]],[[0,1,1],[1,1,0]]],L.CHANGE_BLOCK=[[1,1,1,1]],L.MOVE_SPEED=.01,L.AUTO_MOVE_SPEED=.06,L.FALL_CHECK_LEN=4,L.ELIMINATE_PROP_ROW=12,L.ELIMINATE_SINGLE=100,L.ELIMINATE_DOUBLE=150,L.FALL_SPEED_LIST=[10,15,20,25,30],L.FALL_SCORE_LIST=[5e3,15e3,3e4,45e3,6e4],L.FALL_SPEED_MAX=500,L.DWON_TYPE=1,_._RF.pop()}}}));

System.register("chunks:///_virtual/GameData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env","./EventManager.ts","./Enum.ts","./PlatformManager.ts"],(function(e,t){var i,a,n,r,o,s,l,u,c,h,p,f,m,b;return{setters:[function(e){i=e.applyDecoratedDescriptor,a=e.createClass,n=e.initializerDefineProperty,r=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e.sys,u=e.game,c=e.Game,h=e.warn},function(e){p=e.PREVIEW},function(e){f=e.default},function(e){m=e.EventType},function(e){b=e.PlatformManager}],execute:function(){var y,d,g,v,w,D,_,T,z,S,k,L,C,x,A,I,O,G,P,E,N,K,M,R,H,F,U,Y,J,W,V,j,B,q,Q,X,Z,$,ee,te,ie,ae,ne,re,oe,se,le,ue,ce,he,pe,fe,me,be,ye,de,ge,ve,we,De,_e,Te,ze,Se,ke,Le,Ce,xe,Ae,Ie,Oe,Ge,Pe,Ee,Ne,Ke,Me,Re,He,Fe,Ue,Ye,Je,We,Ve,je,Be,qe,Qe,Xe,Ze,$e,et,tt,it,at,nt,rt,ot,st,lt,ut,ct,ht,pt,ft,mt,bt,yt,dt,gt,vt,wt,Dt,_t,Tt,zt,St,kt,Lt,Ct,xt,At,It;e({localfield:Pt,serverfield:function(e){return function(e,t){try{("WECHAT_GAME"===l.platform||l.Platform&&l.Platform.WECHAT_GAME&&l.platform===l.Platform.WECHAT_GAME)&&!0}catch(e){}Ot.push(t)}}}),s._RF.push({},"b3889hMx2pI8J08Se2sfE/t","GameData",void 0),console.log("[Load] Loading GameData.ts (Merged Version)");var Ot=[],Gt={};function Pt(e){return void 0===e&&(e=!1),function(t,i){Ot.push(i),e&&(Gt[i]=0)}}e("GameData",(y=Pt(),d=Pt(),g=Pt(),v=Pt(),w=Pt(),D=Pt(),_=Pt(),T=Pt(),z=Pt(),S=Pt(),k=Pt(),L=Pt(),C=Pt(),x=Pt(!0),A=Pt(),I=Pt(),O=Pt(),G=Pt(!0),P=Pt(),E=Pt(),N=Pt(!0),K=Pt(),M=Pt(),R=Pt(),H=Pt(),F=Pt(),U=Pt(),Y=Pt(),J=Pt(),W=Pt(),V=Pt(),j=Pt(),B=Pt(!0),q=Pt(),Q=Pt(),X=Pt(),Z=Pt(!0),$=Pt(),ee=Pt(),te=Pt(),ie=Pt(),ae=Pt(),ne=Pt(),re=Pt(),oe=Pt(),se=Pt(),le=Pt(),ue=Pt(),ce=Pt(),he=Pt(!0),pe=Pt(),fe=Pt(),me=Pt(),be=Pt(),ye=Pt(),de=Pt(!0),ge=Pt(!0),ve=Pt(!0),we=Pt(),De=Pt(),_e=Pt(!0),(It=function(){function e(){n(this,"lastTime",ze,this),n(this,"login_days",Se,this),n(this,"logoutTime",ke,this),n(this,"regTime",Le,this),n(this,"guide",Ce,this),n(this,"authorize",xe,this),n(this,"tuijian",Ae,this),n(this,"music",Ie,this),n(this,"sound",Oe,this),n(this,"vibrate",Ge,this),n(this,"level",Pe,this),n(this,"lastlevel",Ee,this),n(this,"levelTimes",Ne,this),n(this,"onlineTime",Ke,this),n(this,"maxScore",Me,this),n(this,"dieCount",Re,this),n(this,"isTwo",He,this),n(this,"today_restart",Fe,this),n(this,"endlessData",Ue,this),n(this,"levelData",Ye,this),n(this,"levelDie",Je,this),n(this,"level_ad_count",We,this),n(this,"level_no_ad_count",Ve,this),n(this,"winStreak",je,this),n(this,"maxWinStreak",Be,this),n(this,"isCollect",qe,this),n(this,"dingyue",Qe,this),n(this,"mapId",Xe,this),n(this,"mapIndex",Ze,this),n(this,"blockNum",$e,this),n(this,"skin",et,this),n(this,"skins",tt,this),n(this,"replaceCount",it,this),n(this,"userLayer",at,this),n(this,"userLayerData",nt,this),n(this,"ad_times",rt,this),n(this,"record_videokey",ot,this),n(this,"dy2wxReport",st,this),n(this,"dy2wxReportValue",lt,this),n(this,"dy2wxReportAdCount",ut,this),n(this,"goActivityTime",ct,this),n(this,"goDailyTime",ht,this),n(this,"lastInterstitialTime",pt,this),n(this,"special_user",ft,this),n(this,"plan_id",mt,this),n(this,"activityId",bt,this),n(this,"activityLevel",yt,this),n(this,"activityList",dt,this),n(this,"activityData",gt,this),n(this,"actLevelDie",vt,this),n(this,"actLastlevel",wt,this),n(this,"actLevelTimes",Dt,this),n(this,"collectionIds",_t,this),n(this,"fallTopScore",Tt,this),n(this,"daily_badge_count",zt,this),n(this,"dailyData",St,this),n(this,"daily_is_complete",kt,this),n(this,"dailyLevelTimes",Lt,this),n(this,"dailyLastYm",Ct,this),n(this,"dailyCompleteDays",xt,this),n(this,"dailyLevelDie",At,this)}e.createInstance=function(){return new e},e.load=function(){var t=r(o().mark((function t(){var i,a,n,r,s,f,m,b,y,d=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i in console.log("[GameData] load start (Merged)"),null==this._instance&&(this._instance=this.createInstance()),Ot.forEach((function(e){null==d._instance[e]&&d._instance.constructor&&h("GameData."+e+" 没有配置初始值")})),Gt)Gt[i]=this._instance[i];if(a={},n=function(){var e=l.localStorage.getItem(d.LOCAL_DATA_KEY);e&&(a=JSON.parse(e))},r=!l.isNative&&"undefined"!=typeof window,!(l.isNative||p||r)){t.next=12;break}console.log("[GameData] Local data mode"),n(),t.next=31;break;case 12:return t.prev=12,console.log("[GameData] trying to fetch data from SDK/Server..."),t.next=16,PUCHI_SDK.GameService.getData(this.LOCAL_DATA_KEY);case 16:f=t.sent,console.log("getData=res,",f),1==(null==(s=f.data)?void 0:s.aup)&&(this.isAup=!0),f&&f.data||n(),""==(m=f.data.content)?n():(a=JSON.parse(m),(b=l.localStorage.getItem(this.LOCAL_DATA_KEY))?(y=JSON.parse(b)).logoutTime&&+y.logoutTime>+a.logoutTime?(a=y,console.log("使用了本地的数据")):console.log("未使用了本地的数据"):console.log("未使用了本地的数据2")),t.next=28;break;case 24:t.prev=24,t.t0=t.catch(12),console.log("出啥错了",t.t0),n();case 28:return t.prev=28,console.log("[GameData] data fetch phase finished"),t.finish(28);case 31:return this.localkeys.forEach((function(e){a.hasOwnProperty(e)&&(d._instance[e]=a[e])})),this.updateToday(),console.log("每日重置",Gt),u.on(c.EVENT_HIDE,(function(){console.log("退出游戏"),e.data.logoutTime=Date.now(),e.save(!0)}),this),t.abrupt("return",{code:0});case 36:case"end":return t.stop()}}),t,this,[[12,24,28,31]])})));return function(){return t.apply(this,arguments)}}(),e.syncFromFirebase=function(){var e=r(o().mark((function e(){var i,a,n,r,s=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.isNative&&(l.os===l.OS.IOS||l.os===l.OS.ANDROID)){e.next=2;break}return e.abrupt("return");case 2:return console.log("[GameData] Starting sync from Firebase..."),e.prev=3,e.next=6,t.import("./FirebaseManager.ts");case 6:return i=e.sent,a=i.FirebaseManager,e.next=10,a.instance.loadUserDataAsync();case 10:n=e.sent,console.log("[GameData] Fetched data from Firebase:",n),n&&Object.keys(n).length>0?(r=this.data.logoutTime||0,(n.logoutTime||0)>r?(console.log("[GameData] Cloud data is newer, overwriting local data."),this.localkeys.forEach((function(e){n.hasOwnProperty(e)&&(s.data[e]=n[e])})),this.save(!1)):(console.log("[GameData] Local data is newer or same, keeping local data."),this.save(!0))):(console.log("[GameData] No data on Firebase (new user?), pushing local data."),this.save(!0)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error("[GameData] Firebase sync failed",e.t0);case 18:case"end":return e.stop()}}),e,this,[[3,15]])})));return function(){return e.apply(this,arguments)}}(),e.updateToday=function(){var e=r(o().mark((function e(){var t,i,a,n,r,s=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Math.floor(Date.now()/1e3),!l.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Time&&(t=PUCHI_SDK.Time.currentTime),i=new Date(1e3*t),!this._instance.lastTime){e.next=11;break}if(a=new Date(1e3*this._instance.lastTime),i.getFullYear()===a.getFullYear()&&i.getMonth()===a.getMonth()&&i.getDate()===a.getDate()){e.next=9;break}return console.log("重置日期1:"+a,i),e.next=9,this.onResetDay();case 9:e.next=13;break;case 11:this._instance.lastTime=Math.floor(Date.now()/1e3),console.log("设置日期:"+this._instance.lastTime);case 13:(n=new Date(1e3*t)).setHours(23,59,60),r=n.getTime()-i.getTime()+1e3,console.log("启动零点作业："+n+", "+(r/1e3).toFixed()+"秒后执行：onResetDay"),setTimeout((function(){console.log("执行零点作业：当前时间="+n),s._instance.lastTime=Math.floor(Date.now()/1e3),s.onResetDay()}),r);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.onResetDay=function(){var e=r(o().mark((function e(){var t,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in console.log("每日重置"),f.I.emit(m.RESET_DAY),this._instance.lastTime=Math.floor(Date.now()/1e3),this._instance.login_days+=1,Gt)Gt.hasOwnProperty(t)&&(i=Gt[t],this._instance[t]=i);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.save=function(){var e=r(o().mark((function e(i,a){var n,r,s,u,c,h,p,f=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i=!1),void 0===a&&(a=!1),e.prev=2,e.next=5,t.import("./ReviewMode.ts");case 5:if(n=e.sent,!n.ReviewMode.shouldSkipSave()){e.next=10;break}return console.log("[GameData] Skipping save - Review Mode active"),e.abrupt("return");case 10:e.next=14;break;case 12:e.prev=12,e.t0=e.catch(2);case 14:if(this._instance.guide||a){e.next=16;break}return e.abrupt("return");case 16:if(r={},this.localkeys.forEach((function(e){f._instance.hasOwnProperty(e)&&(r[e]=f._instance[e])})),s=JSON.stringify(r),l.localStorage.setItem(this.LOCAL_DATA_KEY,s),!l.isNative){e.next=23;break}return l.os!==l.OS.IOS&&l.os!==l.OS.ANDROID||t.import("./FirebaseManager.ts").then((function(e){e.FirebaseManager.instance.saveUserData(r)})),e.abrupt("return");case 23:l.isNative||(u=b.getInstance().current)&&u.saveData&&"Native"!==u.name&&(this._instance.logoutTime=Date.now(),r.logoutTime=this._instance.logoutTime,c=JSON.stringify(r),u.saveData(this.LOCAL_DATA_KEY,c).catch((function(e){return console.warn("["+u.name+"] Save failed",e)}))),i&&(console.log("保存本地数据",r),h=0,this.isAup&&(this.isAup=!1,h=2),"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.GameService&&PUCHI_SDK.IsWx&&(null==(p=PUCHI_SDK.GameService.saveData(this.LOCAL_DATA_KEY,r,null,h))||p.catch((function(e){console.warn("[GameData] Cloud save failed:",e)}))));case 25:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t,i){return e.apply(this,arguments)}}(),e.syncFromPlatform=function(){var e=r(o().mark((function e(){var t,i,a,n,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.isNative){e.next=2;break}return e.abrupt("return");case 2:if(console.log("[GameData] Starting sync from Platform CloudStorage..."),e.prev=3,(t=b.getInstance().current)&&t.loadData&&"Native"!==t.name){e.next=8;break}return console.log("[GameData] Platform does not support Cloud load or is Native."),e.abrupt("return");case 8:return e.next=10,t.loadData(this.LOCAL_DATA_KEY);case 10:(i=e.sent)?(console.log("[GameData] Fetched data from "+t.name+":",i),a=JSON.parse(i),n=this.data.logoutTime||0,(a.logoutTime||0)>n?(console.log("[GameData] "+t.name+" Cloud data is newer, overwriting local."),this.localkeys.forEach((function(e){a.hasOwnProperty(e)&&(r.data[e]=a[e])})),this.save(!1),f.I.emit(m.DATA_SYNCED)):(console.log("[GameData] Local data is newer, pushing to "+t.name+" Cloud."),this.save(!0))):(console.log("[GameData] No data in "+t.name+" Cloud, pushing local data."),this.save(!0)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.error("[GameData] Cloud sync failed",e.t0);case 17:case"end":return e.stop()}}),e,this,[[3,14]])})));return function(){return e.apply(this,arguments)}}();var i=e.prototype;return i.addAdTimes=function(){this.ad_times++,this.levelData.ad_times++,console.log("广告次数：",this.ad_times),e.save()},i.clear=function(){this.level=1,this.onlineTime=0,this.guide=!1,this.maxScore=0,this.dieCount=0,this.winStreak=0,this.maxWinStreak=0,this.levelTimes=0,this.lastlevel=1,this.levelDie=!1,this.logoutTime=Date.now(),this.music=!0,this.sound=!0,this.vibrate=!0,this.mapId=1,this.mapIndex=0,this.blockNum=0,this.levelData=new Nt,this.endlessData=new Nt,this.activityData=new Nt,this.login_days=1,this.isTwo=!1,this.tuijian=!1,this.collectionIds=[],this.actLevelDie=!1,this.isCollect=!1,this.today_restart=0,this.authorize=!1,this.dingyue=!1,this.skin=1,this.skins=[1],this.daily_badge_count=0,this.dailyData=new Nt,this.daily_is_complete=!1,this.dailyLevelTimes=0,this.dailyLastYm="",this.dailyCompleteDays=[],this.fallTopScore=0,this.replaceCount=0,this.goActivityTime=0,this.goDailyTime=0,this.dy2wxReport=!1,this.ad_times=0,this.resetAct(0),e.save(!1,!0)},i.clearDaily=function(){this.daily_badge_count=0,this.dailyData=new Nt,this.daily_is_complete=!1,this.dailyLevelTimes=0,this.dailyLastYm="",this.dailyCompleteDays=[],e.save()},i.resetAct=function(e){e!=this.activityId&&(this.activityId=e,this.activityLevel=1,this.activityList=[],this.activityData=new Nt,this.actLevelDie=!1,this.actLastlevel=1,this.actLevelTimes=0)},i.addSkin=function(t){-1==this.skins.indexOf(t)&&(this.skins.push(t),e.save())},a(e,[{key:"isLevelDie",get:function(){return!(this.level<10)&&this.levelDie}},{key:"useLayer",get:function(){if(this.level<10)return 2;var e=180;return!l.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService&&(e=PUCHI_SDK.OnlineService.getParamsInt("user_layer_time",180)),this.onlineTime<e?1:this.layer}},{key:"layer",get:function(){if(this.level<10)return 2;var t=2,i="0,20";!l.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService&&(i=PUCHI_SDK.OnlineService.getParamsString("user_layer","0,20"));var a=i.split(",").map(Number);return e.data.userLayer<a[0]?t=3:e.data.userLayer>a[1]&&(t=1),t}}],[{key:"localkeys",get:function(){return Ot}},{key:"data",get:function(){return this._instance||(this._instance=this.createInstance()),this._instance}}]),e}())._instance=null,It.LOCAL_DATA_KEY="block_game_data2",It.isAup=!1,ze=i((Te=It).prototype,"lastTime",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1358410009}}),Se=i(Te.prototype,"login_days",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ke=i(Te.prototype,"logoutTime",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Date.now()}}),Le=i(Te.prototype,"regTime",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Date.now()}}),Ce=i(Te.prototype,"guide",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xe=i(Te.prototype,"authorize",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ae=i(Te.prototype,"tuijian",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ie=i(Te.prototype,"music",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Oe=i(Te.prototype,"sound",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ge=i(Te.prototype,"vibrate",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Pe=i(Te.prototype,"level",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ee=i(Te.prototype,"lastlevel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ne=i(Te.prototype,"levelTimes",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ke=i(Te.prototype,"onlineTime",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Me=i(Te.prototype,"maxScore",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Re=i(Te.prototype,"dieCount",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),He=i(Te.prototype,"isTwo",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fe=i(Te.prototype,"today_restart",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ue=i(Te.prototype,"endlessData",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Nt}}),Ye=i(Te.prototype,"levelData",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Nt}}),Je=i(Te.prototype,"levelDie",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),We=i(Te.prototype,"level_ad_count",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ve=i(Te.prototype,"level_no_ad_count",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),je=i(Te.prototype,"winStreak",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Be=i(Te.prototype,"maxWinStreak",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),qe=i(Te.prototype,"isCollect",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qe=i(Te.prototype,"dingyue",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xe=i(Te.prototype,"mapId",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ze=i(Te.prototype,"mapIndex",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),$e=i(Te.prototype,"blockNum",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),et=i(Te.prototype,"skin",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),tt=i(Te.prototype,"skins",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[1]}}),it=i(Te.prototype,"replaceCount",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),at=i(Te.prototype,"userLayer",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),nt=i(Te.prototype,"userLayerData",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Et}}),rt=i(Te.prototype,"ad_times",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ot=i(Te.prototype,"record_videokey",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),st=i(Te.prototype,"dy2wxReport",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),lt=i(Te.prototype,"dy2wxReportValue",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ut=i(Te.prototype,"dy2wxReportAdCount",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ct=i(Te.prototype,"goActivityTime",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ht=i(Te.prototype,"goDailyTime",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),pt=i(Te.prototype,"lastInterstitialTime",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ft=i(Te.prototype,"special_user",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),mt=i(Te.prototype,"plan_id",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),bt=i(Te.prototype,"activityId",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),yt=i(Te.prototype,"activityLevel",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),dt=i(Te.prototype,"activityList",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gt=i(Te.prototype,"activityData",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Nt}}),vt=i(Te.prototype,"actLevelDie",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wt=i(Te.prototype,"actLastlevel",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Dt=i(Te.prototype,"actLevelTimes",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_t=i(Te.prototype,"collectionIds",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Tt=i(Te.prototype,"fallTopScore",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),zt=i(Te.prototype,"daily_badge_count",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),St=i(Te.prototype,"dailyData",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Nt}}),kt=i(Te.prototype,"daily_is_complete",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Lt=i(Te.prototype,"dailyLevelTimes",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ct=i(Te.prototype,"dailyLastYm",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),xt=i(Te.prototype,"dailyCompleteDays",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),At=i(Te.prototype,"dailyLevelDie",[_e],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Te));var Et=e("IUserLayerData",(function(){this.reviveCount=0,this.levelTimes=0,this.put=0,this.time=0,this.day=0,this.ad=0})),Nt=e("BoardData",(function(){this.map=[],this.score=0,this.reviveCount=0,this.groupData=[],this.boardColor=[],this.comboColor=1,this.time=0,this.putCount=0,this.collectScore=0,this.collectJewel={},this.ad_times=0,this.isVideo=!1,this.maxAnim=!1,this.replace=!1,this.replaceVideo=!1}));s._RF.pop()}}}));

System.register("chunks:///_virtual/GameDistributionPlatform.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts","./GameData.ts"],(function(e){var t,o,i,n,a;return{setters:[function(e){t=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){i=e.cclegacy},function(e){n=e.AudioManager},function(e){a=e.GameData}],execute:function(){i._RF.push({},"3e60cGEd9pBU4PO8ElZdjnm","GameDistributionPlatform",void 0);e("GameDistributionPlatform",function(){function e(){this.name="GameDistribution",this._sdk=null,this._isInitialized=!1,this.GAME_ID="d1cc6875ea80482d84af71bba2057158",console.log("[GameDistribution] Platform constructor")}var i=e.prototype;return i.init=function(){console.log("[GameDistribution] init - starting async initialization"),this.initAsync().catch((function(e){return console.error("[GameDistribution] init failed:",e)}))},i.initAsync=function(){var e=t(o().mark((function e(){var t=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[GameDistribution] initAsync starting..."),window.GD_OPTIONS={gameId:this.GAME_ID,advertisementSettings:{autoplay:!1},onEvent:function(e){t.handleSDKEvent(e)}},!window.gdsdk&&!window.GD_SDK){e.next=7;break}return this._sdk=window.gdsdk||window.GD_SDK,this._isInitialized=!0,console.log("[GameDistribution] SDK already loaded"),e.abrupt("return");case 7:return e.abrupt("return",new Promise((function(e){if(!document.getElementById("gameDistributionSDK")){console.log("[GameDistribution] Loading SDK script...");var o=document.createElement("script");o.id="gameDistributionSDK",o.src="https://html5.api.gamedistribution.com/main.min.js?gid="+t.GAME_ID,o.async=!0,document.head.appendChild(o)}var i=setInterval((function(){var o=window.gdsdk||window.GD_SDK;o&&(t._sdk=o,t._isInitialized=!0,clearInterval(i),console.log("[GameDistribution] SDK initialized successfully",Object.keys(o)),e())}),100);setTimeout((function(){if(clearInterval(i),!t._isInitialized){console.warn("[GameDistribution] SDK initialization timeout - SDK may not be available");var o=window.gdsdk||window.GD_SDK;o&&(t._sdk=o,t._isInitialized=!0,console.log("[GameDistribution] SDK found after timeout"))}e()}),1e4)})));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.handleSDKEvent=function(e){switch(e.name){case"SDK_GAME_START":console.log("[GameDistribution] Game can start"),this.unmuteGameAudio();break;case"SDK_GAME_PAUSE":console.log("[GameDistribution] Game should pause (ad showing)"),this.muteGameAudio();break;case"SDK_REWARDED_WATCH_COMPLETE":console.log("[GameDistribution] Rewarded video watched completely!"),window.__gdRewardWatched=!0;break;case"SDK_GDPR_TRACKING":console.log("[GameDistribution] GDPR tracking allowed:",e.message);break;case"SDK_GDPR_TARGETING":console.log("[GameDistribution] GDPR targeting allowed:",e.message);break;default:console.log("[GameDistribution] Event:",e.name,e.message)}},i.muteGameAudio=function(){try{n&&n.I&&(n.I.pauseMusic(),n.I.setEffect(!1),console.log("[GameDistribution] Game audio muted for ad"))}catch(e){console.warn("[GameDistribution] Failed to mute audio:",e)}},i.unmuteGameAudio=function(){try{n&&n.I&&(n.I.resumeMusic(),a&&a.data?n.I.setEffect(a.data.sound):n.I.setEffect(!0),console.log("[GameDistribution] Game audio unmuted after ad"))}catch(e){console.warn("[GameDistribution] Failed to unmute audio:",e)}},i.showPreroll=function(){var e=this;return new Promise((function(t){if(!e._sdk)return console.warn("[GameDistribution] SDK not ready for preroll"),void t();console.log("[GameDistribution] Showing preroll ad"),e.muteGameAudio(),e._sdk.showAd("preroll").then((function(){console.log("[GameDistribution] Preroll ad completed"),e.unmuteGameAudio(),t()})).catch((function(o){console.warn("[GameDistribution] Preroll ad error:",o),e.unmuteGameAudio(),t()}))}))},i.login=function(){return Promise.resolve({code:0,userInfo:{userId:"gd_guest_"+Math.floor(1e5*Math.random()),nickName:"Guest",avatarUrl:""}})},i.getUserInfo=function(){return Promise.resolve({})},i.vibrateShort=function(e){navigator.vibrate&&navigator.vibrate(15)},i.vibrateLong=function(){navigator.vibrate&&navigator.vibrate(200)},i.showBanner=function(){console.log("[GameDistribution] showBanner - Not supported, use rewarded/interstitial")},i.hideBanner=function(){console.log("[GameDistribution] hideBanner")},i.showInterstitial=function(){this._sdk?(console.log("[GameDistribution] Showing interstitial ad"),this.muteGameAudio(),"function"==typeof this._sdk.showAd?this._sdk.showAd():(console.warn("[GameDistribution] showAd function not available"),this.unmuteGameAudio())):console.warn("[GameDistribution] SDK not ready for interstitial")},i.showRewardVideo=function(e){var t=this;return new Promise((function(o){var i;if(!t._sdk)return console.warn("[GameDistribution] SDK not ready for rewarded video"),void o({code:1,msg:"SDK not ready"});console.log("[GameDistribution] Showing rewarded video for:",e),t.muteGameAudio(),window.__gdRewardWatched=!1;var n=null==(i=window.GD_OPTIONS)?void 0:i.onEvent;window.GD_OPTIONS.onEvent=function(e){console.log("[GameDistribution] Rewarded event:",e.name),"SDK_REWARDED_WATCH_COMPLETE"===e.name&&(window.__gdRewardWatched=!0,console.log("[GameDistribution] Reward earned!")),n?n(e):t.handleSDKEvent(e)},t._sdk.showAd("rewarded").then((function(){console.log("[GameDistribution] Rewarded ad finished"),t.unmuteGameAudio(),window.GD_OPTIONS.onEvent=n||t.handleSDKEvent.bind(t),window.__gdRewardWatched?o({code:0,msg:"Success"}):o({code:1,msg:"Ad not completed"})})).catch((function(e){console.warn("[GameDistribution] Rewarded ad error:",e),t.unmuteGameAudio(),window.GD_OPTIONS.onEvent=n||t.handleSDKEvent.bind(t),o({code:1,msg:(null==e?void 0:e.message)||"Ad error"})}))}))},i.uploadRankData=function(e,t,o){console.log("[GameDistribution] uploadRankData - Not supported")},i.postMessage=function(e,t){},i.trackEvent=function(e,t){console.log("[GameDistribution] Track: "+e,t)},i.getSafeAreaTop=function(){return 0},i.getVersion=function(){return"1.0.0"},i.saveData=function(e,t){try{localStorage.setItem("gd_"+e,t),console.log("[GameDistribution] Saved "+e+" to localStorage")}catch(e){console.error("[GameDistribution] Save error:",e)}return Promise.resolve()},i.loadData=function(e){try{var t=localStorage.getItem("gd_"+e);return console.log("[GameDistribution] Loaded "+e+" from localStorage"),Promise.resolve(t)}catch(e){return console.error("[GameDistribution] Load error:",e),Promise.resolve(null)}},i.gameReady=function(){console.log("[GameDistribution] Game ready")},i.gameplayStart=function(){console.log("[GameDistribution] Gameplay started")},i.gameplayStop=function(){console.log("[GameDistribution] Gameplay stopped")},e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/GameMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./GameData.ts","./ObjectInstance.ts","./Utils.ts","./GameConst.ts"],(function(e){var t,r,o,s,i,a,n,h;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,r=e.createClass},function(e){o=e.cclegacy},function(e){s=e.ConfigManager},function(e){i=e.GameData},function(e){a=e.default},function(e){n=e.Utils},function(e){h=e.default}],execute:function(){o._RF.push({},"67dc6gdCeJF05YImv8VKEq2","GameMgr",void 0),console.log("[Load] Loading GameMgr.ts");e("GameMgr",function(){function e(){this.nextScore=0,this.nowIdx=0,this.nowIds=[],this.totalWeight=0,this.game=void 0,this.model_type=0,this.bestIds=[],this.randomGroupDepth=0,this.minIds=[],this.minEmptyNum=64,this.maxIds=[],this.maxEmptyNum=0,this.evolutionState=void 0}var o=e.prototype;return o.init=function(e){this.game=e},o.resetData=function(){this.nextScore=0},o.updateScore=function(e){if(e>=this.nextScore){this.nowIdx=0;for(var t=0;t<h.SCORE_STAGE.length;t++)if(e<h.SCORE_STAGE[t]){this.nowIdx=t,this.nextScore=h.SCORE_STAGE[t];break}for(var r=0,o=[],i=1;i<31;i++){var a=s.getBlockTable(i+1);r+=a.weight[this.nowIdx],a.weight[this.nowIdx]>0&&o.push(i+1)}this.totalWeight=r,this.nowIds=o,console.log("当前ids",this.nowIds,"，下一阶段：",this.nextScore)}},o.randomGroups=function(e){void 0===e&&(e=!1),0==this.nowIds.length&&this.updateScore(0),e||3!=i.data.special_user||1!=n.getOnlineParamInt("canput_special_user_3",1)||(e=!0);var t=[];if(e&&Math.random()<n.getOnlineParamInt("random_canput_skip",.99))for(var r=0;r<this.nowIds.length;r++)this.canPutById(this.game.map,this.nowIds[r])&&t.push(this.nowIds[r]);for(var o=[],s=0;s<3;s++)o.push(this.randomOne(e&&t.length>0?t:this.nowIds));o[0]==o[1]&&o[0]==o[2]&&(o[0]=this.randomOne(e&&t.length>0?t:this.nowIds));for(var a=!1,h=0;h<o.length;h++)if(this.canPutById(this.game.map,o[h])){a=!0;break}if(!a){if(console.log("3个都不能放，重新随机一组"),this.randomGroupDepth>10)return console.warn("randomGroups recursion limit reached, returning default blocks"),this.randomGroupDepth=0,[1,1,1];this.randomGroupDepth=(this.randomGroupDepth||0)+1;var l=this.randomGroups();return this.randomGroupDepth=0,l}return console.log("随机模式:",e?"随可放入":"随机全部"),this.model_type=1,this.randomGroupDepth=0,o},o.randomOne=function(e){0==e.length&&(e=this.nowIds);for(var t=n.random(0,this.totalWeight-1),r=0,o=0;o<e.length;o++){if(t<(r+=s.getBlockTable(e[o]).weight[this.nowIdx]))return e[o]}return 1},o.getGroups=function(e){void 0===e&&(e=!1);var t=[];if(e)t=this.offerNewBlockDramaAddClear();else if(this.game.comboCount>=1)if(this.game.comboCount<=3){var r=Math.floor(10*Math.random());this.game.score<i.data.maxScore?(console.log("连击<=3，<历史最高分,70%填空30%随机"),r<=7?(console.log("连击<=3填空"),t=this.offerNewBlockDramaAddClear()):(console.log("连击<=3随机"),t=this.randomGroups())):(console.log("连击<=3,>历史最高分,70%随机30%填空"),r<=3?(console.log("连击<=3填空"),t=this.offerNewBlockDramaAddClear()):(console.log("连击<=3随机"),t=this.randomGroups()))}else this.game.comboCount<=6?(console.log("连击<=6,递增2"),t=this.offerNewBlockDramaAdd3()):(console.log("连击>6,困难模式"),t=this.getHardModel(1));else{var o=60*(this.game.is_hard?1:3)*1e3,s=Date.now()-this.game.hard_time;console.log("t2:",s,"，t：",o),s>o?(t=this.getHardModel(),this.game.hard_time=Date.now()):t=this.getNormalModel()}var a=0;if(t.length>0){for(var h=0;h<t.length;h++)t[h]>0&&a++;3!=a&&console.error("list2:",n.clone(t))}return 3==a&&t&&!t.includes(0)&&3==t.length||(t=this.randomGroups(!0)),n.shuffleArray(t),console.log("实际出题模式",this.modeType),4==this.model_type||8==this.model_type?this.bestIds=t:this.bestIds=[],t},o.levelModelGetGroups=function(e,t,r,o){void 0===r&&(r=!1),void 0===o&&(o=0);var s=[];if(0==e||r)s=this.offerNewBlockDramaAddClear();else if(t)s=1==i.data.useLayer&&Math.random()<n.getOnlineParamInt("level_layer_1_ratio",.5)?this.getLevelModel(e):this.getHardModel(2,e);else{var a=60*(this.game.is_hard,1)*1e3;if(Date.now()-this.game.hard_time>a&&1!=i.data.useLayer)if(o>2){var h=Math.min(.5,.1*(o-2));Math.random()<h?(console.log("触发困难关卡重复玩降低难度",h),s=this.getLevelModel(e)):(console.log("时长进入2，困难模式"),s=this.getHardModel(2,e)),this.game.hard_time=Date.now()}else console.log("时长进入，困难模式"),s=this.getHardModel(2,e),this.game.hard_time=Date.now();else switch(i.data.useLayer){case 1:case 2:s=this.getLevelModel(e);break;case 3:e>.5&&Math.random()<n.getOnlineParamInt("level_layer_3_ratio",.3)?(console.log("概率进入，困难模式"),s=this.getHardModel(2,e)):s=this.getLevelModel(e)}}var l=0;if(s.length>0){for(var c=0;c<s.length;c++)s[c]>0&&l++;3!=l&&console.error("list2:",n.clone(s))}return 3==l&&s&&!s.includes(0)&&3==s.length||(s=this.randomGroups(!0)),n.shuffleArray(s),4==this.model_type||8==this.model_type?this.bestIds=s:this.bestIds=[],console.log("实际出题模式",this.modeType),s},o.getLevelModel=function(e){return e<.2?this.getGroupByWeight(1):e<.4?this.getGroupByWeight(3):e<.6?this.getGroupByWeight(1):e<.8?this.getGroupByWeight(3):e<.9?this.getGroupByWeight(1):this.getGroupByWeight(3)},o.getNormalModel=function(){var e=i.data.maxScore,t=i.data.dieCount>=2?(e-this.game.score)/20:0;return e<=720?this.game.score<=7/18*e?this.getGroupByWeight(1):this.game.score<=.5*e-2*t?this.getGroupByWeight(5):this.game.score<=16/18*e?this.getGroupByWeight(1):this.game.score<=e-2*t||this.game.score<=20/18*e?this.getGroupByWeight(5):this.getGroupByWeight(3):e<=1440?this.game.score<=5/18*e?this.getGroupByWeight(1):this.game.score<=7/18*e-2*t?this.getGroupByWeight(6):this.game.score<=11/18*e?this.getGroupByWeight(1):this.game.score<=13/18*e-2*t?this.getGroupByWeight(3):this.game.score<=16/18*e?this.getGroupByWeight(1):this.game.score<=e||this.game.score<=20/18*e?this.getGroupByWeight(6):this.getGroupByWeight(3):e<=2880?this.game.score<=5/18*e?this.getGroupByWeight(1):this.game.score<=7/18*e-2*t?this.getGroupByWeight(6):this.game.score<=11/18*e?this.getGroupByWeight(1):this.game.score<=13/18*e-2*t?this.getGroupByWeight(3):this.game.score<=16/18*e?this.getGroupByWeight(1):this.getGroupByWeight(3):this.game.score<=5/18*e?this.getGroupByWeight(1):this.game.score<=7/18*e-2*t?this.getGroupByWeight(3):this.game.score<=11/18*e?this.getGroupByWeight(1):this.game.score<=13/18*e-2*t?this.getGroupByWeight(3):this.game.score<=16/18*e?this.getGroupByWeight(1):this.getGroupByWeight(3)},o.getGroupByWeight=function(e){console.log("getGroupByWeight",e);var t=this.getWeight(),r=Math.floor(10*Math.random());switch(e){case 1:return t<=280?r<7?this.getGroupsByType(1):this.getGroupsByType(0):this.getGroupsByType(4);case 2:return t<=310?r<7?this.getGroupsByType(1):this.getGroupsByType(0):t<=430&&r<5?this.getGroupsByType(0):this.getGroupsByType(4);case 3:return t<=310?r<7?this.getGroupsByType(2):this.getGroupsByType(0):t<=430?r<3?this.getGroupsByType(0):this.getGroupsByType(3):r<7?this.getGroupsByType(0):this.getGroupsByType(4);case 4:return t<=330||t<=430&&r<3?this.getGroupsByType(0):this.getGroupsByType(4);case 5:return t<=310?r<7?this.getGroupsByType(2):this.getGroupsByType(0):t<=430||r<7?this.getGroupsByType(0):this.getGroupsByType(4);case 6:return t<=310?r<7?this.getGroupsByType(2):this.getGroupsByType(0):t<=430?r<7?this.getGroupsByType(0):this.getGroupsByType(3):r<7?this.getGroupsByType(0):this.getGroupsByType(4);default:return this.randomGroups()}},o.getWeight=function(){for(var e=0,t=0,r=64-this.getEmptyNum,o=0,s=0,i=0,a=this.game.map,n=0;n<8;n++){for(var h=0,l=0,c=0;c<8;c++)this.game.blocks[8*n+c].color>0?h++:(this.canPlaceById(a,13,n,c)&&o++,this.canPlaceById(a,11,n,c)&&s++,this.canPlaceById(a,22,n,c)&&i++,0===c?-1!==a[n][c+1]&&l++:(7===c||-1!==a[n][c+1]&&l++,-1!==a[n][c-1]&&l++));e+=h*l}for(var g=0;g<8;g++){for(var u=0,f=0,d=0;d<8;d++)-1!==a[d][g]?u++:0===d?-1!==a[d+1][g]&&f++:(7===d||-1!==a[d+1][g]&&f++,-1!==a[d-1][g]&&f++);t+=u*f}var p,m=e+t,y=o>=3?o+20:2*o+10+s/3+3+i/3+3;return p=r>=32?m-y-Math.pow(r-32,2)/5+246:o>0?m-y+Math.pow(r-32,2)/5+246:m-y+Math.pow(r-32,2)/2+246,console.log("空格："+r+"基础权重:"+m+" 最终权重:"+p),p},o.getGroupsByType=function(e){switch(console.log("getGroupsByType",e),e){case 1:return this.offerNewBlockEvolution(!1);case 2:return this.offerNewBlockDramaAddNoClear();case 3:return this.offerBlockDeath3();case 4:return this.offerNewBlockDramaAddClear();case 5:return this.offerNewBlockEvolution(!0);case 0:default:return this.randomGroups()}},o.canPlaceById=function(e,t,r,o){for(var i=n.clone(s.getBlocks(t)),a=0;a<i.length;a++)for(var h=0;h<i[a].length;h++)if(i[a][h]>0){var l=r+a,c=o+h;if(l>=e.length||c>=e[0].length)return!1;if(e[l][c]>0)return!1}return!0},o.canPlace=function(e,t,r,o){for(var s=0;s<t.length;s++)for(var i=0;i<t[s].length;i++)if(t[s][i]>0){var a=r+s,n=o+i;if(a>=e.length||n>=e[0].length)return!1;if(e[a][n]>0)return!1}return!0},o.placeListById=function(e,t,r,o){for(var i=n.clone(s.getBlocks(e)),a=0;a<i.length;a++)for(var h=0;h<i[a].length;h++)i[a][h]>0&&(t[r+a][o+h]=1);return t},o.placeList=function(e,t,r,o){for(var s=0;s<e.length;s++)for(var i=0;i<e[s].length;i++)e[s][i]>0&&(t[r+s][o+i]=1);return t},o.canPutById=function(e,t){var r=n.clone(s.getBlocks(t));return this.canPut(e,r)},o.canPut=function(e,t){for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++)if(this.canPlace(e,t,r,o))return!0;return!1},o.offerNewBlockEvolution=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var r=[0,0,0];this.evolutionState=e,this.minIds=[],this.minEmptyNum=64,this.maxIds=[],this.maxEmptyNum=0;var o=this.nowIds.sort((function(){return Math.random()>.5?-1:1}));if(t)for(var s=[12,13,21,23,24],i=0;i<s.length;i++){var a=o.indexOf(s[i]);-1!==a&&o.splice(a,1)}for(var h=n.clone(this.game.map),l=(new Date).getTime(),c=0;c<o.length;c++){r[0]=o[c];for(var g=0;g<o.length&&(r[0]!=o[g]&&(r[1]=o[g],this.findBestWayByte(r,h,0,2)),!((new Date).getTime()-l>60));g++);if((new Date).getTime()-l>60)break}r=this.evolutionState?this.minIds:this.maxIds,this.minEmptyNum=64,this.maxEmptyNum=0,l=(new Date).getTime();for(c=0;c<o.length&&(r[2]=o[c],this.findBestWayByte(r,h,2,3),!((new Date).getTime()-l>60));c++);return console.log(this.evolutionState?"递减":"递增",r),this.model_type=e?5:6,r},o.findBestWayByte=function(e,t,r,o){if(r>=o){var s=this.getEdgeNum(t);this.evolutionState?s>this.maxEmptyNum&&(this.minIds=e.slice(),this.maxEmptyNum=s):s<this.minEmptyNum&&(this.maxIds=e.slice(),this.minEmptyNum=s)}else for(var i=0;i<8;i++)for(var a=0;a<8;a++)if(this.canPlaceById(t,e[r],i,a)){var h=this.placeListById(e[r],n.clone(t),i,a);this.clearMap(h),this.findBestWayByte(e,h,r+1,o)}},o.clearMap=function(e){for(var t=[],r=0;r<e.length;r++){for(var o=[],s=[],i=0;i<8;i++)e[r][i]>0&&o.push({x:r,y:i}),e[i][r]>0&&s.push({x:i,y:r});8==o.length&&t.push(o),8==s.length&&t.push(s)}for(var a=0;a<t.length;a++)for(var n=t[a],h=0;h<n.length;h++)e[n[h].x][n[h].y]>1?e[n[h].x][n[h].y]--:e[n[h].x][n[h].y]=0;return t.length>0},o.getEdgeNum=function(e){for(var t=0,r=0;r<8;r++)for(var o=0;o<8;o++)e[r][o]>0&&(o-1>=0&&0===e[r][o-1]&&t++,r-1>=0&&0===e[r-1][o]&&t++,o+1<8&&0===e[r][o+1]&&t++,r+1<8&&0===e[r+1][o]&&t++);return t},o.offerNewBlockDramaAddNoClear=function(){var e=this,r=this.randomGroups(!0),o=n.clone(this.game.map),s=[].concat(this.nowIds);n.shuffleArray(s);var i=function(r){for(var i,a=t(s);!(i=a()).done;){var h=i.value;if(!r.includes(h))for(var l=0;l<8;l++)for(var c=0;c<8;c++)if(e.canPlaceById(o,h,l,c)){var g=e.placeListById(h,n.clone(o),l,c);if(e.clearMap(g))return o=g,h}}return null},a=i([]);return a&&(r[0]=a,(a=i([r[0]]))&&(r[1]=a,(a=i([r[0],r[1]]))&&(r[2]=a))),this.model_type=7,r},o.offerBlockDeath3=function(e){void 0===e&&(e=!0);var r=this.randomGroups(!0),o=n.clone(this.game.map),s=[].concat(this.nowIds);n.shuffleArray(s);for(var i,a=Date.now(),h=!1,l=t(s);!(i=l()).done;){var c=i.value;if(!this.canPutById(o,c))for(var g,u=t(s);!(g=u()).done;){var f=g.value;if(f!=c){for(var d=0;d<8;d++){for(var p=0;p<8;p++){if(Date.now()-a>100)return console.log("死亡模式出题失败,走随机————超时"),r;if(this.canPlaceById(o,f,d,p)){var m=this.placeListById(f,n.clone(o),d,p);if(e&&this.clearMap(m))for(var y=0;y<8;y++){for(var v=0;v<8;v++){if(this.canPlaceById(m,c,y,v)){var B=this.placeListById(c,n.clone(m),y,v);this.clearMap(B);for(var I,G=t(s);!(I=G()).done;){var k=I.value;if(k!=f&&k!=c&&this.canPutById(B,k)){h=!0,r=[c,f,k],console.log("死亡模式出题成功，放入1个后可消除,(1,3可能重叠造成死亡)");break}}break}if(h)break}if(h)break}else for(var w,b=t(s);!(w=b()).done;){var M=w.value;if(M!=f&&M!=c)for(var P=0;P<8;P++){for(var W=0;W<8;W++){if(this.canPlaceById(m,M,P,W)){var T=this.placeListById(M,n.clone(m),P,W);if(this.clearMap(T)&&this.canPutById(T,c)){h=!0,r=[c,f,M],console.log("死亡模式出题成功，可能需要放入2个后才可消除");break}}if(h)break}if(h)break}}}if(h)break}if(h)break}if(h)break}}if(h)break}return h?(console.log("死亡模式出题",r),this.model_type=8):console.log("死亡模式出题失败,走随机"),r},o.offerNewBlockDramaAddClear=function(){for(var e=this.randomGroups(!0),t=n.clone(this.game.map),r=n.clone(this.game.map),o=n.clone(this.game.map),s=this.getEdgeNum(t),i=[0,0,0],a=[0,0,0],h=[],l=[],c=0;c<3;c++)h.push(s),l.push(s);for(var g=0;g<3;g++){for(var u=Date.now(),f=42;f>0;f--){for(var d=0;d<8;d++)for(var p=0;p<8;p++)if(this.canPlaceById(t,f,d,p)){var m=this.placeListById(f,n.clone(t),d,p),y=this.getEdgeNum(m);y<h[g]&&this.clearMap(m)?(h[g]=y,i[g]=f,r=m):y<l[g]&&(l[g]=y,a[g]=f,o=m)}if(Date.now()-u>33)break}0!=i[g]?(e[g]=i[g],t=r,this.model_type=2):0!=a[g]?(e[g]=a[g],t=o,this.model_type=2):console.log("填空消除出题失败index:",g)}return console.log("填空消除出题",e),e},o.getHardModel=function(e,r){void 0===e&&(e=0),console.log("困难模式");var o=[],s=n.clone(this.game.map),i=[].concat(this.nowIds);n.shuffleArray(i);for(var a,h=[],l=[],c=t(i);!(a=c()).done;){for(var g=a.value,u=!1,f=!1,d=0;d<8;d++){for(var p=0;p<8;p++){if(this.canPlaceById(s,g,d,p)){var m=this.placeListById(g,n.clone(s),d,p);if(this.clearMap(m)){f=!0;break}u=!0}if(f)break}if(f)break}f||(u?h.push(g):l.push(g))}var y=!1;if(h.length>=1&&l.length>0){for(var v,B=[],I=Date.now(),G=t(h);!(v=G()).done;){for(var k,w=v.value,b=t(h);!(k=b()).done;){for(var M,P=k.value,W=t(l);!(M=W()).done;){var T=M.value;if(Date.now()-I>=120){y=!0;break}var _,D=this.findCorrect([w,P,T]);if(D.result)if(B.push(((_={})[D.diff]=[w,P,T],_)),B.length>=20){y=!0;break}if(y)break}if(y)break}if(y)break}if(console.log("diffList",B),B.length>0){B.sort((function(e,t){return+Object.keys(t)[0]-+Object.keys(e)[0]}));var N=B[B.length-1];o=N[Object.keys(N)[0]],console.log("困难模式出题成功",B,o)}}return o&&3==o.length?this.model_type=4:1==e?(console.log("困难模式出题失败,走递增2",y),o=this.offerNewBlockEvolution(!1,!0)):2==e?(console.log("困难模式出题失败,走关卡模式",y),o=this.getLevelModel(r)):(console.log("困难模式出题失败,走普通模式",y),o=this.getNormalModel()),o},o.checkBestPut=function(e){if(this.bestIds.length>0){for(var t=this.bestIds[e],r=0;r<this.bestIds.length;r++)if(this.bestIds[r]==t){this.bestIds[r]=0;break}var o=this.bestIds.filter((function(e){return e>0}));if(0==o.length)return 3;var s=n.clone(this.game.map);if(this.clearMap(s),1==o.length)return this.canPutById(s,o[0])?2:0;for(var i=0;i<8;i++)for(var a=0;a<8;a++)if(this.canPlaceById(s,o[0],i,a)){var h=this.placeListById(o[0],n.clone(s),i,a);if(this.clearMap(h),this.canPutById(h,o[1]))return 1}s=n.clone(this.game.map);for(var l=0;l<8;l++)for(var c=0;c<8;c++)if(this.canPlaceById(s,o[1],l,c)){var g=this.placeListById(o[1],n.clone(s),l,c);if(this.clearMap(g),this.canPutById(g,o[0]))return 1}return 0}return 0},o.findCorrect=function(e){for(var r=n.clone(this.game.map),o=!1,s=0,i=0,a=0,h=[e];a<h.length;a++){var l=h[a],c=this.findCanPutPos(l[0],r);if(c.length>0)for(var g,u=t(c);!(g=u()).done;){var f=g.value,d=this.placeListById(l[0],n.clone(r),f[0],f[1]),p=this.findCanPutPos(l[1],d);if(p.length>0)for(var m,y=t(p);!(m=y()).done;){var v=m.value;if(i++,this.isCross(l[0],l[1],f,v)){var B=this.placeListById(l[1],n.clone(d),v[0],v[1]);this.clearMap(B)&&this.canPutById(B,l[2])&&(s++,o=!0)}}else i++}}return{result:o,diff:100*+(s/i).toFixed(2)}},o.findCanPutPos=function(e,t){for(var r=[],o=0;o<h.ROW;o++)for(var s=0;s<h.COL;s++)this.canPlaceById(t,e,o,s)&&r.push([o,s]);return r},o.isCross=function(e,t,r,o){for(var s=[],i=0;i<8;i++)s.push([0,0,0,0,0,0,0,0]);var a=n.clone(s);return s=this.placeListById(e,s,r[0],r[1]),a=this.placeListById(t,a,o[0],o[1]),this.canPut(a,s)},o.offerNewBlockDramaAdd3=function(){var e=[0,0,0],t=n.clone(this.game.map),r=[].concat(this.nowIds);n.shuffleArray(r);for(var o=!1,s=0;s<r.length;s++){for(var i=r[s],a=0;a<8;a++){for(var h=0;h<8;h++)if(this.canPlaceById(t,i,a,h)){var l=this.placeListById(i,n.clone(t),a,h);if(this.clearMap(l)){t=l,o=!0,e[0]=i;break}}if(o)break}if(o)break}if(o){for(var c=0,g=[],u=0;u<r.length;u++)for(var f=r[u],d=0;d<8;d++)for(var p=0;p<8;p++)if(this.canPlaceById(t,f,d,p)){var m=this.placeListById(f,n.clone(t),d,p),y=this.getEdgeNum(m);y>c&&(c=y,g=m,e[1]=f)}c=0,n.shuffleArray(r);for(var v=0;v<r.length;v++)for(var B=r[v],I=0;I<8;I++)for(var G=0;G<8;G++)if(this.canPlaceById(t,B,I,G)){var k=this.placeListById(B,n.clone(g),I,G),w=this.getEdgeNum(k);w>c&&(c=w,g=k,e[2]=B)}}return e.includes(0)&&console.log("递增2-找不到合适的块"),this.model_type=3,e},o.findBestWay=function(e,t){e=n.clone(e);for(var r=100,o=null,s=0;s<8;s++)for(var i=0;i<8;i++)if(this.canPlace(t,e,s,i)){var a=this.placeList(e,n.clone(t),s,i),h=this.getEdgeNum(a);h<r&&(r=h,o=[s,i])}return o},r(e,[{key:"modeType",get:function(){return["随机","填空","递增2","困难","递减","递增","递增3","死亡"][this.model_type-1]||"未知模式"}},{key:"getEmptyNum",get:function(){for(var e=0,t=0;t<8;t++)for(var r=0;r<8;r++)this.game.blocks[8*t+r].color>0&&e++;return e}}],[{key:"I",get:function(){return a.getInstance(e)}}]),e}());o._RF.pop()}}}));

System.register("chunks:///_virtual/GoPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./EventManager.ts","./Enum.ts","./I18nManager.ts","./I18nImageText.ts"],(function(e){var t,n,i,r,o,a,l,s,u,c,p,f,b,g,h,y,d,S;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose,a=e.createClass},function(e){l=e.cclegacy,s=e.Sprite,u=e.SpriteFrame,c=e.Label,p=e._decorator,f=e.isValid,b=e.Color},function(e){g=e.default},function(e){h=e.default},function(e){y=e.EventType},function(e){d=e.I18n},function(e){S=e.I18nImageText}],execute:function(){var _,m,I,v,L,T,w,z,C,D,G,E,F;l._RF.push({},"0c2b8W89I5A/qR1BbnLsRbK","GoPanel",void 0);var P=p,A=P.ccclass,x=P.property;e("default",(_=A("panel/GoPanel"),m=x(s),I=x(u),v=x(s),L=x(u),T=x(c),_((C=t((z=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"titleSp",C,r(t)),i(t,"titleSf",D,r(t)),i(t,"bgSp",G,r(t)),i(t,"bgSf",E,r(t)),i(t,"labDesc",F,r(t)),t.type=0,t}n(t,e);var l=t.prototype;return l.init=function(e){this.type=e,this.titleSp.spriteFrame=this.titleSf[e],this.bgSp.spriteFrame=this.bgSf[e],this.initI18nLabels()},l.initI18nLabels=function(){if(f(this.node)){var e=this.DESC_LIST;e&&e[this.type]&&(this.labDesc.string=e[this.type]);var t={nodeName:"title",i18nKey:0===this.type?"go_panel.title_daily":"go_panel.title_activity",outlineColor:new b(50,50,100,255),outlineWidth:3,fontSize:50};S.addOrUpdateLabel(this.titleSp.node,t),S.replaceImageTexts(this.node,[{nodeName:"word_6",i18nKey:"go_panel.btn_go",fontSize:36,outlineColor:new b(50,50,100,255),outlineWidth:3}]);for(var n,i=this.node.getComponentsInChildren(c),r=o(i);!(n=r()).done;){var a=n.value,l=(a.string||"").trim();"前往"!==l&&l!==d.t("go_panel.btn_go")||(a.string=d.t("go_panel.btn_go"))}}},l.onGo=function(){switch(this.type){case 0:h.I.emit(y.TOGGLE_TAB,3);break;case 1:h.I.emit(y.TOGGLE_TAB,1)}this.close()},l.onClose=function(){this.close()},a(t,[{key:"DESC_LIST",get:function(){return d.tArray("go_panel.desc_list")}}]),t}(g)).prototype,"titleSp",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(z.prototype,"titleSf",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),G=t(z.prototype,"bgSp",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(z.prototype,"bgSf",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=t(z.prototype,"labDesc",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=z))||w));l._RF.pop()}}}));

System.register("chunks:///_virtual/HandbookItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./GameData.ts","./RoundBox.ts"],(function(t){var e,n,o,i,a,r,c,s,d,l,u,I,h,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,r=t.Sprite,c=t._decorator,s=t.isValid,d=t.resources,l=t.SpriteFrame,u=t.Component},function(t){I=t.AssetMgr},function(t){h=t.GameData},function(t){p=t.RoundBox}],execute:function(){var b,g,f,m,v,y,z,_,k;a._RF.push({},"5e672z9oTdLkqKPbSfROUfY","HandbookItem",void 0);var F=c,H=F.ccclass,M=F.property,A=new Map;t("HandbookItem",(b=H("HandbookItem"),g=M(r),f=M(r),m=M(p),b((z=e((y=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,o(e,"bg",z,i(e)),o(e,"icon",_,i(e)),o(e,"actIcon",k,i(e)),e._data=null,e._currentActId=-1,e}n(e,t);var a=e.prototype;return a.onEnable=function(){this.actIcon&&this.actIcon.node&&(this.actIcon.node.active=!1)},a.refresh=function(t,e){var n=this;if(void 0===e&&(e=!1),e){if(this.bg.node.parent.active=!0,this.icon.node.active=!1,this.actIcon&&this.actIcon.node&&(this.actIcon.node.active=!1),t<0||t>=h.data.collectionIds.length)return console.warn("[HandbookItem] Invalid activity index:",t,"collectionIds length:",h.data.collectionIds.length),void(this._currentActId=-1);var o=h.data.collectionIds[t];if(!o)return console.warn("[HandbookItem] Invalid activity id at index:",t),void(this._currentActId=-1);this._currentActId=o;var i=A.get(o);if(i)return console.log("[HandbookItem] Cache HIT for id:",o),void(s(this.bg)&&(this.bg.sizeMode=r.SizeMode.CUSTOM,this.bg.spriteFrame=i));s(this.bg)&&(this.bg.spriteFrame=null),console.log("[HandbookItem] Loading activity image, id:",o),d.load("activity/act_"+o+"/spriteFrame",l,(function(t,e){t?console.error("[HandbookItem] Failed to load activity image act_"+o+":",t):(e&&A.set(o,e),s(n.node)&&s(n.bg)&&e&&n._currentActId===o&&(n.bg.sizeMode=r.SizeMode.CUSTOM,n.bg.spriteFrame=e,console.log("[HandbookItem] Loaded and set spriteFrame for id:",o)))}))}else{this.bg.node.parent.active=!0,this.icon.node.active=!0,this.actIcon&&this.actIcon.node&&(this.actIcon.node.active=!1),this._currentActId=-1;var a=t+1;I.I.loadPuzzleImg(a,!0).then((function(t){s(n.node)&&(n.bg.spriteFrame=t)})),h.data.mapId>a?I.I.loadPuzzleImg(a,!1).then((function(t){s(n.node)&&(n.icon.spriteFrame=t)})):this.icon.spriteFrame=null}},e}(u)).prototype,"bg",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(y.prototype,"icon",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(y.prototype,"actIcon",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=y))||v));a._RF.pop()}}}));

System.register("chunks:///_virtual/HandbookPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ListView.ts","./ListViewAdapter.ts","./PuzzleMgr.ts","./HandbookItem.ts","./GameData.ts","./Utils.ts","./I18nManager.ts","./I18nImageText.ts"],(function(t){var e,n,i,o,a,s,r,l,c,u,d,h,g,p,f,b,I,m,v,x,w,y,N;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.createForOfIteratorHelperLoose,s=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){l=t.cclegacy,c=t.Node,u=t._decorator,d=t.find,h=t.UITransform,g=t.view,p=t.Label,f=t.Color},function(t){b=t.default},function(t){I=t.default},function(t){m=t.PuzzleMgr},function(t){v=t.HandbookItem},function(t){x=t.GameData},function(t){w=t.Utils},function(t){y=t.I18n},function(t){N=t.I18nImageText}],execute:function(){var _,k,L,C,M,z,T,A,H;l._RF.push({},"4a93b03ogNGy4w7f+H7G1yK","HandbookPanel",void 0);var P=u,B=P.ccclass,S=P.property;t("default",(_=B("home/HandbookPanel"),k=S(b),L=S(c),C=S(c),_((T=e((z=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,i(e,"mainList",T,o(e)),i(e,"toggleNodes",A,o(e)),i(e,"noAct",H,o(e)),e.dataSet=[],e.selIdx=-1,e.i18nLabelMap=new Map,e}n(e,t);var l=e.prototype;return l.onLoad=function(){var t=this;y.on((function(){t.initI18nLabels(),t.initI18nImageTexts()}),this)},l.onEnable=function(){this.initI18nLabels(),this.initI18nImageTexts(),this.adaptBgNode("bg2"),this.adaptBgNode("content/top/title_bg")},l.adaptBgNode=function(t){var e=this.node.getChildByName(t);if(e||(e=d(t,this.node)),e||"title_bg"===t&&(e=d("content/top/title_bg",this.node)),e){var n=e.getComponent(h);if(n){var i=g.getVisibleSize(),o=n.width,a=n.height;if(t.includes("title_bg"))n.setContentSize(i.width,a),console.log("[HandbookPanel] "+t+" width adapted: "+o+" -> "+i.width);else{var s=i.width/o,r=i.height/a,l=Math.max(s,r),c=o*l,u=a*l;n.setContentSize(c,u),console.log("[HandbookPanel] "+t+" adapted: "+o+"x"+a+" -> "+c.toFixed(0)+"x"+u.toFixed(0))}}}},l.initI18nLabels=function(){for(var t,e={"暂时没有解锁的活动插画喔！":"panel.no_unlock_art"},n=this.node.getComponentsInChildren(p),i=a(n);!(t=i()).done;){var o=t.value;if(this.i18nLabelMap.has(o))o.string=y.t(this.i18nLabelMap.get(o));else{var s=e[o.string];s&&(this.i18nLabelMap.set(o,s),o.string=y.t(s))}}},l.initI18nImageTexts=function(){var t=new f(80,60,40,255);this.toggleNodes[0]&&N.replaceImageTexts(this.toggleNodes[0],[{nodeName:"shoucang_word_1",i18nKey:"handbook.gallery",outlineColor:t,outlineWidth:3}]),this.toggleNodes[1]&&N.replaceImageTexts(this.toggleNodes[1],[{nodeName:"shoucang_word_2",i18nKey:"handbook.gallery",outlineColor:t,outlineWidth:3}]),this.toggleNodes[2]&&N.replaceImageTexts(this.toggleNodes[2],[{nodeName:"shoucang_word_2",i18nKey:"handbook.activity",outlineColor:t,outlineWidth:3}]),this.toggleNodes[3]&&N.replaceImageTexts(this.toggleNodes[3],[{nodeName:"shoucang_word_2",i18nKey:"handbook.activity",outlineColor:t,outlineWidth:3}])},l.init=function(){var t=s(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.wait(100);case 2:this.selIdx=-1,this.onMain();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.updateView=function(t,e,n){t.getComponent(v).refresh(e,1==this.selIdx)},l.onMain=function(){var t=s(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=this.selIdx){t.next=2;break}return t.abrupt("return");case 2:this.selIdx=0,this.toggleBtn(),this.dataSet=new Array(m.I.MAX_ID).fill(0),this.mainList.setAdapter(this),this.noAct.active=!1;case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.onActivity=function(){var t=s(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=this.selIdx){t.next=2;break}return t.abrupt("return");case 2:this.selIdx=1,this.toggleBtn(),this.noAct.active=0==x.data.collectionIds.length,this.dataSet=x.data.collectionIds,this.mainList.setAdapter(this);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.toggleBtn=function(){this.toggleNodes[0].active=0!=this.selIdx,this.toggleNodes[1].active=0==this.selIdx,this.toggleNodes[2].active=1!=this.selIdx,this.toggleNodes[3].active=1==this.selIdx},l.onClose=function(){this.close()},e}(I)).prototype,"mainList",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(z.prototype,"toggleNodes",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=e(z.prototype,"noAct",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=z))||M));l._RF.pop()}}}));

System.register("chunks:///_virtual/HelpPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./I18nManager.ts","./I18nImageText.ts"],(function(e){var t,n,i,o,a,r,l,s,c,p,u,h,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,a=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,l=e.Node,s=e.sp,c=e._decorator,p=e.Label},function(e){u=e.default},function(e){h=e.I18n},function(e){d=e.I18nImageText}],execute:function(){var g,b,f,v,x,y,_,m,w,I,P;r._RF.push({},"a2041iNNDhLpK9Oe/30YB/e","HelpPanel",void 0);var L=c,z=L.ccclass,H=L.property;e("default",(g=z("panel/HelpPanel"),b=H(l),f=H(l),v=H(l),x=H(s.Skeleton),g((m=t((_=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,i(t,"box1",m,o(t)),i(t,"box2",w,o(t)),i(t,"box3",I,o(t)),i(t,"sp",P,o(t)),t.page=0,t}n(t,e);var r=t.prototype;return r.onEnable=function(){this.initI18nLabels()},r.initI18nLabels=function(){var e=this.node.getChildByPath("content/board/shuoming_word");e?(console.log("[HelpPanel] Found title node, applying I18n"),d.addOrUpdateLabel(e,{nodeName:"shuoming_word",i18nKey:"help.title",fontSize:60,outlineWidth:4,useCustomFont:!0})):console.warn("[HelpPanel] Title node shuoming_word not found!");for(var t,n={"拖动底部生成的方块放入棋盘，\n放满一行或者一列，消除方块获得分数":"help.drag_desc","每次放入都会加分\n一次性消除多行有额外加分喔\n当下方块不能放入则游戏结束":"help.score_desc","通过消除宝石来收集它,每收集一块宝石,\n你就离胜利更近一步!":"help.jewel_desc","木块障碍，可通过消除逐渐减少":"help.wood_desc","石头块，固定障碍物，不可消除":"help.stone_desc","下一页":"panel.next_page"},i=this.node.getComponentsInChildren(p),o=a(i);!(t=o()).done;){var r=t.value,l=n[r.string];l&&(r.string=h.t(l))}},r.init=function(e){this.box1.active=this.box2.active=this.box3.active=!1,this.box1.active=1==e,this.box2.active=2==e,this.box3.active=3==e,1==e&&(this.page=0,this.showPage())},r.showPage=function(){this.sp.setAnimation(0,0==this.page?"pingtu_1":"pingtu_2"),this.box1.children[0].active=0==this.page,this.box1.children[1].active=1==this.page},r.onNext=function(){1==this.page?this.page--:this.page++,this.showPage()},r.onClose=function(){this.close()},t}(u)).prototype,"box1",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(_.prototype,"box2",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(_.prototype,"box3",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(_.prototype,"sp",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=_))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/Home.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./Const.ts","./Enum.ts","./GameData.ts","./TDataMgr.ts","./Utils.ts","./AudioManager.ts","./EventManager.ts","./PoolManager.ts","./UIManager.ts","./BoardDataMgr.ts","./BtnEndLess.ts","./BtnHomeLv.ts","./PuzzleMgr.ts","./PlatformManager.ts","./SdkTools.ts","./ActivityMgr.ts","./I18nImageText.ts","./I18nManager.ts"],(function(e){var t,n,i,a,r,o,s,l,u,c,h,d,f,p,g,m,v,y,b,x,I,w,z,P,T,C,S,k,_,D,B,M,L,N,H,E,A,G,j,U,R,K,F,W;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose,o=e.asyncToGenerator,s=e.regeneratorRuntime,l=e.createClass},function(e){u=e.cclegacy,c=e.Component,h=e.Node,d=e.Sprite,f=e._decorator,p=e.sys,g=e.Color,m=e.Label,v=e.UITransform,y=e.LabelOutline,b=e.screen,x=e.view,I=e.Widget,w=e.ParticleSystem2D},function(e){z=e.AssetMgr},function(e){P=e.BUNDLES},function(e){T=e.EventType,C=e.GameType},function(e){S=e.GameData},function(e){k=e.TDataMgr},function(e){_=e.Utils},function(e){D=e.AudioManager},function(e){B=e.default},function(e){M=e.default,L=e.PoolName},function(e){N=e.default,H=e.PanelType},function(e){E=e.BoardDataMgr},function(e){A=e.BtnEndLess},function(e){G=e.BtnHomeLv},function(e){j=e.PuzzleMgr},function(e){U=e.PlatformManager},function(e){R=e.SdkTools},function(e){K=e.ActivityMgr},function(e){F=e.I18nImageText},function(e){W=e.I18n}],execute:function(){var O,V,X,J,Q,Y,Z,q,$,ee,te,ne,ie,ae,re;u._RF.push({},"aa7566Df2ZJb50ekdFVFwD5","Home",void 0),console.log("[Load] Loading Home.ts");var oe=f,se=oe.ccclass,le=oe.property,ue=(e("Home",(O=se("game/Home"),V=le(c),X=le(h),J=le(d),Q=le(G),Y=le(A),Z=le(h),O((ee=t(($=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"main",ee,a(t)),i(t,"puzzleNode",te,a(t)),i(t,"puzzleBg",ne,a(t)),i(t,"labLevel",ie,a(t)),i(t,"btnEndless",ae,a(t)),i(t,"btnTuijian",re,a(t)),t.puzzles=[],t.Col=20,t.Row=20,t.isInit=!1,t.listData=[],t.lastId=0,t.lastIdx=0,t.isInitTuijian=!1,t.recommendPageManager=void 0,t}n(t,e);var l=t.prototype;return l.onLoad=function(){var e=o(s().mark((function e(){var t,n,i,a,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log("[Home] onLoad"),"Yandex"===U.getInstance().current.name&&p.isMobile&&(console.log("[Home] Yandex Mobile detected. aligning to TOP."),(t=this.node.getComponent(I))||(t=this.node.addComponent(I)),t.isAlignTop=!0,t.top=0,t.updateAlignment()),n=0;n<this.Col;n++)for(i=0;i<this.Row;i++)(a=M.get(L.puzzle)).addComponent(ue),this.puzzleNode.addChild(a),(r=a.getComponent(ue)).initPos(n,i,this.Col,this.Col),r.changeColor(0),this.puzzles.push(r);this.isInit=!0,this.initPuzzle(!0),this.initTuijian(),this.initI18nImageTexts(),B.I.on(T.CHECK_OPEN_GO,this.checkGoWin,this),B.I.on(T.DATA_SYNCED,this.onDataSynced,this);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onDataSynced=function(){console.log("[Home] onDataSynced, refreshing UI..."),this.labLevel.refresh(S.data.level),this.refreshLevelButtonText()},l.onEnable=function(){var e=o(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.labLevel.refresh(S.data.level),this.btnEndless.refresh(),this.isInit&&this.initPuzzle(),this.checkShowTuijian(),this.refreshLevelButtonText(),!p.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.GameService&&PUCHI_SDK.GameService.switchBackButtonInTb&&PUCHI_SDK.GameService.switchBackButtonInTb(!0);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onDisable=function(){!p.isNative&&"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.GameService&&PUCHI_SDK.GameService.switchBackButtonInTb&&PUCHI_SDK.GameService.switchBackButtonInTb(!1)},l.initI18nImageTexts=function(){var e=[{nodeName:"zhuye_word_6",i18nKey:"buttons.classic_mode",outlineColor:new g(80,60,40,255),outlineWidth:2}];F.replaceImageTexts(this.node,e),F.listenLanguageChange(this.node,e,this),this.updateLevelButtonText()},l.updateLevelButtonText=function(){var e=this,t=new g(80,60,40,255),n=this.findNodeByName(this.node,"zhuye_word_1"),i=this.findNodeByName(this.node,"zhuye_word_2");if(n&&(n.active=!1),i&&(i.active=!1),this.labLevel&&this.labLevel.node){var a=this.findNodeByName(this.labLevel.node,"labLv");a&&(a.active=!1);for(var o,s=this.labLevel.node.getComponentsInChildren(m),l=r(s);!(o=l()).done;){var u=o.value;/^\d+$/.test(u.string)&&(u.node.active=!1)}}var c=(null==n?void 0:n.parent)||(null==i?void 0:i.parent);if(c){var d=c.getChildByName("_i18n_level_label");if(!d){(d=new h("_i18n_level_label")).layer=c.layer,c.addChild(d),d.setPosition(0,0,0),d.addComponent(v).setContentSize(300,50);var f=d.addComponent(m);f.horizontalAlign=m.HorizontalAlign.CENTER,f.verticalAlign=m.VerticalAlign.CENTER,f.overflow=m.Overflow.NONE,f.isBold=!0,f.fontSize=42,f.lineHeight=46,f.color=new g(255,255,255);d.addComponent(y);f.outlineColor=t,f.outlineWidth=4}var p=d.getComponent(m);p&&(p.string=W.t("buttons.level",S.data.level))}W.on((function(){e.refreshLevelButtonText()}),this)},l.refreshLevelButtonText=function(){var e=this.findNodeByName(this.node,"zhuye_word_1");if(e&&e.parent){var t=e.parent.getChildByName("_i18n_level_label");if(t){var n=t.getComponent(m);n&&(n.string=W.t("buttons.level",S.data.level))}}},l.findNodeByName=function(e,t){for(var n,i=r(e.children);!(n=i()).done;){var a=n.value;if(a.name===t)return a;var o=this.findNodeByName(a,t);if(o)return o}return null},l.onSetting=function(){N.openPanel(H.SettingPanel,!1)},l.onLevel=function(){var e=o(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S.data.isLevelDie){e.next=7;break}return 0!==S.data.levelData.map.length&&E.I.resetLevelData(),e.next=4,R.share("level_start");case 4:return 0==e.sent.code?(this.main.starGame(C.level,!0),S.data.level_ad_count++):this.checkGoWin(),e.abrupt("return");case 7:this.main.starGame(C.level);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onPlay=function(){var e=o(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(S.data.today_restart>=_.getOnlineParamInt("today_restart_limit",3))){e.next=7;break}if(0!=S.data.endlessData.map.length){e.next=7;break}return e.next=4,R.share("game_start");case 4:return 0==e.sent.code&&this.main.starGame(C.default,!0),e.abrupt("return");case 7:this.main.starGame(C.default);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.checkGoWin=function(){_.getServerTime()-S.data.goActivityTime>_.getOnlineParamInt("activity_time",86400)?(S.data.goActivityTime=_.getServerTime(),!K.I.isMAX&&K.I.leftTime>0&&N.openPanel(H.GoPanel,0)):_.getServerTime()-S.data.goDailyTime>_.getOnlineParamInt("daily_time",86400)&&(S.data.goDailyTime=_.getServerTime(),N.openPanel(H.GoPanel,1))},l.onRank=function(){N.openPanel(H.RankPanel)},l.onSkin=function(){N.openPanel(H.SkinPanel)},l.computWxPosition=function(e){var t={left:0,top:0,width:0,height:0},n=e.worldPosition,i=e.getComponent(v).width,a=e.getComponent(v).height,r=b.devicePixelRatio,o=x.getScaleX()/r;t.left=(n.x-i/2)*o;var s=0;return s="undefined"!=typeof wx&&wx.getSystemInfoSync?wx.getSystemInfoSync().screenHeight:x.getFrameSize().height,t.top=s-(n.y+a/2)*o,t.width=i*o,t.height=a*o,t},l.initPuzzle=function(){var e=o(s().mark((function e(t){var n,i,a,r,o,l,u,c,h,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),n=j.I.isMax,i=n?S.data.mapId-1:S.data.mapId,this.lastId!==i&&(this.lastIdx=0,this.puzzles.forEach((function(e){return e.changeColor(0)})),this.puzzleBg.spriteFrame=null),e.next=6,z.I.loadPuzzleImg(i,!0);case 6:return this.puzzleBg.spriteFrame=e.sent,e.next=9,j.I.loadMap(i);case 9:if(this.listData=e.sent,a=n?this.listData.length:S.data.mapIndex,!this.listData){e.next=31;break}for(this.lastId!==i&&(this.lastIdx=0,this.puzzles.forEach((function(e){return e.changeColor(0)}))),this.lastId=i,r=this.lastIdx,this.lastIdx!==a&&(t=!0,this.lastIdx=a),o=0,l=0,u=0;u<this.listData.length;u++)c=this.listData[u],o=Math.max(c.x,o),l=Math.max(c.y,l);this.puzzleNode.setPosition((this.Col-1-l)/2*26,-(this.Row-1-o)/2*26),h=r;case 21:if(!(h<this.listData.length)){e.next=31;break}if(d=this.listData[h],!(h<a)){e.next=28;break}if(this.puzzles[d.y+d.x*this.Row].changeColor(d.blockType),!t){e.next=28;break}return e.next=28,_.wait(10);case 28:h++,e.next=21;break;case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.initTuijian=function(){var e=o(s().mark((function e(){var t,n,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S.data.tuijian){e.next=2;break}return e.abrupt("return");case 2:if(!p.isNative){e.next=4;break}return e.abrupt("return");case 4:if("undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.IsWx){e.next=6;break}return e.abrupt("return");case 6:if(!(S.data.level<10)){e.next=8;break}return e.abrupt("return");case 8:if(t={width:88,height:32,left:277,top:44,right:365,bottom:76},"undefined"!=typeof wx&&wx.getMenuButtonBoundingClientRect&&(t=wx.getMenuButtonBoundingClientRect()),"undefined"!=typeof wx&&wx.getSystemInfoSync){e.next=12;break}return e.abrupt("return");case 12:if(n=wx.getSystemInfoSync().windowWidth/375,i=wx.getSystemInfoSync().screenHeight/n-(2*t.top+t.height)/n,this.btnTuijian.setPosition(this.btnTuijian.position.x,i,0),wx.createPageManager){e.next=17;break}throw"当前基础库版本暂不支持。";case 17:return this.recommendPageManager=wx.createPageManager(),e.next=20,this.recommendPageManager.load({openlink:"TWFRCqV5WeM2AkMXhKwJ03MhfPOieJfAsvXKUbWvQFQtLyyA5etMPabBehga950uzfZcH3Vi3QeEh41xRGEVFw"});case 20:this.isInitTuijian=!0,this.checkShowTuijian();case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.checkShowTuijian=function(){this.isInitTuijian&&(S.data.tuijian||S.data.onlineTime>300&&(this.btnTuijian.active=!0,k.ins.dot("tuijian",{setp:1})))},l.onTuijian=function(){this.btnTuijian.active=!1,S.data.tuijian=!0,k.ins.dot("tuijian",{setp:2}),this.recommendPageManager.show()},l.onXialuo=function(){var e=o(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t}(c)).prototype,"main",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t($.prototype,"puzzleNode",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t($.prototype,"puzzleBg",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=t($.prototype,"labLevel",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=t($.prototype,"btnEndless",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=t($.prototype,"btnTuijian",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=$))||q)),function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))||this).par=null,t._color=void 0,t}n(t,e);var i=t.prototype;return i.onLoad=function(){this.par=this.node.children[0].getComponent(w)},i.initPos=function(e,t,n,i){var a=13-26*n/2+26*t,r=26*i/2-13-26*e;this.node.setPosition(a,r)},i.changeColor=function(){var e=o(s().mark((function e(t,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),this._color=t,!t){e.next=9;break}return e.next=5,z.I.loadIcon(P.Game,"puzzle/block/block_"+t);case 5:this.node.getComponent(d).spriteFrame=e.sent,n&&(D.I.playEffect("block_drop"),this.par.resetSystem()),e.next=10;break;case 9:this.node.getComponent(d).spriteFrame=null;case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),l(t,[{key:"color",get:function(){return this._color}}]),t}(c));u._RF.pop()}}}));

System.register("chunks:///_virtual/I18nImageText.ts",["./rollupPluginModLoBabelHelpers.js","cc","./I18nManager.ts"],(function(e){var n,o,t,a,i,l,r,s,d,u,c,f;return{setters:[function(e){n=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,t=e.Sprite,a=e.UITransform,i=e.Node,l=e.Label,r=e.Color,s=e.resources,d=e.Font,u=e.isValid,c=e.LabelOutline},function(e){f=e.I18n}],execute:function(){o._RF.push({},"1b3aeCMZepAkZtD6r068N7s","I18nImageText",void 0),e("I18nImageText",function(){function e(){}return e.findAllNodesRecursive=function(e,o,t,a){void 0===t&&(t=[]),void 0===a&&(a=0);for(var i,l=n(e.children);!(i=l()).done;){var r=i.value;r.name!==o||t.includes(r)||t.push(r),this.findAllNodesRecursive(r,o,t,a+1)}return t},e.replaceImageTexts=function(e,o){for(var a,i=n(o);!(a=i()).done;){var l=a.value,r=this.findAllNodesRecursive(e,l.nodeName,[]);if(0!==r.length){console.log("[I18nImageText] Found "+r.length+" nodes for "+l.nodeName);for(var s,d=n(r);!(s=d()).done;){var u=s.value;if(!l.keepOriginalImage){var c=u.getComponent(t);c&&(c.spriteFrame=null,c.enabled=!1)}this.addOrUpdateLabel(u,l)}}else console.warn("[I18nImageText] Node not found: "+l.nodeName)}},e.addOrUpdateLabel=function(e,n){var o=this;if(!n.keepOriginalImage){var m=e.getComponent(t);m&&(m.enabled=!1)}var g,h=e.getChildByName("_i18n_label"),v=e.getComponent(a),p=n.fontSize||24;if(v&&!n.fontSize&&(p=Math.floor(.65*v.height),p=Math.max(16,Math.min(p,48))),h)h.active=!0,(g=h.getComponent(l)).overflow=l.Overflow.NONE;else{(h=new i("_i18n_label")).layer=e.layer,e.addChild(h);var I=h.addComponent(a);v&&I.setContentSize(1.5*v.width,v.height),(g=h.addComponent(l)).horizontalAlign=l.HorizontalAlign.CENTER,g.verticalAlign=l.VerticalAlign.CENTER,g.overflow=l.Overflow.NONE}var C=n.params||[];if(g.string=f.t.apply(f,[n.i18nKey].concat(C)),n.i18nKey.includes("unlock")&&console.log('[I18nImageText] Unlock label string: "'+g.string+'" (Key: '+n.i18nKey+", Params: "+C+")"),g.fontSize=p,g.lineHeight=p+4,g.color=n.color||new r(255,255,255),g.isBold=!0,!1!==n.useCustomFont&&(this.commonFont?(g.font=this.commonFont,g.useSystemFont=!1):s.load("font/font",d,(function(e,n){e?console.warn("[I18nImageText] Failed to load font:",e):(o.commonFont=n,u(h)&&(g.font=n,g.useSystemFont=!1))}))),n.outlineWidth||n.outlineColor){var N=h.getComponent(c);N||(N=h.addComponent(c)),g.outlineColor=n.outlineColor||new r(50,50,100,255),g.outlineWidth=n.outlineWidth||Math.max(2,Math.floor(p/12))}n.offset?h.setPosition(n.offset):h.setPosition(0,0,0)},e.listenLanguageChange=function(e,n,o){var t=this;f.on((function(o){u(e)&&t.replaceImageTexts(e,n)}),o)},e}()).commonFont=null,o._RF.pop()}}}));

System.register("chunks:///_virtual/I18nLabel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./I18nManager.ts"],(function(n){var e,t,i,a,o,r,l,s,u,c;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,i=n.initializerDefineProperty,a=n.assertThisInitialized},function(n){o=n.cclegacy,r=n.CCString,l=n._decorator,s=n.Label,u=n.Component},function(n){c=n.I18n}],execute:function(){var p,h,g,f,b,y,d,m;o._RF.push({},"f5a1biI0vZOXLnpQdZ/xaFy","I18nLabel",void 0);var L=l,v=L.ccclass,_=L.property,I=L.menu,C=L.executeInEditMode;n("I18nLabel",(p=v("I18nLabel"),h=I("i18n/I18nLabel"),g=_({tooltip:'翻译键，如 "common.confirm" 或 "game.level"'}),f=_({tooltip:"替换参数，用于替换 {0}, {1} 等占位符",type:[r]}),p(b=h(b=C((d=e((y=function(n){function e(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return e=n.call.apply(n,[this].concat(o))||this,i(e,"i18nKey",d,a(e)),i(e,"params",m,a(e)),e._label=null,e._originAlign=s.HorizontalAlign.CENTER,e}t(e,n);var o=e.prototype;return o.onLoad=function(){this._label=this.getComponent(s),this._label?(this._originAlign=this._label.horizontalAlign,c.on(this.onLanguageChanged,this),this.updateLabel()):console.warn("[I18nLabel] No Label component found on node: "+this.node.name)},o.onDestroy=function(){c.off(this.onLanguageChanged,this)},o.onLanguageChanged=function(n){this.updateLabel()},o.updateLabel=function(){if(this._label&&this.i18nKey){var n=c.t.apply(c,[this.i18nKey].concat(this.params));this._label.string=n}},o.setKey=function(n){this.i18nKey=n;for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];this.params=t.map((function(n){return String(n)})),this.updateLabel()},o.setParams=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];this.params=e.map((function(n){return String(n)})),this.updateLabel()},e}(u)).prototype,"i18nKey",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),m=e(y.prototype,"params",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),b=y))||b)||b)||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/I18nManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,a,r,i,o,s,u,g;return{setters:[function(n){t=n.createForOfIteratorHelperLoose,e=n.createClass,a=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){i=n.cclegacy,o=n.sys,s=n.EventTarget,u=n.resources,g=n.JsonAsset}],execute:function(){i._RF.push({},"c9155ZIQlBHQKH6cWvw/mxI","I18nManager",void 0),console.log("[Load] Loading I18nManager.ts");var c=n("Language",function(n){return n.ZH_CN="zh-CN",n.ZH_TW="zh-TW",n.EN_US="en-US",n.RU="ru",n.ID="id",n.FR="fr",n.ES="es",n.PT="pt",n.AR="ar",n.KO="ko-KR",n.JA="ja",n}({})),l=n("I18N_LANGUAGE_CHANGED","I18N_LANGUAGE_CHANGED"),f=n("I18nManager",function(){function n(){this._currentLang=c.EN_US,this._langData={},this._initialized=!1,this._eventTarget=new s}var i=n.prototype;return i.init=function(){var n=a(r().mark((function n(t){var e,a,i;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._initialized){n.next=3;break}return console.log("[I18n] Already initialized"),n.abrupt("return");case 3:return(e=t)||((a=window.yandexLang)?(console.log("[I18n] Yandex SDK language detected: "+a),e=this.mapYandexLanguage(a),console.log("[I18n] Mapped to Language enum: "+e)):(i=o.localStorage.getItem("i18n_language"),e=i&&Object.values(c).includes(i)?i:this.detectSystemLanguage())),console.log("[I18n] Initializing with language: "+e),n.next=8,this.loadLanguage(e);case 8:this._initialized=!0,console.log("[I18n] Initialized successfully");case 10:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),i.mapYandexLanguage=function(n){return"ru"===n?c.RU:"zh"===n?c.ZH_CN:"id"===n?c.ID:"fr"===n?c.FR:"es"===n?c.ES:"pt"===n?c.PT:"ar"===n?c.AR:"ko"===n?c.KO:"ja"===n?c.JA:c.EN_US},i.detectSystemLanguage=function(){var n=window.yandexLang;if(n)return console.log("[I18n] detectSystemLanguage: Using Yandex SDK language: "+n),this.mapYandexLanguage(n);var t=o.language;if(console.log("[I18n] System language: "+t),console.log("[I18n] System Language Code: "+t),t.startsWith("zh")){var e=o.languageCode?o.languageCode.toLowerCase():"";return e.includes("tw")||e.includes("hk")?c.ZH_TW:c.ZH_CN}return t.startsWith("ru")?c.RU:t.startsWith("id")||t.startsWith("in")?c.ID:t.startsWith("fr")?c.FR:t.startsWith("es")?c.ES:t.startsWith("pt")?c.PT:t.startsWith("ar")?c.AR:t.startsWith("ko")?c.KO:t.startsWith("ja")?c.JA:c.EN_US},i.loadLanguage=function(){var n=a(r().mark((function n(t){var e=this;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,a){var r="i18n/"+t;console.log("[I18n] Loading language pack: "+r),u.load(r,g,(function(i,o){if(i)return console.error("[I18n] Failed to load language pack: "+r,i),void(t!==c.ZH_CN?(console.log("[I18n] Falling back to zh-CN"),e.loadLanguage(c.ZH_CN).then(n).catch(a)):(e._langData={},e._currentLang=t,n()));e._langData=o.json||{},e._currentLang=t,console.log("[I18n] Language pack loaded: "+t+", keys: "+Object.keys(e._langData).length),n()}))})));case 1:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),i.setLanguage=function(){var n=a(r().mark((function n(t){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t!==this._currentLang){n.next=2;break}return n.abrupt("return");case 2:return console.log("[I18n] Switching language: "+this._currentLang+" -> "+t),n.next=5,this.loadLanguage(t);case 5:o.localStorage.setItem("i18n_language",t),this._eventTarget.emit(l,t);case 7:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),i.t=function(n){for(var e,a=n.split("."),r=this._langData,i=t(a);!(e=i()).done;){var o=e.value;if(!r||"object"!=typeof r||!(o in r))return console.warn("[I18n] Missing translation: "+n),n;r=r[o]}if("string"!=typeof r)return console.warn("[I18n] Invalid translation value for: "+n),n;for(var s=r,u=0;u<(arguments.length<=1?0:arguments.length-1);u++)s=s.replace(new RegExp("\\{"+u+"\\}","g"),String(u+1<1||arguments.length<=u+1?void 0:arguments[u+1]));return s},i.tArray=function(n){for(var e,a=n.split("."),r=this._langData,i=t(a);!(e=i()).done;){var o=e.value;if(!r||"object"!=typeof r||!(o in r))return console.warn("[I18n] Missing translation: "+n),[];r=r[o]}return Array.isArray(r)?r:(console.warn("[I18n] Translation value is not an array: "+n),[])},i.has=function(n){for(var e,a=n.split("."),r=this._langData,i=t(a);!(e=i()).done;){var o=e.value;if(!r||"object"!=typeof r||!(o in r))return!1;r=r[o]}return"string"==typeof r},i.on=function(n,t){this._eventTarget.on(l,n,t)},i.off=function(n,t){this._eventTarget.off(l,n,t)},i.isZh=function(){return this._currentLang===c.ZH_CN},i.isRtl=function(){return this._currentLang===c.AR},e(n,[{key:"currentLanguage",get:function(){return this._currentLang}}],[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}());f._instance=null;n("I18n",f.instance);i._RF.pop()}}}));

System.register("chunks:///_virtual/I18nSprite.ts",["./rollupPluginModLoBabelHelpers.js","cc","./I18nManager.ts","./AssetMgr.ts","./Const.ts"],(function(e){var t,n,r,a,i,u,s,c,o,p;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e.isValid,i=e.SpriteFrame,u=e.Sprite},function(e){s=e.I18n,c=e.Language},function(e){o=e.AssetMgr},function(e){p=e.BUNDLES}],execute:function(){r._RF.push({},"bd568nYTS5ApI/G4ZO2k4rC","I18nSprite",void 0);e("I18nSprite",function(){function e(){}return e.getLanguageSuffix=function(){switch(s.currentLanguage){case c.EN_US:return"_en";case c.ZH_CN:default:return""}},e.loadSprite=function(){var e=t(n().mark((function e(t,r){var u,s,c,f,l,d;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&a(t.node)){e.next=2;break}return e.abrupt("return");case 2:return u=this.getLanguageSuffix(),s=r.bundle||p.Panel,c=r.pathPrefix||"images/",f=""+c+r.imageName+u,e.prev=6,e.next=9,o.I.loadAsync(s,f,i);case 9:if(!(l=e.sent)||!a(t.node)){e.next=13;break}return t.spriteFrame=l,e.abrupt("return");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(6),console.log("[I18nSprite] Fallback to original: "+r.imageName);case 18:if(""===u){e.next=30;break}return e.prev=19,f=""+c+r.imageName,e.next=23,o.I.loadAsync(s,f,i);case 23:(d=e.sent)&&a(t.node)&&(t.spriteFrame=d),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(19),console.warn("[I18nSprite] Failed to load: "+f);case 30:case"end":return e.stop()}}),e,this,[[6,15],[19,27]])})));return function(t,n){return e.apply(this,arguments)}}(),e.updateNodeSprite=function(){var e=t(n().mark((function e(t,r){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&a(t)){e.next=2;break}return e.abrupt("return");case 2:if(!(i=t.getComponent(u))){e.next=6;break}return e.next=6,this.loadSprite(i,r);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e.updateSprites=function(){var e=t(n().mark((function e(t,r){var a,i,u,s,c,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,i=Object.entries(r);case 1:if(!(a<i.length)){e.next=13;break}if(u=i[a],s=u[0],c=u[1],!(o=t.getChildByPath(s)||t.getChildByName(s))){e.next=9;break}return e.next=7,this.updateNodeSprite(o,c);case 7:e.next=10;break;case 9:console.warn("[I18nSprite] Node not found: "+s);case 10:a++,e.next=1;break;case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}());r._RF.pop()}}}));

System.register("chunks:///_virtual/IPhoneXScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlatformManager.ts"],(function(e){var t,o,i,n,r,s,f,a,l,h,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,f=e.Widget,a=e.view,l=e.UITransform,h=e.Component},function(e){p=e.PlatformManager}],execute:function(){var g,c,u,d,b,m,y,I,v,w,S,P,X,z,T;r._RF.push({},"68137d6oLFNvJRxpGg6nlmY","IPhoneXScreen",void 0);var L=s,R=L.ccclass,x=L.property,B=L.menu;e("default",(g=B("自定义/IPhoneXScreen"),c=x({tooltip:"如果是IphoneX时高度偏移"}),u=x({tooltip:"如果是IphoneX时宽度偏移"}),d=x({tooltip:"如果是IphoneX时top偏移"}),b=x({tooltip:"如果是IphoneX时left偏移"}),m=x({tooltip:"如果是IphoneX时right偏移"}),y=x({tooltip:"如果是IphoneX时bottom偏移"}),R(I=g((w=t((v=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,i(t,"height",w,n(t)),i(t,"width",S,n(t)),i(t,"offsetTop",P,n(t)),i(t,"offsetLeft",X,n(t)),i(t,"offsetRight",z,n(t)),i(t,"offsetBottom",T,n(t)),t}o(t,e);var r=t.prototype;return r.start=function(){var e=p.getInstance().current;e&&"Yandex"===e.name?console.log("[IPhoneXScreen] Skipping auto-refresh for Yandex (handled in Game.ts)"):this.refresh()},r.refresh=function(){var e=this.node.getComponent(f);if(!this._applied){var t=p.getInstance().current.getSafeAreaTop(),o=t>20;if(("Yandex"===p.getInstance().current.name||window.ysdk)&&t>0&&(o=!0),0===t){o=a.getVisibleSize().height/a.getVisibleSize().width>1.833}if(o&&e)if(this._applied=!0,this.node.getComponent(l)&&(this.node.getComponent(l).height+=this.height,this.node.getComponent(l).width+=this.width),t>0){var i=this.offsetTop>0?this.offsetTop:t;if(console.log("[IPhoneXScreen] Applying Top Offset: "+i+" (SafeTop: "+t+")"),e&&(console.log("[IPhoneXScreen] Disabling Widget to prevent layout override. Original AlignFlags: "+e.alignFlags),e.enabled=!1),i>0){var n=this.node.position;console.log("[IPhoneXScreen] Original Position Y: "+n.y+". Translating by -"+i),this.node.setPosition(n.x,n.y-i,n.z),console.log("[IPhoneXScreen] New Position Y: "+this.node.position.y)}this.offsetLeft>0&&(e.left+=this.offsetLeft),this.offsetRight>0&&(e.right+=this.offsetRight),this.offsetBottom>0&&(e.bottom+=this.offsetBottom)}else{var r=a.getVisibleSize().height/a.getVisibleSize().width,s=1.833;e.top+=this.offsetTop*(r-s+1),e.left+=this.offsetLeft*(r-s+1),e.right+=this.offsetRight*(r-s+1),e.bottom+=this.offsetBottom*(r-s+1),e.updateAlignment()}}},t}(h)).prototype,"height",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),S=t(v.prototype,"width",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),P=t(v.prototype,"offsetTop",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),X=t(v.prototype,"offsetLeft",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=t(v.prototype,"offsetRight",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),T=t(v.prototype,"offsetBottom",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),I=v))||I)||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/IPlatform.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"4bbe4L6axtJ27eo4P2lc2rp","IPlatform",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/LanguagePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./I18nManager.ts","./AudioManager.ts","./EventManager.ts","./Enum.ts"],(function(e){var n,t,a,i,o,r,l,c,s,u,g,d,h,f,p,m,C,v,y,L,b,A,E,P,_,S;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e.Node,s=e.Prefab,u=e._decorator,g=e.Label,d=e.Color,h=e.Widget,f=e.Layout,p=e.Size,m=e.instantiate,C=e.UITransform,v=e.Graphics,y=e.LabelOutline,L=e.Button},function(e){b=e.default},function(e){A=e.Language,E=e.I18n},function(e){P=e.AudioManager},function(e){_=e.default},function(e){S=e.EventType}],execute:function(){var w,I,z,N,R,T,B;l._RF.push({},"94bf50vholIFaeuW0H2nA6+","LanguagePanel",void 0);var x=u,H=x.ccclass,k=x.property;e("default",(w=H("panel/LanguagePanel"),I=k(c),z=k(s),w((T=n((R=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return n=e.call.apply(e,[this].concat(o))||this,a(n,"content",T,i(n)),a(n,"itemPrefab",B,i(n)),n._langList=[{lang:A.EN_US,name:"English"},{lang:A.RU,name:"Русский"},{lang:A.KO,name:"한국어"},{lang:A.JA,name:"日本語"},{lang:A.ID,name:"Indonesia"},{lang:A.FR,name:"Français"},{lang:A.ES,name:"Español"},{lang:A.PT,name:"Português"},{lang:A.AR,name:"العربية"},{lang:A.ZH_CN,name:"简体中文"},{lang:A.ZH_TW,name:"繁體中文"}],n}t(n,e);var l=n.prototype;return l.onLoad=function(){var e=this;this.initList();for(var n=null,t=function(){var t=i[a];if((n=e.node.getChildByPath(t)||e.node.getChildByPath("content/"+t)||e.node.getChildByPath("root/"+t))||e.node.walk((function(e){e.name===t&&(n=e)})),n)return 1},a=0,i=["btn_close","close","btn_exit","Video_exit_button"];a<i.length&&!t();a++);n&&n.on("click",this.onClose,this)},l.onEnable=function(){this.updateSelection()},l.updateSelection=function(){if(this.content){var e=this.content.getChildByName("lang_list");e&&e.children.forEach((function(e){var n=e.name,t=e.getComponentInChildren(g),a=e.getChildByName("SelectedBG"),i=n===E.currentLanguage;a&&(a.active=i),t&&(t.color=new d(255,255,255),t.outlineColor&&(t.outlineColor=new d(0,0,0,150)))}))}},l.initList=function(){var e=this;if(this.content){var n=this.content.getChildByName("lang_list");if(!n){(n=new c("lang_list")).layer=this.content.layer,this.content.addChild(n);var t=n.addComponent(h);t.isAlignHorizontalCenter=!0,t.horizontalCenter=-170,t.isAlignVerticalCenter=!0,t.verticalCenter=-30}var a=n.getComponent(f);a||(a=n.addComponent(f)),a.type=f.Type.GRID,a.resizeMode=f.ResizeMode.CONTAINER,a.startAxis=f.AxisDirection.HORIZONTAL,a.cellSize=new p(220,90),a.spacingX=20,a.spacingY=15,a.constraint=f.Constraint.FIXED_COL,a.constraintNum=2,n.removeAllChildren(),this._langList.forEach((function(t){var a=e.createItem(t);n.addChild(a)})),this.scheduleOnce((function(){a.updateLayout();var t=n.getComponent(h);t&&t.updateAlignment(),e.updateSelection()}),0)}},l.createItem=function(e){var n,t=this;if(this.itemPrefab)n=m(this.itemPrefab);else{(n=new c(e.lang)).layer=this.node.layer;var a=n.getComponent(C);a||(a=n.addComponent(C)),a.setContentSize(220,90);var i=new c("SelectedBG");i.layer=this.node.layer;var o=i.addComponent(v);o.fillColor=new d(170,184,231,255);o.roundRect(-110,-40,220,80,15),o.fill(),i.active=!1,n.addChild(i);var r=new c("Label");r.layer=this.node.layer;var l=r.addComponent(g);l.string=e.name,l.fontSize=36,l.lineHeight=40,l.color=new d(255,255,255),l.horizontalAlign=g.HorizontalAlign.CENTER,l.verticalAlign=g.VerticalAlign.CENTER;r.addComponent(y);l.outlineColor=new d(0,0,0,150),l.outlineWidth=3,n.addChild(r)}var s=n.getComponent(L);return s||(s=n.addComponent(L)),s.transition=L.Transition.SCALE,s.zoomScale=.95,n.on("click",(function(){t.onSelectLanguage(e.lang)}),this),n},l.onSelectLanguage=function(){var e=o(r().mark((function e(n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.I.playEffect("click"),console.log("[LanguagePanel] Selecting language: "+n),n!==E.currentLanguage){e.next=6;break}return console.log("[LanguagePanel] Already current language."),this.close(),e.abrupt("return");case 6:return e.prev=6,e.next=9,E.setLanguage(n);case 9:console.log("[LanguagePanel] Language set to "+n+" success."),_.I.emit(S.LANGUAGE_CHANGED),this.close(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),console.error("[LanguagePanel] Failed to set language:",e.t0);case 17:case"end":return e.stop()}}),e,this,[[6,14]])})));return function(n){return e.apply(this,arguments)}}(),l.onClose=function(){this.close()},n}(b)).prototype,"content",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(R.prototype,"itemPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=R))||N));l._RF.pop()}}}));

System.register("chunks:///_virtual/ListView.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,n,o,s,h,l,r,a,c,u,d,p,f,g,m,y,w,_,b,v;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,s=t.createClass,h=t.asyncToGenerator,l=t.regeneratorRuntime},function(t){r=t.cclegacy,a=t.Vec2,c=t.CCInteger,u=t.ScrollView,d=t.Prefab,p=t._decorator,f=t.NodePool,g=t.instantiate,m=t.Component,y=t.js,w=t.UITransform,_=t.error,b=t.Rect,v=t.warn}],execute:function(){var C,V,I,x,z,R,T,k,H,M,N,W,U,D,L,P;r._RF.push({},"7ef73mso1VKVZX7y6d7RNEf","ListView",void 0);var S=p,B=S.ccclass,O=S.property,X=S.menu,Y=new a;t("default",(C=B("ListView"),V=X("ListView/ListView"),I=O({tooltip:"元素间距"}),x=O({tooltip:"四周距离"}),z=O({type:c,tooltip:"比可见元素多缓存2个, 缓存越多,快速滑动越流畅,但同时初始化越慢."}),R=O({type:c,tooltip:"横向布局的item 数量. 默认为1,即每行一个元素"}),T=O(u),k=O(d),C(H=V((N=i((M=function(t){function i(){for(var i,e=arguments.length,s=new Array(e),h=0;h<e;h++)s[h]=arguments[h];return i=t.call.apply(t,[this].concat(s))||this,n(i,"spacing",N,o(i)),n(i,"margin",W,o(i)),n(i,"spawnCount",U,o(i)),n(i,"column",D,o(i)),n(i,"scrollView",L,o(i)),n(i,"prefab",P,o(i)),i._pool=new f,i._nodes=[],i.content=null,i.adapter=null,i._filledIds={},i.horizontal=!1,i._itemHeight=1,i._itemWidth=1,i._itemsVisible=1,i.dataChanged=!1,i._isInited=!1,i.visibleRange=[-1,-1],i.scrollTopNotifyed=!1,i.scrollBottomNotifyed=!1,i.pullDownCallback=null,i.pullUpCallback=null,i}e(i,t);var r=i.prototype;return r.clear=function(){var t=this;this._nodes.forEach((function(i){t._pool.put(i)})),this._nodes.length=0},r.getNodes=function(){return this._nodes},r.get=function(){var t=null;return t=this._pool.size()>0?this._pool.get():g(this.prefab),this._nodes.push(t),t},r.put=function(t){t instanceof m&&(t=t.node);var i=this._nodes.indexOf(t);i>=0&&y.array.fastRemoveAt(this._nodes,i),this._pool.put(t)},r.onLoad=function(){var t=this;this.init(),this.scrollView&&this.scrollView.node.on("scroll-began",(function(){t.scrollTopNotifyed=!1,t.scrollBottomNotifyed=!1}))},r.onDestroy=function(){this.clear(),this._filledIds={},this._pool.clear(),this._nodes.length=0},r.setAdapter=function(){var t=h(l().mark((function t(i){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.adapter!==i){t.next=3;break}return this.notifyUpdate(),t.abrupt("return");case 3:if(this.adapter=i,null!=this.adapter){t.next=7;break}return v("adapter 为空."),t.abrupt("return");case 7:if(null!=this.prefab){t.next=10;break}return _("Listview 未设置待显示的Item模板."),t.abrupt("return");case 10:this.visibleRange[0]=this.visibleRange[1]=-1,this.notifyUpdate();case 12:case"end":return t.stop()}}),t,this)})));return function(i){return t.apply(this,arguments)}}(),r.getAdapter=function(){return this.adapter},r.getScrollView=function(){return this.scrollView},r.getMatchItem=function(t){var i=null;for(var e in this._filledIds)if(Object.prototype.hasOwnProperty.call(this._filledIds,e)){var n=this._filledIds[e];if(n&&t(n)){i=n;break}}return i},r.getItems=function(){return this._filledIds},r.scrollToPage=function(t,i,e){if(!this.adapter||!this.scrollView)return!1;if(this.horizontal){var n=0,o=this.content.width,s=this.getColumnWH();if(i)n=s*i;else{var h=this.content.node.parent.getComponent(w).width;n=Math.floor(h/s)*s}return Y.set(n*t,0),this.scrollView.scrollToOffset(Y,e),n*(t+1)>=o}var l=this.content.height,r=this.getColumnWH(),a=0;if(i)a=r*i;else{var c=this.content.node.parent.getComponent(w).height;a=Math.floor(c/r)*r}return Y.set(0,a*t),this.scrollView.scrollToOffset(Y,e),a*(t+1)>=l},r.getVisibleElements=function(){var t=0,i=this.content.node.parent.getComponent(w);if(this.horizontal){var e=i.width;t=Math.floor(e/this.getColumnWH())}else{var n=i.height;t=Math.floor(n/this.getColumnWH())}return t*this.column},r.getColumnWH=function(){return this.horizontal?this._itemWidth+this.spacing.x:this._itemHeight+this.spacing.y},r.notifyUpdate=function(){if(null!=this.adapter&&(this._isOnLoadCalled||this.init(),this.scrollView&&this.content)){this._recycleAll(),this.visibleRange[0]=this.visibleRange[1]=-1;var t=this.content.node.parent.getComponent(w),i=Math.ceil(this.adapter.getCount()/this.column);this.horizontal?(this.content.width=i*(this._itemWidth+this.spacing.x)-this.spacing.x+this.margin.x+this.margin.width,this.content.width=Math.max(this.content.width,t.width)):(this.content.height=i*(this._itemHeight+this.spacing.y)-this.spacing.y+this.margin.y+this.margin.height,this.content.height=Math.max(this.content.height,t.height)),this.dataChanged=!0}},r.pullDown=function(t,i){this.pullDownCallback=t.bind(i)},r.pullUp=function(t,i){this.pullUpCallback=t.bind(i)},r.lateUpdate=function(){var t=this.getVisibleRange();this.checkNeedUpdate(t)&&(this.recycleDirty(t),this.updateView(t))},r._layoutVertical=function(t,i){var e=t.getComponent(w),n=i%(this.column||1),o=Math.floor(i/(this.column||1));t.setPosition(this.column>1?this.margin.x+e.width*e.anchorX+(e.width+this.spacing.x)*n-this.content.width*this.content.anchorX:0,-this.margin.y-e.height*(e.anchorY+o)-this.spacing.y*o)},r._layoutHorizontal=function(t,i){var e=t.getComponent(w),n=i%(this.column||1),o=Math.floor(i/(this.column||1));t.setPosition(e.width*(e.anchorX+o)+this.spacing.x*o+this.margin.x,this.column>1?-1*(this.margin.y+e.height*e.anchorY+(e.height+this.spacing.y)*n-this.content.height*this.content.anchorY):0)},r._recycleAll=function(){for(var t in this._filledIds)this._filledIds.hasOwnProperty(t)&&this.put(this._filledIds[t]);this._filledIds={}},r.recycleDirty=function(t){if(t&&!(t.length<2)){for(var i=this.visibleRange[0];i<t[0];i++)i<0||!this._filledIds[i]||(this.put(this._filledIds[i]),this._filledIds[i]=null);for(var e=this.visibleRange[1]-1;e>=t[1];e--)e<0||!this._filledIds[e]||(this.put(this._filledIds[e]),this._filledIds[e]=null);this.visibleRange[0]=t[0],this.visibleRange[1]=t[1]}},r.checkNeedUpdate=function(t){return t&&this.visibleRange&&(this.visibleRange[0]!=t[0]||this.visibleRange[1]!=t[1])},r.updateView=function(t){for(var i=t[0];i<t[1];i++)if(this.dataChanged||!this._filledIds[i]){var e=this._filledIds[i];e||(e=this.get(),this.content.node.addChild(e)),this.horizontal?this._layoutHorizontal(e,i):this._layoutVertical(e,i),this._filledIds[i]=this.adapter._getView(e,i)}this.dataChanged=!1},r.getVisibleRange=function(){if(null==this.adapter)return null;var t=this.scrollView.getScrollOffset(),i=0;(i=this.horizontal?Math.floor((-t.x-this.margin.x)/(this._itemWidth+this.spacing.x)):Math.floor((t.y-this.margin.y)/(this._itemHeight+this.spacing.y)))<0&&(i=0,this.scrollTopNotifyed||(this.notifyScrollToTop(),this.scrollTopNotifyed=!0,this.scrollBottomNotifyed=!0));var e=this.column*(i+this._itemsVisible+this.spawnCount);if(this.horizontal){var n=this.content.node.parent.getComponent(w),o=this.margin.x+e/this.column*(this._itemWidth+this.spacing.x);o<-t.x+n.width&&(e+=this.column*Math.ceil((-t.x+n.width-o)/(this.itemWidth+this.spacing.x)))}else{var s=this.content.node.parent.getComponent(w),h=this.margin.y+e/this.column*(this._itemHeight+this.spacing.y);h<t.y+s.height&&(e+=this.column*Math.ceil((t.y+s.height-h)/(this.itemHeight+this.spacing.y)))}return e>this.adapter.getCount()&&(e=this.adapter.getCount(),this.scrollBottomNotifyed||(this.notifyScrollToBottom(),this.scrollBottomNotifyed=!0)),[i*this.column,e]},r.getStartIdx=function(){if(null==this.adapter)return null;var t=this.scrollView.getScrollOffset(),i=0;return(i=this.horizontal?Math.floor(-t.x/(this._itemWidth+this.spacing.x)):Math.floor(t.y/(this._itemHeight+this.spacing.y)))<0&&(i=0,this.scrollTopNotifyed||(this.notifyScrollToTop(),this.scrollTopNotifyed=!0,this.scrollBottomNotifyed=!0)),i},r.init=function(){if(!this._isInited){if(this._isInited=!0,this.scrollView){this.content=this.scrollView.content.getComponent(w);var t=this.content.node.parent.getComponent(w);this.horizontal=this.scrollView.horizontal,this.horizontal?(this.scrollView.vertical=!1,this.content.anchorX=0,this.content.anchorY=t.anchorY,this.content.node.setPosition(0-t.width*t.anchorX,0)):(this.scrollView.vertical=!0,this.content.anchorX=t.anchorX,this.content.anchorY=1,this.content.node.setPosition(0,t.height*t.anchorY))}else _("ListView need a scrollView for showing.");var i=this.get(),e=i.getComponent(w);this.put(i),this._itemHeight=e.height||10,this._itemWidth=e.width||10;var n=this.content.node.parent.getComponent(w);this.horizontal?this._itemsVisible=Math.ceil(n.width/(this._itemWidth+this.spacing.x)):this._itemsVisible=Math.ceil(n.height/(this._itemHeight+this.spacing.y))}},r.notifyScrollToTop=function(){!this.adapter||this.adapter.getCount()<=0||this.pullDownCallback&&this.pullDownCallback()},r.notifyScrollToBottom=function(){!this.adapter||this.adapter.getCount()<=0||this.pullUpCallback&&this.pullUpCallback()},s(i,[{key:"itemHeight",get:function(){return this._itemHeight}},{key:"itemWidth",get:function(){return this._itemWidth}},{key:"visibleCount",get:function(){return this._itemsVisible}}]),i}(m)).prototype,"spacing",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new a}}),W=i(M.prototype,"margin",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new b}}),U=i(M.prototype,"spawnCount",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),D=i(M.prototype,"column",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),L=i(M.prototype,"scrollView",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=i(M.prototype,"prefab",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=M))||H)||H));r._RF.pop()}}}));

System.register("chunks:///_virtual/ListViewAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts"],(function(t){var e,n,i,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){a=t.default}],execute:function(){var r;n._RF.push({},"7e0911xoKROVoEgcbyR+GBZ","ListViewAdapter",void 0);var o=i,s=o.ccclass,u=(o.property,o.menu);t("default",s("ListViewAdapter")(r=u("ListView/ListViewAdapter")(r=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))||this).dataSet=[],e}e(n,t);var i=n.prototype;return i.setDataSet=function(t){this.dataSet=t||[]},i.getCount=function(){return this.dataSet?this.dataSet.length:0},i.getItem=function(t){return this.dataSet[t]},i._getView=function(t,e){return this.updateView(t,e,this.dataSet[e]),t},n}(a))||r)||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Loading.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,r,t,o,a,i,c,s,u,l,d,p;return{setters:[function(n){e=n.inheritsLoose,r=n.asyncToGenerator,t=n.regeneratorRuntime},function(n){o=n.cclegacy,a=n._decorator,i=n.Component,c=n.find,s=n.Camera,u=n.Color,l=n.loader,d=n.Prefab,p=n.instantiate}],execute:function(){var f;o._RF.push({},"c756a8S6JVEdr9Ua3K7t4Ui","Loading",void 0);var g=a.ccclass;n("default",g(f=function(n){function o(){return n.apply(this,arguments)||this}return e(o,n),o.prototype.onLoad=function(){var n=r(t().mark((function n(){var e,r,o=this;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(e=c("Canvas"))&&(r=e.getComponentInChildren(s))&&(r.clearColor=new u(0,0,0,0),r.clearFlags=s.ClearFlag.SOLID_COLOR),l.loadRes("progress",d,(function(n,e){if(!n){var r=p(e);o.node.addChild(r)}}));case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),o}(i))||f);o._RF.pop()}}}));

System.register("chunks:///_virtual/LoadingTools.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BundleMgr.ts","./Const.ts","./AssetMgr.ts","./Utils.ts","./ConfigManager.ts","./GameData.ts","./Waiting.ts","./PoolManager.ts","./I18nManager.ts","./AudioManager.ts","./PlatformManager.ts"],(function(o){var e,n,a,i,t,s,l,r,d,c,g,u,f,h,p,L,m,T,v,w,x,y,b,P,S,k,I,C,z,D,F,M;return{setters:[function(o){e=o.applyDecoratedDescriptor,n=o.inheritsLoose,a=o.initializerDefineProperty,i=o.assertThisInitialized,t=o.asyncToGenerator,s=o.regeneratorRuntime},function(o){l=o.cclegacy,r=o.Label,d=o._decorator,c=o.Sprite,g=o.sys,u=o.resources,f=o.SpriteFrame,h=o.UITransform,p=o.find,L=o.view,m=o.Component,T=o.macro,v=o.game,w=o.instantiate},function(o){x=o.BundleMgr},function(o){y=o.BUNDLES},function(o){b=o.AssetMgr},function(o){P=o.Utils},function(o){S=o.ConfigManager},function(o){k=o.GameData},function(o){I=o.Waiting},function(o){C=o.default},function(o){z=o.I18n,D=o.Language},function(o){F=o.AudioManager},function(o){M=o.PlatformManager}],execute:function(){var A,B,_,N;l._RF.push({},"4375cBhZXxHf6ZhB4nz8DFc","LoadingTools",void 0),console.log("[Load] Loading LoadingTools.ts (Final Restoration)");var W=d,G=W.ccclass,U=W.property;o("default",(A=U(r),G((N=e((_=function(o){function e(){for(var e,n=arguments.length,t=new Array(n),s=0;s<n;s++)t[s]=arguments[s];return e=o.call.apply(o,[this].concat(t))||this,a(e,"txtProgess",N,i(e)),e.dataSuc=!1,e.sceneSuc=!1,e.main=null,e.count=0,e.t=0,e.p=0,e}n(e,o);var l=e.prototype;return l.onLoad=function(){var o=t(s().mark((function o(){return s().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:console.log("[LoadingTools] onLoad"),this.init();case 2:case"end":return o.stop()}}),o,this)})));return function(){return o.apply(this,arguments)}}(),l.init=function(){var o=t(s().mark((function o(){var e;return s().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:console.log("[LoadingTools] init start"),T.ENABLE_MULTI_TOUCH=!1,v.frameRate=60,this.adaptBackground(),(e=!g.isNative)&&console.log("[LoadingTools] Web platform detected - using optimized loading"),this.loadScene(e),this.handleProgess(3),console.log("[LoadingTools] Calling loadData for all platforms"),this.loadData(),g.isNative&&console.log("[LoadingTools] Native platform specific logic (if any)"),console.log("[LoadingTools] init finished");case 12:case"end":return o.stop()}}),o,this)})));return function(){return o.apply(this,arguments)}}(),l.loadData=function(){var o=t(s().mark((function o(){var e,n;return s().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return console.log("[LoadingTools] loadData start"),this.dataSuc=!1,o.prev=2,e=window.yandexLang,(n=!!e||window.ysdk||window.YaGames)&&this.updateLogo(),console.log("[LoadingTools] Initializing I18n..."),o.next=9,z.init();case 9:return console.log("[LoadingTools] I18n initialized"),n||this.updateLogo(),o.next=13,x.I.loadBundleAsync(y.Config);case 13:return this.handleProgess(1),o.next=16,b.I.loadDirAsync(y.Config,"data");case 16:return this.handleProgess(1),S.loadConfig(),this.handleProgess(1),o.next=21,k.load();case 21:this.handleProgess(1),this.dataSuc=!0,this.toggelScene(),console.log("[LoadingTools] loadData finished successfully"),o.next=30;break;case 27:o.prev=27,o.t0=o.catch(2),console.error("[LoadingTools] loadData failed with error:",o.t0);case 30:case"end":return o.stop()}}),o,this,[[2,27]])})));return function(){return o.apply(this,arguments)}}(),l.loadScene=function(){var o=t(s().mark((function o(e){var n=this;return s().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===e&&(e=!1),console.log("[LoadingTools] loadScene start"),this.sceneSuc=!1,o.prev=3,console.log("[LoadingTools] Loading Common bundle..."),o.next=7,x.I.loadBundleAsync(y.Common);case 7:return this.handleProgess(1),console.log("[LoadingTools] Common bundle loaded"),console.log("[LoadingTools] Loading Audio bundle..."),o.next=12,x.I.loadBundleAsync(y.Audio);case 12:if(this.handleProgess(1),console.log("[LoadingTools] Audio bundle loaded"),e){o.next=21;break}return console.log("[LoadingTools] Warming up audio engine..."),o.next=18,F.I.warmup();case 18:console.log("[LoadingTools] Audio engine warmed up"),o.next=22;break;case 21:console.log("[LoadingTools] Web platform: Skipping audio warmup (will warmup on first play)");case 22:return this.handleProgess(1),console.log("[LoadingTools] Loading Game bundle..."),o.next=26,x.I.loadBundleAsync(y.Game);case 26:return this.handleProgess(1),console.log("[LoadingTools] Game bundle loaded"),console.log("[LoadingTools] Initializing PoolManager..."),o.next=31,C.init();case 31:return console.log("[LoadingTools] PoolManager initialized"),this.handleProgess(1),console.log("[LoadingTools] Loading Main prefab..."),o.next=36,b.I.loadPrefabAsync(y.Game,"Main");case 36:return this.main=o.sent,this.handleProgess(1),console.log("[LoadingTools] Main prefab loaded"),console.log("[LoadingTools] Waiting for dataSuc..."),o.next=42,P.until((function(){return n.dataSuc}));case 42:return this.handleProgess(1),console.log("[LoadingTools] dataSuc confirmed"),console.log("[LoadingTools] Initializing Block Icon..."),o.next=47,b.I.initBlockIcon(k.data.skin);case 47:if(this.handleProgess(1),console.log("[LoadingTools] Block Icon initialized"),e){o.next=56;break}return console.log("[LoadingTools] Loading Panel bundle..."),o.next=53,x.I.loadBundleAsync(y.Panel);case 53:console.log("[LoadingTools] Panel bundle loaded"),o.next=57;break;case 56:console.log("[LoadingTools] Web platform: Deferring Panel bundle");case 57:return this.handleProgess(1),console.log("[LoadingTools] Loading Waiting UI..."),o.next=61,I.load();case 61:this.handleProgess(1),console.log("[LoadingTools] Waiting UI loaded"),this.sceneSuc=!0,this.toggelScene(e),console.log("[LoadingTools] loadScene finished"),o.next=71;break;case 68:o.prev=68,o.t0=o.catch(3),console.error("[LoadingTools] loadScene failed:",o.t0);case 71:case"end":return o.stop()}}),o,this,[[3,68]])})));return function(e){return o.apply(this,arguments)}}(),l.toggelScene=function(){var o=t(s().mark((function o(e){var n,a,i=this;return s().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(void 0===e&&(e=!1),!this.sceneSuc||!this.dataSuc){o.next=13;break}return console.log("[LoadingTools] toggelScene: Transitioning to game scene"),n=Date.now(),o.next=6,P.until((function(){return 100==i.p||Date.now()-n>1e3}));case 6:this.main?p("Canvas").getChildByName("box").addChild(w(this.main)):console.error("[LoadingTools] Main prefab is null!"),this.node.removeFromParent(),(a=p("Canvas").getChildByName("bg"))&&a.removeFromParent(),console.log("[LoadingTools] Game started!"),e&&this.loadDeferredResources(),this.showPrerollAdIfNeeded();case 13:case"end":return o.stop()}}),o,this)})));return function(e){return o.apply(this,arguments)}}(),l.loadDeferredResources=function(){var o=t(s().mark((function o(){return s().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return console.log("[LoadingTools] Loading deferred resources in background..."),o.prev=1,console.log("[LoadingTools] Deferred: Loading Panel bundle..."),o.next=5,x.I.loadBundleAsync(y.Panel);case 5:console.log("[LoadingTools] Deferred: Panel bundle loaded"),console.log("[LoadingTools] Deferred: Warming up audio..."),F.I.warmup().catch((function(o){return console.log("[LoadingTools] Audio warmup skipped:",o)})),console.log("[LoadingTools] Deferred resources loaded successfully"),o.next=14;break;case 11:o.prev=11,o.t0=o.catch(1),console.warn("[LoadingTools] Deferred resources load warning:",o.t0);case 14:case"end":return o.stop()}}),o,null,[[1,11]])})));return function(){return o.apply(this,arguments)}}(),l.showPrerollAdIfNeeded=function(){var o=t(s().mark((function o(){var e;return s().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,!(e=M.getInstance().current)||"GameDistribution"!==e.name||"function"!=typeof e.showPreroll){o.next=7;break}return console.log("[LoadingTools] Showing GameDistribution Preroll ad..."),o.next=6,e.showPreroll();case 6:console.log("[LoadingTools] Preroll ad finished");case 7:o.next=12;break;case 9:o.prev=9,o.t0=o.catch(0),console.warn("[LoadingTools] Preroll ad failed:",o.t0);case 12:case"end":return o.stop()}}),o,null,[[0,9]])})));return function(){return o.apply(this,arguments)}}(),l.handleProgess=function(o){this.count+=o},l.updateLogo=function(){var o=this.findLogoNode(this.node)||(this.node.parent?this.findLogoNode(this.node.parent):null);if(o){console.log("[LoadingTools] Found logo node: "+o.name);var e=o.getComponent(c);if(e){var n,a,i,t,s=window.yandexLang,l=null;if((!!s||window.ysdk||window.YaGames)&&(o.active=!1,console.log("[LoadingTools] Yandex: Logo hidden initially")),s)l=s,console.log("[LoadingTools] Using Yandex SDK language for logo: "+s);else{var r=z.currentLanguage;l=r||g.language}t="ru"===l||l===D.RU?"loading/jiazaiye_logo_ru/spriteFrame":"ko"===l||l===D.KO||null!=(n=l)&&n.startsWith("ko")?"loading/jiazaiye_logo_ko/spriteFrame":l===D.ZH_CN||l===D.ZH_TW||"zh"===l||null!=(a=l)&&a.startsWith("zh")?"loading/jiazaiye_logo_cn/spriteFrame":"en"===l||l===D.EN_US||null!=(i=l)&&i.startsWith("en")?"loading/jiazaiye_logo_en/spriteFrame":"loading/jiazaiye_logo/spriteFrame",console.log("[LoadingTools] Logo path: "+t+" (detectedLang: "+l+")"),u.load(t,f,(function(n,a){if(!n&&a){if(o&&o.isValid&&e&&e.isValid){e.spriteFrame=a;var i=o.getComponent(h);if(i&&a.rect){var s=a.rect.width,l=a.rect.height,r=i.width,d=r/s*l;i.setContentSize(r,d),console.log("[LoadingTools] Logo size updated: "+r+"x"+d+" (original: "+s+"x"+l+")")}o.active=!0,console.log("[LoadingTools] Logo now visible")}}else console.error("[LoadingTools] Failed to load logo sprite: "+t,n),"loading/jiazaiye_logo/spriteFrame"!==t?u.load("loading/jiazaiye_logo/spriteFrame",f,(function(n,a){if(!n&&a&&null!=o&&o.isValid&&null!=e&&e.isValid){e.spriteFrame=a;var i=o.getComponent(h);if(i&&a.rect){var t=i.width,s=t/a.rect.width*a.rect.height;i.setContentSize(t,s)}o.active=!0}})):o.active=!0}))}}else console.warn("[LoadingTools] Logo node not found!")},l.findLogoNode=function(o){if(!o)return null;var e=o.name.toLowerCase();if(e.includes("logo")||e.includes("jiazaiye"))return console.log("[LoadingTools] Found match by Node Name: "+o.name),o;var n=o.getComponent(c);if(n&&n.spriteFrame&&"jiazaiye_logo"===n.spriteFrame.name)return console.log("[LoadingTools] Found match by SpriteFrame Name: "+o.name),o;for(var a=o.children,i=0;i<a.length;i++){var t=this.findLogoNode(a[i]);if(t)return t}return null},l.adaptBackground=function(){var o,e=null==(o=p("Canvas"))?void 0:o.getChildByName("bg");if(e){var n=e.getComponent(h);if(n){var a=L.getVisibleSize(),i=n.width,t=n.height,s=a.width/i,l=a.height/t,r=Math.max(s,l),d=i*r,c=t*r;n.setContentSize(d,c),console.log("[LoadingTools] bg adapted: "+i+"x"+t+" -> "+d.toFixed(0)+"x"+c.toFixed(0)+", visibleSize="+a.width+"x"+a.height)}else console.warn("[LoadingTools] bg UITransform not found")}else console.warn("[LoadingTools] bg node not found")},l.update=function(o){this.t+=o;var e=Math.min(Math.floor(this.count/17*100),100);this.p<e&&(this.p++,this.txtProgess&&(this.txtProgess.string=this.p+"%"))},e}(m)).prototype,"txtProgess",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=_))||B));l._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AssetMgr.ts","./AssetPool.ts","./BundleMgr.ts","./ListView.ts","./ListViewAdapter.ts","./BackgroundAdapter.ts","./CanvasAdapter.ts","./ChannelMgr.ts","./ConfigExtension.ts","./ConfigManager.ts","./DataAccess.ts","./DataModel.ts","./Const.ts","./Enum.ts","./GameData.ts","./IPhoneXScreen.ts","./MiniGameCommon.ts","./ObjectInstance.ts","./Panel.ts","./ReviewMode.ts","./SdkTools.ts","./TDataMgr.ts","./Utils.ts","./EctypeMgr.ts","./FallBlock.ts","./FallBlocks.ts","./FallDownGameView.ts","./FallFailPanel.ts","./FallHelpPanel.ts","./FallPausePanel.ts","./FallRevivePanel.ts","./TopUICom.ts","./ActivityMgr.ts","./BoardDataMgr.ts","./Block.ts","./BtnActLv.ts","./BtnActivity.ts","./BtnEndLess.ts","./BtnHomeLv.ts","./ComBlocks.ts","./ComBox.ts","./ComCombo.ts","./ComDuoxiao.ts","./ComLight.ts","./ComTab.ts","./CompCollectJewelItem.ts","./CompCollectJewels.ts","./GameConst.ts","./ModelView.ts","./RoundBox.ts","./TabItem.ts","./DailyMgr.ts","./Game.ts","./GameMgr.ts","./Home.ts","./Main.ts","./PuzzleMgr.ts","./Loading.ts","./LoadingTools.ts","./Waiting.ts","./AudioManager.ts","./EventManager.ts","./FirebaseManager.ts","./FirebaseWebConfig.ts","./FirebaseWebManager.ts","./MaskView.ts","./PoolManager.ts","./SingularMgr.ts","./TopOnMgr.ts","./UIManager.ts","./Vec2Pool.ts","./ActGetPanel.ts","./ActivityFailPanel.ts","./ActivityPanel.ts","./CollectGamePanel.ts","./ComFail.ts","./DailyFailPanel.ts","./DailyItem.ts","./DailyPanel.ts","./DingyuePanel.ts","./EndPanel.ts","./GoPanel.ts","./HandbookItem.ts","./HandbookPanel.ts","./HelpPanel.ts","./LanguagePanel.ts","./MoreGamePanel.ts","./NoSpace.ts","./RankItem.ts","./RankPanel.ts","./ReplacePanel.ts","./RetPanel.ts","./RevivePanel.ts","./RewardPanel.ts","./SettingPanel.ts","./SkinItem.ts","./SkinPanel.ts","./TargetPanel.ts","./TestPanel.ts","./Tips.ts","./CrazyGamesPlatform.ts","./FacebookPlatform.ts","./GameDistributionPlatform.ts","./IPlatform.ts","./NativePlatform.ts","./PlatformManager.ts","./TelegramPlatform.ts","./VKPlatform.ts","./WechatPlatform.ts","./YandexPlatform.ts","./I18nImageText.ts","./I18nLabel.ts","./I18nManager.ts","./I18nSprite.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Main.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Game.ts","./TopOnMgr.ts","./ComTab.ts","./Home.ts","./EventManager.ts","./Enum.ts","./AssetPool.ts","./Const.ts","./UIManager.ts","./AssetMgr.ts","./Waiting.ts","./BundleMgr.ts","./PoolManager.ts","./I18nImageText.ts","./FallDownGameView.ts","./TDataMgr.ts","./GameData.ts","./EctypeMgr.ts","./Panel.ts","./Utils.ts","./Tips.ts","./I18nManager.ts","./PlatformManager.ts"],(function(e,t){var a,n,i,o,s,r,l,c,u,h,d,f,m,p,g,b,v,y,w,x,P,T,k,I,M,S,_,C,N,A,D,F,G,B,L,E,W,H,O,U,R,z,K,V,Y,Z,q,j,X,J,Q;return{setters:[function(e){a=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,s=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e.Node,u=e._decorator,h=e.sys,d=e.find,f=e.Color,m=e.isValid,p=e.sp,g=e.UITransform,b=e.view,v=e.Component,y=e.Camera,w=e.macro,x=e.v3,P=e.tween,T=e.instantiate},function(e){k=e.Game},function(e){I=e.TopOnMgr},function(e){M=e.ComTab},function(e){S=e.Home},function(e){_=e.default},function(e){C=e.GameType,N=e.TabType,A=e.EventType,D=e.GameStatus},function(e){F=e.AssetPool},function(e){G=e.BUNDLES},function(e){B=e.PanelType,L=e.default},function(e){E=e.AssetMgr},function(e){W=e.Waiting},function(e){H=e.BundleMgr},function(e){O=e.default,U=e.PoolName},function(e){R=e.I18nImageText},function(e){z=e.FallDownGameView},function(e){K=e.TDataMgr},function(e){V=e.GameData},function(e){Y=e.EctypeMgr},function(e){Z=e.default},function(e){q=e.Utils},function(e){j=e.default},function(e){X=e.I18n,J=e.Language},function(e){Q=e.PlatformManager}],execute:function(){var $,ee,te,ae,ne,ie,oe,se,re,le,ce,ue,he;l._RF.push({},"be6282NMtZMq4gYWfKGBMKX","Main",void 0),console.log("[Load] Loading Main.ts");var de=u,fe=de.ccclass,me=de.property;e("Main",($=fe("Main"),ee=me(k),te=me(c),ae=me(c),ne=me(M),ie=me(S),$((re=a((se=function(e){function a(){for(var t,a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return t=e.call.apply(e,[this].concat(n))||this,i(t,"game",re,o(t)),i(t,"ectypeNode",le,o(t)),i(t,"homeTab",ce,o(t)),i(t,"tabs",ue,o(t)),i(t,"home",he,o(t)),t.handbook=null,t.daily=null,t.activity=null,t.moregame=null,t.touch_effect=void 0,t.selIdx=-1,t.selNode=null,t}n(a,e);var l=a.prototype;return l.onLoad=function(){var e=s(r().mark((function e(){var t,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Main] onLoad start"),W.show(),(t=d("Canvas"))&&(a=t.getComponentInChildren(y))&&(a.clearColor=new f(0,0,0,0),a.clearFlags=y.ClearFlag.SOLID_COLOR),w.ENABLE_TRANSPARENT_CANVAS=!0,this.adaptBackground(),_.I.on(A.TOGGLE_TAB,this.toogleTab,this),_.I.on(A.OPEN_TAB,this.evOpenTab,this),_.I.on(A.START_GAME,this.starGame,this),_.I.on(A.OPEN_OTHER_GAME,this.openMoreGame,this),_.I.on(A.GO_HOME,this.onHome,this),e.next=13,this.initPlatformData();case 13:this.initView(),W.hide(),Q.getInstance().current.gameReady&&Q.getInstance().current.gameReady();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.initPlatformData=function(){var e=s(r().mark((function e(){var a,n,i,o,s,l,c,u,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.isNative){e.next=69;break}return console.log("[Main] Checking Web Platform Environment..."),e.prev=2,e.next=5,t.import("./FirebaseWebManager.ts");case 5:return a=e.sent,n=a.FirebaseWebManager,e.next=9,n.instance.init();case 9:i=e.sent,console.log("[Main] Firebase Web Analytics initialized: "+i),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.warn("[Main] Firebase Web init failed (SDK may not be loaded):",e.t0);case 16:if(e.prev=16,o=Q.getInstance().current,console.log("[Main] Current Platform detected:",o.name),"Yandex"!==o.name){e.next=25;break}if(!o.initAsync){e.next=23;break}return e.next=23,o.initAsync();case 23:e.next=38;break;case 25:if("Native"!==o.name){e.next=38;break}return e.next=28,Q.getInstance().loadYandexSDK();case 28:if(s=e.sent){e.next=33;break}return e.next=32,Q.getInstance().loadCrazyGamesSDK();case 32:s=e.sent;case 33:if(!s){e.next=37;break}console.log("[Main] Web SDK loaded dynamically (Yandex/CrazyGames)."),e.next=38;break;case 37:return e.abrupt("return");case 38:return l=Q.getInstance().current,console.log("[Main] Final Platform:",l.name),e.next=42,l.login();case 42:if(!(c=e.sent)||0!==c.code||!c.userInfo){e.next=63;break}if(console.log("[Main] "+l.name+" login success:",c.userInfo.nickName),"Telegram"===l.name&&j.show("Welcome, "+c.userInfo.nickName+"!"),!l.getLanguage){e.next=58;break}if(!(u=(l.getLanguage()||"").toLowerCase())){e.next=58;break}return d=J.EN_US,u.startsWith("zh")?d=u.includes("tw")||u.includes("hk")||u.includes("hant")?J.ZH_TW:J.ZH_CN:u.startsWith("ru")?d=J.RU:u.startsWith("id")?d=J.ID:u.startsWith("fr")?d=J.FR:u.startsWith("es")?d=J.ES:u.startsWith("pt")?d=J.PT:u.startsWith("ar")?d=J.AR:u.startsWith("ko")&&(d=J.KO),console.log("[Main] Syncing "+l.name+" Language: "+u+" -> "+d),e.next=54,X.init(d);case 54:if(X.currentLanguage===d){e.next=58;break}return console.log("[Main] Switching language to: "+d),e.next=58,X.setLanguage(d);case 58:return e.next=60,V.syncFromPlatform();case 60:console.log("[Main] "+l.name+" data sync completed."),e.next=64;break;case 63:console.warn("[Main] "+l.name+" login failed or no user info returned.");case 64:e.next=69;break;case 66:e.prev=66,e.t1=e.catch(16),console.error("[Main] Platform init failed",e.t1);case 69:case"end":return e.stop()}}),e,null,[[2,13],[16,66]])})));return function(){return e.apply(this,arguments)}}(),l.initView=function(){var e=this;this.tabs.refresh(2,!1),this.selIdx=2,this.selNode=this.home.node;var t,a=!1;h.isNative||"undefined"==typeof PUCHI_SDK||PUCHI_SDK.DataService.isnew&&PUCHI_SDK.IsWx&&1==+(null==(t=PUCHI_SDK.Platform.getLaunchOptionsSync().query)?void 0:t.game_scene)&&(a=!0);console.log("isSpecialScene",a),a?(this.openMoreGame(1),this.homeShow(!1)):V.data.guide?V.data.isTwo?this.homeShow(!0):V.data.login_days<3?(V.data.isTwo=!0,this.homeShow(!1),this.game.node.active=!0,this.starGame(C.level)):(V.data.isTwo=!0,this.homeShow(!0)):(this.homeShow(!1),1!=V.data.level?(V.data.guide=!0,this.homeShow(!0)):(this.game.node.active=!0,this.starGame(C.level)));var n=d("Canvas").getChildByName("touch_effect");this.touch_effect=n,n.on(c.EventType.TOUCH_START,(function(t){t.preventSwallow=!0,e.touchStartWorld(t)}),this),n.on(c.EventType.TOUCH_CANCEL,(function(e){e.preventSwallow=!0})),n.on(c.EventType.TOUCH_END,(function(e){e.preventSwallow=!0}),this),n.on(c.EventType.TOUCH_MOVE,(function(e){e.preventSwallow=!0}),this)},l.start=function(){this.initI18nTabs()},l.initI18nTabs=function(){var e=this,t=this.tabs.node,a=new f(50,50,100,255),n=t.getChildByPath("animNode/Layout");n&&(this.updateTabLabels(n,a),X.on((function(){m(n)&&e.updateTabLabels(n,a)}),this))},l.updateTabLabels=function(e,t){for(var a=["tabs.gallery","tabs.daily","tabs.home","tabs.events","tabs.more_games"],n=e.children,i=0;i<n.length&&i<a.length;i++){var o={nodeName:"lab",i18nKey:a[i],outlineColor:t,outlineWidth:1};R.replaceImageTexts(n[i],[o])}},l.toogleTab=function(){var e=s(r().mark((function e(t,a){var n,i,o,s,l,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===a&&(a=!0),!(1==t&&V.data.level<=5)){e.next=4;break}return j.show(X.t("tips.unlock_level_5")),e.abrupt("return");case 4:if(!(3==t&&V.data.level<=10)){e.next=7;break}return j.show(X.t("tips.unlock_level_10")),e.abrupt("return");case 7:if(t!=this.selIdx){e.next=9;break}return e.abrupt("return");case 9:n=this.selIdx,i=this.selNode,this.selIdx=t,this.tabs.refresh(t,!0),e.t0=t,e.next=0===e.t0?16:1===e.t0?24:2===e.t0?32:3===e.t0?34:4===e.t0?42:50;break;case 16:if(this.handbook){e.next=22;break}return e.next=19,E.I.loadPrefabAsync(G.Panel,B.HandbookPanel);case 19:o=e.sent,this.handbook=T(o),this.homeTab.addChild(this.handbook);case 22:return this.selNode=this.handbook,e.abrupt("break",50);case 24:if(this.daily){e.next=30;break}return e.next=27,E.I.loadPrefabAsync(G.Panel,B.DailyPanel);case 27:s=e.sent,this.daily=T(s),this.homeTab.addChild(this.daily);case 30:return this.selNode=this.daily,e.abrupt("break",50);case 32:return this.selNode=this.home.node,e.abrupt("break",50);case 34:if(this.activity){e.next=40;break}return e.next=37,E.I.loadPrefabAsync(G.Panel,B.ActivityPanel);case 37:l=e.sent,this.activity=T(l),this.homeTab.addChild(this.activity);case 40:return this.selNode=this.activity,e.abrupt("break",50);case 42:if(this.moregame){e.next=48;break}return e.next=45,E.I.loadPrefabAsync(G.Panel,B.MoreGamePanel);case 45:c=e.sent,this.moregame=T(c),this.homeTab.addChild(this.moregame);case 48:return this.selNode=this.moregame,e.abrupt("break",50);case 50:a?(n>-1&&i&&P(i).to(.2,{position:x(t>n?-750:750,0,0)}).start(),this.selNode.setPosition(x(t>n?750:-750,0,0)),this.selNode.active=!0,P(this.selNode).to(.2,{position:x(0,0,0)}).call((function(){i&&(i.active=!1)})).start()):(this.selNode.setPosition(x(0,0,0)),this.selNode.active=!0,i&&(i.active=!1)),this.openTab(t);case 52:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),l.evOpenTab=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];this.openTab.apply(this,[e].concat(a)),N.home},l.openTab=function(e){if(this.homeShow(!0),e!=N.home){for(var t=this.selNode.getComponent(Z),a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];t.init.apply(t,n)}},l.starGame=function(e,t){void 0===t&&(t=!1),this.homeShow(!1),this.game.node.active=!0,this.game.play(e,t)},l.onHome=function(){this.homeShow(!0),this.game.node.active=!1;var e=this.ectypeNode.getChildByName("FallDownView");e&&(e.active=!1),I.I.hideBanner();var t=Q.getInstance().current;t.gameplayStop&&t.gameplayStop()},l.homeShow=function(e){this.homeTab.active=e,this.tabs.node.active=e},l.openMoreGame=function(){var e=s(r().mark((function e(t){var a,n,i,o,s,l,c,u,h;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=1===e.t0?3:55;break;case 3:if(a=this.ectypeNode.getChildByName("FallDownView")){e.next=44;break}return W.show(),e.next=8,H.I.loadBundleAsync(G.FallDown);case 8:return e.next=10,E.I.loadPrefabAsync(G.FallDown,"prefabs/fallDownGame");case 10:return n=e.sent,(a=T(n)).name="FallDownView",this.ectypeNode.addChild(a),e.next=16,E.I.loadPrefabAsync(G.FallDown,"prefabs/FallRevivePanel");case 16:return i=e.sent,F.I.addPrefab(i,B.FallRevivePanel),e.next=20,E.I.loadPrefabAsync(G.FallDown,"prefabs/FallFailPanel");case 20:return o=e.sent,F.I.addPrefab(o,B.FallFailPanel),e.next=24,E.I.loadPrefabAsync(G.FallDown,"prefabs/FallHelpPanel");case 24:return s=e.sent,console.log("______help: ",s),F.I.addPrefab(s,B.FallHelpPanel),e.next=29,E.I.loadPrefabAsync(G.FallDown,"prefabs/fallBlock");case 29:return l=e.sent,O.initPool(U.fallBlock,l),e.next=33,E.I.loadPrefabAsync(G.FallDown,"prefabs/fallBlocks");case 33:return c=e.sent,O.initPool(U.fallBlocks,c),e.next=37,E.I.loadPrefabAsync(G.FallDown,"particles/fall_down");case 37:return u=e.sent,O.initPool(U.breakParticles,u),e.next=41,E.I.loadPrefabAsync(G.FallDown,"particles/item_effect");case 41:h=e.sent,O.initPool(U.itemParticles,h),W.hide();case 44:return!1,this.homeShow(!1),a.active=!0,a.getComponent(z).updateGameBox(),K.ins.fallLevelStart("主页开始"),K.ins.dot("video_exposure",{view_reason:"fall_next_lock"}),K.ins.dot("video_exposure",{view_reason:"fall_prop_change"}),K.ins.dot("video_exposure",{view_reason:"fall_prop_eliminate"}),console.log("[Main] openMoreGame: fallTopScore = "+V.data.fallTopScore),V.data.fallTopScore<=0?(console.log("[Main] Opening FallHelpPanel"),L.addPanel(B.FallHelpPanel)):(console.log("[Main] Setting gameStatus to Game"),Y.I.gameStatus=D.Game),e.abrupt("break",55);case 55:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.touchStartWorld=function(e){var t=O.get(U.click);if(t){var a=t.getComponent(p.Skeleton);if(a&&a.skeletonData){a.enabled=!1,t.setParent(this.touch_effect);var n=e.getUILocation();t.setWorldPosition(n.x,n.y,0),a.setCompleteListener((function(){O.put(U.click,t)}));var i=q.random(1,5);try{a.setAnimation(0,"idle"+i,!1),a.enabled=!0}catch(e){console.warn("[Main] touchStartWorld setAnimation error:",e),a.enabled=!0}}else O.put(U.click,t)}},l.adaptBackground=function(){this.adaptBgNode(this.node.getChildByName("bg"),"Main/bg");var e=this.node.getChildByName("homeTab");if(e&&this.adaptBgNode(e.getChildByName("bg"),"homeTab/bg"),this.tabs&&this.tabs.node){var t=this.tabs.node.getChildByName("animNode");if(t){var a=t.getChildByName("bg");if(a){var n=a.getComponent(g);if(n){var i=b.getVisibleSize(),o=n.width,s=n.height;n.setContentSize(i.width,s),console.log("[Main] tabs/animNode/bg width adapted: "+o+" -> "+i.width)}}}}},l.adaptBgNode=function(e,t){if(e){var a=e.getComponent(g);if(a){var n=b.getVisibleSize(),i=a.width,o=a.height;if(!(i>=n.width&&o>=n.height)){var s=n.width/i,r=n.height/o,l=Math.max(s,r),c=i*l,u=o*l;a.setContentSize(c,u),console.log("[Main] "+t+" adapted: "+i+"x"+o+" -> "+c.toFixed(0)+"x"+u.toFixed(0))}}else console.warn("[Main] "+t+" UITransform not found")}else console.log("[Main] "+t+" node not found, skipping adaptation")},a}(v)).prototype,"game",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=a(se.prototype,"ectypeNode",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=a(se.prototype,"homeTab",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=a(se.prototype,"tabs",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=a(se.prototype,"home",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=se))||oe));l._RF.pop()}}}));

System.register("chunks:///_virtual/MaskView.ts",["cc"],(function(n){var e,t,o,i,c,a,s;return{setters:[function(n){e=n.cclegacy,t=n.isValid,o=n.Node,i=n.UITransform,c=n.BlockInputEvents,a=n.director,s=n.Widget}],execute:function(){var d;n("MaskView",void 0),e._RF.push({},"795d4EA+DFEMp2mww7cXLMF","MaskView",void 0),function(n){n.show=function(){1===++d&&(r(),e.active=!0)},n.log=function(){console.log("addForcewait",d)},n.hide=function(){0===--d&&(r(),e.active=!1)};var e=null,d=0;function r(){if(!t(e)){(e=new o("LayerBlock")).addComponent(i),e.getComponent(i).zIndex=9999,e.addComponent(c),e.setParent(a.getScene());var n=e.addComponent(s);n.isAlignLeft=n.isAlignRight=n.isAlignTop=n.isAlignBottom=!0,n.left=n.right=n.top=n.bottom=0,n.alignMode=s.AlignMode.ON_WINDOW_RESIZE}}}(d||(d=n("MaskView",{}))),e._RF.pop()}}}));

System.register("chunks:///_virtual/MiniGameCommon.ts",["cc","./GameData.ts"],(function(e){var i,n,o;return{setters:[function(e){i=e.cclegacy,n=e.sys},function(e){o=e.GameData}],execute:function(){i._RF.push({},"5f288tc3hpD2bCLVi91LhYQ","MiniGameCommon",void 0),console.log("[Load] Loading MiniGameCommon.ts");var t=e("MiniGameCommon",function(){function e(){}return e.init=function(){if(n.isNative)console.log("[MiniGameCommon] Native platform, skipping init.");else if("undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService){if(1==PUCHI_SDK.OnlineService.getParamsInt("req_minigame_open",1))try{if("undefined"!=typeof requirePlugin){var e=(0,requirePlugin("MiniGameCommon",{enableRequireHostModule:!0,customEnv:{wx:wx}}).default)();void 0===e||void 0===e.canIUse?console.error("插件初始化失败1"):(console.error("插件初始化成功"),this.isInit=!0,this.miniGameCommon=e)}}catch(e){console.error("插件初始化失败2"),console.error(e)}}else console.log("[MiniGameCommon] PUCHI_SDK not available, skipping init.")},e.dot=function(e){var i=this;return new Promise((function(t,a){if(!n.isNative&&i.miniGameCommon){var m,r;m=o.data.record_videokey[e+"_1"]||0,r=o.data.record_videokey[e+"_2"]||0;var s='{"gift_scene":'+e+',"gift_name":"'+e+'","gift_value":'+m+',"gift_value_success":'+r+"}";i.miniGameCommon.getUserLabel({reportData:s,labelId:"iaa_feature"}).then((function(e){t(e)})).catch((function(e){a(e)}))}else t({code:0,msg:"Mock success"})}))},e}());t.miniGameCommon=void 0,t.isInit=!1,i._RF.pop()}}}));

System.register("chunks:///_virtual/ModelView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./GameData.ts","./Utils.ts","./BoardDataMgr.ts","./CompCollectJewels.ts","./EventManager.ts","./PoolManager.ts","./AssetMgr.ts","./Const.ts","./AudioManager.ts","./I18nManager.ts","./ReviewMode.ts"],(function(e,t){var n,o,r,i,a,l,c,s,u,d,f,g,p,h,v,m,w,S,b,M,y,C,k,T,I,P,x,z,V,E,A,D,R,B,N,_,L,F;return{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){c=e.cclegacy,s=e.Label,u=e.Node,d=e._decorator,f=e.view,g=e.v3,p=e.sys,h=e.UITransform,v=e.Sprite,m=e.UIOpacity,w=e.Color,S=e.find,b=e.tween,M=e.Component,y=e.sp,C=e.isValid,k=e.instantiate},function(e){T=e.EventType,I=e.GameType,P=e.CollectType},function(e){x=e.GameData},function(e){z=e.Utils},function(e){V=e.BoardDataMgr},function(e){E=e.CompCollectJewels},function(e){A=e.default},function(e){D=e.default,R=e.PoolName},function(e){B=e.AssetMgr},function(e){N=e.BUNDLES},function(e){_=e.AudioManager},function(e){L=e.I18n},function(e){F=e.ReviewMode}],execute:function(){var O,U,j,G,H,q,J,W,Y,K,Q,X,Z,$,ee,te,ne,oe,re,ie,ae,le,ce,se,ue;function de(e,t){if(console.log("[safeSkin-ModelView] Called with skinName='"+t+"'"),!e)return console.warn("[safeSkin-ModelView] Skeleton is null"),!1;if(!e.skeletonData)return console.warn("[safeSkin-ModelView] skeletonData is null"),!1;try{var n=e.skeletonData.getRuntimeData();if(console.log("[safeSkin-ModelView] getRuntimeData returned:",n?"valid":"null"),!n||!n.findSkin)return console.warn("[safeSkin-ModelView] Cannot check skin existence"),!1;var o=n.findSkin(t);return console.log("[safeSkin-ModelView] findSkin('"+t+"') returned:",o?"found":"NOT FOUND"),o?(console.log("[safeSkin-ModelView] Calling setSkin('"+t+"')..."),e.setSkin(t),console.log("[safeSkin-ModelView] setSkin completed successfully"),!0):(console.warn("[safeSkin-ModelView] Skin '"+t+"' not found, skipping setSkin"),!1)}catch(e){return console.warn("[safeSkin-ModelView] Error setting skin '"+t+"':",e),!1}}c._RF.push({},"31120HaqY1HW6nmhyLyUEqS","ModelView",void 0);var fe=d,ge=fe.ccclass,pe=fe.property;e("ModelView",(O=ge("game/ModelView"),U=pe(s),j=pe(s),G=pe(u),H=pe(s),q=pe(u),J=pe(E),W=pe(u),Y=pe(s),K=pe(s),Q=pe(u),X=pe(u),O((ee=n(($=function(e){function n(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,r(t,"labScore",ee,i(t)),r(t,"maxScore",te,i(t)),r(t,"endlessModel",ne,i(t)),r(t,"labTarget",oe,i(t)),r(t,"btnHelp",re,i(t)),r(t,"collectModel",ie,i(t)),r(t,"collectProgress",ae,i(t)),r(t,"collectScore",le,i(t)),r(t,"collectTargetScore",ce,i(t)),r(t,"scoreModel",se,i(t)),r(t,"animTargetScoreNode",ue,i(t)),t.reviewModeBanner=null,t.recordScore=0,t}o(n,e);var c=n.prototype;return c.onLoad=function(){A.I.on(T.TARGET_ANIM,this.targetAnim,this);var e=f.getVisibleSize().height/f.getVisibleSize().width>1.8;this.labTarget.node.setPosition(g(0,e?90:65,0));var t=e?1:.8;this.collectModel.node.setScale(t,t,t),p.os===p.OS.IOS&&this.labTarget.node.on(u.EventType.TOUCH_END,this.onLabelTargetTap,this)},c.onLabelTargetTap=function(){var e=a(l().mark((function e(){var n,o,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!F.recordTap()){e.next=11;break}return this.showReviewModeBanner(),e.next=5,z.wait(500);case 5:return e.next=7,t.import("./UIManager.ts");case 7:n=e.sent,o=n.default,r=n.PanelType,o.openPanel(r.RetPanel,!0,0);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.showReviewModeBanner=function(){if(!this.reviewModeBanner){var e=new u("ReviewModeBanner");e.addComponent(h).setContentSize(400,40);var t=new u("BG");t.addComponent(h).setContentSize(400,40);var n=t.addComponent(v);n.type=v.Type.SIMPLE,n.sizeMode=v.SizeMode.CUSTOM,t.addComponent(m).opacity=200,t.parent=e;var o=new u("Label"),r=o.addComponent(s);r.string="REVIEW MODE ACTIVE",r.fontSize=24,r.color=new w(255,255,0),r.horizontalAlign=s.HorizontalAlign.CENTER,r.verticalAlign=s.VerticalAlign.CENTER,o.parent=e;var i=S("Canvas");if(i){e.parent=i;var a=f.getVisibleSize();e.setPosition(0,a.height/2-150)}this.reviewModeBanner=e}},c.refresh=function(){switch(this.endlessModel.active=this.collectModel.node.active=this.scoreModel.active=!1,V.I.type){case I.default:this.endlessModel.active=!0;break;case I.level:V.I.collectType==P.score?(this.scoreModel.active=!0,this.collectTargetScore.string=V.I.levelCfg.score+""):(this.collectModel.node.active=!0,this.collectModel.refresh(V.I.levelCfg.getCollect()));break;case I.activity:case I.daily:V.I.collectType==P.score?(this.scoreModel.active=!0,this.collectTargetScore.string=V.I.levelCfg.score+""):(this.collectModel.node.active=!0,this.collectModel.refresh(V.I.levelCfg.getCollect()))}},c.updateScore=function(e,t,n){switch(void 0===t&&(t=!1),void 0===n&&(n=!1),V.I.type){case I.default:this.labTarget.node.active=!1,this.updateEndlessScore(e,t,n);break;case I.level:this.labTarget.node.active=!0,this.labTarget.string=L.t("game.level",x.data.level),V.I.collectType==P.score&&this.updateCollectScore(e,t);break;case I.activity:this.labTarget.node.active=!0,this.labTarget.string=L.t("game.level",x.data.activityLevel),V.I.collectType==P.score&&this.updateCollectScore(e,t);break;case I.daily:this.labTarget.node.active=!0,this.labTarget.string=L.t("home.daily_challenge"),V.I.collectType==P.score&&this.updateCollectScore(e,t)}},c.updateEndlessScore=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!1),e&&t){for(var o=+this.labScore.string,r=e-o,i=Math.min(n?20:10,r),a=Math.floor(r/i),l=[],c=0;c<i;c++)l.push(o+a*(c+1));l.push(e),this.recordScore=e,this.animScore(this.labScore,l,e),n&&(this.labScore.node.scale=g(1,1,1),b(this.labScore.node).delay(.7).to(.1,{scale:g(1.5,1.5,1.5)}).to(.05,{scale:g(1,1,1)}).start()),this.maxScore.string=x.data.maxScore+""}else this.labScore.string=e+"",this.maxScore.string=x.data.maxScore+"";this.maxScore.fontSize=x.data.maxScore>999999?30:36},c.animScore=function(){var e=a(l().mark((function e(t,n,o){var r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.recordScore==o){e.next=2;break}return e.abrupt("return");case 2:if(r=n.shift(),t.string=r+"",!n.length){e.next=8;break}return e.next=7,z.wait(100-2*(15-n.length));case 7:this.animScore(t,n,o);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,o){return e.apply(this,arguments)}}(),c.updateCollectScore=function(e,t){void 0===t&&(t=!1);var n=360*Math.min(e/V.I.levelCfg.score,1);if(t){b(this.collectProgress.getComponent(h)).to(.5,{width:n}).start();for(var o=+this.collectScore.string,r=(e=Math.min(e,V.I.levelCfg.score))-o,i=Math.min(10,r),a=Math.floor(r/i),l=[],c=0;c<i;c++)l.push(o+a*(c+1));l.push(e),this.recordScore=e,this.animScore(this.collectScore,l,e)}else this.collectScore.string=Math.min(e,V.I.levelCfg.score)+"",this.collectProgress.getComponent(h).width=n},c.updateJewel=function(e,t){var n;t||(t=V.I.getCollectById(e)),null==(n=this.collectModel.getItem(e))||n.updateNum(t)},c.targetAnim=function(){var e=a(l().mark((function e(t,n,o,r){var i,a,c,u,d=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V.I.collectType!=P.score){e.next=12;break}if(!o){e.next=3;break}return e.abrupt("return");case 3:(i=k(this.animTargetScoreNode)).children[0].getComponent(s).string=V.I.levelCfg.score+"",i.parent=S("Canvas"),i.active=!0,i.getComponent(m).opacity=255,i.setWorldPosition(t),b(i).to(.3,{worldPosition:this.scoreModel.children[0].worldPosition}).call((function(){b(i.getComponent(m)).to(.1,{opacity:0}).call((function(){i.removeFromParent()})).start()})).start(),e.next=24;break;case 12:return c=D.get(R.jewel),e.next=15,B.I.loadIcon(N.Game,"images/jewel1_"+n);case 15:if(c.getComponent(v).spriteFrame=e.sent,c.parent=S("Canvas"),c.setWorldPosition(t),u=null==(a=this.collectModel.getItem(n))?void 0:a.icon.node.worldPosition){e.next=22;break}return c.removeFromParent(),e.abrupt("return");case 22:c.angle=0,o?(c.setScale(.65,.65,.65),b(c).to(.2,{scale:g(1.4,1.4,1.4)}).to(.1,{scale:g(1,1,1)}).delay(.1+.1*r).to(.4,{worldPosition:u,angle:-360},{easing:"quadInOut"}).call((function(){_.I.playEffect("level_mode_start_and_gem_collect");var e=D.get(R.jewelParticle);if(e){var t=e.getComponent(y.Skeleton);if(t){t.enabled=!1,e.parent=S("Canvas"),e.setWorldPosition(u);var o=["hong","lv","qing","cheng","feng","lan","huang"][n-1]||"hong";if(!de(t,o))return console.warn("[ModelView] jewelParticle skin '"+o+"' failed"),void e.removeFromParent();try{t.setAnimation(0,"enter",!1)}catch(e){console.warn("[ModelView] jewelParticle setAnimation error:",e)}t.enabled=!0,z.wait(2e3).then((function(){C(e)&&e.removeFromParent()}))}else console.warn("[ModelView] jewelParticle has no Skeleton component")}})).to(.1,{scale:g(1.2,1.2,1.2)}).to(.05,{scale:g(1,1,1)}).call((function(){c.removeFromParent();var e=V.I.getCollectById(n);d.updateJewel(n,e)})).start()):(c.setScale(1,1,1),b(c).to(.4,{worldPosition:u,angle:-360},{easing:"quadInOut"}).call((function(){c.removeFromParent();var e=V.I.getCollectById(n);d.updateJewel(n,e)})).start());case 24:case"end":return e.stop()}}),e,this)})));return function(t,n,o,r){return e.apply(this,arguments)}}(),n}(M)).prototype,"labScore",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=n($.prototype,"maxScore",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=n($.prototype,"endlessModel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=n($.prototype,"labTarget",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=n($.prototype,"btnHelp",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=n($.prototype,"collectModel",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=n($.prototype,"collectProgress",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=n($.prototype,"collectScore",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=n($.prototype,"collectTargetScore",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=n($.prototype,"scoreModel",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=n($.prototype,"animTargetScoreNode",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=$))||Z));c._RF.pop()}}}));

System.register("chunks:///_virtual/MoreGamePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./Enum.ts","./EventManager.ts","./I18nImageText.ts"],(function(e){var t,n,o,i,a,r,s,l,u,d,c,g,h;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){i=e.cclegacy,a=e.find,r=e.UITransform,s=e.view,l=e.Color,u=e._decorator},function(e){d=e.default},function(e){c=e.EventType},function(e){g=e.default},function(e){h=e.I18nImageText}],execute:function(){var p;i._RF.push({},"edc09qsOjVE5oCAbfElgbuR","MoreGamePanel",void 0);var m=u,f=m.ccclass;m.property,e("default",f("home/MoreGamePanel")(p=function(e){function i(){return e.apply(this,arguments)||this}t(i,e);var u=i.prototype;return u.onEnable=function(){this.initI18nImageTexts(),this.adaptBgNode("bg2"),this.adaptBgNode("content/top/title_bg")},u.adaptBgNode=function(e){var t=this.node.getChildByName(e);if(t||(t=a(e,this.node)),t||"title_bg"===e&&(t=a("content/top/title_bg",this.node)),t){var n=t.getComponent(r);if(n){var o=s.getVisibleSize(),i=n.width,l=n.height;if(e.includes("title_bg"))n.setContentSize(o.width,l),console.log("[MoreGamePanel] "+e+" width adapted: "+i+" -> "+o.width);else{var u=o.width/i,d=o.height/l,c=Math.max(u,d),g=i*c,h=l*c;n.setContentSize(g,h),console.log("[MoreGamePanel] "+e+" adapted: "+i+"x"+l+" -> "+g.toFixed(0)+"x"+h.toFixed(0))}}}},u.initI18nImageTexts=function(){var e=new l(50,80,120,255),t=[{nodeName:"gdyx_title_word",i18nKey:"more_games_page.title",outlineColor:e,outlineWidth:3},{nodeName:"gdyx_word_2",i18nKey:"more_games_page.play",outlineColor:new l(50,100,50,255),outlineWidth:2},{nodeName:"gdyx_word_1",i18nKey:"more_games_page.coming_soon",outlineColor:e,outlineWidth:2}];h.replaceImageTexts(this.node,t),h.listenLanguageChange(this.node,t,this)},u.init=function(){var e=n(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u.onOpen=function(e,t){console.log(+t),+t>0&&g.I.emit(c.OPEN_OTHER_GAME,+t)},u.onClose=function(){},i}(d))||p);i._RF.pop()}}}));

System.register("chunks:///_virtual/NativePlatform.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TopOnMgr.ts","./EventManager.ts","./Tips.ts","./I18nManager.ts","./UIManager.ts","./GameMgr.ts","./Enum.ts","./BoardDataMgr.ts"],(function(e){var o,t,i,n,a,l,s,r,c,d,g,I,f,v,h,u,N,S,m,_,p,E,L,y,A,T;return{setters:[function(e){o=e.extends},function(e){t=e.cclegacy,i=e.sys,n=e.input,a=e.Input,l=e.KeyCode,s=e.game,r=e.native,c=e.director,d=e.Node,g=e.Layers,I=e.UITransform,f=e.Size,v=e.BlockInputEvents,h=e.Graphics,u=e.Color,N=e.Label},function(e){S=e.TopOnMgr},function(e){m=e.default},function(e){_=e.default},function(e){p=e.I18n},function(e){E=e.default,L=e.PanelType},function(e){y=e.GameMgr},function(e){A=e.GameState},function(e){T=e.BoardDataMgr}],execute:function(){t._RF.push({},"35b16QKx7JANa1MCrh/BfFA","NativePlatform",void 0);e("NativePlatform",function(){function e(){this.name="Native",this._loadingNode=null}var t=e.prototype;return t.init=function(){console.log("NativePlatform init"),"undefined"!=typeof PUCHI_SDK&&(PUCHI_SDK.Platform=this,console.log("[Native] PUCHI_SDK.Platform forcibly assigned to NativePlatform")),this.fixSdkFlags(),i.platform===i.Platform.ANDROID&&(console.log("[Native] Registering Back Key Listener"),n.on(a.EventType.KEY_DOWN,this.onKeyDown,this))},t.onKeyDown=function(e){if(e.keyCode===l.MOBILE_BACK){if(console.log("[Native] Back Key Pressed"),E.handleBack())return void console.log("[Native] Panel closed");var o=y.I.game,t=!0;o&&o.game&&o.game.home&&(t=!!o.game.home.active),t||T.I.state!==A.Play?(console.log("[Native] In Home -> Exiting Game"),s.end()):(console.log("[Native] In Game -> Opening Setting Panel (Pause)"),E.openPanel(L.SettingPanel))}},t.fixSdkFlags=function(){if("undefined"!=typeof PUCHI_SDK)try{PUCHI_SDK.IsWx=!1,PUCHI_SDK.IsWeb=!1,PUCHI_SDK.IsQQ=!1,PUCHI_SDK.IsOppo=!1,PUCHI_SDK.IsVivo=!1,PUCHI_SDK.IsDouyin=!1,console.log("[NativePlatform] Fixed PUCHI_SDK flags")}catch(e){console.warn("[NativePlatform] Failed to fix PUCHI_SDK flags",e)}},t.login=function(){return console.log("[Native] login success"),Promise.resolve({code:0,openid:"native_test_user"})},t.getUserInfo=function(){return Promise.resolve({nickName:"Player",avatarUrl:""})},t.getVersion=function(){if(console.log("[Native] getVersion Start"),i.os===i.OS.ANDROID)try{var e=r.reflection.callStaticMethod("com/cocos/game/AppActivity","getAppVersion","()Ljava/lang/String;");return console.log("[Native] getVersion Success: "+e),e||"1.0.0"}catch(e){return console.error("[Native] getVersion Failed: ",e),"1.0.0"}else if(i.os===i.OS.IOS)try{var o=r.reflection.callStaticMethod("AppDelegate","getAppVersion");return console.log("[Native] iOS getVersion Success: "+o),o||"1.0.0"}catch(e){return console.error("[Native] iOS getVersion Failed: ",e),"1.0.0"}return"1.0.0"},t.vibrateShort=function(e){if(void 0===e&&(e="medium"),console.log("[Native] vibrateShort calling 40ms, style="+e),void 0!==r&&r.reflection){if(i.os===i.OS.ANDROID)try{var o=128;switch(e){case"light":o=60;break;case"medium":o=128;break;case"heavy":o=255}r.reflection.callStaticMethod("com/cocos/game/AppActivity","vibrateWithAmplitude","(II)V",40,o)}catch(e){console.error("[Native] vibrateShort Failed: ",e)}else if(i.os===i.OS.IOS)try{var t=1;switch(e){case"light":t=0;break;case"medium":t=1;break;case"heavy":t=2}r.reflection.callStaticMethod("AppDelegate","vibrateShort:",t)}catch(e){console.error("[Native] iOS vibrateShort Failed: ",e)}}else console.log("[Native] native.reflection not found, skipping vibration")},t.vibrateLong=function(){if(console.log("[Native] vibrateLong calling 400ms"),void 0!==r&&r.reflection&&i.os===i.OS.ANDROID)try{r.reflection.callStaticMethod("com/cocos/game/AppActivity","vibrate","(I)V",400)}catch(e){console.error("[Native] vibrateLong Failed: ",e)}},t.showBanner=function(){console.log("[Native] showBanner"),S.I.showBanner()},t.hideBanner=function(){console.log("[Native] hideBanner"),S.I.hideBanner()},t.showInterstitial=function(){var e=this;S.I.checkInterstitialLimit()?(console.log("[Native] showInterstitial with delay"),this.showLoading(),setTimeout((function(){if(!S.I.isInterstitialReady())return console.log("[Native] Interstitial not ready after delay"),e.hideLoading(),void _.show(p.t("ad.not_ready"));var o=function(){console.log("[Native] Interstitial Show -> Hide Loading"),e.hideLoading(),n()},t=function(o){console.log("[Native] Interstitial Fail -> Hide Loading"),e.hideLoading(),_.show(p.t("ad.play_failed")),n()},i=function(){n()},n=function(){m.I.off(S.Event.INTERSTITIAL_SHOW,o,e),m.I.off(S.Event.INTERSTITIAL_FAIL,t,e),m.I.off(S.Event.INTERSTITIAL_CLOSE,i,e)};m.I.on(S.Event.INTERSTITIAL_SHOW,o,e),m.I.on(S.Event.INTERSTITIAL_FAIL,t,e),m.I.on(S.Event.INTERSTITIAL_CLOSE,i,e),S.I.showInterstitial()}),1e3)):console.log("[Native] Interstitial blocked by logic limit")},t.showInterstitialWithCallback=function(e){var o=this;if(!S.I.checkInterstitialLimit())return console.log("[Native] showInterstitialWithCallback: blocked by limit, executing callback"),void e();if(!S.I.isInterstitialReady())return console.log("[Native] showInterstitialWithCallback: not ready, executing callback"),void e();console.log("[Native] showInterstitialWithCallback: showing ad");var t=!1,i=function(){t||(t=!0,s(),e())},n=function(){console.log("[Native] Interstitial Show (with callback)"),o.hideLoading()},a=function(){console.log("[Native] Interstitial Closed -> executing callback"),o.hideLoading(),i()},l=function(e){console.log("[Native] Interstitial Failed -> executing callback"),o.hideLoading(),i()},s=function(){m.I.off(S.Event.INTERSTITIAL_SHOW,n,o),m.I.off(S.Event.INTERSTITIAL_CLOSE,a,o),m.I.off(S.Event.INTERSTITIAL_FAIL,l,o)};m.I.on(S.Event.INTERSTITIAL_SHOW,n,this),m.I.on(S.Event.INTERSTITIAL_CLOSE,a,this),m.I.on(S.Event.INTERSTITIAL_FAIL,l,this),this.showLoading(),S.I.showInterstitial()},t.showLoading=function(){var e=this;if(!this._loadingNode||!this._loadingNode.isValid){var o=c.getScene().getChildByName("Canvas");if(o){this._loadingNode=new d("NativeLoading"),this._loadingNode.layer=g.Enum.UI_2D,this._loadingNode.addComponent(I).setContentSize(new f(2e3,2e3)),this._loadingNode.addComponent(v);var t=this._loadingNode.addComponent(h);t.fillColor=new u(0,0,0,200),t.rect(-2e3,-2e3,4e3,4e3),t.fill();var i=new d("Label");i.layer=g.Enum.UI_2D;var n=i.addComponent(N);n.string=p.t("ad.loading"),n.fontSize=40,n.lineHeight=50,n.color=u.WHITE,i.parent=this._loadingNode,this._loadingNode.parent=o,setTimeout((function(){e._loadingNode&&e._loadingNode.isValid&&(e.hideLoading(),_.show(p.t("ad.load_timeout")))}),5e3)}}},t.hideLoading=function(){this._loadingNode&&(this._loadingNode.destroy(),this._loadingNode=null)},t.showRewardVideo=function(e){var o=this;return console.log("[Native] showRewardVideo: "+e),new Promise((function(e){if(!S.I.isRewardReady())return console.warn("[Native] Reward Video reported NOT READY. Retrying load..."),S.I.loadRewardVideo(),_.show(p.t("ad.not_ready")),void e({code:1,msg:"Ad not ready"});o.showLoading();var t=!1,i=function(){console.log("[Native] Ad Reward Profit"),t=!0},n=function(){console.log("[Native] Ad Closed"),l(),o.hideLoading(),t?e({code:0,msg:"ok"}):(_.show(p.t("ad.reward_failed")),e({code:1,msg:"User cancelled"}))},a=function(t){console.log("[Native] Ad Failed: "+t),l(),o.hideLoading(),_.show(p.t("ad.play_failed")),e({code:-1,msg:t||"Ad failed"})},l=function(){m.I.off(S.Event.REWARD_PROFIT,i,o),m.I.off(S.Event.REWARD_CLOSE,n,o),m.I.off(S.Event.REWARD_FAIL,a,o)};m.I.on(S.Event.REWARD_PROFIT,i,o),m.I.on(S.Event.REWARD_CLOSE,n,o),m.I.on(S.Event.REWARD_FAIL,a,o),S.I.showRewardVideo()}))},t.uploadRankData=function(e,t,n){console.log("[Native] uploadRankData key:"+e+" value:"+t),i.localStorage.setItem("rank_"+e,JSON.stringify(o({value:t},n)))},t.postMessage=function(e,o){console.log("[Native] postMessage event:"+e,o)},t.trackEvent=function(e,o){console.log("[Native] trackEvent: "+e,o)},t.getSafeAreaTop=function(){return i.os===i.OS.IOS?44:0},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/NoSpace.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./I18nManager.ts"],(function(t){var n,e,o,a,r,i,s,c,l,p,u,f,h,y,d,g,b;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,a=t.assertThisInitialized,r=t.asyncToGenerator,i=t.regeneratorRuntime},function(t){s=t.cclegacy,c=t.Animation,l=t.Label,p=t._decorator,u=t.UIOpacity,f=t.tween,h=t.Component,y=t.find,d=t.instantiate},function(t){g=t.AssetMgr},function(t){b=t.I18n}],execute:function(){var m,v,w,_,P,A,C,L;s._RF.push({},"cda2f4M8Y9Af4/H/3CEfP3u","NoSpace",void 0);var x=p,I=x.ccclass,M=x.property;t("default",(m=I("panel/NoSpace"),v=M(c),w=M(l),m(((L=function(t){function n(){for(var n,e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return n=t.call.apply(t,[this].concat(r))||this,o(n,"anim",A,a(n)),o(n,"tipLab",C,a(n)),n}return e(n,t),n.prototype.show=function(t,e){var o=this;this.tipLab.string=t,this.node.getComponent(u).opacity=255,this.anim.play(),f(this.node.getComponent(u)).to(.3,{opacity:255}).delay(.8).to(.3,{opacity:0}).call((function(){o.node.setParent(null),n._pool.push(o),e&&e()})).start()},n.show=function(){var t=r(i().mark((function t(e,o){var a,r,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e=null),void 0===o&&(o=null),null===e&&(e=b.t("tips.no_space")),a=null,!this._pool.length){t.next=8;break}a=this._pool.pop(),t.next=13;break;case 8:return t.next=10,g.I.loadPrefabAsync("Panel","NoSpace");case 10:r=t.sent,s=d(r),a=s.getComponent(n);case 13:a.node.setParent(y("Canvas")),a.show(e,o);case 15:case"end":return t.stop()}}),t,this)})));return function(n,e){return t.apply(this,arguments)}}(),n}(h))._pool=[],A=n((P=L).prototype,"anim",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=n(P.prototype,"tipLab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=P))||_));s._RF.pop()}}}));

System.register("chunks:///_virtual/ObjectInstance.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"18429hsQt9E94reIcidRx8E","ObjectInstance",void 0),n("default",function(){function n(){}return n.getInstance=function(t){if(!n.instances.has(t)){var e=new t;return n.instances.set(t,e),e}return n.instances.get(t)},n}()).instances=new Map,t._RF.pop()}}}));

System.register("chunks:///_virtual/Panel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIManager.ts","./AssetPool.ts"],(function(t){var e,n,o,i,r,a,l,s,c,u,p,d,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,a=t.Node,l=t._decorator,s=t.Component,c=t.director,u=t.UITransform,p=t.view},function(t){d=t.default},function(t){f=t.AssetPool}],execute:function(){var h,g,b,y,m,w,P,v,z,C,k;r._RF.push({},"3399dHBwfFGH44rpfPpwokl","Panel",void 0),console.log("[Load] Loading Panel.ts");var x=l,B=x.ccclass,H=x.property,M=x.menu;t("default",(h=M("视图/Panel"),g=H(a),b=H({tooltip:"点击背景关闭"}),y=H({tooltip:"内容图层",type:a}),m=H({tooltip:"是否隐藏,勾选调用close不销毁"}),B(w=h((v=e((P=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,o(e,"bg",v,i(e)),o(e,"touchBackgroundClose",z,i(e)),o(e,"content",C,i(e)),o(e,"isHide",k,i(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){},r.start=function(){this.adaptBgMask()},r.showModal=function(t){this.node.getComponents(s).forEach((function(e){var n=e;n.onShow&&n.onShow.apply(e,t)})),c.getScene().addChild(this.node)},r.close=function(t){this.isHide&&t?d.hdiePanel(t,this):f.I.put(this.node)},r.onDisable=function(){d.nextPanel()},r.init=function(){},r.adaptBgMask=function(){if(this.bg||(this.bg=this.node.getChildByName("bg")),this.bg){var t=this.bg.getComponent(u);if(t){var e=p.getVisibleSize(),n=t.width,o=t.height,i=e.width/n,r=e.height/o,a=Math.max(i,r),l=n*a,s=o*a;t.setContentSize(l,s),console.log("[Panel] bg mask adapted: "+n+"x"+o+" -> "+l.toFixed(0)+"x"+s.toFixed(0))}}},e}(s)).prototype,"bg",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(P.prototype,"touchBackgroundClose",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C=e(P.prototype,"content",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(P.prototype,"isHide",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=P))||w)||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/PlatformManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WechatPlatform.ts","./NativePlatform.ts","./TelegramPlatform.ts","./YandexPlatform.ts","./VKPlatform.ts","./CrazyGamesPlatform.ts","./FacebookPlatform.ts","./GameDistributionPlatform.ts"],(function(e){var t,n,r,a,o,i,s,c,u,l,m,f,d;return{setters:[function(e){t=e.createClass,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){a=e.cclegacy,o=e.sys},function(e){i=e.WechatPlatform},function(e){s=e.NativePlatform},function(e){c=e.TelegramPlatform},function(e){u=e.YandexPlatform},function(e){l=e.VKPlatform},function(e){m=e.CrazyGamesPlatform},function(e){f=e.FacebookPlatform},function(e){d=e.GameDistributionPlatform}],execute:function(){a._RF.push({},"099d5VnjsdMQYNZ01UW6e87","PlatformManager",void 0),e("PlatformManager",function(){function e(){this._platform=null,this.initPlatform()}e.getInstance=function(){return this._instance||(this._instance=new e),this._instance};var a=e.prototype;return a.initPlatform=function(){if(o.platform===o.Platform.WECHAT_GAME)this._platform=new i;else if(o.platform===o.Platform.MOBILE_BROWSER||o.platform===o.Platform.DESKTOP_BROWSER){var e=new URLSearchParams(window.location.search),t=e.has("vk_app_id")||e.has("vk_platform")||"vk"===e.get("platform");window.Telegram&&window.Telegram.WebApp?this._platform=new c:t?this._platform=new l:window.FBInstant?this._platform=new f:window.YaGames?this._platform=new u:window.CrazyGames?this._platform=new m:this.isGameDistributionEnvironment()?(console.log("[PlatformManager] GameDistribution environment detected"),this._platform=new d):(console.log("[Loader] Not Telegram, VK, Yandex, or Facebook. Native/CrazyGames fallback."),this._platform=new s)}else this._platform=new s;console.log("[PlatformManager] Current Platform: "+this._platform.name),this._platform.init()},a.isGameDistributionEnvironment=function(){if(window.gdsdk||window.GD_OPTIONS)return!0;var e=window.location.hostname;if(e.includes("gamedistribution")||e.includes("revision.gamedistribution")||e.includes("html5.gamedistribution"))return!0;var t=window.location.search;return!(!t.includes("platform=gd")&&!t.includes("platform=gamedistribution"))},a.loadYandexSDK=function(){var e=n(r().mark((function e(){var t,a,i,s,c,l=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isNative){e.next=2;break}return e.abrupt("return",!1);case 2:if(!window.Telegram||!window.Telegram.WebApp){e.next=4;break}return e.abrupt("return",!1);case 4:if(!window.YaGames){e.next=10;break}return t=new u,this._platform=t,e.next=9,t.initAsync();case 9:return e.abrupt("return",!0);case 10:if(a=window.location.hostname,i=window.location.search,s=a.includes("yandex.net")||a.includes("yandex.com")||a.includes("yandex.ru"),c=i.includes("platform=yandex"),s||c){e.next=16;break}return e.abrupt("return",!1);case 16:return e.abrupt("return",new Promise((function(e){var t=document.createElement("script");t.src="https://yandex.ru/games/sdk/v2",t.async=!0,t.onload=n(r().mark((function t(){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("[PlatformManager] Yandex SDK script loaded."),!window.YaGames){t.next=9;break}return n=new u,l._platform=n,t.next=6,n.initAsync();case 6:e(!0),t.next=10;break;case 9:e(!1);case 10:case"end":return t.stop()}}),t)}))),t.onerror=function(){console.warn("[PlatformManager] Failed to load Yandex SDK script. Environment is likely not Yandex."),e(!1)},document.head.appendChild(t)})));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.loadCrazyGamesSDK=function(){var e=n(r().mark((function e(){var t,a,i,s,c,u=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isNative){e.next=2;break}return e.abrupt("return",!1);case 2:if(!window.Telegram||!window.Telegram.WebApp){e.next=4;break}return e.abrupt("return",!1);case 4:if(!window.YaGames){e.next=6;break}return e.abrupt("return",!1);case 6:if(!window.CrazyGames){e.next=12;break}return t=new m,this._platform=t,e.next=11,t.initAsync();case 11:return e.abrupt("return",!0);case 12:if(a=window.location.hostname,i=window.location.search,s=a.includes("crazygames.com")||a.includes("1001juegos.com"),c=i.includes("platform=crazygames"),s||c){e.next=18;break}return e.abrupt("return",!1);case 18:return e.abrupt("return",new Promise((function(e){var t=document.createElement("script");t.src="https://sdk.crazygames.com/crazygames-sdk-v2.js",t.async=!0,t.onload=n(r().mark((function t(){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("[PlatformManager] CrazyGames SDK script loaded."),!window.CrazyGames){t.next=9;break}return n=new m,u._platform=n,t.next=6,n.initAsync();case 6:e(!0),t.next=10;break;case 9:e(!1);case 10:case"end":return t.stop()}}),t)}))),t.onerror=function(){console.warn("[PlatformManager] Failed to load CrazyGames SDK script."),e(!1)},document.head.appendChild(t)})));case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.loadGameDistributionSDK=function(){var e=n(r().mark((function e(){var t,a,i,s,c,u=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isNative){e.next=2;break}return e.abrupt("return",!1);case 2:if(!window.Telegram||!window.Telegram.WebApp){e.next=4;break}return e.abrupt("return",!1);case 4:if(!window.YaGames){e.next=6;break}return e.abrupt("return",!1);case 6:if(!window.CrazyGames){e.next=8;break}return e.abrupt("return",!1);case 8:if(!window.gdsdk){e.next=14;break}return t=new d,this._platform=t,e.next=13,t.initAsync();case 13:return e.abrupt("return",!0);case 14:if(a=window.location.hostname,i=window.location.search,s=a.includes("gamedistribution.com")||a.includes("html5.gamedistribution.com"),c=i.includes("platform=gd")||i.includes("platform=gamedistribution"),s||c){e.next=20;break}return e.abrupt("return",!1);case 20:return e.abrupt("return",new Promise((function(e){var t=document.createElement("script");t.id="gameDistributionSDK",t.src="https://html5.api.gamedistribution.com/main.min.js",t.async=!0,t.onload=n(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("[PlatformManager] GameDistribution SDK script loaded."),setTimeout(n(r().mark((function t(){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.gdsdk){t.next=8;break}return n=new d,u._platform=n,t.next=5,n.initAsync();case 5:e(!0),t.next=9;break;case 8:e(!1);case 9:case"end":return t.stop()}}),t)}))),500);case 2:case"end":return t.stop()}}),t)}))),t.onerror=function(){console.warn("[PlatformManager] Failed to load GameDistribution SDK script."),e(!1)},document.head.appendChild(t)})));case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t(e,[{key:"current",get:function(){return this._platform}}]),e}())._instance=void 0,a._RF.pop()}}}));

System.register("chunks:///_virtual/PoolManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./Const.ts"],(function(e){var o,a,c,t,r,n,l,s,i;return{setters:[function(e){o=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){c=e.cclegacy,t=e._decorator,r=e.NodePool,n=e.instantiate,l=e.error},function(e){s=e.AssetMgr},function(e){i=e.BUNDLES}],execute:function(){var u,p;c._RF.push({},"f6bc3bClD1JQbFLlf+VLzvx","PoolManager",void 0);var f=t,m=f.ccclass,b=(f.property,e("default",m(((p=function(){function e(){}return e.init=function(){var c=o(a().mark((function c(){var t,r;return a().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=[b.block,b.shadow,b.comBlocks,b.light,b.xiaochu,b.xiaochu2,b.combo,b.duoxiao,b.score,b.jewel,b.jewelParticle,b.click,b.puzzle,b.obstacles,b.maxAnim,b.bestPos,b.spine_perfect],r=t.map(o(a().mark((function o(c){var t;return a().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,s.I.loadPrefabAsync(i.Game,"comp/"+c);case 3:t=o.sent,e.initPool(c,t),o.next=10;break;case 7:o.prev=7,o.t0=o.catch(0),console.error("[PoolManager] Failed to load prefab: "+c,o.t0);case 10:case"end":return o.stop()}}),o,null,[[0,7]])})))),c.next=4,Promise.all(r);case 4:console.log("[PoolManager] All "+t.length+" prefabs loaded");case 5:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}(),e.initPool=function(o,a){e.map[o]||(e.map[o]=new r),e.prefabMap[o]=a},e.get=function(o){e.map[o]||(e.map[o]=new r);var a=e.map[o].get();if(a||(a=n(e.prefabMap[o])))return a;l(o+"未初始化预制体")},e.put=function(o,a){e.map[o]?e.map[o].put(a):l(o+"未初始化池")},e}()).map={},p.prefabMap={},u=p))||u),e("PoolName",function(e){return e.block="block",e.shadow="shadow",e.comBlocks="comBlocks",e.light="light",e.xiaochu="spine_xiaochu",e.xiaochu2="spine_xiaochu2",e.combo="combo",e.duoxiao="duoxiao",e.score="score",e.jewel="jewel",e.jewelParticle="jewelParticle",e.click="click",e.puzzle="puzzle",e.obstacles="eff_obstacles",e.maxAnim="maxAnim",e.bestPos="bestPos",e.spine_perfect="spine_perfect",e.colorBlock="colorBlock",e.fallBlock="fallBlock",e.fallBlocks="fallBlocks",e.breakParticles="breakParticles",e.itemParticles="itemParticles",e}({})));c._RF.pop()}}}));

System.register("chunks:///_virtual/PuzzleMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./GameData.ts","./ObjectInstance.ts"],(function(t){var n,e,r,a,u,s,i;return{setters:[function(t){n=t.createClass,e=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){a=t.cclegacy},function(t){u=t.AssetMgr},function(t){s=t.GameData},function(t){i=t.default}],execute:function(){a._RF.push({},"e5a688oIgRO0ajCyFvC8X9a","PuzzleMgr",void 0);t("PuzzleMgr",function(){function t(){this._map={},this.MAX_ID=100}var a=t.prototype;return a.init=function(){var t=e(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.loadMap(s.data.mapId);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),a.addStage=function(){},a.loadMap=function(){var t=e(r().mark((function t(n){var e,a,s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._map[n]){t.next=2;break}return t.abrupt("return",this._map[n]);case 2:return e=n<=8?"Game":n<=50?"Puzzle":"Puzzle2",t.next=5,u.I.loadJson(e,"json/map"+n);case 5:return(a=t.sent)&&a.json&&(s=(s=a.json).sort((function(t,n){return t.id-n.id})),this._map[n]=s),t.abrupt("return",this._map[n]);case 8:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}(),n(t,[{key:"isMax",get:function(){return s.data.mapId>this.MAX_ID}}],[{key:"I",get:function(){return i.getInstance(t)}}]),t}());a._RF.pop()}}}));

System.register("chunks:///_virtual/RankItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./I18nManager.ts"],(function(e){var r,t,n,i,a,o,l,s,u,c,p,b,f;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,o=e.Sprite,l=e.SpriteFrame,s=e.Label,u=e._decorator,c=e.assetManager,p=e.Texture2D,b=e.Component},function(e){f=e.I18n}],execute:function(){var g,h,m,S,d,k,v,y,I,w,D,z,F,R,_;a._RF.push({},"15e5avl6HpDl5InOZHu1BjA","RankItem",void 0);var x=u,H=x.ccclass,P=x.property;e("RankItem",(g=H("RankItem"),h=P(o),m=P(l),S=P(o),d=P(l),k=P(s),v=P(o),g((w=r((I=function(e){function r(){for(var r,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return r=e.call.apply(e,[this].concat(a))||this,n(r,"bg",w,i(r)),n(r,"bgSf",D,i(r)),n(r,"rankIcon",z,i(r)),n(r,"rankSf",F,i(r)),n(r,"labs",R,i(r)),n(r,"icon",_,i(r)),r}return t(r,e),r.prototype.refresh=function(e,r,t){var n=this;this.labs[0].string=r<100?(r+1).toString():f.t("rank.not_ranked"),this.labs[1].string=e.nickname,this.labs[2].string=t?e.fraction.toString():f.t("game.level",e.fraction);var i=0;if(e.extend&&(i=JSON.parse(e.extend).badge),this.labs[3].string=""+i,r<3){this.labs[0].string="";var a=e.uid==PUCHI_SDK.DataService.uid;this.bg.spriteFrame=this.bgSf[a?1:0],this.rankIcon.spriteFrame=this.rankSf[r]}else{var o=e.uid==PUCHI_SDK.DataService.uid;this.bg.spriteFrame=this.bgSf[o?1:0],this.rankIcon.spriteFrame=null}e.headurl&&c.loadRemote(e.headurl,{ext:".png"},(function(e,r){if(!e){var t=new l,i=new p;i.image=r,t.texture=i,n.icon.spriteFrame=t}}))},r}(b)).prototype,"bg",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=r(I.prototype,"bgSf",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=r(I.prototype,"rankIcon",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=r(I.prototype,"rankSf",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=r(I.prototype,"labs",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=r(I.prototype,"icon",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=I))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/RankPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ListView.ts","./ListViewAdapter.ts","./RankItem.ts","./GameData.ts","./Tips.ts","./Utils.ts","./PlatformManager.ts","./SdkTools.ts","./I18nManager.ts"],(function(e){var t,i,n,a,r,s,o,u,c,l,h,d,f,p,b,g,v,x,k,I,D,m,_,w,S;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose,s=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){u=e.cclegacy,c=e.Node,l=e.SubContextView,h=e._decorator,d=e.Label,f=e.tween,p=e.v3,b=e.UITransform,g=e.view},function(e){v=e.default},function(e){x=e.default},function(e){k=e.RankItem},function(e){I=e.GameData},function(e){D=e.default},function(e){m=e.Utils},function(e){_=e.PlatformManager},function(e){w=e.SdkTools},function(e){S=e.I18n}],execute:function(){var z,y,P,A,C,U,H,L,K,B,V,F,R,M,T,W,G,j,O;u._RF.push({},"c493aFvpVBO6r1BFan7APi+","RankPanel",void 0);var N=h,E=N.ccclass,J=N.property,q=(e("default",(z=E("panel/RankPanel"),y=J(v),P=J(c),A=J(c),C=J(c),U=J(c),H=J(k),L=J(c),K=J(l),z((F=t((V=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,n(t,"rankList",F,a(t)),n(t,"toggleBg",R,a(t)),n(t,"boxAuthorize",M,a(t)),n(t,"boxAuthorize2",T,a(t)),n(t,"btnAuthorize",W,a(t)),n(t,"selfItem",G,a(t)),n(t,"toggleBg2",j,a(t)),n(t,"subView",O,a(t)),t.dataSet=[],t.lvData=[],t.scoreData=[],t.selIdx=-1,t.selIdx2=-1,t.isAuthorize=!1,t._authorizeBtn=null,t.isFirst=!1,t}i(t,e);var u=t.prototype;return u.onLoad=function(){_.getInstance().current.uploadRankData("rank_score",I.data.maxScore,{badge:I.data.daily_badge_count+""}),_.getInstance().current.uploadRankData("rank_level",I.data.level,{badge:I.data.daily_badge_count+""})},u.onEnable=function(){this.initI18nLabels()},u.initI18nLabels=function(){for(var e,t={"世界排行":"rank.world_rank","好友排行":"rank.friend_rank","点击授权":"rank.click_auth","需要授权你的头像昵称信息\n才可以加入排行榜哦":"rank.need_avatar_auth","需要授权你的好友信息\n才可以查看排行榜哦":"rank.need_friend_auth"},i=this.node.getComponentsInChildren(d),n=r(i);!(e=n()).done;){var a=e.value,s=t[a.string];s&&(a.string=S.t(s))}},u.init=function(){var e=s(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.selIdx=-1,this.selIdx2=-1,this.onLv();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.updateView=function(e,t,i){e.getComponent(k).refresh(i,t,1==this.selIdx)},u.onLv=function(){var e=s(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.selIdx){e.next=2;break}return e.abrupt("return");case 2:this.selIdx=0,this.selIdx2=-1,f(this.toggleBg).to(.2,{position:p(-180,440,0)}).start(),this.isFirst?(this.isAuthorize=!0,this.boxAuthorize2.active=!1,this.onFriend()):(this.isAuthorize=!0,this.isFirst=!0,this.boxAuthorize2.active=!1,this.onFriend());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onScore=function(){var e=s(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=this.selIdx){e.next=2;break}return e.abrupt("return");case 2:this.selIdx=1,f(this.toggleBg).to(.2,{position:p(100,440,0)}).start(),this.selIdx2=-1,this.onFriend();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onAuthorize=function(){var e,t=this;"undefined"!=typeof wx?wx.getUserProfile({desc:"补充用户资料",success:(e=s(o().mark((function e(i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,PUCHI_SDK.Login.login(!0);case 2:I.data.authorize=!0,t.onWorld();case 4:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),fail:function(e){D.show(S.t("tips.need_auth"))}}):(I.data.authorize=!0,this.onWorld())},u.onAuthorize2=function(){this.isAuthorize=!0,this.boxAuthorize2.active=!1,this.onFriend()},u.onFriend=function(){0!=this.selIdx2&&(this.isAuthorize?(this.selfItem.node.active=!1,this.rankList.node.active=!1,this.selIdx2=0,f(this.toggleBg2).to(.2,{position:p(-125,2,0)}).start(),PUCHI_SDK.IsWx?(this.subView.enabled=!0,this.subView.node.active=!0,0==this.selIdx?_.getInstance().current.postMessage("rank_level",{openid:PUCHI_SDK.DataService.openid}):_.getInstance().current.postMessage("rank_score",{openid:PUCHI_SDK.DataService.openid})):console.log("非微信小游戏不支持好友排行！")):this.boxAuthorize2.active=!0)},u.onWorld=function(){var e=s(o().mark((function e(){var t,i,n,a,r,s,u,c,l,h,d,v,x,k,D,_,w,S,z,y,P=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=this.selIdx2){e.next=2;break}return e.abrupt("return");case 2:if(this.boxAuthorize2.active=!1,this.subView.enabled=!1,this.subView.node.active=!1,I.data.authorize){e.next=15;break}if(this.selfItem.node.active=!1,this.boxAuthorize.active=!0,0!=PUCHI_SDK.IsWx){e.next=10;break}return e.abrupt("return");case 10:return t=this.btnAuthorize.getComponent(b).getBoundingBoxToWorld(),i=g.getVisibleSize(),this._authorizeBtn=PUCHI_SDK.Platform.createUserInfoButton({type:"txt",text:"",style:{left:t.xMin,top:i.height-t.yMax,width:t.width,height:t.height,backgroundColor:"#ffffff00"},withCredentials:!0}),this._authorizeBtn.onTap((function(){P.onAuthorize()})),e.abrupt("return");case 15:if(this.selfItem.node.active=!0,this.boxAuthorize.active=!1,this.selfItem.node.active=!0,this.rankList.node.active=!0,f(this.toggleBg2).to(.2,{position:p(125,2,0)}).start(),this.selIdx2=1,0!=this.selIdx){e.next=46;break}if(0!=this.lvData.length){e.next=31;break}if(!PUCHI_SDK.IsWeb){e.next=27;break}for(n=0;n<100;n++)(a=new q).fraction=1e3-n,a.headurl="https://wxsdk-cdn.miso-lab.com/image/headurl/icon"+(n+1)+".jpg",a.nickname="玩家"+(n+1),a.uid=1e3+n+"",this.lvData.push(a);e.next=31;break;case 27:return e.next=29,PUCHI_SDK.GameService.rankListV2("rank_level");case 29:0==(r=e.sent).code&&(this.lvData=r.data.list);case 31:this.dataSet=m.clone(this.lvData),this.rankList.setAdapter(this),c=0;case 34:if(!(c<this.lvData.length)){e.next=42;break}if(+this.lvData[c].uid!=+PUCHI_SDK.DataService.uid){e.next=39;break}return s=this.lvData[c],u=c,e.abrupt("break",42);case 39:c++,e.next=34;break;case 42:s||(u=999,(d=new q).fraction=I.data.level,d.headurl=(null==(l=PUCHI_SDK.DataService.userinfo)?void 0:l.headurl)||"",d.nickname=(null==(h=PUCHI_SDK.DataService.userinfo)?void 0:h.nickname)||"",d.uid=PUCHI_SDK.DataService.uid+"",d.extend=JSON.stringify({badge:I.data.daily_badge_count}),s=d),this.selfItem.refresh(s,u,!1),e.next=69;break;case 46:if(0!=this.scoreData.length){e.next=56;break}if(!PUCHI_SDK.IsWeb){e.next=52;break}for(v=0;v<100;v++)(x=new q).fraction=1e4-v,x.headurl="https://wxsdk-cdn.miso-lab.com/image/headurl/icon"+(v+100)+".jpg",x.nickname="玩家"+(v+100),x.uid=1e4+v+"",this.scoreData.push(x);this.scoreData[10].uid="1228876",e.next=56;break;case 52:return e.next=54,PUCHI_SDK.GameService.rankListV2("rank_score");case 54:0==(k=e.sent).code&&(this.scoreData=k.data.list);case 56:this.dataSet=m.clone(this.scoreData),this.rankList.setAdapter(this),w=0;case 59:if(!(w<this.scoreData.length)){e.next=67;break}if(+this.scoreData[w].uid!=+PUCHI_SDK.DataService.uid){e.next=64;break}return D=this.scoreData[w],_=w,e.abrupt("break",67);case 64:w++,e.next=59;break;case 67:D||(_=999,(y=new q).fraction=I.data.maxScore,y.headurl=(null==(S=PUCHI_SDK.DataService.userinfo)?void 0:S.headurl)||"",y.nickname=(null==(z=PUCHI_SDK.DataService.userinfo)?void 0:z.nickname)||"",y.uid=PUCHI_SDK.DataService.uid+"",D=y),this.selfItem.refresh(D,_,!0);case 69:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),u.onClose=function(){this.close()},u.onShare=function(){w.share("share_rank")},t}(x)).prototype,"rankList",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(V.prototype,"toggleBg",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(V.prototype,"boxAuthorize",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(V.prototype,"boxAuthorize2",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(V.prototype,"btnAuthorize",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(V.prototype,"selfItem",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(V.prototype,"toggleBg2",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(V.prototype,"subView",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=V))||B)),e("IGameRankData",(function(){this.uid=void 0,this.fraction=void 0,this.headurl=void 0,this.nickname=void 0,this.extend=void 0})));u._RF.pop()}}}));

System.register("chunks:///_virtual/ReplacePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigManager.ts","./Panel.ts","./Utils.ts","./ComBlocks.ts","./PoolManager.ts","./SdkTools.ts","./TDataMgr.ts","./I18nImageText.ts"],(function(t){var e,n,o,i,r,a,s,c,l,u,h,p,f,d,g,m,b,y,C,v,T,k;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized,r=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){s=t.cclegacy,c=t.Node,l=t._decorator,u=t.Color,h=t.tween,p=t.UIOpacity,f=t.Tween},function(t){d=t.ConfigManager},function(t){g=t.default},function(t){m=t.Utils},function(t){b=t.ComBlocks},function(t){y=t.default,C=t.PoolName},function(t){v=t.SdkTools},function(t){T=t.TDataMgr},function(t){k=t.I18nImageText}],execute:function(){var w,_,A,N,P,x,B,D,E,I,R;s._RF.push({},"b8f71ksPTFG44kIZk9PvyLy","ReplacePanel",void 0);var S=l,z=S.ccclass,H=S.property;t("default",(w=z("panel/ReplacePanel"),_=H(c),A=H(c),N=H(c),P=H(c),w((D=e((B=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,o(e,"iconVideo",D,i(e)),o(e,"btnClose",E,i(e)),o(e,"btnClose2",I,i(e)),o(e,"groupNode",R,i(e)),e.groups=[],e.isTouch=!1,e.isAnim=!1,e.t=0,e.callback=void 0,e}n(e,t);var s=e.prototype;return s.onLoad=function(){this.bg.on(c.EventType.TOUCH_START,this.touchStart,this),this.bg.on(c.EventType.TOUCH_END,this.touchEnd,this),this.bg.on(c.EventType.TOUCH_CANCEL,this.touchEnd,this);for(var t=0;t<3;t++){var e=y.get(C.comBlocks);e.getComponent(b).init(t,null),this.groupNode.addChild(e),this.groups.push(e.getComponent(b))}var n=new u(50,80,120,255),o=[{nodeName:"word_3",i18nKey:"home.free_replace",outlineColor:n,outlineWidth:3},{nodeName:"word_2",i18nKey:"home.free_replace",outlineColor:n,outlineWidth:3},{nodeName:"shezhi_word_1",i18nKey:"home.replace_block",outlineColor:n,outlineWidth:3},{nodeName:"fuhuo_word",i18nKey:"tips.no_space",outlineColor:n,outlineWidth:3}];k.replaceImageTexts(this.node,o)},s.update=function(t){this.isTouch&&!this.isAnim&&Date.now()-this.t>1e3&&(this.isAnim=!0,this.animHide())},s.touchStart=function(){this.isTouch=!0,this.t=Date.now()},s.touchEnd=function(){this.isTouch=!1,this.isAnim&&(this.isAnim=!1,this.animShow())},s.animHide=function(){h(this.content.getComponent(p)).to(.1,{opacity:0}).start(),h(this.bg.getComponent(p)).to(.1,{opacity:50}).start()},s.animShow=function(){f.stopAllByTarget(this.content),f.stopAllByTarget(this.bg),h(this.content.getComponent(p)).to(.1,{opacity:255}).start(),h(this.bg.getComponent(p)).to(.1,{opacity:180}).start()},s.init=function(){var t=r(a().mark((function t(e,n,o,i){var r,s,c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(this.callback=e,this.btnClose.active=!i,this.btnClose2.active=!i,this.iconVideo.active=!i,r=0;r<3;r++)(s=d.getBlockTable(n[r]))&&(c=m.clone(s.getBlocks()),this.groups[r].createBlocks(c,o[r]),this.groups[r].showAnim2());this.iconVideo.active&&T.ins.dot("video_exposure",{view_reason:"replace_block"});case 6:case"end":return t.stop()}}),t,this)})));return function(e,n,o,i){return t.apply(this,arguments)}}(),s.onClose=function(){this.close(),this.callback(!1)},s.onReplace=function(){var t=r(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.iconVideo.active){t.next=6;break}return t.next=3,v.share("replace_block");case 3:return 0==t.sent.code&&(this.close(),this.callback(!0)),t.abrupt("return");case 6:this.close(),this.callback(!0);case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e}(g)).prototype,"iconVideo",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(B.prototype,"btnClose",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(B.prototype,"btnClose2",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(B.prototype,"groupNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=B))||x));s._RF.pop()}}}));

System.register("chunks:///_virtual/RetPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./ConfigManager.ts","./Const.ts","./Enum.ts","./GameData.ts","./Panel.ts","./TDataMgr.ts","./Utils.ts","./BoardDataMgr.ts","./GameConst.ts","./PuzzleMgr.ts","./AudioManager.ts","./EventManager.ts","./MaskView.ts","./PoolManager.ts","./SdkTools.ts","./UIManager.ts","./I18nManager.ts","./I18nImageText.ts","./PlatformManager.ts","./ReviewMode.ts"],(function(e){var t,a,n,i,r,l,o,s,c,u,d,p,h,f,b,v,m,g,y,k,w,x,I,C,z,_,N,P,S,R,D,W,T,H,L,M,A,E,B,U,K,O,F,G,X,Y,V,Z,j;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.createClass,l=e.createForOfIteratorHelperLoose,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){c=e.cclegacy,u=e.sp,d=e.Node,p=e.Label,h=e.Sprite,f=e._decorator,b=e.UITransform,v=e.Color,m=e.sys,g=e.ParticleSystem2D,y=e.Component,k=e.v3,w=e.UIOpacity,x=e.tween,I=e.LabelOutline,C=e.isValid},function(e){z=e.AssetMgr},function(e){_=e.ConfigManager},function(e){N=e.BUNDLES},function(e){P=e.EventType,S=e.GameType,R=e.CollectType},function(e){D=e.GameData},function(e){W=e.default},function(e){T=e.TDataMgr},function(e){H=e.Utils},function(e){L=e.BoardDataMgr},function(e){M=e.default},function(e){A=e.PuzzleMgr},function(e){E=e.AudioManager},function(e){B=e.default},function(e){U=e.MaskView},function(e){K=e.default,O=e.PoolName},function(e){F=e.SdkTools},function(e){G=e.default,X=e.PanelType},function(e){Y=e.I18n},function(e){V=e.I18nImageText},function(e){Z=e.PlatformManager},function(e){j=e.ReviewMode}],execute:function(){var Q,J,q,$,ee,te,ae,ne,ie,re,le,oe,se,ce,ue,de,pe,he,fe,be,ve,me,ge,ye,ke,we,xe,Ie,Ce,ze,_e,Ne,Pe,Se,Re,De,We,Te,He,Le,Me,Ae,Ee;c._RF.push({},"33c9c9AbSRGCpNOvKuNrXnY","RetPanel",void 0);var Be=f,Ue=Be.ccclass,Ke=Be.property,Oe=(e("default",(Q=Ue("panel/RetPanel"),J=Ke(u.Skeleton),q=Ke(d),$=Ke(d),ee=Ke(d),te=Ke(d),ae=Ke(d),ne=Ke(d),ie=Ke(p),re=Ke(p),le=Ke(p),oe=Ke(d),se=Ke(d),ce=Ke(d),ue=Ke(d),de=Ke(d),pe=Ke(h),he=Ke(d),fe=Ke(d),be=Ke(d),ve=Ke(d),Q((ye=t((ge=function(e){function t(){for(var t,a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,n(t,"sp",ye,i(t)),n(t,"hardNode",ke,i(t)),n(t,"animNode",we,i(t)),n(t,"btnNext",xe,i(t)),n(t,"btnNextHard",Ie,i(t)),n(t,"btnReplay",Ce,i(t)),n(t,"btnReplayHard",ze,i(t)),n(t,"labNow",_e,i(t)),n(t,"labWinStreak",Ne,i(t)),n(t,"labWinStreak_2",Pe,i(t)),n(t,"winStreakBg",Se,i(t)),n(t,"slideNode",Re,i(t)),n(t,"boxSlide",De,i(t)),n(t,"puzzleNode",We,i(t)),n(t,"handBook",Te,i(t)),n(t,"puzzleBg",He,i(t)),n(t,"boxAdditional",Le,i(t)),n(t,"boxTips",Me,i(t)),n(t,"failNode",Ae,i(t)),n(t,"shareNode",Ee,i(t)),t.isClick=!1,t.puzzles=[],t.Col=20,t.Row=20,t.isWin=!1,t.listData=[],t.lastId=0,t}a(t,e);var r=t.prototype;return r.onLoad=function(){for(var e=0;e<this.Col;e++)for(var t=0;t<this.Row;t++){var a=K.get(O.puzzle);a.addComponent(Oe),this.puzzleNode.addChild(a);var n=a.getComponent(Oe);n.initPos(e,t,this.Col,this.Col),n.changeColor(0),this.puzzles.push(n)}},r.initI18nLabels=function(){if(this.labWinStreak_2){this.labWinStreak_2.overflow=p.Overflow.SHRINK,this.labWinStreak_2.enableWrapText=!0;var e=this.labWinStreak_2.getComponent(b);e&&e.setContentSize(100,80),this.labWinStreak_2.fontSize=24,this.labWinStreak_2.string=Y.t("panel.win_streak")}if(this.boxTips){var t,a,n=null==(t=this.boxTips.getChildByName("label-002"))?void 0:t.getComponent(p);n&&(n.string=Y.t("panel.streak_more"));var i=null==(a=this.boxTips.getChildByName("label-001"))?void 0:a.getComponent(p);i&&(i.string=Y.t("panel.also_more"))}if(this.boxAdditional){var r=this.boxAdditional.getComponentInChildren(p);r&&(r.string=Y.t("panel.new_user_extra"))}},r.replaceBtnText=function(e,t,a,n,i){if(void 0===n&&(n=4),void 0===i&&(i=54),e){var r=function e(t){if(t.name.startsWith("word_"))return t;for(var a,n=l(t.children);!(a=n()).done;){var i=e(a.value);if(i)return i}return null}(e);r&&(console.log("[I18n] Replacing text for "+e.name+" -> "+r.name+", key: "+t),V.addOrUpdateLabel(r,{nodeName:r.name,i18nKey:t,outlineColor:a,outlineWidth:n,fontSize:i}))}},r.initI18nImageTexts=function(e){var t=new v(50,100,50,255);this.replaceBtnText(this.btnNext,"panel.next_level",t,4,60),this.replaceBtnText(this.btnNextHard,"panel.next_level",t,4,60),this.replaceBtnText(this.btnReplay,"panel.replay",t,4,60),this.replaceBtnText(this.btnReplayHard,"panel.replay",t,4,60)},r.init=function(){var e=o(s().mark((function e(t,a){var n,i,r,l,o,c,u,h,f,b,m,g,y,C,z,N,P,W,A,B,U=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===a&&(a=0),this.isWin=t,this.isClick=!0,this.initPuzzle(!0),this.initI18nLabels(),this.initI18nImageTexts(t),E.I.playEffect(t?"level_mode_success":"defeat"),this.sp&&this.sp.node&&this.sp.node.parent&&((n=this.sp.node.parent.getChildByName("generated_title_label"))||((n=new d("generated_title_label")).parent=this.sp.node.parent,n.setPosition(this.sp.node.x,this.sp.node.y+50,0),(i=n.addComponent(p)).fontSize=96,i.lineHeight=110,i.isBold=!0,this.labNow&&this.labNow.font&&(i.font=this.labNow.font),n.addComponent(I),i.outlineWidth=4),(r=n.getComponent(p)).string=t?Y.t("end_panel.victory"):Y.t("end_panel.failed"),l=t?new v(180,80,0,255):new v(80,80,80,255),n.getComponent(I)||n.addComponent(I),r.outlineColor=l,r.outlineWidth=4,n.active=!0),o=!1,c=!!L.I.levelCfg.is_hardlevel,this.animNode.getComponent(w).opacity=0,this.hardNode.active=!1,this.boxAdditional.active=!1,this.boxTips.active=!1,this.failNode.active=!t,this.puzzleNode.parent.active=t,"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.IsWx,this.shareNode.active=!1,t?(c=!(null==(u=_.getLevelTable(D.data.level))||!u.is_hardlevel),h=Math.min(D.data.winStreak-1,4),f=M.PUZZLE_REWARD[h],D.data.level<=11?(this.boxAdditional.active=!0,f+=20):this.boxTips.active=D.data.level<100,D.data.blockNum+=f,D.data.blockNum=Math.min(D.data.blockNum,F.isWhite?1e4:200)):this.boxTips.active=D.data.level<100,T.ins.levelEnd(t?D.data.level-1:D.data.level,t?"关卡胜利":"关卡失败",L.I.data.time,D.data.levelTimes,L.I.data.reviveCount,L.I.collectRatio,L.I.collectType==R.jewel?"宝石模式":"分数模式",L.I.data.putCount,a,L.I.data.isVideo),D.data.level<=10&&(D.data.userLayerData.reviveCount+=L.I.data.reviveCount,t&&(D.data.levelTimes>1&&(D.data.userLayer+=D.data.levelTimes-1,D.data.userLayerData.levelTimes+=D.data.levelTimes-1),L.I.data.putCount>M.winLefts[D.data.level-2]?(D.data.userLayer+=1,D.data.userLayerData.put+=1):(D.data.userLayer-=1,D.data.userLayerData.put-=1),L.I.data.time>M.winTimes[D.data.level-2]?(D.data.userLayer+=1,D.data.userLayerData.time+=1):(D.data.userLayer-=1,D.data.userLayerData.time-=1),10==D.data.level&&(D.data.userLayerData.day=D.data.login_days<=2?3:-3,D.data.login_days<=2?D.data.userLayer-=3:D.data.userLayer+=3,D.data.userLayerData.ad=D.data.ad_times<=2?3:-3,D.data.ad_times<=2?D.data.userLayer-=3:D.data.userLayer+=3,T.ins.dot("user_layer",{score:D.data.userLayer})))),this.btnNext.active=this.btnNextHard.active=this.btnReplay.active=this.btnReplayHard.active=!1,b=L.I.winStreak,m=new v,this.winStreakBg.active=b>=5,this.labWinStreak.outlineColor=v.fromHEX(m,b>=5?"#2256A5":"#9D0300"),this.labWinStreak_2.outlineColor=v.fromHEX(m,b>=5?"#2256A5":"#9D0300"),t?(this.sp.setCompleteListener((function(){U.sp.setCompleteListener(null),U.sp.setAnimation(0,"1_loop",!0),o=!0})),this.sp.setAnimation(0,"1_enter",!1),this.btnNext.active=!c,this.btnNextHard.active=c):(this.sp.setCompleteListener((function(){U.sp.setCompleteListener(null),U.sp.setAnimation(0,"2_loop",!0),o=!0})),this.sp.setAnimation(0,"2_enter",!1),this.btnReplay.active=!c,this.btnReplayHard.active=c,this.btnReplay.children[0].children[0].active=this.btnReplayHard.children[0].children[0].active=D.data.level>=10),this.labWinStreak.string=""+b,0==b?(this.labNow.string="+2",this.slideNode.setPosition(k(-220,0)),this.slideNode.getComponent(w).opacity=0):b<=5?(g=Math.min(b-1,4),y=M.PUZZLE_REWARD[g],this.labNow.string="+"+y,this.slideNode.setPosition(k(110*g-220,0)),this.slideNode.getComponent(w).opacity=255):(this.labNow.string="+10",this.slideNode.setPosition(k(220,0)),this.slideNode.getComponent(w).opacity=255),this.boxSlide.active=!0,e.next=33,H.until((function(){return o}));case 33:return o=!1,x(this.animNode.getComponent(w)).to(.2,{opacity:255}).call((function(){o=!0})).start(),this.hardNode.active=!!L.I.levelCfg.is_hardlevel,e.next=38,H.until((function(){return o}));case 38:if(!t){e.next=53;break}0==b?(this.labNow.string="+0",this.slideNode.setPosition(k(-220,0)),x(this.slideNode.getComponent(w)).to(.2,{opacity:255}).call((function(){U.labNow.string="+2",x(U.labWinStreak.node.parent.parent).to(.2,{scale:k(1.2,1.2,1.2)}).call((function(){U.labWinStreak.string="1"})).to(.1,{scale:k(1,1,1)}).call((function(){U.initPuzzle()})).start()})).start()):b<=5?(C=Math.min(D.data.winStreak-1,4),z=M.PUZZLE_REWARD[C],N=110*C-220,x(this.slideNode).to(.3,{position:k(N,0,0)}).call((function(){U.labNow.string="+"+z,x(U.labWinStreak.node.parent.parent).to(.2,{scale:k(1.2,1.2,1.2)}).call((function(){U.labWinStreak.string=""+(b+1),4==b&&(U.labWinStreak.outlineColor=v.fromHEX(m,"#2256A5"),U.labWinStreak_2.outlineColor=v.fromHEX(m,"#2256A5"),U.winStreakBg.active=!0)})).to(.1,{scale:k(1,1,1)}).call((function(){U.initPuzzle()})).start()})).start()):(this.labNow.string="+10",x(this.labWinStreak.node.parent.parent).to(.2,{scale:k(1.2,1.2,1.2)}).call((function(){U.labWinStreak.string=""+(b+1)})).to(.1,{scale:k(1,1,1)}).call((function(){U.initPuzzle()})).start()),P=_.skinsTable,W=0;case 42:if(!(W<P.length)){e.next=51;break}if(1!=P[W].type){e.next=48;break}if(P[W].target!=D.data.level-1){e.next=48;break}return D.data.addSkin(P[W].ID),G.addPanel(X.RewardPanel,{type:2,id:P[W].ID}),e.abrupt("break",51);case 48:W++,e.next=42;break;case 51:e.next=54;break;case 53:b>0?x(this.slideNode).to(.3,{position:k(-220,0,0)}).call((function(){U.labNow.string="+2",x(U.labWinStreak.node.parent.parent).to(.2,{scale:k(1.2,1.2,1.2)}).call((function(){U.labWinStreak.string="0",b>=5&&(U.labWinStreak.outlineColor=v.fromHEX(m,"#9D0300"),U.labWinStreak_2.outlineColor=v.fromHEX(m,"#9D0300"),U.winStreakBg.active=!1)})).to(.1,{scale:k(1,1,1)}).start()})).start():(this.slideNode.setPosition(k(-220,0,0)),this.slideNode.getComponent(w).opacity=255);case 54:if(this.isClick=!1,(this.btnReplay.active||this.btnReplayHard.active)&&(A="level_replay",L.I.type==S.activity&&(A="level_replay2"),T.ins.dot("video_exposure",{view_reason:A})),1==D.data.special_user&&PUCHI_SDK.IsWx&&1==PUCHI_SDK.OnlineService.getParamsInt("special_user_in",1)&&PUCHI_SDK.InterstitialAd.show(),!PUCHI_SDK.IsWx||!t){e.next=63;break}if(D.data.level!=PUCHI_SDK.OnlineService.getParamsInt("level_tuijian_end",9)){e.next=63;break}return B=wx.createPageManager(),e.next=62,B.load({openlink:"TWFRCqV5WeM2AkMXhKwJ03MhfPOieJfAsvXKUbWvQFQtLyyA5etMPabBehga950uzfZcH3Vi3QeEh41xRGEVFw"});case 62:B.show();case 63:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),r.onHome=function(){if(!this.isClick){if(this.isClick=!0,j.isActive)return console.log("[RetPanel] Review mode - going directly to home"),void this.close();var e="Yandex"===Z.getInstance().current.name,t=m.isNative,a=10;e?a=3:"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService&&(a=PUCHI_SDK.OnlineService.getParamsInt("level_interstitial",10)),console.log("[RetPanel] onHome - level: "+D.data.level+", threshold: "+a+", isNative: "+t);var n=D.data.level>=a,i=!this.isWin&&D.data.level>=10;this.close();var r=function(){B.I.emit(P.GO_HOME),i&&B.I.emit(P.CHECK_OPEN_GO)};if(n&&t){console.log("[RetPanel] onHome: Native - showing ad FIRST");var l=Z.getInstance().current;l.showInterstitialWithCallback?l.showInterstitialWithCallback(r):r()}else if(n&&e){console.log("[RetPanel] onHome: Yandex - showing ad FIRST");var o=window.ysdk;o?o.adv.showFullscreenAdv({callbacks:{onClose:function(){return r()},onError:function(){return r()}}}):r()}else r()}},r.onNext=function(){if(!this.isClick){if(this.isClick=!0,j.isActive)return console.log("[RetPanel] Review mode - going to home instead of next level"),this.close(),void B.I.emit(P.GO_HOME);var e="Yandex"===Z.getInstance().current.name,t=m.isNative,a=10;e?a=3:"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService&&(a=PUCHI_SDK.OnlineService.getParamsInt("level_interstitial",10)),console.log("[RetPanel] onNext - level: "+D.data.level+", threshold: "+a+", isNative: "+t);var n=D.data.level>=a;this.close();var i=function(){B.I.emit(P.REPLAY)};if(n&&t){console.log("[RetPanel] onNext: Native - showing ad FIRST");var r=Z.getInstance().current;r.showInterstitialWithCallback?r.showInterstitialWithCallback(i):i()}else if(n&&e){console.log("[RetPanel] onNext: Yandex - showing ad FIRST");var l=window.ysdk;l?l.adv.showFullscreenAdv({callbacks:{onClose:function(){return i()},onError:function(){return i()}}}):i()}else i()}},r.onShare=function(){PUCHI_SDK.ShareVideoService.play("share_level_win",{title:"姐妹，我通过"+(D.data.level-1)+"关了！",share_type:1})},r.onReplay=function(){var e=o(s().mark((function e(){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[RetPanel] onReplay called. isClick="+this.isClick+", level="+D.data.level),!this.isClick){e.next=4;break}return console.log("[RetPanel] onReplay blocked: isClick is true"),e.abrupt("return");case 4:if(!(D.data.level<10)){e.next=9;break}return console.log("[RetPanel] Level < 10, emitting REPLAY first, then close"),B.I.emit(P.REPLAY),this.close(),e.abrupt("return");case 9:return this.isClick=!0,t="level_replay",L.I.type==S.activity&&(t="level_replay2"),e.next=14,F.share(t);case 14:a=e.sent,this.isClick=!1,0==a.code&&(this.close(),D.data.level_ad_count++,B.I.emit(P.REPLAY,!0));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.initPuzzle=function(){var e=o(s().mark((function e(t){var a,n,i,r,l,o,c,u,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=!1),a=A.I.isMax,n=a?D.data.mapId-1:D.data.mapId,e.next=5,z.I.loadPuzzleImg(n,!0);case 5:return this.puzzleBg.spriteFrame=e.sent,e.next=8,A.I.loadMap(n);case 8:if(this.listData=e.sent,i=a?this.listData.length:D.data.mapIndex,this.listData){for(this.lastId!==n&&this.puzzles.forEach((function(e){return e.changeColor(0)})),r=0,l=0,o=0;o<this.listData.length;o++)c=this.listData[o],r=Math.max(c.x,r),l=Math.max(c.y,l);for(this.puzzleNode.setPosition((this.Col-1-l)/2*26,-(this.Row-1-r)/2*26),u=0;u<this.listData.length;u++)d=this.listData[u],u<i&&this.puzzles[d.y+d.x*this.Row].changeColor(d.blockType)}!t&&!a&&D.data.blockNum>0&&(U.show(),this.animPuzzle());case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.animPuzzle=function(){var e=o(s().mark((function e(){var t,a,n,i,r,l,c,u=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!A.I.isMax){e.next=3;break}return U.hide(),e.abrupt("return");case 3:console.log("animPuzzle",D.data.blockNum),t=D.data.mapIndex+D.data.blockNum,a=t>=this.listData.length,n=t-D.data.mapIndex<10,i=D.data.mapIndex;case 8:if(!(i<t)){e.next=19;break}if(r=this.listData[i]){e.next=12;break}return e.abrupt("break",19);case 12:return this.puzzles[r.y+r.x*this.Row].changeColor(r.blockType,!0),e.next=16,H.wait(n?50:30);case 16:i++,e.next=8;break;case 19:return e.next=21,H.wait(n?50:30);case 21:if(D.data.mapIndex=t,D.data.blockNum=0,!a){e.next=37;break}return D.data.mapId++,D.data.mapIndex=0,D.data.blockNum=t-this.listData.length,D.data.mapId>A.I.MAX_ID&&(D.data.blockNum=0),l=this.puzzleBg.node.parent,c=!1,x(l).to(1,{worldPosition:this.handBook.worldPosition,scale:k(0,0,0)}).call(o(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A.I.isMax?D.data.mapId-1:D.data.mapId,e.next=3,z.I.loadPuzzleImg(t,!0);case 3:u.puzzleBg.spriteFrame=e.sent,A.I.isMax||u.lastId===t||u.puzzles.forEach((function(e){return e.changeColor(0)})),l.setPosition(k(0,110,0)),x(l).to(.5,{scale:k(1,1,1)}).call((function(){c=!0})).start();case 7:case"end":return e.stop()}}),e)})))).start(),e.next=33,H.until((function(){return c}));case 33:U.hide(),this.initPuzzle(),e.next=38;break;case 37:U.hide();case 38:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(W)).prototype,"sp",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=t(ge.prototype,"hardNode",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=t(ge.prototype,"animNode",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=t(ge.prototype,"btnNext",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=t(ge.prototype,"btnNextHard",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=t(ge.prototype,"btnReplay",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ze=t(ge.prototype,"btnReplayHard",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=t(ge.prototype,"labNow",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=t(ge.prototype,"labWinStreak",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=t(ge.prototype,"labWinStreak_2",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=t(ge.prototype,"winStreakBg",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Re=t(ge.prototype,"slideNode",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),De=t(ge.prototype,"boxSlide",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),We=t(ge.prototype,"puzzleNode",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=t(ge.prototype,"handBook",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),He=t(ge.prototype,"puzzleBg",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=t(ge.prototype,"boxAdditional",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=t(ge.prototype,"boxTips",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=t(ge.prototype,"failNode",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ee=t(ge.prototype,"shareNode",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=ge))||me)),function(e){function t(){for(var t,a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).par=null,t._color=void 0,t}a(t,e);var n=t.prototype;return n.onLoad=function(){this.par=this.node.children[0].getComponent(g)},n.initPos=function(e,t,a,n){var i=13-26*a/2+26*t,r=26*n/2-13-26*e;this.node.setPosition(i,r)},n.changeColor=function(){var e=o(s().mark((function e(t,a){var n=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===a&&(a=!1),this._color=t,!t){e.next=9;break}return e.next=5,z.I.loadIcon(N.Game,"puzzle/block/block_"+t);case 5:this.node.getComponent(h).spriteFrame=e.sent,a&&(E.I.playEffect("block_drop"),this.par.node.active=!0,this.par.resetSystem(),H.wait(2e3).then((function(){C(n.par.node)&&(n.par.node.active=!1)}))),e.next=10;break;case 9:this.node.getComponent(h).spriteFrame=null;case 10:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),r(t,[{key:"color",get:function(){return this._color}}]),t}(y));c._RF.pop()}}}));

System.register("chunks:///_virtual/ReviewMode.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t,e){var i,n;return{setters:[function(t){i=t.createClass},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"ba744mbHc1CIY5qlErUxNHk","ReviewMode",void 0);var o=function(){function t(){this._isActive=!1,this._tapCount=0,this._tapTimer=0,this.TAP_THRESHOLD=5,this.TAP_TIMEOUT=3e3}var n=t.prototype;return n.recordTap=function(){var t=this;return this._tapTimer&&clearTimeout(this._tapTimer),this._tapCount++,console.log("[ReviewMode] Tap count: "+this._tapCount+"/"+this.TAP_THRESHOLD),this._tapTimer=setTimeout((function(){t._tapCount=0,console.log("[ReviewMode] Tap count reset due to timeout")}),this.TAP_TIMEOUT),this._tapCount>=this.TAP_THRESHOLD&&!this._isActive&&(this._tapCount=0,clearTimeout(this._tapTimer),this.activate(),!0)},n.activate=function(){this._isActive=!0,console.log("[ReviewMode] ✅ REVIEW MODE ACTIVATED!"),e.import("./GameData.ts").then((function(t){var e=t.GameData.data;e.guide=!0,e.level=30,e.collectionIds=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],e.mapId=8,e.mapIndex=100,e.goDailyTime=Date.now(),e.goActivityTime=Date.now(),console.log("[ReviewMode] All content unlocked for review"),console.log("[ReviewMode] Gallery unlocked: mapId="+e.mapId+", mapIndex="+e.mapIndex),console.log("[ReviewMode] Events unlocked: collectionIds="+e.collectionIds.length+" items")}))},n.shouldSkipSave=function(){return this._isActive},n.shouldSkipAds=function(){return this._isActive},i(t,[{key:"isActive",get:function(){return this._isActive}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}();o._instance=null;t("ReviewMode",o.instance);n._RF.pop()}}}));

System.register("chunks:///_virtual/RevivePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./BoardDataMgr.ts","./Enum.ts","./GameConst.ts","./SdkTools.ts","./TDataMgr.ts","./I18nManager.ts","./I18nImageText.ts"],(function(e){var t,n,i,a,r,o,l,s,c,v,u,p,f,d,I,y,h,b,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose,o=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e.Label,v=e._decorator,u=e.Color},function(e){p=e.default},function(e){f=e.BoardDataMgr},function(e){d=e.GameType},function(e){I=e.default},function(e){y=e.SdkTools},function(e){h=e.TDataMgr},function(e){b=e.I18n},function(e){g=e.I18nImageText}],execute:function(){var _,m,R,T,C;s._RF.push({},"5ca0479CzZGBoj28PPHbr+A","RevivePanel",void 0);var w=v,k=w.ccclass,x=w.property;e("default",(_=k("panel/RevivePanel"),m=x(c),_((C=t((T=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"labRevive",C,a(t)),t.callback=void 0,t}n(t,e);var s=t.prototype;return s.onEnable=function(){this.initI18nLabels(),this.initI18nImageTexts()},s.initI18nLabels=function(){for(var e,t=this.node.getComponentsInChildren(c),n=r(t);!(e=n()).done;){var i=e.value;if("label-001"===i.node.name){i.string=b.t("panel.revive_desc");break}}},s.initI18nImageTexts=function(){new u(50,80,150,255);var e=[{nodeName:"fuhuo_word",i18nKey:"revive_panel.title",outlineColor:new u(0,107,219,255),outlineWidth:6},{nodeName:"word_3",i18nKey:"revive_panel.revive_btn",outlineColor:new u(50,80,150,255),outlineWidth:3}];g.replaceImageTexts(this.node,e)},s.init=function(e){this.callback=e;var t=I.REVIVE_COUNT;switch(f.I.type){case d.level:case d.activity:f.I.isHardLevel&&(t=I.HARD_REVIVE_COUNT);break;case d.daily:case d.default:t=I.HARD_REVIVE_COUNT}this.labRevive.string=b.t("panel.revive_remain",t-f.I.data.reviveCount);var n="revive";f.I.type==d.level?n="revive2":f.I.type==d.activity?n="revive3":f.I.type==d.daily&&(n="revive4"),h.ins.dot("video_exposure",{view_reason:n})},s.onRevive=function(){var e=o(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="revive",f.I.type==d.level?t="revive2":f.I.type==d.activity?t="revive3":f.I.type==d.daily&&(t="revive4"),e.next=4,y.share(t);case 4:0==e.sent.code&&(this.close(),this.callback(!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.onClose=function(){this.close(),this.callback(!1)},t}(p)).prototype,"labRevive",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=T))||R));s._RF.pop()}}}));

System.register("chunks:///_virtual/RewardPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./AssetMgr.ts","./I18nManager.ts","./I18nImageText.ts"],(function(e){var t,n,i,r,a,o,s,l,u,c,p,f,h,m,b,g,d,I,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.createForOfIteratorHelperLoose,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){l=e.cclegacy,u=e.sp,c=e.Sprite,p=e.SpriteFrame,f=e.Label,h=e._decorator,m=e.Color,b=e.isValid},function(e){g=e.default},function(e){d=e.AssetMgr},function(e){I=e.I18n},function(e){y=e.I18nImageText}],execute:function(){var v,w,L,S,k,x,_,F,T,C,M;l._RF.push({},"8907euWYCBG4J7IjhpSApyn","RewardPanel",void 0);var z=h,P=z.ccclass,A=z.property;e("default",(v=P("panel/RewardPanel"),w=A(u.Skeleton),L=A(c),S=A(p),k=A(f),v((F=t((_=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"sp",F,r(t)),i(t,"imgSp",T,r(t)),i(t,"imgSF",C,r(t)),i(t,"labNum",M,r(t)),t.i18nLabelMap=new Map,t.callback=void 0,t}n(t,e);var l=t.prototype;return l.onLoad=function(){var e=this;I.on((function(){e.initI18nLabels(),e.initI18nImageTexts()}),this)},l.start=function(){this.initI18nImageTexts()},l.onEnable=function(){this.initI18nLabels(),this.initI18nImageTexts()},l.initI18nImageTexts=function(){var e=[{nodeName:"shezhi_word_5",i18nKey:"panel.collect",outlineColor:new m(80,60,40,255),outlineWidth:2}];y.replaceImageTexts(this.node,e)},l.initI18nLabels=function(){for(var e,t={"领取奖励啦~":"panel.reward_title"},n=this.node.getComponentsInChildren(f),i=a(n);!(e=i()).done;){var r=e.value,o=this.i18nLabelMap.get(r);o||(o=t[r.string])&&this.i18nLabelMap.set(r,o),o&&(r.string=I.t(o))}},l.init=function(){var e=o(s().mark((function e(t,n){var i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sp.setCompleteListener((function(){i.sp.setCompleteListener(null),i.sp.setAnimation(0,"3_loop",!0)})),this.sp.setAnimation(0,"3_enter",!1),this.callback=n,e.t0=t.type,e.next=1===e.t0?6:2===e.t0?9:12;break;case 6:return this.imgSp.spriteFrame=this.imgSF[t.type-1],this.labNum.string="+"+t.num,e.abrupt("break",12);case 9:return d.I.loadIcon("Panel","images/skin/icon_"+t.id).then((function(e){b(i.node)&&(i.imgSp.spriteFrame=e)})),this.labNum.string="",e.abrupt("break",12);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),l.onClose=function(){this.callback&&this.callback(),this.close()},t}(g)).prototype,"sp",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(_.prototype,"imgSp",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=t(_.prototype,"imgSF",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=t(_.prototype,"labNum",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=_))||x));l._RF.pop()}}}));

System.register("chunks:///_virtual/RoundBox.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env"],(function(t){var e,r,i,a,n,o,s,h,p,u,l,d,f,c,m,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.initializerDefineProperty,i=t.inheritsLoose,a=t.assertThisInitialized,n=t.createClass},function(t){o=t.cclegacy,s=t.SpriteAtlas,h=t.SpriteFrame,p=t.Enum,u=t.CCInteger,l=t._decorator,d=t.NodeEventType,f=t.isValid,c=t.UITransform,m=t.UIRenderer},function(t){y=t.DEV}],execute:function(){var _,g,b,v,D,M,F,z,x,C,S,R,w,B,T,k,O,I,E,U,N,P,A,j,L,V;o._RF.push({},"ce1a8KVCilLu7k801iOjD+F","RoundBox",void 0);var W=t("SizeMode",function(t){return t[t["CUSTOM: 自定义尺寸"]=0]="CUSTOM: 自定义尺寸",t[t["TRIMMED: 原始尺寸裁剪透明像素"]=1]="TRIMMED: 原始尺寸裁剪透明像素",t[t["RAW: 图片原始尺寸"]=2]="RAW: 图片原始尺寸",t}({})),H=[0,9,11,0,11,1,2,8,10,2,4,8,3,5,7,3,7,6],G=l,Z=G.ccclass,q=G.property,K=G.menu,X=(_=Z("Corner"),g=q({displayName:y}),b=q({displayName:y}),v=q({displayName:y}),D=q({displayName:y}),_((z=e((F=function(){r(this,"leftBottom",z,this),r(this,"rightBottom",x,this),r(this,"leftTop",C,this),r(this,"rightTop",S,this),this.visible=null}).prototype,"leftBottom",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),x=e(F.prototype,"rightBottom",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),C=e(F.prototype,"leftTop",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),S=e(F.prototype,"rightTop",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),M=F))||M);t("RoundBox",(R=K("Public/RoundBox"),w=q({type:s,readonly:!0}),B=q({type:h}),T=q({type:p(W)}),k=q({type:u,displayName:y}),O=q({displayName:y}),I=q({displayName:y}),Z(E=R((N=e((U=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return e=t.call.apply(t,[this].concat(n))||this,r(e,"atlas",N,a(e)),r(e,"_spriteFrame",P,a(e)),r(e,"_sizeMode",A,a(e)),r(e,"_segment",j,a(e)),r(e,"_radius",L,a(e)),r(e,"_corner",V,a(e)),e}i(e,t);var o=e.prototype;return o.__preload=function(){t.prototype.__preload.call(this),this._assembler={updateColor:this.updateColor.bind(this),updateRenderData:this.onFlushed.bind(this),fillBuffers:this.fillBuffer.bind(this)}},o.onLoad=function(){t.prototype.onLoad.call(this),this.updateSpriteFrame(),this.updateCorner(),this.createBuffer(),this.node.on(d.SIZE_CHANGED,this.onSizeChanged,this)},o.onDestroy=function(){t.prototype.onDestroy.call(this),this.node.off(d.SIZE_CHANGED,this.onSizeChanged,this)},o.updateCorner=function(){var t=this._corner;t.visible=[t.leftBottom,t.rightBottom,t.rightTop,t.leftTop]},o.createBuffer=function(){this.destroyRenderData();for(var t=this._renderData=this.requestRenderData(),e=0,r=0,i=this._corner.visible;r<4;i[r++]&&++e);t.dataLength=12+(this.segment-1)*e,t.resize(t.dataLength,3*(6+this.segment*e)),this._updateColor(),this.updateIData()},o.fillBuffer=function(){if(this._spriteFrame&&this._spriteFrame.texture){var t=this._renderData;if(t&&f(this.node)){var e=t.chunk;if(e){if(this.node.hasChangedFlags||t.vertDirty){for(var r=e.vb,i=t.data,a=this.node.worldMatrix,n=a.m00,o=a.m01,s=a.m04,h=a.m05,p=a.m12,u=a.m13,l=0,d=0,c=r.length,m=t.floatStride;l<c;l+=m,++d){var y=i[d].x,_=i[d].y;r[l]=n*y+s*_+p,r[l+1]=o*y+h*_+u}t.vertDirty=!1}for(var g=e.vertexOffset,b=e.meshBuffer,v=b.iData,D=e.ib,M=0,F=t.indexCount,z=b.indexOffset;M<F;v[z++]=g+D[M++]);b.indexOffset+=t.indexCount}}}},o.updateMaterial=function(){t.prototype.updateMaterial.call(this),null!=this._customMaterial||(this._customMaterial=this.getSharedMaterial(0))},o.onSizeChanged=function(){if(this._spriteFrame){var t=this.node.getComponent(c);switch(this._sizeMode){case W["TRIMMED: 原始尺寸裁剪透明像素"]:var e=this._spriteFrame._rect;if(t.width===e.width&&t.height===e.height)return;break;case W["RAW: 图片原始尺寸"]:var r=this._spriteFrame._originalSize;if(t.width===r.width&&t.height===r.height)return}this._sizeMode=W["CUSTOM: 自定义尺寸"]}},o.updateSpriteFrame=function(){this.spriteFrame?(this._renderData&&(this._renderData.textureDirty=!0),this.updateSizeMode()):this.atlas=null},o.updateSizeMode=function(){var t;if(this._spriteFrame){var e=null!=(t=this.node.getComponent(c))?t:this.node.addComponent(c);switch(this._sizeMode){case W["TRIMMED: 原始尺寸裁剪透明像素"]:e.setContentSize(this._spriteFrame._rect.size);break;case W["RAW: 图片原始尺寸"]:e.setContentSize(this._spriteFrame._originalSize)}}},o.onFlushed=function(){var t=this._spriteFrame;t&&this._renderData&&f(this.node)&&(this.updateVData(),this._renderData.updateRenderData(this,t))},o.updateVData=function(){var t,e=this._renderData;if(e&&f(this.node)){var r=e.data;if(r){var i=null==(t=this.node._uiProps)?void 0:t.uiTransformComp;if(i){var a=i.width,n=i.height,o=i.anchorX,s=i.anchorY,h=-a*o,p=-n*s,u=a*(1-o),l=n*(1-s),d=Math.min(this._radius,Math.min(a,n)/2),c=h+d,m=p+d,y=u-d,_=l-d,g=this._corner;r[0].x=c,r[0].y=g.leftBottom?m:p,r[1].x=h,r[1].y=r[0].y,r[2].x=c,r[2].y=p,r[3].x=y,r[3].y=g.rightBottom?m:p,r[4].x=y,r[4].y=p,r[5].x=u,r[5].y=r[3].y,r[6].x=y,r[6].y=g.rightTop?_:l,r[7].x=u,r[7].y=r[6].y,r[8].x=y,r[8].y=l,r[9].x=c,r[9].y=g.leftTop?_:l,r[10].x=c,r[10].y=l,r[11].x=h,r[11].y=r[9].y;for(var b=Math.PI/(this._segment<<1),v=Math.sin(b),D=Math.cos(b),M=g.visible,F=0,z=12;F<4;++F)if(M[F])for(var x=3*F,C=r[x].x,S=r[x].y,R=r[x+1].x-C,w=r[x+1].y-S,B=0,T=this._segment-1;B<T;++B)r[z].x=C+R*D-w*v,r[z].y=S+w*D+R*v,R=r[z].x-C,w=r[z].y-S,++z;for(var k=e.chunk.vb,O=3,I=k.length,E=e.floatStride,U=0;O<I;O+=E,++U)k[O]=(r[U].x-h)/a,k[O+1]=(r[U].y-p)/n;this.fitUV(k)}}}},o.fitUV=function(t){if(this.spriteFrame){var e=this.spriteFrame.uv;if(this.spriteFrame._rotated)for(var r=e[0],i=e[1],a=e[4]-r,n=e[3]-i,o=3,s=t.length,h=this._renderData.floatStride;o<s;o+=h){var p=t[o];t[o]=r+t[o+1]*a,t[o+1]=i+p*n}else{r=e[0],i=e[1],a=e[2]-r,n=e[5]-i;for(var u=3,l=t.length,d=this._renderData.floatStride;u<l;u+=d)t[u]=r+t[u]*a,t[u+1]=i+t[u+1]*n}}},o.updateColor=function(){for(var t=this._renderData,e=t.chunk.vb,r=this.color,i=r.r/255,a=r.g/255,n=r.b/255,o=r.a/255,s=5,h=e.length,p=t.floatStride;s<h;s+=p)e[s]=i,e[s+1]=a,e[s+2]=n,e[s+3]=o},o.updateIData=function(){for(var t=this._renderData.chunk._ib,e=H.length-1;e>-1;t[e]=H[e--]);for(var r=H.length,i=this._corner.visible,a=36,n=0;n<4;++n)if(i[n]){for(var o=3*n,s=o+1,h=a/3,p=0,u=this._segment-1;p<u;++p)t[r++]=o,t[r++]=s,t[r++]=h,s=h++,a+=3;t[r++]=o,t[r++]=s,t[r++]=o+2}},o._render=function(t){this._spriteFrame&&this._renderData&&t.commitComp(this,this._renderData,this._spriteFrame,this._assembler,null)},o._canRender=function(){return!(!this._spriteFrame||!this._spriteFrame.texture)&&t.prototype._canRender.call(this)},n(e,[{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){if(f(this.node)){this._spriteFrame;if(this._spriteFrame=t,!t)return this.atlas=null,void this.markForUpdateRenderData();this.updateSpriteFrame(),this.markForUpdateRenderData()}}},{key:"sizeMode",get:function(){return this._sizeMode},set:function(t){this._sizeMode=t,this.updateSizeMode()}},{key:"segment",get:function(){return this._segment},set:function(t){this._segment=Math.max(t,1),this.createBuffer(),this.markForUpdateRenderData()}},{key:"radius",get:function(){return this._radius},set:function(t){this._radius=Math.max(t,0),this.markForUpdateRenderData()}},{key:"corner",get:function(){return this._corner},set:function(t){this._corner=t,this.updateCorner(),this.createBuffer(),this.markForUpdateRenderData()}}]),e}(m)).prototype,"atlas",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(U.prototype,"_spriteFrame",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(U.prototype,"spriteFrame",[B],Object.getOwnPropertyDescriptor(U.prototype,"spriteFrame"),U.prototype),A=e(U.prototype,"_sizeMode",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return W["TRIMMED: 原始尺寸裁剪透明像素"]}}),e(U.prototype,"sizeMode",[T],Object.getOwnPropertyDescriptor(U.prototype,"sizeMode"),U.prototype),j=e(U.prototype,"_segment",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),e(U.prototype,"segment",[k],Object.getOwnPropertyDescriptor(U.prototype,"segment"),U.prototype),L=e(U.prototype,"_radius",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),e(U.prototype,"radius",[O],Object.getOwnPropertyDescriptor(U.prototype,"radius"),U.prototype),V=e(U.prototype,"_corner",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new X}}),e(U.prototype,"corner",[I],Object.getOwnPropertyDescriptor(U.prototype,"corner"),U.prototype),E=U))||E)||E));o._RF.pop()}}}));

System.register("chunks:///_virtual/SdkTools.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./MiniGameCommon.ts","./Utils.ts","./PlatformManager.ts"],(function(e){var t,r,a,n,o,i,d,s,c;return{setters:[function(e){t=e.createClass,r=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){n=e.cclegacy,o=e.sys},function(e){i=e.GameData},function(e){d=e.MiniGameCommon},function(e){s=e.Utils},function(e){c=e.PlatformManager}],execute:function(){n._RF.push({},"f5adcUyLZ1BMrC482v4WAG+","SdkTools",void 0),console.log("[Load] Loading SdkTools.ts");e("SdkTools",function(){function e(){}return e.share=function(){var e=r(a().mark((function e(t){var n,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isNative||o.os!==o.OS.ANDROID&&o.os!==o.OS.IOS){e.next=5;break}return console.log("[SdkTools] Native Share/Ad Trigger: "+t),e.next=4,c.getInstance().current.showRewardVideo(t);case 4:return e.abrupt("return",e.sent);case 5:if(!(n=c.getInstance().current)||"Telegram"!==n.name&&"Yandex"!==n.name&&"CrazyGames"!==n.name&&"GameDistribution"!==n.name){e.next=11;break}return console.log("[SdkTools] "+n.name+" Share/Ad Trigger: "+t),e.next=10,n.showRewardVideo(t);case 10:return e.abrupt("return",e.sent);case 11:if("undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.IsWx){e.next=13;break}return e.abrupt("return",Promise.resolve({code:0,msg:"ok"}));case 13:return 2!=(u=PUCHI_SDK.ShareVideoService.getShareVideoType(t))&&3!=u||(i.data.record_videokey[t+"_1"]||(i.data.record_videokey[t+"_1"]=0),i.data.record_videokey[t+"_1"]++),e.next=17,PUCHI_SDK.ShareVideoService.play(t);case 17:return 0==(l=e.sent).code&&(console.log(l),2!=u&&3!=u||(i.data.record_videokey[t+"_2"]||(i.data.record_videokey[t+"_2"]=0),i.data.record_videokey[t+"_2"]++,i.data.addAdTimes(),1==PUCHI_SDK.OnlineService.getParamsInt("req_minigame_open",1)&&s.wait(3e4).then((function(){d.dot(t).then(r(a().mark((function e(t){var r,n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("上报成功",t),e.next=3,PUCHI_SDK.GameService.wxEstimate(t.iv,t.encryptedData);case 3:r=e.sent,console.log("解密数据",r),i.data.dy2wxReport||2!=PUCHI_SDK.OnlineService.getParamsInt("dy2wxReport_oepn",2)||0==+r.code&&(o=(null==(n=r.data)?void 0:n.value)||0,i.data.dy2wxReportValue+=o,i.data.dy2wxReportAdCount++,Date.now()-i.data.regTime<=60*PUCHI_SDK.OnlineService.getParamsInt("dy2wxReport_time",12)*60*1e3&&Date.now()-i.data.regTime>60*PUCHI_SDK.OnlineService.getParamsInt("dy2wxReport_time_start",0)*60*1e3&&i.data.dy2wxReportValue/i.data.dy2wxReportAdCount>=PUCHI_SDK.OnlineService.getParamsInt("dy2wxReport_value",5)&&i.data.dy2wxReportAdCount>=PUCHI_SDK.OnlineService.getParamsInt("dy2wxReport_ad_times",3)&&(PUCHI_SDK.GameService.dy2wxReport(),i.data.dy2wxReport=!0),Date.now()-i.data.regTime>864e5&&(i.data.dy2wxReport=!0));case 6:case"end":return e.stop()}}),e)}))))})))),e.abrupt("return",l);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t(e,null,[{key:"isWhite",get:function(){if(o.platform==o.Platform.DESKTOP_BROWSER||o.platform==o.Platform.MOBILE_BROWSER)return!0;if(o.isNative)return!1;if("undefined"==typeof PUCHI_SDK)return!1;var e=PUCHI_SDK.OnlineService.getParamsString("GMWhiteId");if(""==e||null==e)return!1;var t=e.split(",");return!(!t.includes(PUCHI_SDK.DataService.openid)&&!t.includes(PUCHI_SDK.DataService.uid.toString()))}}]),e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/SettingPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts","./GameData.ts","./EventManager.ts","./Enum.ts","./AudioManager.ts","./BoardDataMgr.ts","./SdkTools.ts","./UIManager.ts","./TDataMgr.ts","./I18nManager.ts","./I18nImageText.ts"],(function(e){var t,n,i,a,o,r,l,s,c,u,d,f,v,h,g,p,b,y,I,m,P,D,_,S,H,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose,r=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e.Node,u=e.Label,d=e._decorator,f=e.Color},function(e){v=e.default},function(e){h=e.GameData},function(e){g=e.default},function(e){p=e.EventType,b=e.GameState,y=e.GameType},function(e){I=e.AudioManager},function(e){m=e.BoardDataMgr},function(e){P=e.SdkTools},function(e){D=e.default,_=e.PanelType},function(e){S=e.TDataMgr},function(e){H=e.I18n},function(e){C=e.I18nImageText}],execute:function(){var L,K,U,N,w,M,E,T,A,G,R,z,x,V,k,W,O,F,B;s._RF.push({},"837ecP5Fx9Ea7HkE6Sw390D","SettingPanel",void 0);var Y=d,j=Y.ccclass,q=Y.property;e("default",(L=j("panel/SettingPanel"),K=q(c),U=q(c),N=q(c),w=q(c),M=q(c),E=q(c),T=q(c),A=q(u),L((z=t((R=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,i(t,"closeNodes",z,a(t)),i(t,"btns",x,a(t)),i(t,"btnReplay",V,a(t)),i(t,"btnLevel",k,a(t)),i(t,"btnLevelHard",W,a(t)),i(t,"homeNodes",O,a(t)),i(t,"btnDingyue",F,a(t)),i(t,"labVer",B,a(t)),t.langNode=null,t.langLabel=null,t.i18nLabelMap=new Map,t}n(t,e);var s=t.prototype;return s.onLoad=function(){g.I.on(p.REFRESH_DINGYUE,this.refreshDingyue,this),g.I.on(p.LANGUAGE_CHANGED,this.refreshI18n,this),this.initI18nLabels()},s.start=function(){this.initI18nImageTexts()},s.initI18nImageTexts=function(){var e=new f(80,60,40,255),t=[{nodeName:"shezhi_word_1",i18nKey:"settings.title",outlineColor:e,outlineWidth:3},{nodeName:"shezhi_word_5",i18nKey:"settings.home",outlineColor:e,outlineWidth:2},{nodeName:"word_6",i18nKey:"settings.restart",outlineColor:e,outlineWidth:2},{nodeName:"shezhi_word_6",i18nKey:"settings.restart",outlineColor:e,outlineWidth:2},{nodeName:"shezhi_word_7",i18nKey:"settings.restart_hard",outlineColor:e,outlineWidth:2}];C.replaceImageTexts(this.node,t)},s.refreshI18n=function(){this.initI18nLabels(),this.initI18nImageTexts()},s.initI18nLabels=function(){for(var e,t={"音效":"settings.sound","音乐":"settings.music","震动":"settings.vibration","语言":"settings.language"},n=this.node.getComponentsInChildren(u),i=o(n);!(e=i()).done;){var a=e.value,r=this.i18nLabelMap.get(a);r||(r=t[a.string])&&this.i18nLabelMap.set(a,r),r&&(a.string=H.t(r))}},s.onLanguageSwitch=function(){D.addPanel(_.LanguagePanel)},s.init=function(e){if(void 0===e&&(e=!0),m.I.state=b.Stop,this.closeNodes[0].active=!h.data.vibrate,this.closeNodes[1].active=!h.data.music,this.closeNodes[2].active=!h.data.sound,this.btns.forEach((function(t){t.active=e})),this.refreshDingyue(),this.homeNodes.active=!e,"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.IsWx||(this.btnDingyue.active=!1,this.homeNodes&&(this.homeNodes.active=!1)),e)switch(this.btnReplay.active=!0,this.btnLevel.active=!1,this.btnLevelHard.active=!1,m.I.type){case y.level:h.data.level>=10&&(this.btnReplay.active=!1,m.I.levelCfg.is_hardlevel?(this.btnLevelHard.active=!0,this.btnLevel.active=!1):(this.btnLevel.active=!0,this.btnLevelHard.active=!1));break;case y.activity:this.btnReplay.active=!1,m.I.levelCfg.is_hardlevel?(this.btnLevelHard.active=!0,this.btnLevel.active=!1):(this.btnLevel.active=!0,this.btnLevelHard.active=!1);break;case y.daily:this.btnReplay.active=!1,this.btnLevel.active=!0,this.btnLevelHard.active=!1;break;default:h.data.today_restart>=PUCHI_SDK.OnlineService.getParamsInt("today_restart_limit",3)&&(this.btnReplay.active=!1,this.btnLevel.active=!0)}var t="1.0.0";console.log("[SettingPanel] Checking PUCHI_SDK:",typeof PUCHI_SDK),"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Platform&&(console.log("[SettingPanel] Platform name:",PUCHI_SDK.Platform.name),console.log("[SettingPanel] Has getVersion:",typeof PUCHI_SDK.Platform.getVersion)),"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Platform&&PUCHI_SDK.Platform.getVersion?(t=PUCHI_SDK.Platform.getVersion(),console.log("[SettingPanel] getVersion returned:",t)):"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.GAMEDATA&&(t=PUCHI_SDK.GAMEDATA.version,console.log("[SettingPanel] Using GAMEDATA version:",t));var n="0";if("undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.DataService&&(n=PUCHI_SDK.DataService.uid||"0"),this.labVer.string="v"+t+"_"+n,P.isWhite&&this.labVer.node.on(c.EventType.TOUCH_END,(function(){g.I.emit(p.SHOW_GM)})),this.btnLevel.active||this.btnLevelHard.active){var i="replay";m.I.type==y.level?i="replay2":m.I.type==y.activity?i="replay3":m.I.type==y.daily&&(i="replay4"),S.ins.dot("video_exposure",{view_reason:i})}},s.onHome=function(){this.close(),g.I.emit(p.GO_HOME)},s.onRepaly=function(){this.close(),g.I.emit(p.REPLAY)},s.onLevelReplay=function(){var e=r(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="replay",m.I.type==y.level?t="replay2":m.I.type==y.activity?t="replay3":m.I.type==y.daily&&(t="replay4"),e.next=4,P.share(t);case 4:0==e.sent.code&&(this.close(),g.I.emit(p.REPLAY,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.onClose=function(){m.I.state=b.Play,this.close()},s.onVibrate=function(){h.data.vibrate=!h.data.vibrate,this.closeNodes[0].active=!h.data.vibrate},s.onMusic=function(){h.data.music=!h.data.music,I.I.setMusic(h.data.music),this.closeNodes[1].active=!h.data.music},s.onSound=function(){h.data.sound=!h.data.sound,I.I.setEffect(h.data.sound),this.closeNodes[2].active=!h.data.sound},s.refreshDingyue=function(){"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.IsWx?this.btnDingyue.active=!h.data.dingyue:this.btnDingyue.active=!1},s.onDingyue=function(){D.addPanel(_.DingyuePanel)},s.onCollectGame=function(){D.addPanel(_.CollectGamePanel)},t}(v)).prototype,"closeNodes",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=t(R.prototype,"btns",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=t(R.prototype,"btnReplay",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(R.prototype,"btnLevel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(R.prototype,"btnLevelHard",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(R.prototype,"homeNodes",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(R.prototype,"btnDingyue",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(R.prototype,"labVer",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=R))||G));s._RF.pop()}}}));

System.register("chunks:///_virtual/SingularMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ObjectInstance.ts"],(function(n){var e,t,l,a,r;return{setters:[function(n){e=n.createClass},function(n){t=n.cclegacy,l=n.sys,a=n.native},function(n){r=n.default}],execute:function(){t._RF.push({},"8fb80iG8RdM4qIqLlofmaHD","SingularMgr",void 0),n("SingularMgr",function(){function n(){}var t=n.prototype;return t.isEnabled=function(){return!!l.isNative&&(l.os===l.OS.IOS||l.os===l.OS.ANDROID)},t.callAndroid=function(e,t){try{for(var l,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(l=a.reflection).callStaticMethod.apply(l,[n.ANDROID_CLASS_NAME,e,t].concat(i))}catch(n){return console.error("[SingularMgr] Android call failed: "+e,n),null}},t.callIOS=function(n,e){try{return void 0!==e?a.reflection.callStaticMethod("AppDelegate",n,e):a.reflection.callStaticMethod("AppDelegate",n)}catch(e){return console.error("[SingularMgr] iOS call failed: "+n,e),null}},t.trackLogin=function(n){this.isEnabled()?(console.log("[SingularMgr] Tracking sngLogin",n),l.os===l.OS.ANDROID?n?this.callAndroid("trackLoginWithUserId","(Ljava/lang/String;)V",n):this.callAndroid("trackLogin","()V"):l.os===l.OS.IOS&&(n?this.callIOS("trackSingularLoginWithUserId:",n):this.callIOS("trackSingularLogin")),console.log("[SingularMgr] sngLogin tracked",n)):console.log("[SingularMgr] sngLogin (disabled)",n)},t.trackTutorialComplete=function(n,e,t){this.isEnabled()?(console.log("[SingularMgr] Tracking sngTutorialComplete",n),l.os===l.OS.ANDROID?n?this.callAndroid("trackTutorialCompleteWithDetails","(Ljava/lang/String;Ljava/lang/String;I)V",n,e||"game",null!=t?t:1):this.callAndroid("trackTutorialComplete","()V"):l.os===l.OS.IOS&&this.callIOS("trackSingularTutorialComplete"),console.log("[SingularMgr] sngTutorialComplete tracked",n)):console.log("[SingularMgr] sngTutorialComplete (disabled)",n)},t.trackEvent=function(n,e){this.isEnabled()?(l.os===l.OS.ANDROID?e&&Object.keys(e).length>0?this.callAndroid("trackEventWithArgs","(Ljava/lang/String;Ljava/lang/String;)V",n,JSON.stringify(e)):this.callAndroid("trackEvent","(Ljava/lang/String;)V",n):l.os===l.OS.IOS&&this.callIOS("trackSingularEvent:",n),console.log("[SingularMgr] Event tracked: "+n,e)):console.log("[SingularMgr] Event (disabled): "+n,e)},t.setCustomUserId=function(n){this.isEnabled()?(l.os===l.OS.ANDROID?this.callAndroid("setCustomUserId","(Ljava/lang/String;)V",n):l.os===l.OS.IOS&&this.callIOS("setSingularUserId:",n),console.log("[SingularMgr] Custom user ID set: "+n)):console.log("[SingularMgr] Set user ID (disabled): "+n)},t.unsetCustomUserId=function(){this.isEnabled()?(l.os===l.OS.ANDROID&&this.callAndroid("unsetCustomUserId","()V"),console.log("[SingularMgr] Custom user ID cleared")):console.log("[SingularMgr] Unset user ID (disabled)")},t.trackRevenue=function(n,e,t){this.isEnabled()?(l.os===l.OS.ANDROID&&this.callAndroid("trackRevenue","(Ljava/lang/String;Ljava/lang/String;D)V",n,e,t),console.log("[SingularMgr] Revenue tracked: "+n+", "+e+" "+t)):console.log("[SingularMgr] Revenue (disabled): "+n+", "+e+" "+t)},t.trackAdRevenue=function(n,e,t,r,i,o){if(this.isEnabled()){if(console.log("[SingularMgr] Tracking ad revenue: "+n+", "+e+" "+t+", network: "+r+", adType: "+o),l.os===l.OS.ANDROID)this.callAndroid("trackAdRevenue","(Ljava/lang/String;Ljava/lang/String;DLjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",n,e,t,r||"",i||"",o||"");else if(l.os===l.OS.IOS)try{a.reflection.callStaticMethod("AppDelegate","trackSingularAdRevenueWithPlatform:currency:revenue:networkName:adUnitId:adType:",n,e,t,r||"",i||"",o||"")}catch(n){console.error("[SingularMgr] iOS ad revenue call failed:",n)}console.log("[SingularMgr] Ad revenue tracked: "+n+", "+e+" "+t)}else console.log("[SingularMgr] Ad Revenue (disabled): "+n+", "+e+" "+t)},t.trackAdRevenueSimple=function(n,e,t){this.trackAdRevenue(n,e,t)},t.trackLevelComplete=function(n){this.trackEvent("level_complete",{level:n})},t.trackRegistration=function(){this.trackEvent("sng_sign_up")},t.trackPurchase=function(n,e,t){this.trackRevenue("sng_purchase",e,t),this.trackEvent("sng_purchase",{product_id:n,currency:e,amount:t})},e(n,null,[{key:"I",get:function(){return r.getInstance(n)}}]),n}()).ANDROID_CLASS_NAME="com/cocos/game/SingularBridge",t._RF.pop()}}}));

System.register("chunks:///_virtual/SkinItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./ConfigManager.ts","./GameData.ts","./EventManager.ts","./Enum.ts","./UIManager.ts","./Tips.ts","./SdkTools.ts","./TDataMgr.ts","./I18nManager.ts","./I18nImageText.ts","./Const.ts"],(function(e){var t,n,a,i,r,o,s,c,l,u,d,p,b,f,v,k,m,h,g,y,_,C,I,w,S,T,L,x,N;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized,r=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e.Sprite,l=e.Label,u=e.Node,d=e._decorator,p=e.isValid,b=e.Layout,f=e.UITransform,v=e.Color,k=e.Component},function(e){m=e.AssetMgr},function(e){h=e.ConfigManager},function(e){g=e.GameData},function(e){y=e.default},function(e){_=e.EventType},function(e){C=e.default,I=e.PanelType},function(e){w=e.default},function(e){S=e.SdkTools},function(e){T=e.TDataMgr},function(e){L=e.I18n},function(e){x=e.I18nImageText},function(e){N=e.BUNDLES}],execute:function(){var M,D,z,B,P,E,O,A,H,R,U;s._RF.push({},"b425fe1iIJCu526BrA+32JS","SkinItem",void 0);var G=d,W=G.ccclass,F=G.property;e("SkinItem",(M=W("SkinItem"),D=F(c),z=F(l),B=F(l),P=F(u),M((A=t((O=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,a(t,"icon",A,i(t)),a(t,"labName",H,i(t)),a(t,"labLv",R,i(t)),a(t,"btns",U,i(t)),t.id=void 0,t}n(t,e);var s=t.prototype;return s.refresh=function(e){var t=this,n=e+1;this.id=n;var a=h.getSkinsTable(n),i={"经典":"skin.name_classic","布纹":"skin.name_cloth","花纹":"skin.name_pattern","卡通":"skin.name_cartoon","礼盒":"skin.name_gift","木纹":"skin.name_wood","纯色":"skin.name_solid","霓虹":"skin.name_neon"}[a.name];i&&L.has(i)?this.labName.string=L.t(i):this.labName.string=a.name,m.I.loadIcon("Panel","images/skin/icon_"+n).then((function(e){p(t.node)&&(t.icon.spriteFrame=e)}));var r=g.data.skins.indexOf(n)>-1;if(this.btns.forEach((function(e){e.active=!1})),this.updateBtnLabel(this.btns[0],"skin.in_use"),this.updateBtnLabel(this.btns[1],"skin.use"),r)this.btns[n==g.data.skin?0:1].active=!0;else switch(a.type){case 1:this.updateBtnLabel(this.btns[2],"skin.level_unlock",a.target),this.btns[2].active=!0,this.labLv&&(this.labLv.node.active=!1);break;case 2:case 3:case 4:T.ins.dot("video_exposure",{view_reason:"unlock_skin"}),this.updateBtnLabel(this.btns[4],"skin.video_unlock"),this.btns[4].active=!0;break;case 5:this.updateBtnLabel(this.btns[3],"skin.activity_unlock"),this.btns[3].active=!0}},s.updateBtnLabel=function(e,t){if(e){e.children.forEach((function(e){"button_word_1"!==e.name&&"Layout"!==e.name&&"word"!==e.name||(e.active=!1)}));var n=e.getComponent(b);n&&(n.enabled=!1);for(var a=e.getChildByName("_i18n_label"),i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];if("skin.video_unlock"!==t){var s=e.getChildByName("video_layout");s&&(s.active=!1),a&&(a.active=!0);var d=a?a.getComponent(l):null;if(d)d.string=L.t.apply(L,[t].concat(r));else{var k=new v(0,0,0,255),h=24;"skin.in_use"===t?(k=new v(139,69,19,255),h=28):k=t.includes("level_unlock")?new v(80,80,80,255):new v(40,60,100,255),x.addOrUpdateLabel(e,{nodeName:e.name,i18nKey:t,params:r,fontSize:h,outlineColor:k,outlineWidth:3,color:v.WHITE,keepOriginalImage:!0})}}else{a&&(a.active=!1);var g=e.getChildByName("video_layout");if(!g){(g=new u("video_layout")).parent=e,g.setPosition(0,0,0);var y=g.addComponent(b);y.type=b.Type.HORIZONTAL,y.resizeMode=b.ResizeMode.CONTAINER,y.spacingX=5;var _=new u("icon");_.parent=g;var C=_.addComponent(c);C.sizeMode=c.SizeMode.CUSTOM;var I=_.addComponent(f);I.setContentSize(34,30);var w=new u("label");w.parent=g;var S=w.addComponent(l);S.fontSize=24,S.lineHeight=26,S.color=v.WHITE,S.enableOutline=!0,S.outlineColor=new v(40,60,100,255),S.outlineWidth=3,m.I.loadIcon(N.Common,"icon_shipin_1").then((function(e){if(p(_)&&e){var t=_.getComponent(c);t&&(t.spriteFrame=e)}}))}g.active=!0;var T=g.getChildByName("label").getComponent(l);T.string=L.t.apply(L,[t].concat(r))}}},s.onClick=function(){var e=r(o().mark((function e(t,n){var a,i,s=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=h.getSkinsTable(this.id),i=function(){g.data.addSkin(s.id),C.addPanel(I.RewardPanel,{type:2,id:s.id}),s.refresh(s.id-1)},e.t0=+n,e.next=1===e.t0?5:2===e.t0?6:3===e.t0?9:4===e.t0?11:5===e.t0?20:25;break;case 5:return e.abrupt("break",25);case 6:return g.data.skin=this.id,y.I.emit(_.CHANGE_SKIN),e.abrupt("break",25);case 9:return g.data.level>a.target&&i(),e.abrupt("break",25);case 11:e.t1=a.type,e.next=2===e.t1?14:4===e.t1?16:5===e.t1?18:19;break;case 14:return PUCHI_SDK.IsWx?wx.getGameClubData({dataTypeList:[{type:1}],success:function(){var e=r(o().mark((function e(t){var n,a,r,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,PUCHI_SDK.GameService.wxDecryption(t.iv,t.encryptedData);case 3:if(n=e.sent,console.log("解密数据",n),n.code){e.next=20;break}a=JSON.parse(n.data),r=a.dataList,s=!1,c=0;case 10:if(!(c<r.length)){e.next=19;break}if(1!=r[c].dataType.type){e.next=16;break}if(!(r[c].value>0)){e.next=16;break}return i(),s=!0,e.abrupt("break",19);case 16:c++,e.next=10;break;case 19:s||w.show(L.t("tips.join_circle"));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fail:function(e){console.error(e)}}):i(),e.abrupt("break",19);case 16:return g.data.dingyue?i():C.addPanel(I.DingyuePanel),e.abrupt("break",19);case 18:return e.abrupt("break",19);case 19:return e.abrupt("break",25);case 20:return e.next=22,S.share("unlock_skin");case 22:return 0==e.sent.code&&i(),e.abrupt("break",25);case 25:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t}(k)).prototype,"icon",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(O.prototype,"labName",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(O.prototype,"labLv",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(O.prototype,"btns",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=O))||E));s._RF.pop()}}}));

System.register("chunks:///_virtual/SkinPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ListView.ts","./ListViewAdapter.ts","./ConfigManager.ts","./SkinItem.ts","./EventManager.ts","./Enum.ts","./I18nManager.ts","./I18nImageText.ts"],(function(n){var t,e,i,o,a,r,s,l,u,c,f,h,p,d,g,m,y,L,k;return{setters:[function(n){t=n.applyDecoratedDescriptor,e=n.inheritsLoose,i=n.initializerDefineProperty,o=n.assertThisInitialized,a=n.createForOfIteratorHelperLoose,r=n.asyncToGenerator,s=n.regeneratorRuntime},function(n){l=n.cclegacy,u=n._decorator,c=n.Label,f=n.Color},function(n){h=n.default},function(n){p=n.default},function(n){d=n.ConfigManager},function(n){g=n.SkinItem},function(n){m=n.default},function(n){y=n.EventType},function(n){L=n.I18n},function(n){k=n.I18nImageText}],execute:function(){var v,w,I,b,C;l._RF.push({},"457b2cHMnFG4ZwlpKKZyqQY","SkinPanel",void 0);var S=u,M=S.ccclass,_=S.property;n("default",(v=M("panel/SkinPanel"),w=_(h),v((C=t((b=function(n){function t(){for(var t,e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return t=n.call.apply(n,[this].concat(a))||this,i(t,"mainList",C,o(t)),t.dataSet=[],t.i18nLabelMap=new Map,t}e(t,n);var l=t.prototype;return l.onLoad=function(){var n=this;m.I.on(y.CHANGE_SKIN,this.onChangeSkin,this),L.on((function(){console.log("[SkinPanel] Language changed, refreshing view..."),n.initI18nLabels(),n.init()}),this)},l.onEnable=function(){this.initI18nLabels(),this.mainList&&this.dataSet.length>0&&this.mainList.notifyUpdate()},l.initI18nLabels=function(){for(var n,t={"暂时没有解锁的活动插画喔！":"panel.no_unlock_art"},e=this.node.getComponentsInChildren(c),i=a(e);!(n=i()).done;){var o=n.value;if(this.i18nLabelMap.has(o))o.string=L.t(this.i18nLabelMap.get(o));else{var r=t[o.string];r&&(this.i18nLabelMap.set(o,r),o.string=L.t(r))}}},l.onChangeSkin=function(){this.init()},l.init=function(){var n=r(s().mark((function n(){var t,e;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=d.skinsTable.length,this.dataSet=new Array(t).fill(0),this.mainList.setAdapter(this),e=[{nodeName:"title_word",i18nKey:"skin.title",outlineColor:new f(12,114,151,255),outlineWidth:3},{nodeName:"title",i18nKey:"skin.title",outlineColor:new f(12,114,151,255),outlineWidth:3},{nodeName:"biaoti",i18nKey:"skin.title",outlineColor:new f(12,114,151,255),outlineWidth:3},{nodeName:"common_title_skin",i18nKey:"skin.title",outlineColor:new f(12,114,151,255),outlineWidth:3},{nodeName:"word",i18nKey:"skin.title",outlineColor:new f(12,114,151,255),outlineWidth:3}],this.node&&k.replaceImageTexts(this.node,e);case 5:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),l.updateView=function(n,t,e){n.getComponent(g).refresh(t)},l.onClose=function(){this.close()},t}(p)).prototype,"mainList",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=b))||I));l._RF.pop()}}}));

System.register("chunks:///_virtual/TabItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,r,o,a,s,c,l,u,p,f,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){s=t.cclegacy,c=t.Sprite,l=t.SpriteFrame,u=t._decorator,p=t.v3,f=t.tween,h=t.Component}],execute:function(){var b,d,m,y,v,S,g,w,T;s._RF.push({},"ab32a3j0UBN64idd/XB5aA1","TabItem",void 0);var _=u,z=_.ccclass,F=_.property;t("TabItem",(b=z("game/TabItem"),d=F(c),m=F(c),y=F(l),b((g=e((S=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,n(e,"icon",g,r(e)),n(e,"lab",w,r(e)),n(e,"iconSf",T,r(e)),e.isSelected=!1,e}i(e,t);var s=e.prototype;return s.onEnable=function(){var t=o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),s.refresh=function(t,e){var i=this.isSelected;this.icon.spriteFrame=t?this.iconSf[1]:this.iconSf[0],this.lab.node.getChildByName("_i18n_label")||(this.lab.spriteFrame=t?this.iconSf[3]:this.iconSf[2]);var n=p(0,20,0),r=p(0,36,0),o=p(0,-38,0),a=p(0,-32,0);e?t?(f(this.icon.node).to(.2,{position:r}).start(),f(this.lab.node).to(.2,{position:a}).start()):i&&(f(this.icon.node).to(.2,{position:n}).start(),f(this.lab.node).to(.2,{position:o}).start()):(this.icon.node.setPosition(t?r:n),this.lab.node.setPosition(t?a:o)),this.isSelected=t},e}(h)).prototype,"icon",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(S.prototype,"lab",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(S.prototype,"iconSf",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=S))||v));s._RF.pop()}}}));

System.register("chunks:///_virtual/TargetPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Enum.ts","./Panel.ts","./Utils.ts","./BoardDataMgr.ts","./CompCollectJewels.ts","./EventManager.ts","./MaskView.ts","./AudioManager.ts","./I18nManager.ts"],(function(e){var t,n,o,i,a,r,l,c,s,u,d,f,g,h,p,v,m,y,M,w,b,C,I,T,x,_;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e.Label,s=e.Node,u=e._decorator,d=e.find,f=e.Widget,g=e.UITransform,h=e.view,p=e.tween,v=e.UIOpacity},function(e){m=e.EventType,y=e.CollectType},function(e){M=e.default},function(e){w=e.Utils},function(e){b=e.BoardDataMgr},function(e){C=e.CompCollectJewels},function(e){I=e.default},function(e){T=e.MaskView},function(e){x=e.AudioManager},function(e){_=e.I18n}],execute:function(){var z,P,k,B,N,E,A,S,D;l._RF.push({},"65c94e70s5Os4BKOE/QZgU7","TargetPanel",void 0);var O=u,R=O.ccclass,U=O.property;e("default",(z=R("panel/TargetPanel"),P=U(C),k=U(c),B=U(s),z((A=t((E=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return t=e.call.apply(e,[this].concat(a))||this,o(t,"collectModel",A,i(t)),o(t,"collectScore",S,i(t)),o(t,"scoreModel",D,i(t)),t}n(t,e);var l=t.prototype;return l.onLoad=function(){},l.onEnable=function(){this.adaptBgNode("content/zhandou_qian_bg")},l.adaptBgNode=function(e){var t=this.node.getChildByName(e);if(t||(t=d(e,this.node)),t){var n=t.getComponent(f);n&&(n.enabled=!1);var o=t.getComponent(g);if(o){var i=h.getVisibleSize(),a=o.width,r=o.height;if(e.includes("zhandou_qian_bg"))o.setContentSize(i.width,r),console.log("[TargetPanel] "+e+" width adapted: "+a+" -> "+i.width);else{var l=i.width/a,c=i.height/r,s=Math.max(l,c),u=a*s,p=r*s;o.setContentSize(u,p),console.log("[TargetPanel] "+e+" adapted: "+a+"x"+r+" -> "+u.toFixed(0)+"x"+p.toFixed(0))}}}},l.init=function(){var e=a(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.show(),this.content.getComponent(v).opacity=255,b.I.collectType==y.score?(this.collectModel.node.active=!1,this.scoreModel.active=!0,this.collectScore.string=b.I.levelCfg.score+""):(this.collectModel.node.active=!0,this.scoreModel.active=!1,this.collectModel.refresh(b.I.levelCfg.getCollect(),!0)),e.next=5,w.wait(1e3);case 5:if(x.I.playEffect("target_show"),b.I.collectType!=y.score){e.next=11;break}this.scoreModel.active=!1,I.I.emit(m.TARGET_ANIM,this.scoreModel.worldPosition),e.next=22;break;case 11:t=b.I.levelCfg.getCollect(),n=0;case 13:if(!(n<t.length)){e.next=22;break}if(I.I.emit(m.TARGET_ANIM,this.collectModel.getItem(t[n].id).node.worldPosition,t[n].id),this.collectModel.getItem(t[n].id).hide(),!(n<t.length-1)){e.next=19;break}return e.next=19,w.wait(50);case 19:n++,e.next=13;break;case 22:return this.fadeOut(),e.next=25,w.wait(200);case 25:T.hide(),this.close();case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.start=function(){var e,t=null==(e=this.content.getChildByName("Node"))?void 0:e.getChildByName("label"),n=function(){if(t&&t.isValid){var e=t.getComponent(c);e&&(e.string=_.t("home.current_target"))}};n(),_.on((function(){n()}),this)},l.fadeOut=function(){p(this.content.getComponent(v)).to(.1,{opacity:0}).start(),p(this.bg.getComponent(v)).to(.1,{opacity:50}).start()},t}(M)).prototype,"collectModel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(E.prototype,"collectScore",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(E.prototype,"scoreModel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=E))||N));l._RF.pop()}}}));

System.register("chunks:///_virtual/TDataMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FirebaseManager.ts","./GameData.ts"],(function(e,t){var a,i,n,r,s,l,o,c;return{setters:[function(e){a=e.createClass,i=e.extends,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e.sys},function(e){o=e.FirebaseManager},function(e){c=e.GameData}],execute:function(){s._RF.push({},"a4249moZfdDm5vxvYZASaoY","TDataMgr",void 0),e("TDataMgr",function(){function e(e,t){this._userDataFlag=!1,console.log("[TDataMgr] Internal analytics (TDataMgr/TDAnalytics) are globally DISABLED."),window.TDAnalytics={init:function(){},login:function(){},timeEvent:function(){},track:function(){},userSet:function(){},setDynamicSuperProperties:function(){}}}var i=e.prototype;return i.isParamsInvalid=function(){return!0},i.login=function(){this.isParamsInvalid()||(TDAnalytics.login(PUCHI_SDK.DataService.uid.toString()),this._updateSuperProperties())},i.onPageShow=function(){this.isParamsInvalid()||TDAnalytics.timeEvent({eventName:"ta_page_hide"})},i.onPageHide=function(){this.isParamsInvalid()||(e.ins.updateUserData(),TDAnalytics.track({eventName:"ta_page_hide"}))},i.loading=function(e){this.isParamsInvalid()||TDAnalytics.track({eventName:"loading_funnel",properties:{state:u[e]}})},i.levelStart=function(e,t,a,i,n){_.track("start_level",{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}),this.isParamsInvalid()?o.instance.logEvent("start_level",{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}):TDAnalytics.track({eventName:"start_level",properties:{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}})},i.levelEnd=function(e,t,a,i,n,r,s,l,c,u){if(_.track("level_end",{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,level_ad_count:c,start_way:u?"广告开局":"免费开始"}),this.isParamsInvalid())return o.instance.logEvent("level_end",{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,level_ad_count:c,start_way:u?"广告开局":"免费开始"}),void(1===e&&1===i&&"胜利通关"===t&&this.trackSingularTutorialComplete());TDAnalytics.track({eventName:"level_end",properties:{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,level_ad_count:c,start_way:u?"广告开局":"免费开始"}})},i.actLevelStart=function(e,t,a,i,n){_.track("activity_start_level",{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}),this.isParamsInvalid()?o.instance.logEvent("activity_start_level",{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}):TDAnalytics.track({eventName:"activity_start_level",properties:{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}})},i.actLevelEnd=function(e,t,a,i,n,r,s,l,c){_.track("activity_level_end",{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,start_way:c?"广告开局":"免费开始"}),this.isParamsInvalid()?o.instance.logEvent("activity_level_end",{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,start_way:c?"广告开局":"免费开始"}):TDAnalytics.track({eventName:"activity_level_end",properties:{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,start_way:c?"广告开局":"免费开始"}})},i.dailyLevelStart=function(e,t,a,i,n){_.track("daily_start_level",{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}),this.isParamsInvalid()?o.instance.logEvent("daily_start_level",{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}):TDAnalytics.track({eventName:"daily_start_level",properties:{level_id:e,start_times:t,collectType:a,start_way:i?"广告开局":"免费开始",startType:n}})},i.dailyLevelEnd=function(e,t,a,i,n,r,s,l,c){_.track("daily_level_end",{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,start_way:c?"广告开局":"免费开始"}),this.isParamsInvalid()?o.instance.logEvent("daily_level_end",{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,start_way:c?"广告开局":"免费开始"}):TDAnalytics.track({eventName:"daily_level_end",properties:{level_id:e,result:t,duration:a,is_first_win:i,relive:n,ratio:r,game_model:s,put_count:l,start_way:c?"广告开局":"免费开始"}})},i.fallLevelStart=function(e){_.track("fall_start",{start_way:e}),this.isParamsInvalid()?o.instance.logEvent("fall_start",{start_way:e}):TDAnalytics.track({eventName:"fall_start",properties:{start_way:e}})},i.fallLevelEnd=function(e,t,a,i,n,r,s,l){_.track("fall_end",{duration:e,result:t,best_score:a,this_score:i,is_next:n,is_change:r,is_Eliminate:s,retry_times:l}),this.isParamsInvalid()?o.instance.logEvent("fall_end",{duration:e,result:t,best_score:a,this_score:i,is_next:n,is_change:r,is_Eliminate:s,retry_times:l}):TDAnalytics.track({eventName:"fall_end",properties:{duration:e,result:t,best_score:a,this_score:i,is_next:n,is_change:r,is_Eliminate:s,retry_times:l}})},i.adStart=function(e,t){this.isParamsInvalid()||TDAnalytics.track({eventName:"ad_start",properties:{view_reason:e,ad_type:t}})},i.adEnd=function(e,t,a,i,n){_.track("ad_end",{duration:e,view_reason:t,is_complete:a,view_result:d[i],ad_type:0===n?"Rewarded":"Interstitial"}),this.isParamsInvalid()||TDAnalytics.track({eventName:"ad_end",properties:{duration:e,view_reason:t,is_complete:a,view_result:i,ad_type:n}})},i.shareStart=function(e){_.track("share_panel_imp",{share_reason:e}),this.isParamsInvalid()||TDAnalytics.track({eventName:"share_panel_imp",properties:{share_reason:e}})},i.shareEnd=function(e,t,a){_.track("share_end",{share_reason:e,channel:t,state:a}),this.isParamsInvalid()||TDAnalytics.track({eventName:"share_end",properties:{share_reason:e,channel:t,state:a}})},i.dot=function(e,t){_.track(e,t),this.isParamsInvalid()||TDAnalytics.track({eventName:e,properties:t})},i._updateSuperProperties=function(){this.isParamsInvalid()||TDAnalytics.setDynamicSuperProperties((function(){return{"#device_model":PUCHI_SDK.Platform.getSystemInfoSync().model,game_version:PUCHI_SDK.GAMEDATA.version,level:c.data.level,mapId:c.data.mapId,maxScore:c.data.maxScore,channelId:PUCHI_SDK.DataService.channelId+"",queryChannelId:PUCHI_SDK.DataService.queryChannelId+"",userLayer:c.data.layer,onlineTime:c.data.onlineTime,ad_times:c.data.ad_times,special_user:c.data.special_user,plan_id:c.data.plan_id}}))},i.updateUserData=function(){var e=this;this.isParamsInvalid()||1!=this._userDataFlag&&(this._userDataFlag=!0,setTimeout((function(){e._userDataFlag=!1,TDAnalytics.userSet({properties:{level:c.data.level,maxScore:c.data.maxScore,first_login_time:PUCHI_SDK.DataService.regDate,login_days:c.data.login_days,channelId:PUCHI_SDK.DataService.channelId+"",userLayer:c.data.layer,skin:c.data.skin,daily_badge_count:c.data.daily_badge_count,dayduration:c.data.onlineTime,ad_times:c.data.ad_times,special_user:c.data.special_user,plan_id:c.data.plan_id}})})))},i.trackSingularTutorialComplete=function(){t.import("cc").then((function(e){var a=e.sys;a.os!==a.OS.IOS?t.import("./ChannelMgr.ts").then((function(e){var a=e.ChannelMgr.getChannelId();"google"===a?t.import("./SingularMgr.ts").then((function(e){var t=e.SingularMgr;console.log("[TDataMgr] Tracking Singular sngTutorialComplete for Google channel"),t.I.trackTutorialComplete("level_1","game",1)})).catch((function(e){return console.error("[TDataMgr] Failed to import SingularMgr:",e)})):console.log("[TDataMgr] Skip Singular tutorial complete for channel: "+a)})).catch((function(e){return console.error("[TDataMgr] Failed to import ChannelMgr:",e)})):t.import("./SingularMgr.ts").then((function(e){var t=e.SingularMgr;console.log("[TDataMgr] Tracking Singular sngTutorialComplete for iOS"),t.I.trackTutorialComplete("level_1","game",1)})).catch((function(e){return console.error("[TDataMgr] Failed to import SingularMgr:",e)}))}))},a(e,null,[{key:"ins",get:function(){return null==this._ins&&(l.isNative?this._ins=new e("mock_id","mock_url"):(this._ins=new e("2c98c257ff184a91852d530f8721657e","https://analysis.d3games.com"),"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.DataService&&PUCHI_SDK.DataService.regDate&&console.log("注册时间:",PUCHI_SDK.DataService.regDate.toLocaleString()))),this._ins}}]),e}())._ins=null;var _=function(){function e(){}return e.track=function(e,t){void 0===t&&(t={}),this.legacyFetch(e,t)},e.legacyFetch=function(e,t){var a=i({event_name:e},t),s=0,l=!1;if(window.Telegram&&window.Telegram.WebApp){var o,c=null==(o=window.Telegram.WebApp.initDataUnsafe)?void 0:o.user;c&&c.id&&(s=c.id,l=!0)}if(l){s||(s=123456);var _="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),u=window.Telegram&&window.Telegram.WebApp&&window.Telegram.WebApp.platform||"unknown_web",d={event_name:"custom-event",user_id:s,session_id:_,app_name:this.APP_NAME,client_timestamp:(new Date).toISOString(),custom_data:a,platform:u};fetch(this.API_URL,{method:"POST",headers:{"Content-Type":"application/json","TGA-Auth-Token":this.TOKEN},body:JSON.stringify(d)}).then(n(r().mark((function e(t){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=7;break}return e.next=3,t.text();case 3:a=e.sent,console.error("[TelegramDirect] Failed:",t.status,a),e.next=7;break;case 7:case"end":return e.stop()}}),e)})))).catch((function(e){return console.error("[TelegramDirect] Error:",e)}))}},e}();_.API_URL="https://tganalytics.xyz/events",_.TOKEN="eyJhcHBfbmFtZSI6ImJsb2NrX2NhbnZhcyIsImFwcF91cmwiOiJodHRwczovL3QubWUvYmxvY2tjYW52YXNib3QiLCJhcHBfZG9tYWluIjoiaHR0cHM6Ly9ibG9ja2NhbnZhcy5wYWdlcy5kZXYvIn0=!i/6mHJCX4nKfATHdd1XrbQAslMAvEXi6xg5gEqckiY8=",_.APP_NAME="block_canvas";var u=e("TDLoadingState",function(e){return e[e["开始加载"]=0]="开始加载",e[e["加载完成"]=1]="加载完成",e}({})),d=(e("TDEnergyEarnMethod",function(e){return e[e["广告回满"]=0]="广告回满",e[e["邮件补发"]=1]="邮件补发",e}({})),e("TDPropSpendMethod",function(e){return e[e["主线关卡消耗"]=0]="主线关卡消耗",e[e["每日挑战消耗"]=1]="每日挑战消耗",e[e["活动消耗"]=2]="活动消耗",e}({})),e("TDPropType",function(e){return e[e["洗牌"]=0]="洗牌",e[e["提示"]=1]="提示",e}({})),e("TDFirstFailAct",function(e){return e[e["点击洗牌"]=0]="点击洗牌",e[e["点击认输"]=1]="点击认输",e[e["点击关闭"]=2]="点击关闭",e}({})),e("TDLevelResult",function(e){return e[e["首次死局放弃"]=0]="首次死局放弃",e[e["失败"]=1]="失败",e[e["主动认输"]=2]="主动认输",e[e["胜利通关"]=3]="胜利通关",e[e.GM=4]="GM",e[e["主页退出"]=5]="主页退出",e[e["第二次死局放弃"]=6]="第二次死局放弃",e}({})),e("TDADViewResult",function(e){return e[e["看完广告"]=0]="看完广告",e[e["中途跳过"]=1]="中途跳过",e[e["广告加载失败"]=2]="广告加载失败",e}({})));e("TDADType",function(e){return e[e["激励视频"]=0]="激励视频",e}({}));s._RF.pop()}}}));

System.register("chunks:///_virtual/TelegramPlatform.ts",["cc"],(function(e){var o,n;return{setters:[function(e){o=e.cclegacy,n=e.sys}],execute:function(){o._RF.push({},"6efbc8jvelKZ5VsYPRGz8TH","TelegramPlatform",void 0);e("TelegramPlatform",function(){function e(){this.name="Telegram",this._webApp=null,window.Telegram&&window.Telegram.WebApp&&(this._webApp=window.Telegram.WebApp)}var o=e.prototype;return o.init=function(){if(console.log("TelegramPlatform init"),window.PUCHI_SDK&&(window.PUCHI_SDK.Platform=this,console.log("[Telegram] PUCHI_SDK.Platform assigned")),!document.getElementById("adsgram-script")){var e=document.createElement("script");e.src="https://sad.adsgram.ai/js/sad.min.js",e.id="adsgram-script",e.async=!0,e.onload=function(){return console.log("[Telegram] AdsGram SDK loaded")},e.onerror=function(e){return console.error("[Telegram] AdsGram SDK load failed",e)},document.head.appendChild(e)}if(this._webApp){var o;this._webApp.ready();try{this._webApp.expand()}catch(e){console.warn("[Telegram] Expand failed:",e)}this._webApp.setHeaderColor&&this._webApp.setHeaderColor("#283C5A"),console.log("Telegram WebApp version:",this._webApp.version),console.log("Telegram User:",null==(o=this._webApp.initDataUnsafe)?void 0:o.user)}},o.login=function(){var e=this;return new Promise((function(o){if(e._webApp&&e._webApp.initDataUnsafe&&e._webApp.initDataUnsafe.user){var a=e._webApp.initDataUnsafe.user;console.log("[Telegram] Login success:",a),o({code:0,userInfo:{userId:a.id,nickName:a.first_name+(a.last_name?" "+a.last_name:""),avatarUrl:a.photo_url||""}})}else console.warn("Telegram WebApp not ready or no user data"),n.platform===n.Platform.MOBILE_BROWSER||(n.platform,n.Platform.DESKTOP_BROWSER),o({code:1,msg:"Login failed"})}))},o.getUserInfo=function(){var e;return Promise.resolve((null==(e=this._webApp)||null==(e=e.initDataUnsafe)?void 0:e.user)||{})},o.vibrateShort=function(e){void 0===e&&(e="medium"),this._webApp&&this._webApp.HapticFeedback&&this._webApp.HapticFeedback.impactOccurred(e)},o.vibrateLong=function(){this._webApp&&this._webApp.HapticFeedback&&this._webApp.HapticFeedback.notificationOccurred("success")},o.showBanner=function(){console.log("[Telegram] showBanner (Not implemented yet)")},o.hideBanner=function(){console.log("[Telegram] hideBanner")},o.showInterstitial=function(){console.log("[Telegram] showInterstitial (Not implemented yet)")},o.showRewardVideo=function(e){return new Promise((function(e){var o=window.Adsgram;if(!o)return console.warn("[Telegram] AdsGram SDK not loaded yet."),void e({code:1,msg:"Ads SDK not ready"});o.init({blockId:"19649"}).show().then((function(o){console.log("[Telegram] Ad result:",o),o&&o.done?e({code:0,msg:"Success"}):e({code:1,msg:(null==o?void 0:o.description)||"Skipped or Failed"})})).catch((function(o){console.error("[Telegram] Ad error:",o),e({code:1,msg:(null==o?void 0:o.description)||"Error"})}))}))},o.uploadRankData=function(e,o,n){console.log("[Telegram] uploadRankData "+e+": "+o)},o.postMessage=function(e,o){console.log("[Telegram] postMessage "+e,o)},o.trackEvent=function(e,o){console.log("[Telegram] trackEvent "+e,o)},o.getSafeAreaTop=function(){return 0},o.getVersion=function(){var e;return(null==(e=this._webApp)?void 0:e.version)||"1.0.0"},o.saveData=function(e,o){var n=this;return new Promise((function(a,r){n._webApp&&n._webApp.CloudStorage?n._webApp.CloudStorage.setItem(e,o,(function(o,n){o?(console.error("[Telegram] CloudStorage save failed:",o),r(o)):n?(console.log("[Telegram] CloudStorage save success for key:",e),a()):(console.warn("[Telegram] CloudStorage save returned false"),a())})):(console.warn("[Telegram] CloudStorage not available, skipping save"),a())}))},o.loadData=function(e){var o=this;return new Promise((function(n,a){o._webApp&&o._webApp.CloudStorage?o._webApp.CloudStorage.getItem(e,(function(o,a){o?(console.error("[Telegram] CloudStorage load failed:",o),n(null)):(console.log("[Telegram] CloudStorage load success for key:",e),n(a))})):(console.warn("[Telegram] CloudStorage not available, returning null"),n(null))}))},o.getLanguage=function(){var e;return(null==(e=this._webApp)||null==(e=e.initDataUnsafe)||null==(e=e.user)?void 0:e.language_code)||""},e}());o._RF.pop()}}}));

System.register("chunks:///_virtual/TestPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Panel.ts"],(function(t){var e,n,r,i,a,c,l,o;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,c=t.Label,l=t._decorator},function(t){o=t.default}],execute:function(){var s,u,p,f,h;a._RF.push({},"e6b7atWStlEsq6Q87cA3h+r","TestPanel",void 0);var y=l,d=y.ccclass,b=y.property;t("default",(s=d("panel/TestPanel"),u=b(c),s((h=e((f=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return e=t.call.apply(t,[this].concat(a))||this,r(e,"txtDesc",h,i(e)),e.callback=void 0,e}return n(e,t),e.prototype.init=function(t){this.txtDesc.string="我是测试面板"},e}(o)).prototype,"txtDesc",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=f))||p));a._RF.pop()}}}));

System.register("chunks:///_virtual/Tips.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetMgr.ts","./I18nManager.ts"],(function(t){var e,n,r,i,o,a,s,p,c,l,u,f,h,y,b,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){s=t.cclegacy,p=t.Label,c=t._decorator,l=t.UIOpacity,u=t.tween,f=t.Component,h=t.find,y=t.instantiate},function(t){b=t.AssetMgr},function(t){g=t.I18n}],execute:function(){var d,v,L,m,w,_,P,T;s._RF.push({},"ae3f0LY5m1Lfr7/rGR09Kky","Tips",void 0);var k=c,x=k.ccclass,C=k.property;t("default",(d=x("panel/Tips"),v=C(p),L=C(p),d(((T=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,r(e,"tipLab",_,i(e)),r(e,"tipLab2",P,i(e)),e}return n(e,t),e.prototype.show=function(t,n){var r=this,i=g.t(t);i!==t||g.has(t)||(i=t),this.tipLab.string=this.tipLab2.string=i,this.node.getComponent(l).opacity=0,u(this.node.getComponent(l)).to(.3,{opacity:255}).delay(.8).to(.3,{opacity:0}).call((function(){r.node.setParent(null),e._pool.push(r),n&&n()})).start()},e.show=function(){var t=o(a().mark((function t(n,r){var i,o,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===r&&(r=null),i=null,!this._pool.length){t.next=6;break}i=this._pool.pop(),t.next=11;break;case 6:return t.next=8,b.I.loadPrefabAsync("Panel","Tips");case 8:o=t.sent,s=y(o),i=s.getComponent(e);case 11:i.show(n,r),i.node.setParent(h("Canvas"));case 13:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),e}(f))._pool=[],_=e((w=T).prototype,"tipLab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(w.prototype,"tipLab2",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=w))||m));s._RF.pop()}}}));

System.register("chunks:///_virtual/TopOnMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./EventManager.ts"],(function(i){var t,e,n,o,s,a;return{setters:[function(i){t=i.createClass},function(i){e=i.cclegacy,n=i.native,o=i.sys},function(i){s=i.GameData},function(i){a=i.default}],execute:function(){e._RF.push({},"e2304dReAFEqpiRj0NajEjO","TopOnMgr",void 0);var r=i("TopOnMgr",function(){function i(){this.className="com/cocos/game/TopOnBridge",this.isAndroid=!1,this.isIOS=!1,this._sdkInitialized=!1,this._pendingBannerShow=!1}var e=i.prototype;return e.init=function(){var t=this;(this.isAndroid||this.isIOS)&&(console.log("[TopOnMgr] Registering native event listeners..."),n.jsbBridgeWrapper.addNativeEventListener(i.Event.AD_LOADED,(function(e){console.log("[TopOnMgr] AD Loaded Generic: "+e),e===t.REWARD_ID?(console.log("[TopOnMgr] -> Classified as REWARD_LOADED"),a.I.emit(i.Event.REWARD_LOADED,e)):e===t.INTERSTITIAL_ID?(console.log("[TopOnMgr] -> Classified as INTERSTITIAL_LOADED"),a.I.emit(i.Event.INTERSTITIAL_LOADED,e)):e===t.BANNER_ID?console.log("[TopOnMgr] -> Classified as BANNER_LOADED"):console.warn("[TopOnMgr] Unknown Placement ID Loaded: "+e)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.AD_FAILED,(function(e){var n=e.split("|"),o=n[0],s=n.length>1?n.slice(1).join("|"):"Unknown Error";console.error("[TopOnMgr] AD Failed Generic: "+o+", Err: "+s),o===t.REWARD_ID?a.I.emit(i.Event.REWARD_FAIL,s):o===t.INTERSTITIAL_ID?a.I.emit(i.Event.INTERSTITIAL_FAIL,s):t.BANNER_ID})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.REWARD_SHOW,(function(t){console.log("[TopOnMgr] Reward Video Show: "+t),a.I.emit(i.Event.REWARD_SHOW,t)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.REWARD_CLOSE,(function(t){console.log("[TopOnMgr] Reward Video Closed: "+t),a.I.emit(i.Event.REWARD_CLOSE,t)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.REWARD_FAIL,(function(t){console.error("[TopOnMgr] Reward Video Play Failed: "+t),a.I.emit(i.Event.REWARD_FAIL,t)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.REWARD_PROFIT,(function(t){console.log("[TopOnMgr] Reward Video Profit! Give Reward."),a.I.emit(i.Event.REWARD_PROFIT,t)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.INTERSTITIAL_SHOW,(function(t){console.log("[TopOnMgr] Interstitial Show: "+t),a.I.emit(i.Event.INTERSTITIAL_SHOW,t)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.INTERSTITIAL_CLOSE,(function(t){console.log("[TopOnMgr] Interstitial Closed: "+t),a.I.emit(i.Event.INTERSTITIAL_CLOSE,t)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.BANNER_SHOW,(function(i){console.log("[TopOnMgr] Banner Show: "+i)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.BANNER_CLICK,(function(i){console.log("[TopOnMgr] Banner Clicked: "+i)})),n.jsbBridgeWrapper.addNativeEventListener(i.Event.BANNER_CLOSE,(function(i){console.log("[TopOnMgr] Banner Closed: "+i)})))},e.initSDK=function(i,t){(this.isAndroid||this.isIOS)&&(console.log("[TopOnMgr] initSDK: "+i),this.isAndroid?n.reflection.callStaticMethod(this.className,"initSDK","(Ljava/lang/String;Ljava/lang/String;)V",i,t):this.isIOS&&n.reflection.callStaticMethod("AppDelegate","initSDK:appKey:",i,t),this._sdkInitialized=!0,console.log("[TopOnMgr] SDK initialized, checking pending banner..."),this.initAutoAd(this.REWARD_ID),this.initInterstitialAutoAd(this.INTERSTITIAL_ID),this._pendingBannerShow&&(console.log("[TopOnMgr] Processing pending banner show request"),this._pendingBannerShow=!1,this.showBanner()))},e.initAutoAd=function(i){(this.isAndroid||this.isIOS)&&(console.log("[TopOnMgr] initAutoAd (Reward): "+i),this.isAndroid?n.reflection.callStaticMethod(this.className,"initAutoAd","(Ljava/lang/String;)V",i):this.isIOS&&n.reflection.callStaticMethod("AppDelegate","initAutoAd:",i))},e.initInterstitialAutoAd=function(i){(this.isAndroid||this.isIOS)&&(console.log("[TopOnMgr] initAutoAd (Interstitial): "+i),this.isAndroid?n.reflection.callStaticMethod(this.className,"initInterstitialAutoAd","(Ljava/lang/String;)V",i):this.isIOS&&n.reflection.callStaticMethod("AppDelegate","initInterstitialAutoAd:",i))},e.isRewardReady=function(){return!this.isAndroid&&!this.isIOS||(this.isAndroid?n.reflection.callStaticMethod(this.className,"isAutoAdReady","(Ljava/lang/String;)Z",this.REWARD_ID):!!this.isIOS&&n.reflection.callStaticMethod("AppDelegate","isAutoAdReady:",this.REWARD_ID))},e.isInterstitialReady=function(){return!this.isAndroid&&!this.isIOS||(this.isAndroid?n.reflection.callStaticMethod(this.className,"isInterstitialAutoAdReady","(Ljava/lang/String;)Z",this.INTERSTITIAL_ID):!!this.isIOS&&n.reflection.callStaticMethod("AppDelegate","isInterstitialAutoAdReady:",this.INTERSTITIAL_ID))},e.loadRewardVideo=function(){console.log("[TopOnMgr] loadRewardVideo: Manual Retry Fallback"),this.initAutoAd(this.REWARD_ID)},e.showRewardVideo=function(){if(!this.isAndroid&&!this.isIOS)return console.log("[TopOnMgr] Mock Show Reward"),a.I.emit(i.Event.REWARD_SHOW,"mock"),void setTimeout((function(){a.I.emit(i.Event.REWARD_PROFIT,"mock"),a.I.emit(i.Event.REWARD_CLOSE,"mock")}),1e3);console.log("[TopOnMgr] showRewardVideo: "+this.REWARD_ID),this.isAndroid?n.reflection.callStaticMethod(this.className,"showAutoAd","(Ljava/lang/String;)V",this.REWARD_ID):this.isIOS&&n.reflection.callStaticMethod("AppDelegate","showAutoAd:",this.REWARD_ID)},e.checkInterstitialLimit=function(){if(s.data.login_days<=1)return console.log("[TopOnMgr] Interstitial blocked: New User Protection (login_days="+s.data.login_days+")"),!1;var i=Date.now()-s.data.lastInterstitialTime;return!(i<3e5)||(console.log("[TopOnMgr] Interstitial blocked: Cooldown active ("+Math.floor((3e5-i)/1e3)+"s remaining)"),!1)},e.showInterstitial=function(){try{if(require("../Base/ReviewMode").ReviewMode.shouldSkipAds())return void console.log("[TopOnMgr] Skipping interstitial - Review Mode active")}catch(i){}if(this.checkInterstitialLimit())return this.isAndroid||this.isIOS?void(this.isInterstitialReady()?(console.log("[TopOnMgr] showInterstitial: "+this.INTERSTITIAL_ID),s.data.lastInterstitialTime=Date.now(),s.save(),this.isAndroid?n.reflection.callStaticMethod(this.className,"showInterstitialAutoAd","(Ljava/lang/String;)V",this.INTERSTITIAL_ID):this.isIOS&&n.reflection.callStaticMethod("AppDelegate","showInterstitialAutoAd:",this.INTERSTITIAL_ID)):console.warn("[TopOnMgr] Interstitial Ad NOT Ready for placement: "+this.INTERSTITIAL_ID)):(console.log("[TopOnMgr] Mock Show Interstitial"),s.data.lastInterstitialTime=Date.now(),s.save(),a.I.emit(i.Event.INTERSTITIAL_SHOW,"mock"),void setTimeout((function(){a.I.emit(i.Event.INTERSTITIAL_CLOSE,"mock")}),1e3))},e.showBanner=function(){if(this.isAndroid||this.isIOS){if(!this._sdkInitialized)return console.log("[TopOnMgr] showBanner: SDK not yet initialized, queuing request"),void(this._pendingBannerShow=!0);console.log("[TopOnMgr] showBanner: "+this.BANNER_ID),this.isAndroid?n.reflection.callStaticMethod(this.className,"showBanner","(Ljava/lang/String;)V",this.BANNER_ID):this.isIOS&&n.reflection.callStaticMethod("AppDelegate","showBanner:",this.BANNER_ID)}},e.hideBanner=function(){(this.isAndroid||this.isIOS)&&(console.log("[TopOnMgr] hideBanner"),this.isAndroid?n.reflection.callStaticMethod(this.className,"hideBanner","()V"):this.isIOS&&n.reflection.callStaticMethod("AppDelegate","hideBanner"))},t(i,[{key:"BANNER_ID",get:function(){return this.isAndroid?"n694298336fa85":this.isIOS?"n694b5ee2c89cc":""}},{key:"REWARD_ID",get:function(){return this.isAndroid?"n6942984e5588a":this.isIOS?"n694b63fa11983":""}},{key:"INTERSTITIAL_ID",get:function(){return this.isAndroid?"n69429862e2c1f":this.isIOS?"n694b6458a86e8":""}}],[{key:"I",get:function(){return this.instance||(this.instance=new i,this.instance.isAndroid=o.isNative&&o.os===o.OS.ANDROID,this.instance.isIOS=o.isNative&&o.os===o.OS.IOS,this.instance.init()),this.instance}}]),i}());r.instance=null,r.Event={REWARD_LOADED:"TOPON_REWARD_LOADED",REWARD_SHOW:"TOPON_REWARD_SHOW",REWARD_CLOSE:"TOPON_REWARD_CLOSE",REWARD_FAIL:"TOPON_REWARD_FAIL",REWARD_PROFIT:"TOPON_REWARD_PROFIT",INTERSTITIAL_LOADED:"TOPON_INTERSTITIAL_LOADED",INTERSTITIAL_SHOW:"TOPON_INTERSTITIAL_SHOW",INTERSTITIAL_CLOSE:"TOPON_INTERSTITIAL_CLOSE",INTERSTITIAL_FAIL:"TOPON_INTERSTITIAL_FAIL",BANNER_LOADED:"TOPON_BANNER_LOADED",BANNER_FAIL:"TOPON_BANNER_FAIL",BANNER_SHOW:"TOPON_BANNER_SHOW",BANNER_CLICK:"TOPON_BANNER_CLICK",BANNER_CLOSE:"TOPON_BANNER_CLOSE",AD_LOADED:"TOPON_AD_LOADED",AD_FAILED:"TOPON_AD_FAILED"},e._RF.pop()}}}));

System.register("chunks:///_virtual/TopUICom.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FallBlocks.ts","./EctypeMgr.ts","./GameData.ts","./Enum.ts","./UIManager.ts","./SdkTools.ts"],(function(e){var t,n,r,o,a,c,i,l,s,u,p,f,k,m,g,x,h,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized,a=e.asyncToGenerator,c=e.regeneratorRuntime},function(e){i=e.cclegacy,l=e.Label,s=e.Node,u=e._decorator,p=e.Component},function(e){f=e.FallBlocks},function(e){k=e.EctypeMgr},function(e){m=e.GameData},function(e){g=e.GameStatus},function(e){x=e.default,h=e.PanelType},function(e){I=e.SdkTools}],execute:function(){var b,_,y,d,S,v,B,P,T,C,G;i._RF.push({},"05c10pI/dpBALVyWgGl1g9z","TopUICom",void 0);var L=u,w=L.ccclass,F=L.property;e("TopUICom",(b=w("Ectype/FallDown/TopUICom"),_=F(l),y=F(l),d=F(f),S=F(s),b((P=t((B=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return t=e.call.apply(e,[this].concat(a))||this,r(t,"cur_score",P,o(t)),r(t,"max_score",T,o(t)),r(t,"next_block",C,o(t)),r(t,"next_lock",G,o(t)),t}n(t,e);var i=t.prototype;return i.freshComponent=function(){this.cur_score.string=""+k.I.score,this.next_block.clearBlocks(),this.next_lock.active=k.I.nextLock,this.max_score.string=""+m.data.fallTopScore},i.freshScore=function(){this.cur_score.string=""+k.I.score},i.freshNextBlock=function(){k.I.nextLock||this.next_block.createBlocks(k.I.getFirstBlockData())},i.onPauseBtnClick=function(){k.I.gameStatus===g.Game&&(k.I.gameStatus=g.Pause,x.addPanel(h.FallPausePanel))},i.onHelpBtnClick=function(){k.I.gameStatus===g.Game&&(k.I.gameStatus=g.Pause,x.addPanel(h.FallHelpPanel))},i.onNextBlockClick=function(){var e=a(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.I.gameStatus===g.Game){e.next=2;break}return e.abrupt("return");case 2:if(!k.I.nextLock){e.next=9;break}return k.I.gameStatus=g.Pause,e.next=6,I.share("fall_next_lock");case 6:t=e.sent,k.I.gameStatus=g.Game,0===t.code&&(k.I.nextLock=!1,this.next_lock.active=k.I.nextLock,this.freshNextBlock());case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(p)).prototype,"cur_score",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(B.prototype,"max_score",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(B.prototype,"next_block",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(B.prototype,"next_lock",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=B))||v));i._RF.pop()}}}));

System.register("chunks:///_virtual/UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetPool.ts","./Const.ts"],(function(e){var n,a,t,i,l,r,o,s,c,p;return{setters:[function(e){n=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){t=e.cclegacy,i=e.UITransform,l=e.view,r=e.find,o=e.director,s=e.Animation},function(e){c=e.AssetPool},function(e){p=e.BUNDLES}],execute:function(){t._RF.push({},"971fdavjXhHpKNpmc+DfzNh","UIManager",void 0),console.log("[Load] Loading UIManager.ts");e("PanelType",function(e){return e.SettingPanel="SettingPanel",e.RevivePanel="RevivePanel",e.EndPanel="EndPanel",e.RetPanel="RetPanel",e.TargetPanel="TargetPanel",e.RankPanel="RankPanel",e.SkinPanel="SkinPanel",e.HelpPanel="HelpPanel",e.ActivityFailPanel="ActivityFailPanel",e.ActGetPanel="ActGetPanel",e.CollectGamePanel="CollectGamePanel",e.DingyuePanel="DingyuePanel",e.RewardPanel="RewardPanel",e.DailyFailPanel="DailyFailPanel",e.FallPausePanel="FallPausePanel",e.FallRevivePanel="FallRevivePanel",e.FallFailPanel="FallFailPanel",e.FallHelpPanel="FallHelpPanel",e.ReplacePanel="ReplacePanel",e.GoPanel="GoPanel",e.HandbookPanel="HandbookPanel",e.DailyPanel="DailyPanel",e.ActivityPanel="ActivityPanel",e.MoreGamePanel="MoreGamePanel",e.LanguagePanel="LanguagePanel",e}({}));var u=e("default",function(){function e(){}return e.loadData=function(){var e=n(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.openPanel=function(){var t=n(a().mark((function n(t){var i,l,r,o,u,d,h=arguments;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(i=h.length,l=new Array(i>1?i-1:0),r=1;r<i;r++)l[r-1]=h[r];if(!this.panelHideList||!this.panelHideList[t]){n.next=8;break}return e.panel_type=t,this.isOpen=!0,this.panelHideList[t].node.active=!0,this.adaptPanelBg(this.panelHideList[t].node),(o=this.panelHideList[t]).init.apply(o,l),n.abrupt("return");case 8:if(!this.isOpen){n.next=12;break}this.panelDataList.push({type:t,arg:l}),n.next=24;break;case 12:if(this.isOpen=!0,u=c.I.get(t)){n.next=18;break}return n.next=17,c.I.createObjAsync(p.Panel,t);case 17:u=n.sent;case 18:e.panel_type=t,this.addChild(u),this.adaptPanelBg(u),(d=u.getComponent("Panel"))&&d.init.apply(d,l),u.getComponent(s)&&u.getComponent(s).play();case 24:case"end":return n.stop()}}),n,this)})));return function(e){return t.apply(this,arguments)}}(),e.adaptPanelBg=function(e){var n=e.getChildByName("bg");if(n){var a=n.getComponent(i);if(a){var t=l.getVisibleSize(),r=a.width,o=a.height;if(!(r>=t.width&&o>=t.height)){var s=t.width/r,c=t.height/o,p=Math.max(s,c),u=r*p,d=o*p;a.setContentSize(u,d),console.log("[UIManager] Panel bg adapted: "+r+"x"+o+" -> "+u.toFixed(0)+"x"+d.toFixed(0))}}}},e.waitOpenPanel=function(n){for(var a=arguments.length,t=new Array(a>1?a-1:0),i=1;i<a;i++)t[i-1]=arguments[i];return new Promise((function(a,i){e.openPanel.apply(e,[n,a].concat(t))}))},e.waitAddPanel=function(n){for(var a=arguments.length,t=new Array(a>1?a-1:0),i=1;i<a;i++)t[i-1]=arguments[i];return new Promise((function(a,i){e.addPanel.apply(e,[n,a].concat(t))}))},e.nextPanel=function(){if(this.panelDataList.length>0){var n=this.panelDataList.shift();this.isOpen=!1,this.openPanel.apply(this,[n.type].concat(n.arg))}else e.panel_type=null,this.isOpen=!1},e.addPanel=function(){var t=n(a().mark((function n(t){var i,l,r,o,u,d=arguments;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=c.I.get(t)){n.next=5;break}return n.next=4,c.I.createObjAsync(p.Panel,t);case 4:i=n.sent;case 5:if(e.panel_type=t,l=i.getComponent("Panel")){for(r=d.length,o=new Array(r>1?r-1:0),u=1;u<r;u++)o[u-1]=d[u];l.init.apply(l,o)}this.addChild(i),this.adaptPanelBg(i),i.getComponent(s)&&i.getComponent(s).play();case 11:case"end":return n.stop()}}),n,this)})));return function(e){return t.apply(this,arguments)}}(),e.addChild=function(e){var n=this._root;null==n&&(n=r("Canvas").getChildByName("panel"),this._root=n),e.parent=n},e.hdiePanel=function(e,n){if(this.panelHideList)this.panelHideList[e]||(this.panelHideList[e]=n);else{var a,t=((a={})[""+e]=n,a);this.panelHideList=t}n.node.active=!1},e.loadScene=function(e){var t=this;return new Promise(n(a().mark((function n(i,l){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.preloadScene(e);case 2:r=n.sent;case 3:if(r){n.next=8;break}return n.next=6,t.preloadScene(e);case 6:n.next=3;break;case 8:o.loadScene(e,(function(){i(1)}));case 9:case"end":return n.stop()}}),n)}))))},e.handleBack=function(){if(null==this._root&&(this._root=r("Canvas").getChildByName("panel")),this._root&&this._root.children.length>0){var e=this._root.children[this._root.children.length-1];if(e){var n=e.getComponent("Panel");return n&&n.close?(console.log("[UIManager] handleBack: Closing panel "+e.name),n.close(),!0):(console.log("[UIManager] handleBack: Destroying node "+e.name),e.destroy(),!0)}}return!1},e.preloadScene=function(e){return new Promise((function(t,i){o.preloadScene(e,n(a().mark((function e(n,i){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(!n);case 1:case"end":return e.stop()}}),e)}))))}))},e}());u.panelDataList=[],u.panelHideList=void 0,u.isOpen=!1,u.panel_type=void 0,u._root=null,t._RF.pop()}}}));

System.register("chunks:///_virtual/Utils.ts",["./rollupPluginModLoBabelHelpers.js","cc","./I18nManager.ts"],(function(t){var e,n,r,o;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,r=t.sys},function(t){o=t.I18n}],execute:function(){n._RF.push({},"4f93a987UxIA783XACvE6UE","Utils",void 0);t("Utils",function(){function t(){}return t.getServerTime=function(){return r.isNative?Math.floor(Date.now()/1e3):"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Time?PUCHI_SDK.Time.currentTime:Math.floor(Date.now()/1e3)},t.getOnlineParamInt=function(t,e){return r.isNative?e:"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService?PUCHI_SDK.OnlineService.getParamsInt(t,e):e},t.getOnlineParamString=function(t,e){return r.isNative?e:"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.OnlineService?PUCHI_SDK.OnlineService.getParamsString(t,e):e},t.tryParseJSON=function(t,e){var n=e;try{n=JSON.parse(t)||e}catch(t){}return n},t.getLocalStorage=function(t,e){var n=r.localStorage.getItem(t)||"";return this.tryParseJSON(n,e)},t.setLocalStorage=function(t,e){r.localStorage.setItem(t,JSON.stringify(e))},t.clone=function(t){return JSON.parse(JSON.stringify(t))},t.isEmpty=function(t){return"{}"===JSON.stringify(t)},t.random=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},t.randOneList=function(t){return t[this.random(0,t.length-1)]},t.randomList=function(t){return t.sort((function(){return Math.random()-.5}))},t.randomOneByWeight=function(t,e){for(var n,r=0,o=new Array,a=0;a<t.length;a++)n=void 0!==t[a].weight?t[a].weight:0,o[a]=n,r=this.mathGcd(r,n);for(var i=new Array,u=0,c=0,f=0;f<t.length;f++){c=o[f]/r;for(var s=0;s<c;s++)i.push(f);u+=c}return t[i[Math.floor(Math.random()*u)]]},t.mathGcd=function(t,e){var n=Math.min(t,e),r=Math.max(t,e),o=1;if(0===t||0===e)return r;for(var a=n;a>=1;a--)if(n%a==0&&r%a==0){o=a;break}return o},t.sum=function(t){if(0==t.length)return 0;var e=t.reduce((function(t,e){return t+e}),0);return e},t.wait=function(t){return void 0===t&&(t=1e3),new Promise((function(e,n){setTimeout((function(){e()}),t)}))},t.until=function(t){return new Promise((function(e,n){var r=setInterval((function(){t()&&(clearInterval(r),e())}),.01)}))},t.toTimeStr=function(t,e){void 0===e&&(e=!1);var n,r=t;e&&(n=Math.floor(r/3600)+"",r%=3600);var o=Math.floor(r/60)+"",a=Math.floor(r%60)+"";return o=1===o.length?"0"+o:o,a=1===a.length?"0"+a:a,e?(n=1===n.length?"0"+n:n)+":"+o+":"+a:o+":"+a},t.nowDayBegin=function(){return new Date((new Date).toLocaleDateString()).getTime()},t.nextDay=function(){return new Date((new Date).toLocaleDateString()).getTime()+864e5},t.getDateNow12=function(){return new Date((new Date).toLocaleDateString()).getTime()+432e5},t.getHMS=function(t){t/=1e3;var e=Math.floor(t/3600),n=Math.floor(t%3600/60),r=Math.floor(t%60);return e>0?e+":"+this.add(n)+":"+this.add(r):this.add(n)+":"+this.add(r)},t.getFormatBySecond2=function(t,e){void 0===e&&(e=!1);var n=new Date(t),r=n.getFullYear(),o=n.getMonth()+1,a=n.getDate(),i=n.getHours(),u=n.getMinutes(),c=n.getSeconds();return e?r+"-"+this.add(o)+"-"+this.add(a):r+"-"+o+"-"+a+" "+i+":"+u+":"+c},t.add=function(t){return t<10?"0"+t:t},t.webCopyString=function(t){var e=t+"",n=document.createElement("textarea");n.value=e,n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-9999px",n.style.fontSize="12pt";var r=getSelection(),o=!1;r.rangeCount>0&&(o=r.getRangeAt(0)),document.body.appendChild(n),n.select(),n.selectionStart=0,n.selectionEnd=e.length;var a=!1;try{a=document.execCommand("copy")}catch(t){}return document.body.removeChild(n),o&&(r.removeAllRanges(),r.addRange(o)),a},t.getAngle=function(t,e,n,r){var o=Math.abs(t-n),a=Math.abs(e-r),i=a/Math.sqrt(Math.pow(o,2)+Math.pow(a,2)),u=Math.acos(i),c=Math.floor(180/(Math.PI/u));return n>t&&r>e&&(c=180-c),n==t&&r>e&&(c=180),n>t&&r==e&&(c=90),n<t&&r>e&&(c=180+c),n<t&&r==e&&(c=270),n<t&&r<e&&(c=360-c),c},t.unique=function(t){return Array.from(new Set(t))},t.getDate=function(t){var e=3600,n=Math.floor(t/86400),r=Math.floor(t%86400/e),a=Math.floor((t-r*e)/60),i=Math.floor((t-r*e)%60),u="";return t>0?0==n?("",0==r?(u="",0==a?("",0==i?"":i<10?o.t("time.second","0"+i):o.t("time.second",i)):o.t("time.minute",a)+(0==i?"":i<10?o.t("time.second","0"+i):o.t("time.second",i))):(u=o.t("time.hour",r),0==a?("",u+(0==i?"":i<10?o.t("time.second","0"+i):o.t("time.second",i))):u+(a<10?o.t("time.minute","0"+a):o.t("time.minute",a)))):o.t("time.day",n):""},t.randFromList=function(t,e){return this.randSortList(t).slice(0,e)},t.removeFromList=function(t,e){var n=t.indexOf(e);t.splice(n,1)},t.randSortList=function(t){return t.sort((function(){return Math.random()-.5}))},t.randN=function(t,e,n){for(var r=[],o=t;o<e;o++)r.push(o);return this.randSortList(r).slice(0,n)},t.shuffleArray=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),r=[t[n],t[e]];t[e]=r[0],t[n]=r[1]}},t.rotate90Clockwise=function(t){for(var e=t.length,n=t[0].length,r=[],o=0;o<n;o++){r[o]=[];for(var a=0;a<e;a++)r[o][a]=t[a][o]}for(var i=0;i<n;i++)r[i].reverse();return r},e(t,null,[{key:"isWX",get:function(){return"undefined"!=typeof wx}}]),t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/Vec2Pool.ts",["cc"],(function(o){var t,e;return{setters:[function(o){t=o.cclegacy,e=o.Vec2}],execute:function(){t._RF.push({},"ccd17XqZkVN9pR0NglCllDN","Vec2Pool",void 0);var i=o("Vec2Pool",function(){function o(){}return o.get=function(o,t){if(o=o||0,t=t||0,this._poolSize>0){this._poolSize--;var i=this._pool.pop();return i.x=o,i.y=t,i}return new e(o,t)},o.put=function(o){this._pool.push(o),this._poolSize++},o.puts=function(){for(var o=0;o<arguments.length;o++)this.put(o<0||arguments.length<=o?void 0:arguments[o])},o.clear=function(){this._pool.length=0,this._poolSize=0},o}());i._pool=[],i._poolSize=0,t._RF.pop()}}}));

System.register("chunks:///_virtual/VKPlatform.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,o;return{setters:[function(e){t=e.createClass,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"dfed8VeVjZE/4MT4fJ62fBO","VKPlatform",void 0);e("VKPlatform",function(){function e(){this.name="VK",this.isNative=!1}var o=e.prototype;return o.init=function(){console.log("VKPlatform init")},o.login=function(){var e=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getUserInfo());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.getUserInfo=function(){var e=n(r().mark((function e(){var t=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(!t.bridge)return console.warn("[VK] vkBridge not found"),void e({code:-1});t.bridge.send("VKWebAppGetUserInfo").then((function(t){var n,r;console.log("[VK] User info:",t);var o={nickName:t.first_name+" "+t.last_name,avatarUrl:t.photo_100,city:null==(n=t.city)?void 0:n.title,country:null==(r=t.country)?void 0:r.title,gender:1===t.sex?2:1,id:t.id};e({code:0,userInfo:o})})).catch((function(t){console.error("[VK] GetUserInfo failed:",t),e({code:-1,msg:"Get User Info Failed"})}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o.getLanguage=function(){return new URLSearchParams(window.location.search).get("language")||navigator.language||"en"},o.showBanner=function(){this.bridge&&this.bridge.send("VKWebAppShowBannerAd",{banner_location:"bottom"}).then((function(e){e.result&&console.log("[VK] Banner shown")})).catch((function(e){console.warn("[VK] ShowBanner error:",e)}))},o.hideBanner=function(){this.bridge&&this.bridge.send("VKWebAppHideBannerAd").then((function(e){e.result&&console.log("[VK] Banner hidden")})).catch((function(e){console.warn("[VK] HideBanner error:",e)}))},o.showRewardVideo=function(){var e=n(r().mark((function e(t){var n=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=2;break}return e.abrupt("return",Promise.resolve({code:-1,msg:"SDK missing"}));case 2:return e.abrupt("return",new Promise((function(e){n.bridge.send("VKWebAppShowNativeAds",{ad_format:"reward"}).then((function(t){t.result?e({code:0,msg:"Success"}):e({code:-1,msg:"Failed"})})).catch((function(t){console.error("[VK] ShowRewardVideo failed:",t),e({code:-1,msg:"Error"})}))})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.showInterstitial=function(){var e=n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=2;break}return e.abrupt("return");case 2:this.bridge.send("VKWebAppShowNativeAds",{ad_format:"interstitial"}).then((function(e){console.log("[VK] Interstitial result:",e)})).catch((function(e){console.error("[VK] ShowInterstitial failed:",e)}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.showInterstitialWithCallback=function(e){this.showInterstitial().then((function(){e&&e()}))},o.share=function(e,t,n){this.bridge&&this.bridge.send("VKWebAppShare",{link:"https://vk.com/app"+this.getAppId()})},o.uploadRankData=function(e,t,n){console.log("[VK] uploadRankData: "+e+" = "+t)},o.postMessage=function(e,t){},o.trackEvent=function(e,t){console.log("[VK] Track Event: "+e,t)},o.getSafeAreaTop=function(){return 0},o.getVersion=function(){return"1.0.0"},o.supportCloudStorage=function(){return!0},o.saveData=function(){var e=n(r().mark((function e(t,n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.bridge.send("VKWebAppStorageSet",{key:t,value:n});case 5:console.log("[VK] CloudStorage set success:",t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("[VK] CloudStorage set failed:",e.t0);case 11:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t,n){return e.apply(this,arguments)}}(),o.loadData=function(){var e=n(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.bridge){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,this.bridge.send("VKWebAppStorageGet",{keys:[t]});case 5:if(!((n=e.sent).keys&&n.keys.length>0)){e.next=8;break}return e.abrupt("return",n.keys[0].value);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("[VK] CloudStorage get failed:",e.t0);case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),o.getAppId=function(){return new URLSearchParams(window.location.search).get("vk_app_id")||""},o.vibrateShort=function(e){this.bridge&&this.bridge.supports("VKWebAppTapticImpactOccurred")&&this.bridge.send("VKWebAppTapticImpactOccurred",{style:e||"medium"})},o.vibrateLong=function(){this.bridge&&this.bridge.supports("VKWebAppTapticNotificationOccurred")&&this.bridge.send("VKWebAppTapticNotificationOccurred",{type:"success"})},o.gameReady=function(){console.log("[VK] gameReady called"),this.bridge&&this.bridge.send("VKWebAppInit").then((function(){return console.log("[VK] VKWebAppInit confirmed in gameReady")})).catch((function(e){return console.error("[VK] VKWebAppInit re-call failed:",e)}))},o.gameplayStart=function(){console.log("[VK] gameplayStart")},o.gameplayStop=function(){console.log("[VK] gameplayStop")},t(e,[{key:"bridge",get:function(){return window.vkBridge}}]),e}());o._RF.pop()}}}));

System.register("chunks:///_virtual/Waiting.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetPool.ts"],(function(t){var e,i,n,o,a,r,s,l,c,u,g,d,h,f,p,m,W,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,r=t.Node,s=t._decorator,l=t.UITransform,c=t.view,u=t.Tween,g=t.tween,d=t.resources,h=t.Prefab,f=t.error,p=t.find,m=t.isValid,W=t.Component},function(t){v=t.AssetPool}],execute:function(){var b,y,w,N,A,C;a._RF.push({},"cb61eLXCOpLi6DYIOauW0Bc","Waiting",void 0),console.log("[Load] Loading Waiting.ts");var B=s,L=B.ccclass,P=B.property,x="CommonLoading",I="remove",z=0,D=1,F=3;t("Waiting",(b=L("Waiting"),y=P(r),b(((C=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,n(e,"rotateNode",A,o(e)),e.state=z,e}i(e,t);var a=e.prototype;return a.onEnable=function(){this.state=D,this.runAnim(),this.adaptBg()},a.adaptBg=function(){var t=this.node.getChildByName("bg");if(t){var e=t.getComponent(l);if(e){var i=c.getVisibleSize(),n=e.width,o=e.height,a=i.width/n,r=i.height/o,s=Math.max(a,r),u=n*s,g=o*s;e.setContentSize(u,g),console.log("[Waiting] bg adapted: "+n+"x"+o+" -> "+u.toFixed(0)+"x"+g.toFixed(0))}}},a.onDisable=function(){this.stopAnim()},a.hide=function(){this.state!==F&&this.node.emit(I,this)},a.runAnim=function(){var t=this;u.stopAllByTarget(this.rotateNode),this.rotateNode.angle=0,g(this.rotateNode).to(1,{angle:-360}).call((function(){t.rotateNode.angle=0})).union().repeatForever().start()},a.stopAnim=function(){u.stopAllByTarget(this.rotateNode),this.rotateNode.angle=0},a.lateUpdate=function(t){},e.load=function(){return new Promise((function(t,e){d.load("Waiting",h,(function(e,i){if(e)return f("load Waiting error: "+e.message),void t();v.I.addPrefab(i,x),t()}))}))},e.showWaiting=function(){var t=v.I.createObject(x);return t.parent=p("Canvas"),t.once(I,(function(t){t&&m(t.node)&&(t.node.emit(I),console.log("还回对象池"),v.I.put(t),e.lastWaiting=null)})),e.lastWaiting=t.getComponent(e),e.lastWaiting},e.show=function(){if(!e.lastWaiting)return e.showWaiting()},e.hide=function(){e.lastWaiting&&e.lastWaiting.hide()},e}(W)).lastWaiting=null,A=e((N=C).prototype,"rotateNode",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=N))||w));a._RF.pop()}}}));

System.register("chunks:///_virtual/WechatPlatform.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t;return{setters:[function(e){n=e.extends},function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"284b9gdWwxHQqwEwlxZYXXb","WechatPlatform",void 0);e("WechatPlatform",function(){function e(){this.name="Wechat"}var t=e.prototype;return t.init=function(){console.log("WechatPlatform init")},t.login=function(){return new Promise((function(e,n){"undefined"!=typeof wx?wx.login({success:function(n){e(n)},fail:function(e){n(e)}}):e({})}))},t.getUserInfo=function(){return new Promise((function(e,n){"undefined"!=typeof wx?wx.getUserInfo({success:function(n){e(n)},fail:function(e){n(e)}}):e({})}))},t.vibrateShort=function(e){void 0===e&&(e="medium"),"undefined"!=typeof wx&&wx.vibrateShort({type:e})},t.vibrateLong=function(){"undefined"!=typeof wx&&wx.vibrateLong()},t.showBanner=function(){"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Banner&&PUCHI_SDK.Banner.show()},t.hideBanner=function(){"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Banner&&PUCHI_SDK.Banner.hide()},t.showInterstitial=function(){"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.InterstitialAd&&PUCHI_SDK.InterstitialAd.show()},t.showRewardVideo=function(e){return new Promise((function(n){"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.ShareVideoService?PUCHI_SDK.ShareVideoService.play(e).then((function(e){n(e)})):n({code:0,msg:"ok"})}))},t.uploadRankData=function(e,t,o){if("undefined"!=typeof wx){var i=n({value:t},o);wx.setUserCloudStorage({KVDataList:[{key:e,value:JSON.stringify(i)}]})}},t.postMessage=function(e,n){"undefined"!=typeof wx&&wx.getOpenDataContext().postMessage({eventType:e,data:n})},t.trackEvent=function(e,n){"undefined"!=typeof PUCHI_SDK&&PUCHI_SDK.Analytics&&PUCHI_SDK.Analytics.trace(e,n)},t.getSafeAreaTop=function(){if("undefined"!=typeof wx){var e=wx.getSystemInfoSync();if(e.safeArea)return e.safeArea.top}return 0},t.getVersion=function(){return"1.0.0"},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/YandexPlatform.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,a,o;return{setters:[function(e){n=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"a1814DbQ3NHX5Wb+NccM5zA","YandexPlatform",void 0);e("YandexPlatform",function(){function e(){this.name="Yandex",this._ysdk=null,this._player=null,this._lb=null,console.log("YandexPlatform constructor")}var o=e.prototype;return o.init=function(){console.log("YandexPlatform init (sync wrapper)"),this.initAsync().catch((function(e){return console.error("Yandex init failed in background",e)}))},o.initAsync=function(){var e=n(a().mark((function e(){var n,o,t,r,s,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("YandexPlatform initAsync"),n=window.location.hostname,!("localhost"===n||"127.0.0.1"===n||n.startsWith("192.168.")||n.startsWith("10."))){e.next=10;break}return console.warn("[Yandex] Local environment detected. Swapping to MOCK SDK to prevent 'No parent' errors."),this._ysdk=this.createLocalMockSDK(),e.next=8,this._ysdk.getPlayer();case 8:return this._player=e.sent,e.abrupt("return");case 10:if(!this._ysdk){e.next=13;break}return console.log("Yandex SDK already initialized (local)"),e.abrupt("return");case 13:o=5e3,t=100,r=0;case 16:if(window.ysdk||!(r<o)){e.next=26;break}if(window.YaGames){e.next=20;break}return console.error("[Yandex] SDK script not loaded (no window.YaGames). Cannot initialize."),e.abrupt("return");case 20:return console.log("[Yandex] Waiting for SDK init... ("+r+"ms)"),e.next=23,new Promise((function(e){return setTimeout(e,t)}));case 23:r+=t,e.next=16;break;case 26:if(!window.ysdk){e.next=31;break}console.log("[Yandex] SDK found in window.ysdk (Early Init). Reusing..."),this._ysdk=window.ysdk,e.next=50;break;case 31:if(console.warn("[Yandex] window.ysdk not set after timeout. Attempting lazy init..."),!window.YaGames){e.next=48;break}return e.prev=33,e.next=36,window.YaGames.init();case 36:s=e.sent,this._ysdk=s,window.ysdk=s,console.log("[Yandex] SDK initialized (Lazy fallback)"),e.next=46;break;case 42:throw e.prev=42,e.t0=e.catch(33),console.error("[Yandex] SDK lazy init failed:",e.t0),e.t0;case 46:e.next=50;break;case 48:return console.error("[Yandex] Cannot initialize SDK: YaGames not available."),e.abrupt("return");case 50:if(!this._ysdk){e.next=62;break}return e.prev=51,e.next=54,this._ysdk.getPlayer();case 54:i=e.sent,this._player=i,console.log("Yandex Player initialized:",i.getUniqueID()),e.next=62;break;case 59:e.prev=59,e.t1=e.catch(51),console.warn("Yandex Player init (guest/unauth):",e.t1);case 62:case"end":return e.stop()}}),e,this,[[33,42],[51,59]])})));return function(){return e.apply(this,arguments)}}(),o.createLocalMockSDK=function(){return console.log("[Yandex] Creating Mock SDK..."),{environment:{app:{id:"mock_app_id"},i18n:{lang:"en",tld:"com"}},features:{LoadingAPI:{ready:function(){return console.log("[Mock-Yandex] LoadingAPI.ready()")}}},getPlayer:function(){return Promise.resolve({getUniqueID:function(){return"mock_user_id"},getName:function(){return"Mock User"},getPhoto:function(e){return"mock_avatar_url"},setData:function(e,n){return console.log("[Mock-Yandex] Player.setData",e),Promise.resolve()},getData:function(e){return console.log("[Mock-Yandex] Player.getData",e),Promise.resolve({})}})},getLeaderboards:function(){return Promise.resolve({setLeaderboardScore:function(e,n){return console.log("[Mock-Yandex] setLeaderboardScore "+e+": "+n),Promise.resolve()}})},adv:{showFullscreenAdv:function(e){console.log("[Mock-Yandex] showFullscreenAdv"),e.callbacks&&e.callbacks.onClose&&e.callbacks.onClose(!0)},showRewardedVideo:function(e){console.log("[Mock-Yandex] showRewardedVideo"),e.callbacks&&(e.callbacks.onOpen&&e.callbacks.onOpen(),e.callbacks.onRewarded&&e.callbacks.onRewarded(),e.callbacks.onClose&&e.callbacks.onClose())}}}},o.login=function(){var e=this;return new Promise((function(n){e._ysdk?e._player?n({code:0,userInfo:{userId:e._player.getUniqueID(),nickName:e._player.getName()||"Guest",avatarUrl:e._player.getPhoto("medium")||""}}):e._ysdk.getPlayer().then((function(a){e._player=a,n({code:0,userInfo:{userId:a.getUniqueID(),nickName:a.getName()||"Guest",avatarUrl:a.getPhoto("medium")||""}})})).catch((function(e){console.log("Yandex login required"),n({code:1,msg:"User need login"})})):n({code:1,msg:"SDK not ready"})}))},o.getUserInfo=function(){return this._player?Promise.resolve({userId:this._player.getUniqueID(),nickName:this._player.getName(),avatarUrl:this._player.getPhoto("medium")}):Promise.resolve({})},o.vibrateShort=function(e){navigator.vibrate&&navigator.vibrate(15)},o.vibrateLong=function(){navigator.vibrate&&navigator.vibrate(200)},o.showBanner=function(){console.log("Yandex showBanner (Not fully supported/implemented)")},o.hideBanner=function(){console.log("Yandex hideBanner")},o.showInterstitial=function(){var e=this;console.log("[Yandex] showInterstitial called, SDK ready: "+!!this._ysdk),this._ysdk?(this.gameplayStop(),this.muteGameAudio(),this._ysdk.adv.showFullscreenAdv({callbacks:{onClose:function(n){console.log("[Yandex] Interstitial closed",n),e.unmuteGameAudio(),e.gameplayStart()},onError:function(n){console.log("[Yandex] Interstitial Error",n),e.unmuteGameAudio(),e.gameplayStart()}}})):console.log("[Yandex] showInterstitial skipped - SDK not ready")},o.muteGameAudio=function(){try{var e=require("../Manager/AudioManager").AudioManager;e&&e.I&&(e.I.pauseMusic(),e.I.setEffect(!1),console.log("[Yandex] Game audio muted for ad"))}catch(e){console.warn("[Yandex] Failed to mute audio:",e)}},o.unmuteGameAudio=function(){try{var e=require("../Manager/AudioManager").AudioManager,n=require("../Base/GameData").GameData;e&&e.I&&(e.I.resumeMusic(),n&&n.data?e.I.setEffect(n.data.sound):e.I.setEffect(!0),console.log("[Yandex] Game audio unmuted after ad"))}catch(e){console.warn("[Yandex] Failed to unmute audio:",e)}},o.showRewardVideo=function(e){var n=this;return new Promise((function(e){if(n._ysdk){n.gameplayStop(),n.muteGameAudio();var a=!1;n._ysdk.adv.showRewardedVideo({callbacks:{onOpen:function(){console.log("Video ad open.")},onRewarded:function(){console.log("Rewarded!"),a=!0},onClose:function(){console.log("Video ad closed."),n.unmuteGameAudio(),n.gameplayStart(),e(a?{code:0,msg:"Success"}:{code:1,msg:"User skipped"})},onError:function(a){console.log("Error while open video ad:",a),n.unmuteGameAudio(),n.gameplayStart(),e({code:1,msg:"Error"})}}})}else e({code:1,msg:"SDK not ready"})}))},o.uploadRankData=function(e,n,a){if(this._ysdk)if(this._player)try{var o;null!=(o=this._ysdk.leaderboards)&&o.setScore?this._ysdk.leaderboards.setScore(e,n).then((function(){console.log("[Yandex] Upload rank "+e+": "+n)})).catch((function(e){var n;null!=e&&null!=(n=e.message)&&n.includes("no auth")||"NO_AUTH"===(null==e?void 0:e.code)?console.log("[Yandex] Rank upload skipped (no auth)"):console.warn("[Yandex] Rank upload warning:",(null==e?void 0:e.message)||e)})):this._ysdk.getLeaderboards?this._ysdk.getLeaderboards().then((function(a){a.setLeaderboardScore(e,n),console.log("[Yandex] Upload rank "+e+": "+n+" (legacy API)")})).catch((function(e){return console.log("[Yandex] Rank upload skipped:",null==e?void 0:e.message)})):console.log("[Yandex] No leaderboard API available")}catch(e){console.warn("[Yandex] uploadRankData error:",e)}else console.log("[Yandex] Skipping rank upload (user not authenticated)")},o.postMessage=function(e,n){},o.trackEvent=function(e,n){console.log("[Yandex] Track "+e,n)},o.getSafeAreaTop=function(){return 50},o.getVersion=function(){return"1.0.0"},o.saveData=function(e,n){var a=this;return new Promise((function(o,t){if(!a._player)return console.log("[Yandex] Player not ready, save ignored (Guest/Local)"),void o();var r={};r[e]=n,a._player.setData(r,!0).then((function(){console.log("[Yandex] Saved "+e),o()})).catch((function(e){console.error("[Yandex] Save failed",e),o()}))}))},o.loadData=function(e){var n=this;return new Promise((function(a,o){if(!n._player)return console.log("[Yandex] Player not ready, load ignored (Guest/Local)"),void a(null);n._player.getData([e]).then((function(n){n&&void 0!==n[e]?a(n[e]):a(null)})).catch((function(e){console.error("[Yandex] Load failed",e),a(null)}))}))},o.getLanguage=function(){return this._ysdk&&this._ysdk.environment&&this._ysdk.environment.i18n?this._ysdk.environment.i18n.lang:navigator.language||"en"},o.gameReady=function(){this._ysdk&&this._ysdk.features&&this._ysdk.features.LoadingAPI?(this._ysdk.features.LoadingAPI.ready(),console.log("[Yandex] LoadingAPI.ready() called.")):console.log("[Yandex] LoadingAPI not available (SDK not ready or missing).")},o.gameplayStart=function(){var e;null!=(e=this._ysdk)&&null!=(e=e.features)&&e.GameplayAPI&&(this._ysdk.features.GameplayAPI.start(),console.log("[Yandex] GameplayAPI.start() called."))},o.gameplayStop=function(){var e;null!=(e=this._ysdk)&&null!=(e=e.features)&&e.GameplayAPI&&(this._ysdk.features.GameplayAPI.stop(),console.log("[Yandex] GameplayAPI.stop() called."))},e}());o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});